/home/backup/lh/anaconda3/bin/python3 /home/backup/lh/KD/mae_lite/tools/train.py 
2026-01-29 15:21:18.081 | INFO     | __main__:main_worker:227 - gpuid: 0, args: <>Namespace(dist_backend='nccl', dist_url=None, batch_size=32, max_epoch=100, devices='0', eval=True, exp_file='/home/backup/lh/KD/projects/eval_tools/finetuning_progressive_v3_exp.py', ckpt='/home/backup/lh/KD/outputs/HiFuse_Small_1e-5-0.05/ft_progressive_v3_eval/88.4last_epoch_best_ckpt.checkpoints.tar', amp=False, exp_options=None, world_size=1)
/home/backup/lh/KD/mae_lite/tools/train.py:228: DeprecationWarning: The 'ansi' parameter is deprecated, please use 'colors' instead
  logger.opt(ansi=True).info(
2026-01-29 15:21:18.089 | INFO     | __main__:main_worker:228 - Used experiment configs:
======================  ========================================================================================================
config key              value
======================  ========================================================================================================
batch_size              32
max_epoch               100
seed                    0
data_format             image
clip_grad               1.0
clip_mode               norm
output_dir              /home/backup/lh/KD/outputs
print_interval          10
dump_interval           5
eval_interval           1
enable_tensorboard      True
dataset                 MyDataSet
transform               typical_imagenet_transform
image_size              224
encoder_arch            HiFuse_Small
pretrained              False
num_classes             3
global_pool             True
img_size                224
input_size              <class 'NoneType'>
crop_pct                <class 'NoneType'>
mean                    <class 'NoneType'>
std                     <class 'NoneType'>
interpolation
validation_batch_size   <class 'NoneType'>
validation_dataset      MyDataSet
test_dataset            MyDataSet
test_batch_size         <class 'NoneType'>
opt                     adamw
opt_eps                 1e-08
opt_betas               (0.9, 0.999)
momentum                0.9
weight_decay            0.05
sched                   warmcos
basic_lr_per_img        3.125e-06
lr_noise                <class 'NoneType'>
lr_noise_pct            0.67
lr_noise_std            1.0
lr_cycle_mul            1.0
lr_cycle_decay          0.5
lr_cycle_limit          1
lr_k_decay              1.0
warmup_lr_per_img       3.125e-06
min_lr_per_img          3.125e-07
epochs                  100
epoch_repeats           0
start_epoch             <class 'NoneType'>
decay_epochs            <class 'NoneType'>
warmup_epochs           3
cooldown_epochs         5
patience_epochs         10
decay_rate              0.1
no_aug                  False
scale                   (0.08, 1.0)
ratio                   (0.75, 1.3333333333333333)
hflip                   0.5
vflip                   0.0
color_jitter            0.4
aa                      rand-m9-mstd0.5-inc1
reprob                  0.25
remode                  pixel
recount                 1
resplit                 False
mixup                   0.0
cutmix                  0.0
cutmix_minmax           <class 'NoneType'>
mixup_prob              1.0
mixup_switch_prob       0.5
mixup_mode              batch
mixup_off_epoch         0
smoothing               0.1
train_interpolation     bicubic
drop                    0.0
drop_connect            <class 'NoneType'>
drop_path               0.1
drop_block              <class 'NoneType'>
bn_tf                   False
bn_momentum             <class 'NoneType'>
bn_eps                  <class 'NoneType'>
sync_bn                 False
dist_bn                 reduce
model_ema               True
model_ema_force_cpu     False
model_ema_decay         0.9998
num_workers             10
weights_prefix
layer_decay             1.0
warmup_lr               1e-06
min_lr                  1e-06
attn_drop_rate          0.0
pretrain_exp_name       HiFuse_Small_1e-5-0.05
save_folder_prefix      ft_progressive_v3_
use_enhanced_model      True
enhancement_reduction   0.0625
backbone_lr_scale       0.05
mhf_lr_scale            0.2
enhancement_lr_scale    3.0
head_lr_scale           2.0
freeze_backbone_epochs  3
push_start_epoch        12
push_interval           8
push_end_epoch          88
push_momentum           0.85
stage1_ckpt_path        <class 'NoneType'>
loss_weights            {'clst_scale': 0.8, 'sep_scale': 0.2, 'orth_scale': 0.02, 'local_consistency_scale': 0.1, 'margin': 0.4}
======================  ========================================================================================================
/home/backup/lh/KD/mae_lite/tools/train.py:235: DeprecationWarning: The 'ansi' parameter is deprecated, please use 'colors' instead
  logger.opt(ansi=True).info("<yellow>Environment info:</yellow>\n<blue>{}</blue>".format(collect_env_info()))
/home/backup/lh/KD/mae_lite/utils/env.py:48: UserWarning: Current path is possibly not a valid git repository.
  warnings.warn("Current path is possibly not a valid git repository.")
2026-01-29 15:21:18.830 | INFO     | __main__:main_worker:235 - Environment info:
----------------------  --------------------------------------------------------------------------
sys.platform            linux
Python                  3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
numpy                   1.24.3
Pillow                  9.4.0
PyTorch                 2.1.0 @/home/backup/lh/anaconda3/lib/python3.11/site-packages/torch
PyTorch debug build     False
CUDA available          True
GPU 0                   NVIDIA GeForce RTX 3090
CUDA_HOME               /usr
NVCC                    Build cuda_12.0.r12.0/compiler.32267302_0
torchvision             0.16.0 @/home/backup/lh/anaconda3/lib/python3.11/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.8.1
----------------------  --------------------------------------------------------------------------
Git status: unknown
----------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.1.1 (Git Hash 64f6bcbcbab628e96f33a62c3e975f8535a7bde4)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-invalid-partial-specialization -Wno-unused-private-field -Wno-aligned-allocation-unavailable -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.1.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

2026-01-29 15:21:19.328474: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-29 15:21:20.283801: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
220 images were found in the dataset.
1753 images for training.
468 images for validation.
2026-01-29 15:21:22.667 | INFO     | projects.eval_tools.finetuning_mae_exp:get_model:120 - Using enhanced model: HiFuse_Small_Enhanced (reduction=0.0625)
[main_model_enhanced] MHF Enhancement: Enabled (reduction=0.0625)
2026-01-29 15:21:22.798 | INFO     | finetuning_progressive_v3_exp:get_model:108 - [Exp] Loss weights adjusted:
2026-01-29 15:21:22.799 | INFO     | finetuning_progressive_v3_exp:get_model:109 -   sep_scale: 0.12 -> 0.2
2026-01-29 15:21:22.799 | INFO     | finetuning_progressive_v3_exp:get_model:110 -   orth_scale: 0.08 -> 0.02
2026-01-29 15:21:22.799 | INFO     | finetuning_progressive_v3_exp:get_model:111 -   local_consistency_scale: 0.05 -> 0.1
2026-01-29 15:21:22.800 | INFO     | finetuning_progressive_v3_exp:get_model:112 -   margin: 0.3 -> 0.4
2026-01-29 15:21:22.802 | INFO     | finetuning_progressive_v3_exp:get_model:108 - [Exp] Loss weights adjusted:
2026-01-29 15:21:22.803 | INFO     | finetuning_progressive_v3_exp:get_model:109 -   sep_scale: 0.12 -> 0.2
2026-01-29 15:21:22.803 | INFO     | finetuning_progressive_v3_exp:get_model:110 -   orth_scale: 0.08 -> 0.02
2026-01-29 15:21:22.804 | INFO     | finetuning_progressive_v3_exp:get_model:111 -   local_consistency_scale: 0.05 -> 0.1
2026-01-29 15:21:22.804 | INFO     | finetuning_progressive_v3_exp:get_model:112 -   margin: 0.3 -> 0.4
2026-01-29 15:21:22.811 | INFO     | __main__:main_worker:262 - Illustration of model strcutures:
Model(
  (model): main_model_enhanced(
    (downsample_layers): ModuleList(
      (0): Sequential(
        (0): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
        (1): LayerNorm()
      )
      (1): Sequential(
        (0): LayerNorm()
        (1): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
      )
      (2): Sequential(
        (0): LayerNorm()
        (1): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
      )
      (3): Sequential(
        (0): LayerNorm()
        (1): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
      )
    )
    (stages): ModuleList(
      (0): Sequential(
        (0): Block(
          (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=96, out_features=384, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=384, out_features=96, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=96, out_features=384, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=384, out_features=96, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=96, out_features=384, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=384, out_features=96, bias=True)
          (drop_path): Identity()
        )
      )
      (1): Sequential(
        (0): Block(
          (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=192, out_features=768, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=768, out_features=192, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=192, out_features=768, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=768, out_features=192, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=192, out_features=768, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=768, out_features=192, bias=True)
          (drop_path): Identity()
        )
      )
      (2): Sequential(
        (0): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (3): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (4): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (5): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (6): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (7): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (8): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
      )
      (3): Sequential(
        (0): Block(
          (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
          (drop_path): Identity()
        )
      )
    )
    (conv_norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
    (patch_embed): PatchEmbed(
      (proj): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
      (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
    )
    (pos_drop): Dropout(p=0, inplace=False)
    (meta_tokenlize): PatchEmbed(
      (proj): Conv2d(96, 768, kernel_size=(16, 16), stride=(16, 16))
      (norm): Identity()
    )
    (layers1): BasicLayer(
      (blocks): ModuleList(
        (0): SwinTransformerBlock(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
        (1): SwinTransformerBlock(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
    )
    (layers2): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=192, out_features=192, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=768, out_features=192, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
    (layers3): BasicLayer(
      (blocks): ModuleList(
        (0-5): 6 x SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=384, out_features=384, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=1536, out_features=384, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
    )
    (layers4): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=1536, out_features=768, bias=False)
        (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
      )
    )
    (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (avgpool): AdaptiveAvgPool1d(output_size=1)
    (head): HeadOptimal(
      (proj): Sequential(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (2): Dropout(p=0.1, inplace=False)
      )
      (proto_manager): DynamicPrototypeManagerOptimal()
      (mixed_attn): MixedAttentionBlockOptimal(
        (cross_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
        )
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
        )
        (light_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
        )
        (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (gate): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=True)
          (1): GELU(approximate='none')
          (2): Linear(in_features=768, out_features=3, bias=True)
        )
      )
      (ffn): Sequential(
        (0): Linear(in_features=768, out_features=3072, bias=True)
        (1): GELU(approximate='none')
        (2): Dropout(p=0.1, inplace=False)
        (3): Linear(in_features=3072, out_features=768, bias=True)
        (4): Dropout(p=0.1, inplace=False)
      )
      (ffn_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (proto_loss_fn): OptimalPrototypeLoss()
    )
    (fu1): MHF_block_v2(
      (att_conv): Sequential(
        (0): Conv2d(192, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(96, 6, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(6, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(192, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(288, 48, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(48, 48, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(288, 96, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.0, inplace=False)
      (enhancement): EnhancementModuleLite(
        (channel_att): Sequential(
          (0): AdaptiveAvgPool2d(output_size=1)
          (1): Conv2d(96, 8, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): ReLU(inplace=True)
          (3): Conv2d(8, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (4): Sigmoid()
        )
        (spatial_att): Sequential(
          (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): Sigmoid()
        )
      )
    )
    (fu2): MHF_block_v2(
      (att_conv): Sequential(
        (0): Conv2d(384, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(192, 12, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(12, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(384, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(576, 96, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(576, 192, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.1, inplace=False)
      (enhancement): EnhancementModuleLite(
        (channel_att): Sequential(
          (0): AdaptiveAvgPool2d(output_size=1)
          (1): Conv2d(192, 12, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): ReLU(inplace=True)
          (3): Conv2d(12, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (4): Sigmoid()
        )
        (spatial_att): Sequential(
          (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): Sigmoid()
        )
      )
    )
    (fu3): MHF_block_v2(
      (att_conv): Sequential(
        (0): Conv2d(768, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(384, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(24, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(768, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(1152, 192, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(1152, 384, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.2, inplace=False)
      (enhancement): EnhancementModuleLite(
        (channel_att): Sequential(
          (0): AdaptiveAvgPool2d(output_size=1)
          (1): Conv2d(384, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): ReLU(inplace=True)
          (3): Conv2d(24, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (4): Sigmoid()
        )
        (spatial_att): Sequential(
          (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): Sigmoid()
        )
      )
    )
    (fu4): MHF_block_v2(
      (att_conv): Sequential(
        (0): Conv2d(1536, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(768, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(48, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(1536, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(2304, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(2304, 384, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(2304, 768, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.2, inplace=False)
      (enhancement): EnhancementModuleLite(
        (channel_att): Sequential(
          (0): AdaptiveAvgPool2d(output_size=1)
          (1): Conv2d(768, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): ReLU(inplace=True)
          (3): Conv2d(48, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (4): Sigmoid()
        )
        (spatial_att): Sequential(
          (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): Sigmoid()
        )
      )
    )
  )
  (train_loss_fn): LabelSmoothingCrossEntropy()
  (ema_model): ModelEmaV2(
    (module): main_model_enhanced(
      (downsample_layers): ModuleList(
        (0): Sequential(
          (0): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
          (1): LayerNorm()
        )
        (1): Sequential(
          (0): LayerNorm()
          (1): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
        )
        (2): Sequential(
          (0): LayerNorm()
          (1): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
        )
        (3): Sequential(
          (0): LayerNorm()
          (1): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
        )
      )
      (stages): ModuleList(
        (0): Sequential(
          (0): Block(
            (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=384, out_features=96, bias=True)
            (drop_path): Identity()
          )
          (1): Block(
            (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=384, out_features=96, bias=True)
            (drop_path): Identity()
          )
          (2): Block(
            (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=384, out_features=96, bias=True)
            (drop_path): Identity()
          )
        )
        (1): Sequential(
          (0): Block(
            (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=768, out_features=192, bias=True)
            (drop_path): Identity()
          )
          (1): Block(
            (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=768, out_features=192, bias=True)
            (drop_path): Identity()
          )
          (2): Block(
            (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=768, out_features=192, bias=True)
            (drop_path): Identity()
          )
        )
        (2): Sequential(
          (0): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (1): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (2): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (3): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (4): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (5): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
Parameter groups for differential learning rate:
  - backbone: 305 tensors, 56,940,186 params (51.6%), lr=5.00e-06
  - mhf_original: 164 tensors, 21,889,848 params (19.8%), lr=2.00e-05
  - enhancement: 16 tensors, 98,380 params (0.1%), lr=3.00e-04
  - head: 84 tensors, 31,477,830 params (28.5%), lr=2.00e-04
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (6): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (7): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (8): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
        )
        (3): Sequential(
          (0): Block(
            (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
            (drop_path): Identity()
          )
          (1): Block(
            (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
            (drop_path): Identity()
          )
          (2): Block(
            (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
            (drop_path): Identity()
          )
        )
      )
      (conv_norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0, inplace=False)
      (meta_tokenlize): PatchEmbed(
        (proj): Conv2d(96, 768, kernel_size=(16, 16), stride=(16, 16))
        (norm): Identity()
      )
      (layers1): BasicLayer(
        (blocks): ModuleList(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=96, out_features=96, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): Identity()
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=96, out_features=96, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): DropPath()
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
        )
      )
      (layers2): BasicLayer(
        (blocks): ModuleList(
          (0-1): 2 x SwinTransformerBlock(
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=192, out_features=192, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): DropPath()
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
        )
        (downsample): PatchMerging(
          (reduction): Linear(in_features=384, out_features=192, bias=False)
          (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        )
      )
      (layers3): BasicLayer(
        (blocks): ModuleList(
          (0-5): 6 x SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): DropPath()
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
        )
        (downsample): PatchMerging(
          (reduction): Linear(in_features=768, out_features=384, bias=False)
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
      (layers4): BasicLayer(
        (blocks): ModuleList(
          (0-1): 2 x SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): DropPath()
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
        )
        (downsample): PatchMerging(
          (reduction): Linear(in_features=1536, out_features=768, bias=False)
          (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        )
      )
      (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
      (head): HeadOptimal(
        (proj): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): Dropout(p=0.1, inplace=False)
        )
        (proto_manager): DynamicPrototypeManagerOptimal()
        (mixed_attn): MixedAttentionBlockOptimal(
          (cross_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (light_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (norm3): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (gate): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=True)
            (1): GELU(approximate='none')
            (2): Linear(in_features=768, out_features=3, bias=True)
          )
        )
        (ffn): Sequential(
          (0): Linear(in_features=768, out_features=3072, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=3072, out_features=768, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
        (ffn_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (proto_loss_fn): OptimalPrototypeLoss()
      )
      (fu1): MHF_block_v2(
        (att_conv): Sequential(
          (0): Conv2d(192, 2, kernel_size=(1, 1), stride=(1, 1))
          (1): Sigmoid()
        )
        (maxpool): AdaptiveMaxPool2d(output_size=1)
        (avgpool): AdaptiveAvgPool2d(output_size=1)
        (se): Sequential(
          (0): Conv2d(96, 6, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): ReLU()
          (2): Conv2d(6, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
        )
        (sigmoid): Sigmoid()
        (spatial): Conv(
          (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
          (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_x): Conv(
          (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_g): Conv(
          (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (norm1): LayerNorm()
        (norm2): LayerNorm()
        (chan): Conv(
          (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W): Conv(
          (conv): Conv2d(192, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (gelu): GELU(approximate='none')
        (residual): Residual(
          (relu): ReLU(inplace=True)
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv1): Conv(
            (conv): Conv2d(288, 48, kernel_size=(1, 1), stride=(1, 1))
          )
          (bn2): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv(
            (conv): Conv2d(48, 48, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          )
          (bn3): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv(
            (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
          )
          (skip_layer): Conv(
            (conv): Conv2d(288, 96, kernel_size=(1, 1), stride=(1, 1))
          )
        )
        (dropout): Dropout2d(p=0.0, inplace=False)
        (enhancement): EnhancementModuleLite(
          (channel_att): Sequential(
            (0): AdaptiveAvgPool2d(output_size=1)
            (1): Conv2d(96, 8, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (2): ReLU(inplace=True)
            (3): Conv2d(8, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (4): Sigmoid()
          )
          (spatial_att): Sequential(
            (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): Sigmoid()
          )
        )
      )
      (fu2): MHF_block_v2(
        (att_conv): Sequential(
          (0): Conv2d(384, 2, kernel_size=(1, 1), stride=(1, 1))
          (1): Sigmoid()
        )
        (maxpool): AdaptiveMaxPool2d(output_size=1)
        (avgpool): AdaptiveAvgPool2d(output_size=1)
        (se): Sequential(
          (0): Conv2d(192, 12, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): ReLU()
          (2): Conv2d(12, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
        )
        (sigmoid): Sigmoid()
        (spatial): Conv(
          (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
          (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_x): Conv(
          (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_g): Conv(
          (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (norm1): LayerNorm()
        (norm2): LayerNorm()
        (chan): Conv(
          (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W): Conv(
          (conv): Conv2d(384, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (gelu): GELU(approximate='none')
        (residual): Residual(
          (relu): ReLU(inplace=True)
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv1): Conv(
            (conv): Conv2d(576, 96, kernel_size=(1, 1), stride=(1, 1))
          )
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv(
            (conv): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          )
          (bn3): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv(
            (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
          )
          (skip_layer): Conv(
            (conv): Conv2d(576, 192, kernel_size=(1, 1), stride=(1, 1))
          )
        )
        (dropout): Dropout2d(p=0.1, inplace=False)
        (enhancement): EnhancementModuleLite(
          (channel_att): Sequential(
            (0): AdaptiveAvgPool2d(output_size=1)
            (1): Conv2d(192, 12, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (2): ReLU(inplace=True)
            (3): Conv2d(12, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (4): Sigmoid()
          )
          (spatial_att): Sequential(
            (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): Sigmoid()
          )
        )
      )
      (fu3): MHF_block_v2(
        (att_conv): Sequential(
          (0): Conv2d(768, 2, kernel_size=(1, 1), stride=(1, 1))
          (1): Sigmoid()
        )
        (maxpool): AdaptiveMaxPool2d(output_size=1)
        (avgpool): AdaptiveAvgPool2d(output_size=1)
        (se): Sequential(
          (0): Conv2d(384, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): ReLU()
          (2): Conv2d(24, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)
        )
        (sigmoid): Sigmoid()
        (spatial): Conv(
          (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
          (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_x): Conv(
          (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_g): Conv(
          (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (norm1): LayerNorm()
        (norm2): LayerNorm()
        (chan): Conv(
          (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W): Conv(
          (conv): Conv2d(768, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (gelu): GELU(approximate='none')
        (residual): Residual(
          (relu): ReLU(inplace=True)
          (bn1): BatchNorm2d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv1): Conv(
            (conv): Conv2d(1152, 192, kernel_size=(1, 1), stride=(1, 1))
          )
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv(
            (conv): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          )
          (bn3): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv(
            (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
          )
          (skip_layer): Conv(
            (conv): Conv2d(1152, 384, kernel_size=(1, 1), stride=(1, 1))
          )
        )
        (dropout): Dropout2d(p=0.2, inplace=False)
        (enhancement): EnhancementModuleLite(
          (channel_att): Sequential(
            (0): AdaptiveAvgPool2d(output_size=1)
            (1): Conv2d(384, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (2): ReLU(inplace=True)
            (3): Conv2d(24, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (4): Sigmoid()
          )
          (spatial_att): Sequential(
            (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): Sigmoid()
          )
        )
      )
      (fu4): MHF_block_v2(
        (att_conv): Sequential(
          (0): Conv2d(1536, 2, kernel_size=(1, 1), stride=(1, 1))
          (1): Sigmoid()
        )
        (maxpool): AdaptiveMaxPool2d(output_size=1)
        (avgpool): AdaptiveAvgPool2d(output_size=1)
        (se): Sequential(
          (0): Conv2d(768, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): ReLU()
          (2): Conv2d(48, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
        )
        (sigmoid): Sigmoid()
        (spatial): Conv(
          (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
          (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_x): Conv(
          (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_g): Conv(
          (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (norm1): LayerNorm()
        (norm2): LayerNorm()
        (chan): Conv(
          (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W): Conv(
          (conv): Conv2d(1536, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (gelu): GELU(approximate='none')
        (residual): Residual(
          (relu): ReLU(inplace=True)
          (bn1): BatchNorm2d(2304, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv1): Conv(
            (conv): Conv2d(2304, 384, kernel_size=(1, 1), stride=(1, 1))
          )
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv(
            (conv): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          )
          (bn3): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv(
            (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
          )
          (skip_layer): Conv(
            (conv): Conv2d(2304, 768, kernel_size=(1, 1), stride=(1, 1))
          )
        )
        (dropout): Dropout2d(p=0.2, inplace=False)
        (enhancement): EnhancementModuleLite(
          (channel_att): Sequential(
            (0): AdaptiveAvgPool2d(output_size=1)
            (1): Conv2d(768, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (2): ReLU(inplace=True)
            (3): Conv2d(48, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (4): Sigmoid()
          )
          (spatial_att): Sequential(
            (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): Sigmoid()
          )
        )
      )
    )
  )
)
2026-01-29 15:21:22.812 | INFO     | projects.eval_tools.finetuning_mae_exp:get_optimizer:150 - Using differential learning rates:
2026-01-29 15:21:22.813 | INFO     | projects.eval_tools.finetuning_mae_exp:get_optimizer:151 -   backbone: 0.05x, mhf: 0.2x, enhancement: 3.0x, head: 2.0x
2026-01-29 15:21:22.813 | INFO     | finetuning_progressive_v3_exp:get_model:108 - [Exp] Loss weights adjusted:
2026-01-29 15:21:22.813 | INFO     | finetuning_progressive_v3_exp:get_model:109 -   sep_scale: 0.12 -> 0.2
2026-01-29 15:21:22.814 | INFO     | finetuning_progressive_v3_exp:get_model:110 -   orth_scale: 0.08 -> 0.02
2026-01-29 15:21:22.814 | INFO     | finetuning_progressive_v3_exp:get_model:111 -   local_consistency_scale: 0.05 -> 0.1
2026-01-29 15:21:22.814 | INFO     | finetuning_progressive_v3_exp:get_model:112 -   margin: 0.3 -> 0.4
2026-01-29 15:21:23.272 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_current_state:111 - Loading stage1 weights from: /home/backup/lh/KD/outputs/HiFuse_Small_1e-5-0.05/ft_progressive_v3_eval/88.4last_epoch_best_ckpt.checkpoints.tar
2026-01-29 15:21:24.752 | INFO     | finetuning_progressive_v3_exp:get_model:108 - [Exp] Loss weights adjusted:
2026-01-29 15:21:24.753 | INFO     | finetuning_progressive_v3_exp:get_model:109 -   sep_scale: 0.12 -> 0.2
2026-01-29 15:21:24.753 | INFO     | finetuning_progressive_v3_exp:get_model:110 -   orth_scale: 0.08 -> 0.02
2026-01-29 15:21:24.753 | INFO     | finetuning_progressive_v3_exp:get_model:111 -   local_consistency_scale: 0.05 -> 0.1
2026-01-29 15:21:24.753 | INFO     | finetuning_progressive_v3_exp:get_model:112 -   margin: 0.3 -> 0.4
2026-01-29 15:21:24.884 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_model_weights_stage2:172 - Successfully loaded 679 parameters
2026-01-29 15:21:24.885 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_model_weights_stage2:173 - Skipped 679 parameters (shape mismatch or not in target)
[main_model_enhanced] Backbone frozen: 353 parameter tensors
2026-01-29 15:21:24.998 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_current_state:113 - Loaded keys: 647
2026-01-29 15:21:24.998 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_current_state:114 - Missing keys (new modules): ['ema_model.module.downsample_layers.0.0.weight', 'ema_model.module.downsample_layers.0.0.bias', 'ema_model.module.downsample_layers.0.1.weight', 'ema_model.module.downsample_layers.0.1.bias', 'ema_model.module.downsample_layers.1.0.weight', 'ema_model.module.downsample_layers.1.0.bias', 'ema_model.module.downsample_layers.1.1.weight', 'ema_model.module.downsample_layers.1.1.bias', 'ema_model.module.downsample_layers.2.0.weight', 'ema_model.module.downsample_layers.2.0.bias']...
2026-01-29 15:21:24.998 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_current_state:115 - Unexpected keys: []...
2026-01-29 15:21:24.999 | INFO     | __main__:main_worker:321 - Training start...
2026-01-29 15:21:25.001 | INFO     | __main__:main_worker:346 - Backbone frozen for first 3 epochs (Head warmup)
2026-01-29 15:21:30.108 | INFO     | __main__:main_worker:355 - ---> start train epoch1
2026-01-29 15:21:36.098 | INFO     | __main__:main_worker:429 - [1/100], remain:0d.00h.53m, It:[10/54], Max-Mem:8348M, Data-Time:0.016, LR:0.0000, Train_Loss:0.3423, total_loss:tensor([0.3423], device='cuda:0'), ce_loss:0.7039768695831299, cluster_loss:0.100568987429142, sep_loss:0.03095266781747341, soft_orth_loss:0.0049657272174954414, local_consistency_loss:0.0008898345986381173, proto_loss:0.13737721741199493
2026-01-29 15:21:39.361 | INFO     | __main__:main_worker:429 - [1/100], remain:0d.00h.40m, It:[20/54], Max-Mem:8348M, Data-Time:0.673, LR:0.0000, Train_Loss:0.8674, total_loss:tensor([0.8674], device='cuda:0'), ce_loss:0.9958860278129578, cluster_loss:0.1509464979171753, sep_loss:0.03011496178805828, soft_orth_loss:0.004965333733707666, local_consistency_loss:0.006842779461294413, proto_loss:0.19286957383155823
2026-01-29 15:21:44.075 | INFO     | __main__:main_worker:429 - [1/100], remain:0d.00h.41m, It:[30/54], Max-Mem:8348M, Data-Time:1.483, LR:0.0000, Train_Loss:-0.1478, total_loss:tensor([-0.1478], device='cuda:0'), ce_loss:0.40963780879974365, cluster_loss:0.07241083681583405, sep_loss:0.02637571655213833, soft_orth_loss:0.004964228719472885, local_consistency_loss:0.0006340990657918155, proto_loss:0.1043848767876625
2026-01-29 15:21:49.085 | INFO     | __main__:main_worker:429 - [1/100], remain:0d.00h.41m, It:[40/54], Max-Mem:8348M, Data-Time:1.913, LR:0.0000, Train_Loss:-0.0093, total_loss:tensor([-0.0093], device='cuda:0'), ce_loss:0.4759162366390228, cluster_loss:0.09188058227300644, sep_loss:0.028042426332831383, soft_orth_loss:0.004962310194969177, local_consistency_loss:0.0033736363984644413, proto_loss:0.12825895845890045
2026-01-29 15:21:54.429 | INFO     | __main__:main_worker:429 - [1/100], remain:0d.00h.42m, It:[50/54], Max-Mem:8348M, Data-Time:2.798, LR:0.0000, Train_Loss:-0.0817, total_loss:tensor([-0.0817], device='cuda:0'), ce_loss:0.44416290521621704, cluster_loss:0.07853136211633682, sep_loss:0.028701579198241234, soft_orth_loss:0.004962555132806301, local_consistency_loss:0.00126719253603369, proto_loss:0.11346269398927689
Evaluating: 100%|| 15/15 [00:09<00:00,  1.60it/s]
acc1: 88.0342, acc3: 100.0000, Precision: 0.7893, Recall: 0.8824, F1-Score: 0.8201, Specificity: 0.9452
2026-01-29 15:22:04.809 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [1/100], Top1:88.034, Top3:100.000, Test_precision:0.7893,Test_recall:0.8824,Test_f1:0.8201,,Test_specificity:0.9452 Test_loss:0.341813
2026-01-29 15:22:04.810 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:22:07.310 | INFO     | __main__:main_worker:355 - ---> start train epoch2
2026-01-29 15:22:16.129 | INFO     | __main__:main_worker:429 - [2/100], remain:0d.00h.42m, It:[10/54], Max-Mem:8348M, Data-Time:1.496, LR:0.0000, Train_Loss:0.2497, total_loss:tensor([0.2497], device='cuda:0'), ce_loss:0.6275006532669067, cluster_loss:0.11307258903980255, sep_loss:0.030899053439497948, soft_orth_loss:0.00496468273922801, local_consistency_loss:0.0004649553447961807, proto_loss:0.14940127730369568
2026-01-29 15:22:21.103 | INFO     | __main__:main_worker:429 - [2/100], remain:0d.00h.42m, It:[20/54], Max-Mem:8348M, Data-Time:1.249, LR:0.0000, Train_Loss:0.2985, total_loss:tensor([0.2985], device='cuda:0'), ce_loss:0.6496760845184326, cluster_loss:0.12017884105443954, sep_loss:0.03279171139001846, soft_orth_loss:0.00496159540489316, local_consistency_loss:0.0010164827108383179, proto_loss:0.1589486300945282
2026-01-29 15:22:25.277 | INFO     | __main__:main_worker:429 - [2/100], remain:0d.00h.40m, It:[30/54], Max-Mem:8348M, Data-Time:0.737, LR:0.0001, Train_Loss:-0.3124, total_loss:tensor([-0.3124], device='cuda:0'), ce_loss:0.3206685185432434, cluster_loss:0.05883083492517471, sep_loss:0.021639632061123848, soft_orth_loss:0.004953902680426836, local_consistency_loss:0.0004954892210662365, proto_loss:0.08591985702514648
2026-01-29 15:22:29.981 | INFO     | __main__:main_worker:429 - [2/100], remain:0d.00h.40m, It:[40/54], Max-Mem:8348M, Data-Time:0.871, LR:0.0001, Train_Loss:-0.0988, total_loss:tensor([-0.0988], device='cuda:0'), ce_loss:0.4315170645713806, cluster_loss:0.08484377712011337, sep_loss:0.02522417902946472, soft_orth_loss:0.004941611550748348, local_consistency_loss:0.0003853757807519287, proto_loss:0.1153949424624443
2026-01-29 15:22:34.180 | INFO     | __main__:main_worker:429 - [2/100], remain:0d.00h.39m, It:[50/54], Max-Mem:8348M, Data-Time:0.787, LR:0.0001, Train_Loss:0.8042, total_loss:tensor([0.8042], device='cuda:0'), ce_loss:0.9478198289871216, cluster_loss:0.1544305682182312, sep_loss:0.03786507993936539, soft_orth_loss:0.004936839919537306, local_consistency_loss:0.0007496035541407764, proto_loss:0.1979820877313614
Evaluating: 100%|| 15/15 [00:08<00:00,  1.78it/s]
2026-01-29 15:22:45.417 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [2/100], Top1:85.684, Top3:100.000, Test_precision:0.7559,Test_recall:0.8288,Test_f1:0.7803,,Test_specificity:0.9292 Test_loss:0.357276
2026-01-29 15:22:45.418 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:22:45.418 | INFO     | __main__:main_worker:355 - ---> start train epoch3
acc1: 85.6838, acc3: 100.0000, Precision: 0.7559, Recall: 0.8288, F1-Score: 0.7803, Specificity: 0.9292
2026-01-29 15:22:55.352 | INFO     | __main__:main_worker:429 - [3/100], remain:0d.00h.40m, It:[10/54], Max-Mem:8348M, Data-Time:2.109, LR:0.0001, Train_Loss:-0.0113, total_loss:tensor([-0.0113], device='cuda:0'), ce_loss:0.4889363944530487, cluster_loss:0.08407304435968399, sep_loss:0.027330655604600906, soft_orth_loss:0.0049255830235779285, local_consistency_loss:0.0014826328260824084, proto_loss:0.11781192570924759
2026-01-29 15:22:59.487 | INFO     | __main__:main_worker:429 - [3/100], remain:0d.00h.38m, It:[20/54], Max-Mem:8348M, Data-Time:1.547, LR:0.0001, Train_Loss:0.3254, total_loss:tensor([0.3254], device='cuda:0'), ce_loss:0.6719948649406433, cluster_loss:0.11552374809980392, sep_loss:0.034797344356775284, soft_orth_loss:0.004919061437249184, local_consistency_loss:0.0014861635863780975, proto_loss:0.15672633051872253
2026-01-29 15:23:04.123 | INFO     | __main__:main_worker:429 - [3/100], remain:0d.00h.38m, It:[30/54], Max-Mem:8348M, Data-Time:2.062, LR:0.0001, Train_Loss:-0.0535, total_loss:tensor([-0.0535], device='cuda:0'), ce_loss:0.46033039689064026, cluster_loss:0.08316044509410858, sep_loss:0.030152851715683937, soft_orth_loss:0.004910933319479227, local_consistency_loss:0.00041216632234863937, proto_loss:0.11863639205694199
2026-01-29 15:23:09.189 | INFO     | __main__:main_worker:429 - [3/100], remain:0d.00h.39m, It:[40/54], Max-Mem:8348M, Data-Time:2.337, LR:0.0001, Train_Loss:0.0333, total_loss:tensor([0.0333], device='cuda:0'), ce_loss:0.5041837096214294, cluster_loss:0.09964579343795776, sep_loss:0.02587565779685974, soft_orth_loss:0.0049088760279119015, local_consistency_loss:0.00131439499091357, proto_loss:0.13174472749233246
2026-01-29 15:23:12.445 | INFO     | __main__:main_worker:429 - [3/100], remain:0d.00h.37m, It:[50/54], Max-Mem:8348M, Data-Time:0.678, LR:0.0001, Train_Loss:0.1985, total_loss:tensor([0.1985], device='cuda:0'), ce_loss:0.6192651987075806, cluster_loss:0.08845178782939911, sep_loss:0.03532782942056656, soft_orth_loss:0.004912855103611946, local_consistency_loss:0.0006090487586334348, proto_loss:0.1293015331029892
Evaluating: 100%|| 15/15 [00:08<00:00,  1.77it/s]
acc1: 86.1111, acc3: 100.0000, Precision: 0.7623, Recall: 0.8495, F1-Score: 0.7921, Specificity: 0.9357
[main_model_enhanced] Backbone unfrozen: 353 parameter tensors
2026-01-29 15:23:22.693 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [3/100], Top1:86.111, Top3:100.000, Test_precision:0.7623,Test_recall:0.8495,Test_f1:0.7921,,Test_specificity:0.9357 Test_loss:0.330282
2026-01-29 15:23:22.695 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:23:22.695 | INFO     | __main__:main_worker:355 - ---> start train epoch4
2026-01-29 15:23:22.699 | INFO     | __main__:main_worker:364 - Backbone unfrozen at epoch 4 (Head warmup completed)
2026-01-29 15:23:33.280 | INFO     | __main__:main_worker:429 - [4/100], remain:0d.00h.53m, It:[10/54], Max-Mem:11245M, Data-Time:2.241, LR:0.0001, Train_Loss:0.1785, total_loss:tensor([0.1785], device='cuda:0'), ce_loss:0.6028788089752197, cluster_loss:0.0939984992146492, sep_loss:0.032674115151166916, soft_orth_loss:0.004908495582640171, local_consistency_loss:0.0004890866111963987, proto_loss:0.13207019865512848
2026-01-29 15:23:37.605 | INFO     | __main__:main_worker:429 - [4/100], remain:0d.00h.45m, It:[20/54], Max-Mem:11245M, Data-Time:0.831, LR:0.0001, Train_Loss:0.3098, total_loss:tensor([0.3098], device='cuda:0'), ce_loss:0.6814168095588684, cluster_loss:0.09859630465507507, sep_loss:0.0355357900261879, soft_orth_loss:0.004902709275484085, local_consistency_loss:0.0020019421353936195, proto_loss:0.1410367339849472
2026-01-29 15:23:41.438 | INFO     | __main__:main_worker:429 - [4/100], remain:0d.00h.40m, It:[30/54], Max-Mem:11245M, Data-Time:0.425, LR:0.0001, Train_Loss:0.0302, total_loss:tensor([0.0302], device='cuda:0'), ce_loss:0.527686595916748, cluster_loss:0.07568313926458359, sep_loss:0.02977306954562664, soft_orth_loss:0.004894611891359091, local_consistency_loss:0.0006491377134807408, proto_loss:0.11099996417760849
2026-01-29 15:23:45.160 | INFO     | __main__:main_worker:429 - [4/100], remain:0d.00h.38m, It:[40/54], Max-Mem:11245M, Data-Time:0.275, LR:0.0001, Train_Loss:-0.0620, total_loss:tensor([-0.0620], device='cuda:0'), ce_loss:0.45634031295776367, cluster_loss:0.08707744628190994, sep_loss:0.026266882196068764, soft_orth_loss:0.00488668866455555, local_consistency_loss:0.0005564544117078185, proto_loss:0.11878746747970581
2026-01-29 15:23:50.313 | INFO     | __main__:main_worker:429 - [4/100], remain:0d.00h.39m, It:[50/54], Max-Mem:11245M, Data-Time:1.687, LR:0.0001, Train_Loss:-0.0883, total_loss:tensor([-0.0883], device='cuda:0'), ce_loss:0.47466036677360535, cluster_loss:0.06414444744586945, sep_loss:0.0177426990121603, soft_orth_loss:0.004878433421254158, local_consistency_loss:0.001471725874580443, proto_loss:0.08823730796575546
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
2026-01-29 15:23:59.931 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [4/100], Top1:86.111, Top3:100.000, Test_precision:0.7525,Test_recall:0.7554,Test_f1:0.7538,,Test_specificity:0.9163 Test_loss:0.412705
acc1: 86.1111, acc3: 100.0000, Precision: 0.7525, Recall: 0.7554, F1-Score: 0.7538, Specificity: 0.9163
2026-01-29 15:23:59.931 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:23:59.932 | INFO     | __main__:main_worker:355 - ---> start train epoch5
2026-01-29 15:24:07.854 | INFO     | __main__:main_worker:429 - [5/100], remain:0d.00h.33m, It:[10/54], Max-Mem:11245M, Data-Time:0.547, LR:0.0001, Train_Loss:0.1579, total_loss:tensor([0.1579], device='cuda:0'), ce_loss:0.5849376916885376, cluster_loss:0.09675951302051544, sep_loss:0.033453162759542465, soft_orth_loss:0.004867190029472113, local_consistency_loss:0.0012462594313547015, proto_loss:0.1363261342048645
2026-01-29 15:24:12.560 | INFO     | __main__:main_worker:429 - [5/100], remain:0d.00h.36m, It:[20/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:0.0613, total_loss:tensor([0.0613], device='cuda:0'), ce_loss:0.5247758626937866, cluster_loss:0.10054357349872589, sep_loss:0.026139462366700172, soft_orth_loss:0.004863661248236895, local_consistency_loss:0.0005147269112057984, proto_loss:0.1320614367723465
2026-01-29 15:24:16.150 | INFO     | __main__:main_worker:429 - [5/100], remain:0d.00h.34m, It:[30/54], Max-Mem:11245M, Data-Time:0.186, LR:0.0001, Train_Loss:0.6497, total_loss:tensor([0.6497], device='cuda:0'), ce_loss:0.8558131456375122, cluster_loss:0.14768369495868683, sep_loss:0.034203242510557175, soft_orth_loss:0.0048642391338944435, local_consistency_loss:0.0022036980371922255, proto_loss:0.1889548897743225
2026-01-29 15:24:22.151 | INFO     | __main__:main_worker:429 - [5/100], remain:0d.00h.38m, It:[40/54], Max-Mem:11245M, Data-Time:0.023, LR:0.0001, Train_Loss:0.3904, total_loss:tensor([0.3904], device='cuda:0'), ce_loss:0.7121334671974182, cluster_loss:0.12927213311195374, sep_loss:0.027385925874114037, soft_orth_loss:0.004862696398049593, local_consistency_loss:0.0006958779995329678, proto_loss:0.16221663355827332
2026-01-29 15:24:26.867 | INFO     | __main__:main_worker:429 - [5/100], remain:0d.00h.38m, It:[50/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:0.3294, total_loss:tensor([0.3294], device='cuda:0'), ce_loss:0.6827573180198669, cluster_loss:0.12037181854248047, sep_loss:0.02597855031490326, soft_orth_loss:0.004860274493694305, local_consistency_loss:0.0010263713775202632, proto_loss:0.15223701298236847
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
2026-01-29 15:24:36.498 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [5/100], Top1:86.111, Top3:100.000, Test_precision:0.7678,Test_recall:0.8616,Test_f1:0.7999,,Test_specificity:0.9362 Test_loss:0.352495
acc1: 86.1111, acc3: 100.0000, Precision: 0.7678, Recall: 0.8616, F1-Score: 0.7999, Specificity: 0.9362
2026-01-29 15:24:36.499 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:24:51.581 | INFO     | __main__:main_worker:355 - ---> start train epoch6
2026-01-29 15:24:59.721 | INFO     | __main__:main_worker:429 - [6/100], remain:0d.00h.36m, It:[10/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:-0.0055, total_loss:tensor([-0.0055], device='cuda:0'), ce_loss:0.49933621287345886, cluster_loss:0.08405192941427231, sep_loss:0.025754308328032494, soft_orth_loss:0.0048578958958387375, local_consistency_loss:0.0013175280764698982, proto_loss:0.11598166823387146
2026-01-29 15:25:04.430 | INFO     | __main__:main_worker:429 - [6/100], remain:0d.00h.37m, It:[20/54], Max-Mem:11245M, Data-Time:0.044, LR:0.0001, Train_Loss:0.0465, total_loss:tensor([0.0465], device='cuda:0'), ce_loss:0.516327440738678, cluster_loss:0.09741907566785812, sep_loss:0.02892417646944523, soft_orth_loss:0.004854715894907713, local_consistency_loss:0.00047742784954607487, proto_loss:0.13167539238929749
2026-01-29 15:25:09.578 | INFO     | __main__:main_worker:429 - [6/100], remain:0d.00h.39m, It:[30/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0001, Train_Loss:-0.3394, total_loss:tensor([-0.3394], device='cuda:0'), ce_loss:0.3128741383552551, cluster_loss:0.06350504606962204, sep_loss:0.01348576694726944, soft_orth_loss:0.004853499587625265, local_consistency_loss:0.0014413122553378344, proto_loss:0.0832856297492981
2026-01-29 15:25:14.802 | INFO     | __main__:main_worker:429 - [6/100], remain:0d.00h.40m, It:[40/54], Max-Mem:11245M, Data-Time:0.017, LR:0.0001, Train_Loss:0.6690, total_loss:tensor([0.6690], device='cuda:0'), ce_loss:0.8814316987991333, cluster_loss:0.14290273189544678, sep_loss:0.029742896556854248, soft_orth_loss:0.004851379431784153, local_consistency_loss:0.0013168931473046541, proto_loss:0.1788139045238495
2026-01-29 15:25:18.541 | INFO     | __main__:main_worker:429 - [6/100], remain:0d.00h.38m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.0529, total_loss:tensor([-0.0529], device='cuda:0'), ce_loss:0.45661965012550354, cluster_loss:0.09263937175273895, sep_loss:0.027889857068657875, soft_orth_loss:0.0048499805852770805, local_consistency_loss:0.0005741261993534863, proto_loss:0.1259533315896988
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
2026-01-29 15:25:29.512 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [6/100], Top1:86.752, Top3:100.000, Test_precision:0.7899,Test_recall:0.7847,Test_f1:0.7849,,Test_specificity:0.9249 Test_loss:0.326390
2026-01-29 15:25:29.513 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:25:29.514 | INFO     | __main__:main_worker:355 - ---> start train epoch7
acc1: 86.7521, acc3: 100.0000, Precision: 0.7899, Recall: 0.7847, F1-Score: 0.7849, Specificity: 0.9249
2026-01-29 15:25:38.608 | INFO     | __main__:main_worker:429 - [7/100], remain:0d.00h.45m, It:[10/54], Max-Mem:11245M, Data-Time:0.080, LR:0.0001, Train_Loss:0.1696, total_loss:tensor([0.1696], device='cuda:0'), ce_loss:0.6012545228004456, cluster_loss:0.09155501425266266, sep_loss:0.033266328275203705, soft_orth_loss:0.00484293419867754, local_consistency_loss:0.0011183889582753181, proto_loss:0.13078266382217407
2026-01-29 15:25:43.014 | INFO     | __main__:main_worker:429 - [7/100], remain:0d.00h.40m, It:[20/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0001, Train_Loss:0.3184, total_loss:tensor([0.3184], device='cuda:0'), ce_loss:0.6920846104621887, cluster_loss:0.10080418735742569, sep_loss:0.03238029032945633, soft_orth_loss:0.004836891312152147, local_consistency_loss:0.000983858946710825, proto_loss:0.13900522887706757
2026-01-29 15:25:47.732 | INFO     | __main__:main_worker:429 - [7/100], remain:0d.00h.39m, It:[30/54], Max-Mem:11245M, Data-Time:0.336, LR:0.0001, Train_Loss:0.1513, total_loss:tensor([0.1513], device='cuda:0'), ce_loss:0.576554536819458, cluster_loss:0.10246157646179199, sep_loss:0.033506929874420166, soft_orth_loss:0.004829656798392534, local_consistency_loss:0.0007743850583210588, proto_loss:0.14157254993915558
2026-01-29 15:25:52.225 | INFO     | __main__:main_worker:429 - [7/100], remain:0d.00h.39m, It:[40/54], Max-Mem:11245M, Data-Time:0.477, LR:0.0001, Train_Loss:0.1650, total_loss:tensor([0.1650], device='cuda:0'), ce_loss:0.5924259424209595, cluster_loss:0.10255320370197296, sep_loss:0.027511009946465492, soft_orth_loss:0.004821029957383871, local_consistency_loss:0.0012505586491897702, proto_loss:0.13613581657409668
2026-01-29 15:25:57.190 | INFO     | __main__:main_worker:429 - [7/100], remain:0d.00h.39m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.2973, total_loss:tensor([-0.2973], device='cuda:0'), ce_loss:0.3495942950248718, cluster_loss:0.05417558550834656, sep_loss:0.017915545031428337, soft_orth_loss:0.004816106520593166, local_consistency_loss:0.0009722988470457494, proto_loss:0.07787954062223434
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
2026-01-29 15:26:07.226 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [7/100], Top1:86.966, Top3:100.000, Test_precision:0.7752,Test_recall:0.7729,Test_f1:0.7740,,Test_specificity:0.9178 Test_loss:0.420999
acc1: 86.9658, acc3: 100.0000, Precision: 0.7752, Recall: 0.7729, F1-Score: 0.7740, Specificity: 0.9178
2026-01-29 15:26:07.227 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:26:07.227 | INFO     | __main__:main_worker:355 - ---> start train epoch8
2026-01-29 15:26:18.225 | INFO     | __main__:main_worker:429 - [8/100], remain:0d.00h.44m, It:[10/54], Max-Mem:11245M, Data-Time:1.960, LR:0.0001, Train_Loss:-0.1469, total_loss:tensor([-0.1469], device='cuda:0'), ce_loss:0.42188194394111633, cluster_loss:0.07448680698871613, sep_loss:0.022671449929475784, soft_orth_loss:0.004814056679606438, local_consistency_loss:0.0009961709147319198, proto_loss:0.1029684841632843
2026-01-29 15:26:22.473 | INFO     | __main__:main_worker:429 - [8/100], remain:0d.00h.39m, It:[20/54], Max-Mem:11245M, Data-Time:0.759, LR:0.0001, Train_Loss:0.2167, total_loss:tensor([0.2167], device='cuda:0'), ce_loss:0.6467412114143372, cluster_loss:0.0884527787566185, sep_loss:0.026187120005488396, soft_orth_loss:0.004813801031559706, local_consistency_loss:0.0007331746746785939, proto_loss:0.12018687278032303
2026-01-29 15:26:26.025 | INFO     | __main__:main_worker:429 - [8/100], remain:0d.00h.35m, It:[30/54], Max-Mem:11245M, Data-Time:0.062, LR:0.0001, Train_Loss:-0.1528, total_loss:tensor([-0.1528], device='cuda:0'), ce_loss:0.4187902808189392, cluster_loss:0.0754937157034874, sep_loss:0.021503230556845665, soft_orth_loss:0.004812321159988642, local_consistency_loss:0.0008449177257716656, proto_loss:0.10265418887138367
2026-01-29 15:26:29.582 | INFO     | __main__:main_worker:429 - [8/100], remain:0d.00h.33m, It:[40/54], Max-Mem:11245M, Data-Time:0.041, LR:0.0001, Train_Loss:0.6510, total_loss:tensor([0.6510], device='cuda:0'), ce_loss:0.8563194274902344, cluster_loss:0.15202735364437103, sep_loss:0.03317508101463318, soft_orth_loss:0.004801667295396328, local_consistency_loss:0.0008172491798177361, proto_loss:0.1908213496208191
2026-01-29 15:26:34.293 | INFO     | __main__:main_worker:429 - [8/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.1179, total_loss:tensor([-0.1179], device='cuda:0'), ce_loss:0.5266991257667542, cluster_loss:0.000214310857700184, sep_loss:0.02587398886680603, soft_orth_loss:0.00479240994900465, local_consistency_loss:0.0005704371142201126, proto_loss:0.03145114704966545
2026-01-29 15:26:36.583 | INFO     | __main__:main_worker:488 - ---> Skipping prototype push: epoch < push_start(12)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
2026-01-29 15:26:44.765 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [8/100], Top1:85.470, Top3:100.000, Test_precision:0.7501,Test_recall:0.8024,Test_f1:0.7708,,Test_specificity:0.9272 Test_loss:0.370632
2026-01-29 15:26:44.766 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:26:44.766 | INFO     | __main__:main_worker:355 - ---> start train epoch9
acc1: 85.4701, acc3: 100.0000, Precision: 0.7501, Recall: 0.8024, F1-Score: 0.7708, Specificity: 0.9272
2026-01-29 15:26:54.399 | INFO     | __main__:main_worker:429 - [9/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11245M, Data-Time:0.294, LR:0.0001, Train_Loss:0.2754, total_loss:tensor([0.2754], device='cuda:0'), ce_loss:0.6388634443283081, cluster_loss:0.12918773293495178, sep_loss:0.026743346825242043, soft_orth_loss:0.004783058539032936, local_consistency_loss:0.0004948077257722616, proto_loss:0.16120895743370056
2026-01-29 15:26:58.867 | INFO     | __main__:main_worker:429 - [9/100], remain:0d.00h.33m, It:[20/54], Max-Mem:11245M, Data-Time:1.024, LR:0.0001, Train_Loss:0.0456, total_loss:tensor([0.0456], device='cuda:0'), ce_loss:0.533107578754425, cluster_loss:0.08749387413263321, sep_loss:0.025926172733306885, soft_orth_loss:0.004778464790433645, local_consistency_loss:0.0017967292806133628, proto_loss:0.11999524384737015
2026-01-29 15:27:04.114 | INFO     | __main__:main_worker:429 - [9/100], remain:0d.00h.36m, It:[30/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:0.1795, total_loss:tensor([0.1795], device='cuda:0'), ce_loss:0.5953838229179382, cluster_loss:0.11020425707101822, sep_loss:0.02791094221174717, soft_orth_loss:0.004770183004438877, local_consistency_loss:0.0009109247475862503, proto_loss:0.14379630982875824
2026-01-29 15:27:08.751 | INFO     | __main__:main_worker:429 - [9/100], remain:0d.00h.36m, It:[40/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:0.0704, total_loss:tensor([0.0704], device='cuda:0'), ce_loss:0.6523030400276184, cluster_loss:0.00023528083693236113, sep_loss:0.027581173926591873, soft_orth_loss:0.004757588263601065, local_consistency_loss:0.0008829802391119301, proto_loss:0.03345702216029167
2026-01-29 15:27:13.045 | INFO     | __main__:main_worker:429 - [9/100], remain:0d.00h.35m, It:[50/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:-0.1138, total_loss:tensor([-0.1138], device='cuda:0'), ce_loss:0.5319218039512634, cluster_loss:0.00022199690283741802, sep_loss:0.024991819635033607, soft_orth_loss:0.00475776894018054, local_consistency_loss:0.000866078888066113, proto_loss:0.030837666243314743
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
2026-01-29 15:27:24.230 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [9/100], Top1:86.538, Top3:100.000, Test_precision:0.7873,Test_recall:0.7599,Test_f1:0.7699,,Test_specificity:0.9161 Test_loss:0.357556
acc1: 86.5385, acc3: 100.0000, Precision: 0.7873, Recall: 0.7599, F1-Score: 0.7699, Specificity: 0.9161
2026-01-29 15:27:24.231 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:27:24.231 | INFO     | __main__:main_worker:355 - ---> start train epoch10
2026-01-29 15:27:33.668 | INFO     | __main__:main_worker:429 - [10/100], remain:0d.00h.36m, It:[10/54], Max-Mem:11245M, Data-Time:1.046, LR:0.0001, Train_Loss:0.4612, total_loss:tensor([0.4612], device='cuda:0'), ce_loss:0.7522060871124268, cluster_loss:0.13484758138656616, sep_loss:0.031209928914904594, soft_orth_loss:0.004746580496430397, local_consistency_loss:0.0010842593619599938, proto_loss:0.1718883514404297
2026-01-29 15:27:37.766 | INFO     | __main__:main_worker:429 - [10/100], remain:0d.00h.34m, It:[20/54], Max-Mem:11245M, Data-Time:0.594, LR:0.0001, Train_Loss:0.7916, total_loss:tensor([0.7916], device='cuda:0'), ce_loss:0.9684421420097351, cluster_loss:0.13788381218910217, sep_loss:0.029503226280212402, soft_orth_loss:0.004741030745208263, local_consistency_loss:0.004640225786715746, proto_loss:0.17676828801631927
2026-01-29 15:27:42.253 | INFO     | __main__:main_worker:429 - [10/100], remain:0d.00h.34m, It:[30/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.0866, total_loss:tensor([-0.0866], device='cuda:0'), ce_loss:0.4765082895755768, cluster_loss:0.06783179193735123, sep_loss:0.021051619201898575, soft_orth_loss:0.004737259820103645, local_consistency_loss:0.0006133915740065277, proto_loss:0.09423406422138214
2026-01-29 15:27:46.399 | INFO     | __main__:main_worker:429 - [10/100], remain:0d.00h.34m, It:[40/54], Max-Mem:11245M, Data-Time:0.708, LR:0.0001, Train_Loss:-0.2400, total_loss:tensor([-0.2400], device='cuda:0'), ce_loss:0.36261919140815735, cluster_loss:0.07667465507984161, sep_loss:0.02163734845817089, soft_orth_loss:0.004732455592602491, local_consistency_loss:0.0008316619205288589, proto_loss:0.10387612134218216
2026-01-29 15:27:51.213 | INFO     | __main__:main_worker:429 - [10/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11245M, Data-Time:1.263, LR:0.0001, Train_Loss:0.3712, total_loss:tensor([0.3712], device='cuda:0'), ce_loss:0.8444779515266418, cluster_loss:0.0006466457853093743, sep_loss:0.035762984305620193, soft_orth_loss:0.004727800842374563, local_consistency_loss:0.001958703389391303, proto_loss:0.04309613257646561
Evaluating: 100%|| 15/15 [00:08<00:00,  1.78it/s]
2026-01-29 15:28:01.573 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [10/100], Top1:84.188, Top3:100.000, Test_precision:0.7780,Test_recall:0.7816,Test_f1:0.7795,,Test_specificity:0.8957 Test_loss:0.352541
acc1: 84.1880, acc3: 100.0000, Precision: 0.7780, Recall: 0.7816, F1-Score: 0.7795, Specificity: 0.8957
2026-01-29 15:28:01.575 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:28:19.904 | INFO     | __main__:main_worker:355 - ---> start train epoch11
2026-01-29 15:28:28.588 | INFO     | __main__:main_worker:429 - [11/100], remain:0d.00h.37m, It:[10/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.3597, total_loss:tensor([-0.3597], device='cuda:0'), ce_loss:0.2927003502845764, cluster_loss:0.07584922015666962, sep_loss:0.014666283503174782, soft_orth_loss:0.004723332356661558, local_consistency_loss:0.0006342832930386066, proto_loss:0.09587311744689941
2026-01-29 15:28:33.575 | INFO     | __main__:main_worker:429 - [11/100], remain:0d.00h.38m, It:[20/54], Max-Mem:11245M, Data-Time:0.141, LR:0.0001, Train_Loss:0.2794, total_loss:tensor([0.2794], device='cuda:0'), ce_loss:0.6401610374450684, cluster_loss:0.1284959316253662, sep_loss:0.030504969879984856, soft_orth_loss:0.004719205666333437, local_consistency_loss:0.0009105540812015533, proto_loss:0.16463066637516022
2026-01-29 15:28:38.210 | INFO     | __main__:main_worker:429 - [11/100], remain:0d.00h.37m, It:[30/54], Max-Mem:11245M, Data-Time:0.847, LR:0.0001, Train_Loss:-0.2358, total_loss:tensor([-0.2358], device='cuda:0'), ce_loss:0.38359835743904114, cluster_loss:0.06596317887306213, sep_loss:0.018302159383893013, soft_orth_loss:0.004714725073426962, local_consistency_loss:0.0007680770941078663, proto_loss:0.08974814414978027
2026-01-29 15:28:42.053 | INFO     | __main__:main_worker:429 - [11/100], remain:0d.00h.35m, It:[40/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:-0.2537, total_loss:tensor([-0.2537], device='cuda:0'), ce_loss:0.3694134056568146, cluster_loss:0.06682123988866806, sep_loss:0.019243035465478897, soft_orth_loss:0.004711615853011608, local_consistency_loss:0.0011337227188050747, proto_loss:0.09190961718559265
2026-01-29 15:28:46.525 | INFO     | __main__:main_worker:429 - [11/100], remain:0d.00h.35m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:0.0021, total_loss:tensor([0.0021], device='cuda:0'), ce_loss:0.5255222320556641, cluster_loss:0.0693175345659256, sep_loss:0.030094370245933533, soft_orth_loss:0.004704073071479797, local_consistency_loss:0.0008806669502519071, proto_loss:0.10499664396047592
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
2026-01-29 15:28:57.383 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [11/100], Top1:86.325, Top3:100.000, Test_precision:0.7670,Test_recall:0.8743,Test_f1:0.7995,,Test_specificity:0.9423 Test_loss:0.392843
2026-01-29 15:28:57.384 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:28:57.385 | INFO     | __main__:main_worker:355 - ---> start train epoch12
acc1: 86.3248, acc3: 100.0000, Precision: 0.7670, Recall: 0.8743, F1-Score: 0.7995, Specificity: 0.9423
2026-01-29 15:29:06.145 | INFO     | __main__:main_worker:429 - [12/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11245M, Data-Time:0.249, LR:0.0001, Train_Loss:0.1959, total_loss:tensor([0.1959], device='cuda:0'), ce_loss:0.6008318066596985, cluster_loss:0.12073742598295212, sep_loss:0.025332648307085037, soft_orth_loss:0.004691637121140957, local_consistency_loss:0.0006116345757618546, proto_loss:0.15137334167957306
2026-01-29 15:29:10.795 | INFO     | __main__:main_worker:429 - [12/100], remain:0d.00h.33m, It:[20/54], Max-Mem:11245M, Data-Time:0.396, LR:0.0001, Train_Loss:0.3049, total_loss:tensor([0.3049], device='cuda:0'), ce_loss:0.6873480081558228, cluster_loss:0.10320933163166046, sep_loss:0.03148603439331055, soft_orth_loss:0.004682711325585842, local_consistency_loss:0.0006752972840331495, proto_loss:0.14005336165428162
2026-01-29 15:29:15.382 | INFO     | __main__:main_worker:429 - [12/100], remain:0d.00h.33m, It:[30/54], Max-Mem:11245M, Data-Time:0.435, LR:0.0001, Train_Loss:-0.2792, total_loss:tensor([-0.2792], device='cuda:0'), ce_loss:0.3470955491065979, cluster_loss:0.06564786285161972, sep_loss:0.026751501485705376, soft_orth_loss:0.004673853516578674, local_consistency_loss:0.0005278335884213448, proto_loss:0.09760105609893799
2026-01-29 15:29:20.234 | INFO     | __main__:main_worker:429 - [12/100], remain:0d.00h.34m, It:[40/54], Max-Mem:11245M, Data-Time:0.947, LR:0.0001, Train_Loss:-0.1364, total_loss:tensor([-0.1364], device='cuda:0'), ce_loss:0.4214732050895691, cluster_loss:0.08564665168523788, sep_loss:0.02446460723876953, soft_orth_loss:0.004662558436393738, local_consistency_loss:0.001093829981982708, proto_loss:0.11586764454841614
2026-01-29 15:29:24.441 | INFO     | __main__:main_worker:429 - [12/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11245M, Data-Time:0.310, LR:0.0001, Train_Loss:0.8299, total_loss:tensor([0.8299], device='cuda:0'), ce_loss:1.1574383974075317, cluster_loss:0.0004135115596000105, sep_loss:0.03404908999800682, soft_orth_loss:0.004650569055229425, local_consistency_loss:0.0004771302919834852, proto_loss:0.03959030285477638
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
acc1: 86.3248, acc3: 100.0000, Precision: 0.7755, Recall: 0.8479, F1-Score: 0.8038, Specificity: 0.9328
2026-01-29 15:29:34.484 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [12/100], Top1:86.325, Top3:100.000, Test_precision:0.7755,Test_recall:0.8479,Test_f1:0.8038,,Test_specificity:0.9328 Test_loss:0.384401
2026-01-29 15:29:34.485 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:29:34.485 | INFO     | __main__:main_worker:355 - ---> start train epoch13
2026-01-29 15:29:43.705 | INFO     | __main__:main_worker:429 - [13/100], remain:0d.00h.35m, It:[10/54], Max-Mem:11245M, Data-Time:1.171, LR:0.0001, Train_Loss:0.4353, total_loss:tensor([0.4353], device='cuda:0'), ce_loss:0.7368720173835754, cluster_loss:0.137603759765625, sep_loss:0.029971743002533913, soft_orth_loss:0.004633394069969654, local_consistency_loss:0.0005810052389279008, proto_loss:0.17278991639614105
2026-01-29 15:29:47.272 | INFO     | __main__:main_worker:429 - [13/100], remain:0d.00h.31m, It:[20/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:-0.1542, total_loss:tensor([-0.1542], device='cuda:0'), ce_loss:0.4044850468635559, cluster_loss:0.0882941260933876, sep_loss:0.02722536399960518, soft_orth_loss:0.00462884409353137, local_consistency_loss:0.0009065495687536895, proto_loss:0.12105488777160645
2026-01-29 15:29:51.742 | INFO     | __main__:main_worker:429 - [13/100], remain:0d.00h.32m, It:[30/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:0.0200, total_loss:tensor([0.0200], device='cuda:0'), ce_loss:0.5353639721870422, cluster_loss:0.08071732521057129, sep_loss:0.02284877933561802, soft_orth_loss:0.004622969310730696, local_consistency_loss:0.000771782360970974, proto_loss:0.10896085202693939
2026-01-29 15:29:56.070 | INFO     | __main__:main_worker:429 - [13/100], remain:0d.00h.32m, It:[40/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:0.4494, total_loss:tensor([0.4494], device='cuda:0'), ce_loss:0.7316381931304932, cluster_loss:0.14910320937633514, sep_loss:0.030878661200404167, soft_orth_loss:0.004611835349351168, local_consistency_loss:0.0010253264335915446, proto_loss:0.1856190264225006
2026-01-29 15:30:01.064 | INFO     | __main__:main_worker:429 - [13/100], remain:0d.00h.33m, It:[50/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:-0.5281, total_loss:tensor([-0.5281], device='cuda:0'), ce_loss:0.1938372403383255, cluster_loss:0.07233831286430359, sep_loss:0.011661794036626816, soft_orth_loss:0.004600686952471733, local_consistency_loss:0.0005963010480627418, proto_loss:0.08919709920883179
Evaluating: 100%|| 15/15 [00:08<00:00,  1.82it/s]
acc1: 86.1111, acc3: 100.0000, Precision: 0.7678, Recall: 0.8504, F1-Score: 0.7977, Specificity: 0.9363
2026-01-29 15:30:11.061 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [13/100], Top1:86.111, Top3:100.000, Test_precision:0.7678,Test_recall:0.8504,Test_f1:0.7977,,Test_specificity:0.9363 Test_loss:0.374844
2026-01-29 15:30:11.062 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:30:11.063 | INFO     | __main__:main_worker:355 - ---> start train epoch14
2026-01-29 15:30:19.495 | INFO     | __main__:main_worker:429 - [14/100], remain:0d.00h.26m, It:[10/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:-0.5408, total_loss:tensor([-0.5408], device='cuda:0'), ce_loss:0.19041554629802704, cluster_loss:0.0685480609536171, sep_loss:0.011380098760128021, soft_orth_loss:0.004590662196278572, local_consistency_loss:0.0009068037616088986, proto_loss:0.08542562276124954
2026-01-29 15:30:23.936 | INFO     | __main__:main_worker:429 - [14/100], remain:0d.00h.30m, It:[20/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:-0.0712, total_loss:tensor([-0.0712], device='cuda:0'), ce_loss:0.4684905409812927, cluster_loss:0.08187944442033768, sep_loss:0.02780137024819851, soft_orth_loss:0.004581477027386427, local_consistency_loss:0.0009948440128937364, proto_loss:0.1152571365237236
2026-01-29 15:30:28.471 | INFO     | __main__:main_worker:429 - [14/100], remain:0d.00h.31m, It:[30/54], Max-Mem:11245M, Data-Time:0.155, LR:0.0001, Train_Loss:-0.0151, total_loss:tensor([-0.0151], device='cuda:0'), ce_loss:0.5056911706924438, cluster_loss:0.0813199058175087, sep_loss:0.028568876907229424, soft_orth_loss:0.004571543540805578, local_consistency_loss:0.0011659077135846019, proto_loss:0.11562623083591461
2026-01-29 15:30:33.631 | INFO     | __main__:main_worker:429 - [14/100], remain:0d.00h.33m, It:[40/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:0.0971, total_loss:tensor([0.0971], device='cuda:0'), ce_loss:0.5569130182266235, cluster_loss:0.10299580544233322, sep_loss:0.026769012212753296, soft_orth_loss:0.004560660570859909, local_consistency_loss:0.0014693618286401033, proto_loss:0.13579484820365906
2026-01-29 15:30:39.070 | INFO     | __main__:main_worker:429 - [14/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:1.4478, total_loss:tensor([1.4478], device='cuda:0'), ce_loss:1.3046536445617676, cluster_loss:0.22007523477077484, sep_loss:0.0380263552069664, soft_orth_loss:0.004548803437501192, local_consistency_loss:0.0015148556558415294, proto_loss:0.2641652524471283
Evaluating: 100%|| 15/15 [00:08<00:00,  1.82it/s]
acc1: 86.5385, acc3: 100.0000, Precision: 0.7832, Recall: 0.7256, F1-Score: 0.7404, Specificity: 0.9164
2026-01-29 15:30:49.150 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [14/100], Top1:86.538, Top3:100.000, Test_precision:0.7832,Test_recall:0.7256,Test_f1:0.7404,,Test_specificity:0.9164 Test_loss:0.420538
2026-01-29 15:30:49.151 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:30:49.151 | INFO     | __main__:main_worker:355 - ---> start train epoch15
2026-01-29 15:30:58.644 | INFO     | __main__:main_worker:429 - [15/100], remain:0d.00h.37m, It:[10/54], Max-Mem:11245M, Data-Time:1.016, LR:0.0001, Train_Loss:1.3720, total_loss:tensor([1.3720], device='cuda:0'), ce_loss:1.238595724105835, cluster_loss:0.23333679139614105, sep_loss:0.03450014069676399, soft_orth_loss:0.004534415900707245, local_consistency_loss:0.0049126846715807915, proto_loss:0.27728402614593506
2026-01-29 15:31:03.483 | INFO     | __main__:main_worker:429 - [15/100], remain:0d.00h.36m, It:[20/54], Max-Mem:11245M, Data-Time:1.408, LR:0.0001, Train_Loss:0.7373, total_loss:tensor([0.7373], device='cuda:0'), ce_loss:0.9182656407356262, cluster_loss:0.15027102828025818, sep_loss:0.03585134819149971, soft_orth_loss:0.004525978118181229, local_consistency_loss:0.0004966846900060773, proto_loss:0.19114503264427185
2026-01-29 15:31:07.913 | INFO     | __main__:main_worker:429 - [15/100], remain:0d.00h.35m, It:[30/54], Max-Mem:11245M, Data-Time:0.893, LR:0.0001, Train_Loss:-0.0683, total_loss:tensor([-0.0683], device='cuda:0'), ce_loss:0.5652612447738647, cluster_loss:0.0001992780453292653, sep_loss:0.03139327093958855, soft_orth_loss:0.0045202202163636684, local_consistency_loss:0.0006867718766443431, proto_loss:0.036799538880586624
2026-01-29 15:31:12.222 | INFO     | __main__:main_worker:429 - [15/100], remain:0d.00h.34m, It:[40/54], Max-Mem:11245M, Data-Time:0.869, LR:0.0001, Train_Loss:-0.3033, total_loss:tensor([-0.3033], device='cuda:0'), ce_loss:0.3289540410041809, cluster_loss:0.07714931666851044, sep_loss:0.022457534447312355, soft_orth_loss:0.004514929838478565, local_consistency_loss:0.0006207843543961644, proto_loss:0.10474256426095963
2026-01-29 15:31:15.777 | INFO     | __main__:main_worker:429 - [15/100], remain:0d.00h.32m, It:[50/54], Max-Mem:11245M, Data-Time:0.141, LR:0.0001, Train_Loss:0.0587, total_loss:tensor([0.0587], device='cuda:0'), ce_loss:0.5569618940353394, cluster_loss:0.08523263782262802, sep_loss:0.025078242644667625, soft_orth_loss:0.004511944018304348, local_consistency_loss:0.000857168750371784, proto_loss:0.11567999422550201
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
acc1: 83.9744, acc3: 100.0000, Precision: 0.7385, Recall: 0.8129, F1-Score: 0.7609, Specificity: 0.9193
2026-01-29 15:31:26.359 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [15/100], Top1:83.974, Top3:100.000, Test_precision:0.7385,Test_recall:0.8129,Test_f1:0.7609,,Test_specificity:0.9193 Test_loss:0.395749
2026-01-29 15:31:26.360 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:31:39.282 | INFO     | __main__:main_worker:355 - ---> start train epoch16
2026-01-29 15:31:48.895 | INFO     | __main__:main_worker:429 - [16/100], remain:0d.00h.42m, It:[10/54], Max-Mem:11245M, Data-Time:1.513, LR:0.0001, Train_Loss:-0.1584, total_loss:tensor([-0.1584], device='cuda:0'), ce_loss:0.4177913963794708, cluster_loss:0.08564295619726181, sep_loss:0.020653728395700455, soft_orth_loss:0.004500229377299547, local_consistency_loss:0.0009445766336284578, proto_loss:0.11174149811267853
2026-01-29 15:31:52.479 | INFO     | __main__:main_worker:429 - [16/100], remain:0d.00h.34m, It:[20/54], Max-Mem:11245M, Data-Time:0.154, LR:0.0001, Train_Loss:-0.0247, total_loss:tensor([-0.0247], device='cuda:0'), ce_loss:0.48732006549835205, cluster_loss:0.08945350348949432, sep_loss:0.02779536321759224, soft_orth_loss:0.0044858092442154884, local_consistency_loss:0.006564700044691563, proto_loss:0.12829937040805817
2026-01-29 15:31:57.294 | INFO     | __main__:main_worker:429 - [16/100], remain:0d.00h.34m, It:[30/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:0.1710, total_loss:tensor([0.1710], device='cuda:0'), ce_loss:0.598787784576416, cluster_loss:0.11226677894592285, sep_loss:0.02701306901872158, soft_orth_loss:0.004476639907807112, local_consistency_loss:0.0003717679064720869, proto_loss:0.1441282480955124
2026-01-29 15:32:02.101 | INFO     | __main__:main_worker:429 - [16/100], remain:0d.00h.34m, It:[40/54], Max-Mem:11245M, Data-Time:0.681, LR:0.0001, Train_Loss:-0.2847, total_loss:tensor([-0.2847], device='cuda:0'), ce_loss:0.35767862200737, cluster_loss:0.06665115803480148, sep_loss:0.020765554159879684, soft_orth_loss:0.00446598744019866, local_consistency_loss:0.0005797033663839102, proto_loss:0.09246239811182022
2026-01-29 15:32:06.494 | INFO     | __main__:main_worker:429 - [16/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11245M, Data-Time:0.782, LR:0.0001, Train_Loss:0.4079, total_loss:tensor([0.4079], device='cuda:0'), ce_loss:0.7451916337013245, cluster_loss:0.11499746143817902, sep_loss:0.03308344632387161, soft_orth_loss:0.004451224114745855, local_consistency_loss:0.001107995631173253, proto_loss:0.15364013612270355
2026-01-29 15:32:07.815 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 16 (LR=0.000096, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.0550
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.9367
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.9246
Local prototype push completed!
2026-01-29 15:32:32.242 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.78it/s]
acc1: 86.9658, acc3: 100.0000, Precision: 0.7707, Recall: 0.8103, F1-Score: 0.7872, Specificity: 0.9333
2026-01-29 15:32:40.711 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [16/100], Top1:86.966, Top3:100.000, Test_precision:0.7707,Test_recall:0.8103,Test_f1:0.7872,,Test_specificity:0.9333 Test_loss:0.335112
2026-01-29 15:32:40.711 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:32:40.712 | INFO     | __main__:main_worker:355 - ---> start train epoch17
2026-01-29 15:32:50.006 | INFO     | __main__:main_worker:429 - [17/100], remain:0d.00h.36m, It:[10/54], Max-Mem:11245M, Data-Time:0.733, LR:0.0001, Train_Loss:0.0070, total_loss:tensor([0.0070], device='cuda:0'), ce_loss:0.5259361267089844, cluster_loss:0.08842908591032028, sep_loss:0.02046673558652401, soft_orth_loss:0.004989824257791042, local_consistency_loss:0.0006081726169213653, proto_loss:0.11449382454156876
2026-01-29 15:32:54.404 | INFO     | __main__:main_worker:429 - [17/100], remain:0d.00h.34m, It:[20/54], Max-Mem:11245M, Data-Time:0.430, LR:0.0001, Train_Loss:-0.4147, total_loss:tensor([-0.4147], device='cuda:0'), ce_loss:0.2716746926307678, cluster_loss:0.06921090185642242, sep_loss:0.017512796446681023, soft_orth_loss:0.00497537711635232, local_consistency_loss:0.0015968565130606294, proto_loss:0.09329593181610107
2026-01-29 15:32:58.919 | INFO     | __main__:main_worker:429 - [17/100], remain:0d.00h.34m, It:[30/54], Max-Mem:11245M, Data-Time:1.003, LR:0.0001, Train_Loss:0.3525, total_loss:tensor([0.3525], device='cuda:0'), ce_loss:0.7150300145149231, cluster_loss:0.10994551330804825, sep_loss:0.032791730016469955, soft_orth_loss:0.004966116510331631, local_consistency_loss:0.0010567745193839073, proto_loss:0.148760125041008
2026-01-29 15:33:03.286 | INFO     | __main__:main_worker:429 - [17/100], remain:0d.00h.33m, It:[40/54], Max-Mem:11245M, Data-Time:0.356, LR:0.0001, Train_Loss:0.0690, total_loss:tensor([0.0690], device='cuda:0'), ce_loss:0.5310255885124207, cluster_loss:0.10968045145273209, sep_loss:0.0301824864000082, soft_orth_loss:0.0049568843096494675, local_consistency_loss:0.0008780397474765778, proto_loss:0.14569786190986633
2026-01-29 15:33:07.646 | INFO     | __main__:main_worker:429 - [17/100], remain:0d.00h.33m, It:[50/54], Max-Mem:11245M, Data-Time:0.736, LR:0.0001, Train_Loss:0.0999, total_loss:tensor([0.0999], device='cuda:0'), ce_loss:0.5855727195739746, cluster_loss:0.08258458226919174, sep_loss:0.027540255337953568, soft_orth_loss:0.004951790440827608, local_consistency_loss:0.002076114993542433, proto_loss:0.11715274304151535
Evaluating: 100%|| 15/15 [00:08<00:00,  1.78it/s]
acc1: 84.8291, acc3: 100.0000, Precision: 0.7407, Recall: 0.7830, F1-Score: 0.7547, Specificity: 0.9167
2026-01-29 15:33:17.747 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [17/100], Top1:84.829, Top3:100.000, Test_precision:0.7407,Test_recall:0.7830,Test_f1:0.7547,,Test_specificity:0.9167 Test_loss:0.432245
2026-01-29 15:33:17.759 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:33:17.760 | INFO     | __main__:main_worker:355 - ---> start train epoch18
2026-01-29 15:33:27.482 | INFO     | __main__:main_worker:429 - [18/100], remain:0d.00h.35m, It:[10/54], Max-Mem:11245M, Data-Time:1.378, LR:0.0001, Train_Loss:-0.3507, total_loss:tensor([-0.3507], device='cuda:0'), ce_loss:0.30933359265327454, cluster_loss:0.07772622257471085, sep_loss:0.015152284875512123, soft_orth_loss:0.004948053043335676, local_consistency_loss:0.0009206638787873089, proto_loss:0.09874721616506577
2026-01-29 15:33:31.448 | INFO     | __main__:main_worker:429 - [18/100], remain:0d.00h.31m, It:[20/54], Max-Mem:11245M, Data-Time:0.467, LR:0.0001, Train_Loss:0.9297, total_loss:tensor([0.9297], device='cuda:0'), ce_loss:1.0481560230255127, cluster_loss:0.14553344249725342, sep_loss:0.03947056457400322, soft_orth_loss:0.004941706079989672, local_consistency_loss:0.0009183386573567986, proto_loss:0.19086405634880066
2026-01-29 15:33:36.387 | INFO     | __main__:main_worker:429 - [18/100], remain:0d.00h.33m, It:[30/54], Max-Mem:11245M, Data-Time:0.402, LR:0.0001, Train_Loss:-0.2441, total_loss:tensor([-0.2441], device='cuda:0'), ce_loss:0.3655810058116913, cluster_loss:0.08054790645837784, sep_loss:0.02500479482114315, soft_orth_loss:0.004929301328957081, local_consistency_loss:0.0009480465087108314, proto_loss:0.11143005639314651
2026-01-29 15:33:41.217 | INFO     | __main__:main_worker:429 - [18/100], remain:0d.00h.33m, It:[40/54], Max-Mem:11245M, Data-Time:0.023, LR:0.0001, Train_Loss:0.0172, total_loss:tensor([0.0172], device='cuda:0'), ce_loss:0.5357288122177124, cluster_loss:0.07954932749271393, sep_loss:0.029089970514178276, soft_orth_loss:0.004921880085021257, local_consistency_loss:0.00044276713742874563, proto_loss:0.11400394886732101
2026-01-29 15:33:45.768 | INFO     | __main__:main_worker:429 - [18/100], remain:0d.00h.33m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:0.3723, total_loss:tensor([0.3723], device='cuda:0'), ce_loss:0.7244747877120972, cluster_loss:0.11834434419870377, sep_loss:0.028405655175447464, soft_orth_loss:0.004915774799883366, local_consistency_loss:0.001493659452535212, proto_loss:0.15315943956375122
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
2026-01-29 15:33:55.996 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [18/100], Top1:82.479, Top3:100.000, Test_precision:0.7262,Test_recall:0.8050,Test_f1:0.7452,,Test_specificity:0.9122 Test_loss:0.415793
2026-01-29 15:33:55.997 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:33:55.998 | INFO     | __main__:main_worker:355 - ---> start train epoch19
acc1: 82.4786, acc3: 100.0000, Precision: 0.7262, Recall: 0.8050, F1-Score: 0.7452, Specificity: 0.9122
2026-01-29 15:34:04.629 | INFO     | __main__:main_worker:429 - [19/100], remain:0d.00h.32m, It:[10/54], Max-Mem:11245M, Data-Time:0.021, LR:0.0001, Train_Loss:0.3211, total_loss:tensor([0.3211], device='cuda:0'), ce_loss:0.71068274974823, cluster_loss:0.09492940455675125, sep_loss:0.035914622247219086, soft_orth_loss:0.004911927040666342, local_consistency_loss:0.0008134951931424439, proto_loss:0.13656945526599884
2026-01-29 15:34:09.517 | INFO     | __main__:main_worker:429 - [19/100], remain:0d.00h.33m, It:[20/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0001, Train_Loss:-0.0081, total_loss:tensor([-0.0081], device='cuda:0'), ce_loss:0.5077021718025208, cluster_loss:0.08836667239665985, sep_loss:0.030565841123461723, soft_orth_loss:0.004903731402009726, local_consistency_loss:0.0006274584447965026, proto_loss:0.12446370720863342
2026-01-29 15:34:14.462 | INFO     | __main__:main_worker:429 - [19/100], remain:0d.00h.34m, It:[30/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0001, Train_Loss:0.3738, total_loss:tensor([0.3738], device='cuda:0'), ce_loss:0.8611190319061279, cluster_loss:0.00026265092310495675, sep_loss:0.03238567337393761, soft_orth_loss:0.004893991630524397, local_consistency_loss:0.002061435952782631, proto_loss:0.03960375487804413
2026-01-29 15:34:18.995 | INFO     | __main__:main_worker:429 - [19/100], remain:0d.00h.33m, It:[40/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:0.4918, total_loss:tensor([0.4918], device='cuda:0'), ce_loss:0.790945827960968, cluster_loss:0.1313127875328064, sep_loss:0.0272685419768095, soft_orth_loss:0.004883892368525267, local_consistency_loss:0.0010461237980052829, proto_loss:0.16451133787631989
2026-01-29 15:34:23.409 | INFO     | __main__:main_worker:429 - [19/100], remain:0d.00h.33m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:-0.0778, total_loss:tensor([-0.0778], device='cuda:0'), ce_loss:0.47337114810943604, cluster_loss:0.08134791254997253, sep_loss:0.02822079136967659, soft_orth_loss:0.004875807091593742, local_consistency_loss:0.0009659256902523339, proto_loss:0.11541043221950531
Evaluating: 100%|| 15/15 [00:08<00:00,  1.79it/s]
2026-01-29 15:34:34.754 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [19/100], Top1:83.547, Top3:100.000, Test_precision:0.7286,Test_recall:0.8198,Test_f1:0.7553,,Test_specificity:0.9293 Test_loss:0.455810
2026-01-29 15:34:34.755 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:34:34.755 | INFO     | __main__:main_worker:355 - ---> start train epoch20
acc1: 83.5470, acc3: 100.0000, Precision: 0.7286, Recall: 0.8198, F1-Score: 0.7553, Specificity: 0.9293
2026-01-29 15:34:44.258 | INFO     | __main__:main_worker:429 - [20/100], remain:0d.00h.34m, It:[10/54], Max-Mem:11245M, Data-Time:1.140, LR:0.0001, Train_Loss:0.2952, total_loss:tensor([0.2952], device='cuda:0'), ce_loss:0.6966102719306946, cluster_loss:0.09840304404497147, sep_loss:0.030679479241371155, soft_orth_loss:0.004870164208114147, local_consistency_loss:0.0012152675772085786, proto_loss:0.1351679563522339
2026-01-29 15:34:49.201 | INFO     | __main__:main_worker:429 - [20/100], remain:0d.00h.34m, It:[20/54], Max-Mem:11245M, Data-Time:1.491, LR:0.0001, Train_Loss:-0.0470, total_loss:tensor([-0.0470], device='cuda:0'), ce_loss:0.47209325432777405, cluster_loss:0.10288899391889572, sep_loss:0.025371817871928215, soft_orth_loss:0.004861359018832445, local_consistency_loss:0.0010308249620720744, proto_loss:0.13415297865867615
2026-01-29 15:34:53.484 | INFO     | __main__:main_worker:429 - [20/100], remain:0d.00h.33m, It:[30/54], Max-Mem:11245M, Data-Time:0.733, LR:0.0001, Train_Loss:0.1149, total_loss:tensor([0.1149], device='cuda:0'), ce_loss:0.5997204184532166, cluster_loss:0.08223060518503189, sep_loss:0.028736043721437454, soft_orth_loss:0.004846799187362194, local_consistency_loss:0.0011259423336014152, proto_loss:0.11693938821554184
2026-01-29 15:34:57.121 | INFO     | __main__:main_worker:429 - [20/100], remain:0d.00h.31m, It:[40/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:0.4458, total_loss:tensor([0.4458], device='cuda:0'), ce_loss:0.7565076947212219, cluster_loss:0.12569205462932587, sep_loss:0.03681476041674614, soft_orth_loss:0.004837842658162117, local_consistency_loss:0.0015434280503541231, proto_loss:0.16888809204101562
2026-01-29 15:35:01.357 | INFO     | __main__:main_worker:429 - [20/100], remain:0d.00h.30m, It:[50/54], Max-Mem:11245M, Data-Time:0.008, LR:0.0001, Train_Loss:0.4909, total_loss:tensor([0.4909], device='cuda:0'), ce_loss:0.9451556205749512, cluster_loss:0.00028626847779378295, sep_loss:0.029230108484625816, soft_orth_loss:0.004829339683055878, local_consistency_loss:0.0012446162290871143, proto_loss:0.03559033200144768
Evaluating: 100%|| 15/15 [00:08<00:00,  1.81it/s]
2026-01-29 15:35:11.409 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [20/100], Top1:85.897, Top3:100.000, Test_precision:0.7626,Test_recall:0.8209,Test_f1:0.7846,,Test_specificity:0.9335 Test_loss:0.408655
acc1: 85.8974, acc3: 100.0000, Precision: 0.7626, Recall: 0.8209, F1-Score: 0.7846, Specificity: 0.9335
2026-01-29 15:35:11.410 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:35:21.281 | INFO     | __main__:main_worker:355 - ---> start train epoch21
2026-01-29 15:35:31.283 | INFO     | __main__:main_worker:429 - [21/100], remain:0d.00h.38m, It:[10/54], Max-Mem:11245M, Data-Time:1.991, LR:0.0001, Train_Loss:-0.2435, total_loss:tensor([-0.2435], device='cuda:0'), ce_loss:0.38215938210487366, cluster_loss:0.07198219001293182, sep_loss:0.02374158799648285, soft_orth_loss:0.004811114631593227, local_consistency_loss:0.0014345732051879168, proto_loss:0.10196946561336517
2026-01-29 15:35:35.304 | INFO     | __main__:main_worker:429 - [21/100], remain:0d.00h.33m, It:[20/54], Max-Mem:11245M, Data-Time:0.513, LR:0.0001, Train_Loss:-0.3242, total_loss:tensor([-0.3242], device='cuda:0'), ce_loss:0.337399423122406, cluster_loss:0.06774886697530746, sep_loss:0.02092066965997219, soft_orth_loss:0.004801440052688122, local_consistency_loss:0.0017960539553314447, proto_loss:0.09526702761650085
2026-01-29 15:35:39.975 | INFO     | __main__:main_worker:429 - [21/100], remain:0d.00h.32m, It:[30/54], Max-Mem:11245M, Data-Time:1.174, LR:0.0001, Train_Loss:-0.1888, total_loss:tensor([-0.1888], device='cuda:0'), ce_loss:0.41655775904655457, cluster_loss:0.07143265753984451, sep_loss:0.02717231586575508, soft_orth_loss:0.004796861670911312, local_consistency_loss:0.0007216261001303792, proto_loss:0.10412346571683884
2026-01-29 15:35:45.664 | INFO     | __main__:main_worker:429 - [21/100], remain:0d.00h.34m, It:[40/54], Max-Mem:11245M, Data-Time:2.227, LR:0.0001, Train_Loss:-0.4453, total_loss:tensor([-0.4453], device='cuda:0'), ce_loss:0.25652366876602173, cluster_loss:0.07437419146299362, sep_loss:0.017126208171248436, soft_orth_loss:0.0047910744324326515, local_consistency_loss:0.0006460490985773504, proto_loss:0.09693752229213715
2026-01-29 15:35:50.110 | INFO     | __main__:main_worker:429 - [21/100], remain:0d.00h.33m, It:[50/54], Max-Mem:11245M, Data-Time:0.977, LR:0.0001, Train_Loss:-0.3546, total_loss:tensor([-0.3546], device='cuda:0'), ce_loss:0.28929603099823, cluster_loss:0.09496491402387619, sep_loss:0.019739804789423943, soft_orth_loss:0.004785408731549978, local_consistency_loss:0.0004224998119752854, proto_loss:0.11991263180971146
Evaluating: 100%|| 15/15 [00:08<00:00,  1.81it/s]
acc1: 86.1111, acc3: 100.0000, Precision: 0.7749, Recall: 0.8203, F1-Score: 0.7944, Specificity: 0.9220
2026-01-29 15:35:59.789 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [21/100], Top1:86.111, Top3:100.000, Test_precision:0.7749,Test_recall:0.8203,Test_f1:0.7944,,Test_specificity:0.9220 Test_loss:0.424873
2026-01-29 15:35:59.790 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:35:59.791 | INFO     | __main__:main_worker:355 - ---> start train epoch22
2026-01-29 15:36:08.233 | INFO     | __main__:main_worker:429 - [22/100], remain:0d.00h.26m, It:[10/54], Max-Mem:11245M, Data-Time:0.301, LR:0.0001, Train_Loss:-0.1880, total_loss:tensor([-0.1880], device='cuda:0'), ce_loss:0.3976244628429413, cluster_loss:0.09776576608419418, sep_loss:0.018029306083917618, soft_orth_loss:0.004776261281222105, local_consistency_loss:0.001011940068565309, proto_loss:0.12158327549695969
2026-01-29 15:36:12.971 | INFO     | __main__:main_worker:429 - [22/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:1.0728, total_loss:tensor([1.0728], device='cuda:0'), ce_loss:1.1070976257324219, cluster_loss:0.17994298040866852, sep_loss:0.03702247887849808, soft_orth_loss:0.0047669848427176476, local_consistency_loss:0.0005015168571844697, proto_loss:0.22223396599292755
2026-01-29 15:36:17.517 | INFO     | __main__:main_worker:429 - [22/100], remain:0d.00h.30m, It:[30/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.0382, total_loss:tensor([-0.0382], device='cuda:0'), ce_loss:0.4960543215274811, cluster_loss:0.08811774104833603, sep_loss:0.028446590527892113, soft_orth_loss:0.0047636209055781364, local_consistency_loss:0.0008164932951331139, proto_loss:0.12214444577693939
2026-01-29 15:36:22.141 | INFO     | __main__:main_worker:429 - [22/100], remain:0d.00h.30m, It:[40/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.0961, total_loss:tensor([-0.0961], device='cuda:0'), ce_loss:0.4772392213344574, cluster_loss:0.07782353460788727, sep_loss:0.022862911224365234, soft_orth_loss:0.00475881015881896, local_consistency_loss:0.0008277284214273095, proto_loss:0.10627298802137375
2026-01-29 15:36:26.609 | INFO     | __main__:main_worker:429 - [22/100], remain:0d.00h.30m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.2964, total_loss:tensor([-0.2964], device='cuda:0'), ce_loss:0.34416690468788147, cluster_loss:0.08391256630420685, sep_loss:0.018819713965058327, soft_orth_loss:0.004752738401293755, local_consistency_loss:0.0003014664980582893, proto_loss:0.10778648406267166
Evaluating: 100%|| 15/15 [00:08<00:00,  1.82it/s]
2026-01-29 15:36:38.295 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [22/100], Top1:86.966, Top3:100.000, Test_precision:0.7894,Test_recall:0.8081,Test_f1:0.7977,,Test_specificity:0.9265 Test_loss:0.370160
2026-01-29 15:36:38.296 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:36:38.297 | INFO     | __main__:main_worker:355 - ---> start train epoch23
acc1: 86.9658, acc3: 100.0000, Precision: 0.7894, Recall: 0.8081, F1-Score: 0.7977, Specificity: 0.9265
2026-01-29 15:36:48.164 | INFO     | __main__:main_worker:429 - [23/100], remain:0d.00h.34m, It:[10/54], Max-Mem:11245M, Data-Time:1.466, LR:0.0001, Train_Loss:0.1557, total_loss:tensor([0.1557], device='cuda:0'), ce_loss:0.5876122117042542, cluster_loss:0.1261313408613205, sep_loss:0.021404646337032318, soft_orth_loss:0.004744749516248703, local_consistency_loss:0.0007628800231032073, proto_loss:0.15304361283779144
2026-01-29 15:36:52.611 | INFO     | __main__:main_worker:429 - [23/100], remain:0d.00h.32m, It:[20/54], Max-Mem:11245M, Data-Time:0.986, LR:0.0001, Train_Loss:0.4783, total_loss:tensor([0.4783], device='cuda:0'), ce_loss:0.7756170630455017, cluster_loss:0.13364577293395996, sep_loss:0.03401632234454155, soft_orth_loss:0.004729761742055416, local_consistency_loss:0.0008504043216817081, proto_loss:0.17324227094650269
2026-01-29 15:36:57.861 | INFO     | __main__:main_worker:429 - [23/100], remain:0d.00h.33m, It:[30/54], Max-Mem:11245M, Data-Time:1.799, LR:0.0001, Train_Loss:-0.2317, total_loss:tensor([-0.2317], device='cuda:0'), ce_loss:0.3918119966983795, cluster_loss:0.07561738044023514, sep_loss:0.023971712216734886, soft_orth_loss:0.00471725407987833, local_consistency_loss:0.00033986472408287227, proto_loss:0.1046462133526802
2026-01-29 15:37:02.369 | INFO     | __main__:main_worker:429 - [23/100], remain:0d.00h.32m, It:[40/54], Max-Mem:11245M, Data-Time:0.766, LR:0.0001, Train_Loss:0.0815, total_loss:tensor([0.0815], device='cuda:0'), ce_loss:0.6776770353317261, cluster_loss:0.00021589361131191254, sep_loss:0.03194386884570122, soft_orth_loss:0.004708721302449703, local_consistency_loss:0.0006241989322006702, proto_loss:0.03749268129467964
2026-01-29 15:37:06.273 | INFO     | __main__:main_worker:429 - [23/100], remain:0d.00h.31m, It:[50/54], Max-Mem:11245M, Data-Time:0.517, LR:0.0001, Train_Loss:-0.1097, total_loss:tensor([-0.1097], device='cuda:0'), ce_loss:0.4409739077091217, cluster_loss:0.10085294395685196, sep_loss:0.02447185292840004, soft_orth_loss:0.0046974183060228825, local_consistency_loss:0.001137763843871653, proto_loss:0.1311599761247635
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
2026-01-29 15:37:15.763 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [23/100], Top1:86.538, Top3:100.000, Test_precision:0.7749,Test_recall:0.8360,Test_f1:0.7992,,Test_specificity:0.9293 Test_loss:0.371772
acc1: 86.5385, acc3: 100.0000, Precision: 0.7749, Recall: 0.8360, F1-Score: 0.7992, Specificity: 0.9293
2026-01-29 15:37:15.765 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:37:15.766 | INFO     | __main__:main_worker:355 - ---> start train epoch24
2026-01-29 15:37:25.782 | INFO     | __main__:main_worker:429 - [24/100], remain:0d.00h.41m, It:[10/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0001, Train_Loss:0.4314, total_loss:tensor([0.4314], device='cuda:0'), ce_loss:0.7480366230010986, cluster_loss:0.1354941874742508, sep_loss:0.03020722046494484, soft_orth_loss:0.0046861558221280575, local_consistency_loss:0.000967752595897764, proto_loss:0.17135532200336456
2026-01-29 15:37:29.900 | INFO     | __main__:main_worker:429 - [24/100], remain:0d.00h.34m, It:[20/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:-0.0105, total_loss:tensor([-0.0105], device='cuda:0'), ce_loss:0.5120884776115417, cluster_loss:0.09476272761821747, sep_loss:0.026137564331293106, soft_orth_loss:0.004679217003285885, local_consistency_loss:0.0010626964503899217, proto_loss:0.12664219737052917
2026-01-29 15:37:34.881 | INFO     | __main__:main_worker:429 - [24/100], remain:0d.00h.34m, It:[30/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:-0.4885, total_loss:tensor([-0.4885], device='cuda:0'), ce_loss:0.24553854763507843, cluster_loss:0.06307859718799591, sep_loss:0.0196191668510437, soft_orth_loss:0.004670870024710894, local_consistency_loss:0.0006448728963732719, proto_loss:0.08801350742578506
2026-01-29 15:37:38.862 | INFO     | __main__:main_worker:429 - [24/100], remain:0d.00h.32m, It:[40/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:1.1260, total_loss:tensor([1.1260], device='cuda:0'), ce_loss:1.1157586574554443, cluster_loss:0.2038031667470932, sep_loss:0.03565368056297302, soft_orth_loss:0.004660343285650015, local_consistency_loss:0.0005812416784465313, proto_loss:0.2446984201669693
2026-01-29 15:37:42.755 | INFO     | __main__:main_worker:429 - [24/100], remain:0d.00h.30m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.1644, total_loss:tensor([-0.1644], device='cuda:0'), ce_loss:0.43036386370658875, cluster_loss:0.08147957175970078, sep_loss:0.024657702073454857, soft_orth_loss:0.004651480354368687, local_consistency_loss:0.0007892390713095665, proto_loss:0.11157799512147903
2026-01-29 15:37:45.839 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 24 (LR=0.000089, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.9562
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.8815
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.8398
Local prototype push completed!
2026-01-29 15:38:12.591 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.81it/s]
acc1: 85.8974, acc3: 100.0000, Precision: 0.7608, Recall: 0.8145, F1-Score: 0.7827, Specificity: 0.9256
2026-01-29 15:38:20.908 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [24/100], Top1:85.897, Top3:100.000, Test_precision:0.7608,Test_recall:0.8145,Test_f1:0.7827,,Test_specificity:0.9256 Test_loss:0.400825
2026-01-29 15:38:20.909 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:38:20.910 | INFO     | __main__:main_worker:355 - ---> start train epoch25
2026-01-29 15:38:31.610 | INFO     | __main__:main_worker:429 - [25/100], remain:0d.00h.34m, It:[10/54], Max-Mem:11245M, Data-Time:1.696, LR:0.0001, Train_Loss:0.4532, total_loss:tensor([0.4532], device='cuda:0'), ce_loss:0.7617778778076172, cluster_loss:0.1359928846359253, sep_loss:0.03009839728474617, soft_orth_loss:0.005330642219632864, local_consistency_loss:0.0013442232739180326, proto_loss:0.17276613414287567
2026-01-29 15:38:35.911 | INFO     | __main__:main_worker:429 - [25/100], remain:0d.00h.31m, It:[20/54], Max-Mem:11245M, Data-Time:0.765, LR:0.0001, Train_Loss:0.7973, total_loss:tensor([0.7973], device='cuda:0'), ce_loss:0.9027869701385498, cluster_loss:0.19731386005878448, sep_loss:0.03958955034613609, soft_orth_loss:0.005324838683009148, local_consistency_loss:0.0009797322563827038, proto_loss:0.24320799112319946
2026-01-29 15:38:40.568 | INFO     | __main__:main_worker:429 - [25/100], remain:0d.00h.31m, It:[30/54], Max-Mem:11245M, Data-Time:1.179, LR:0.0001, Train_Loss:-0.4531, total_loss:tensor([-0.4531], device='cuda:0'), ce_loss:0.26510220766067505, cluster_loss:0.07043252140283585, sep_loss:0.016000322997570038, soft_orth_loss:0.005320289637893438, local_consistency_loss:0.0012987891677767038, proto_loss:0.09305192530155182
2026-01-29 15:38:44.483 | INFO     | __main__:main_worker:429 - [25/100], remain:0d.00h.29m, It:[40/54], Max-Mem:11245M, Data-Time:0.415, LR:0.0001, Train_Loss:0.1287, total_loss:tensor([0.1287], device='cuda:0'), ce_loss:0.5750982761383057, cluster_loss:0.12088829278945923, sep_loss:0.02524159662425518, soft_orth_loss:0.005312465131282806, local_consistency_loss:0.0006806791061535478, proto_loss:0.15212303400039673
2026-01-29 15:38:48.737 | INFO     | __main__:main_worker:429 - [25/100], remain:0d.00h.29m, It:[50/54], Max-Mem:11245M, Data-Time:0.808, LR:0.0001, Train_Loss:0.0602, total_loss:tensor([0.0602], device='cuda:0'), ce_loss:0.5472661256790161, cluster_loss:0.10305646806955338, sep_loss:0.02922957018017769, soft_orth_loss:0.005302549339830875, local_consistency_loss:0.0006223623640835285, proto_loss:0.1382109522819519
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
acc1: 85.8974, acc3: 100.0000, Precision: 0.7678, Recall: 0.8530, F1-Score: 0.7985, Specificity: 0.9310
2026-01-29 15:38:58.406 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [25/100], Top1:85.897, Top3:100.000, Test_precision:0.7678,Test_recall:0.8530,Test_f1:0.7985,,Test_specificity:0.9310 Test_loss:0.395860
2026-01-29 15:38:58.407 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:39:08.762 | INFO     | __main__:main_worker:355 - ---> start train epoch26
2026-01-29 15:39:18.005 | INFO     | __main__:main_worker:429 - [26/100], remain:0d.00h.35m, It:[10/54], Max-Mem:11245M, Data-Time:1.315, LR:0.0001, Train_Loss:0.1941, total_loss:tensor([0.1941], device='cuda:0'), ce_loss:0.6189815998077393, cluster_loss:0.11381812393665314, sep_loss:0.03183189034461975, soft_orth_loss:0.005289075430482626, local_consistency_loss:0.0006409393390640616, proto_loss:0.15158003568649292
2026-01-29 15:39:22.272 | INFO     | __main__:main_worker:429 - [26/100], remain:0d.00h.31m, It:[20/54], Max-Mem:11245M, Data-Time:0.019, LR:0.0001, Train_Loss:-0.2356, total_loss:tensor([-0.2356], device='cuda:0'), ce_loss:0.39501139521598816, cluster_loss:0.07038839161396027, sep_loss:0.028386497870087624, soft_orth_loss:0.005274660885334015, local_consistency_loss:0.0004769188817590475, proto_loss:0.10452646762132645
2026-01-29 15:39:27.256 | INFO     | __main__:main_worker:429 - [26/100], remain:0d.00h.31m, It:[30/54], Max-Mem:11245M, Data-Time:0.019, LR:0.0001, Train_Loss:-0.4467, total_loss:tensor([-0.4467], device='cuda:0'), ce_loss:0.28056660294532776, cluster_loss:0.06308504194021225, sep_loss:0.01647511124610901, soft_orth_loss:0.005264608189463615, local_consistency_loss:0.0004615360521711409, proto_loss:0.08528629690408707
2026-01-29 15:39:32.841 | INFO     | __main__:main_worker:429 - [26/100], remain:0d.00h.32m, It:[40/54], Max-Mem:11245M, Data-Time:0.018, LR:0.0001, Train_Loss:0.2909, total_loss:tensor([0.2909], device='cuda:0'), ce_loss:0.6753953695297241, cluster_loss:0.12368718534708023, sep_loss:0.028195399791002274, soft_orth_loss:0.005260659381747246, local_consistency_loss:0.0007186053553596139, proto_loss:0.1578618586063385
2026-01-29 15:39:37.474 | INFO     | __main__:main_worker:429 - [26/100], remain:0d.00h.32m, It:[50/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:-0.1870, total_loss:tensor([-0.1870], device='cuda:0'), ce_loss:0.42972707748413086, cluster_loss:0.0800628587603569, sep_loss:0.016830770298838615, soft_orth_loss:0.005257398821413517, local_consistency_loss:0.0007400246686302125, proto_loss:0.10289105027914047
Evaluating: 100%|| 15/15 [00:08<00:00,  1.82it/s]
2026-01-29 15:39:48.053 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [26/100], Top1:87.821, Top3:100.000, Test_precision:0.7949,Test_recall:0.8431,Test_f1:0.8154,,Test_specificity:0.9368 Test_loss:0.340307
2026-01-29 15:39:48.054 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:39:48.054 | INFO     | __main__:main_worker:355 - ---> start train epoch27
acc1: 87.8205, acc3: 100.0000, Precision: 0.7949, Recall: 0.8431, F1-Score: 0.8154, Specificity: 0.9368
2026-01-29 15:39:59.196 | INFO     | __main__:main_worker:429 - [27/100], remain:0d.00h.35m, It:[10/54], Max-Mem:11245M, Data-Time:1.941, LR:0.0001, Train_Loss:-0.1610, total_loss:tensor([-0.1610], device='cuda:0'), ce_loss:0.4223422408103943, cluster_loss:0.09221601486206055, sep_loss:0.025264201685786247, soft_orth_loss:0.0052530039101839066, local_consistency_loss:0.0009097891743294895, proto_loss:0.12364301085472107
2026-01-29 15:40:02.987 | INFO     | __main__:main_worker:429 - [27/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11245M, Data-Time:0.295, LR:0.0001, Train_Loss:-0.0247, total_loss:tensor([-0.0247], device='cuda:0'), ce_loss:0.526881754398346, cluster_loss:0.08116722106933594, sep_loss:0.023663882166147232, soft_orth_loss:0.005251383874565363, local_consistency_loss:0.0007222528802230954, proto_loss:0.1108047366142273
2026-01-29 15:40:07.514 | INFO     | __main__:main_worker:429 - [27/100], remain:0d.00h.29m, It:[30/54], Max-Mem:11245M, Data-Time:1.051, LR:0.0001, Train_Loss:-0.0456, total_loss:tensor([-0.0456], device='cuda:0'), ce_loss:0.5401138067245483, cluster_loss:0.05923246964812279, sep_loss:0.023288477212190628, soft_orth_loss:0.005249909590929747, local_consistency_loss:0.0008788557024672627, proto_loss:0.08864971250295639
2026-01-29 15:40:12.211 | INFO     | __main__:main_worker:429 - [27/100], remain:0d.00h.29m, It:[40/54], Max-Mem:11245M, Data-Time:1.263, LR:0.0001, Train_Loss:-0.1671, total_loss:tensor([-0.1671], device='cuda:0'), ce_loss:0.4204742908477783, cluster_loss:0.08980493992567062, sep_loss:0.02652606926858425, soft_orth_loss:0.005246748216450214, local_consistency_loss:0.0011801770888268948, proto_loss:0.1227579414844513
2026-01-29 15:40:17.314 | INFO     | __main__:main_worker:429 - [27/100], remain:0d.00h.30m, It:[50/54], Max-Mem:11245M, Data-Time:1.600, LR:0.0001, Train_Loss:0.4768, total_loss:tensor([0.4768], device='cuda:0'), ce_loss:0.7781169414520264, cluster_loss:0.13900800049304962, sep_loss:0.029434416443109512, soft_orth_loss:0.005243489518761635, local_consistency_loss:0.0007097028428688645, proto_loss:0.1743956059217453
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
acc1: 85.6838, acc3: 100.0000, Precision: 0.7669, Recall: 0.7912, F1-Score: 0.7781, Specificity: 0.9158
2026-01-29 15:40:26.996 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [27/100], Top1:85.684, Top3:100.000, Test_precision:0.7669,Test_recall:0.7912,Test_f1:0.7781,,Test_specificity:0.9158 Test_loss:0.357873
2026-01-29 15:40:26.996 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:40:26.997 | INFO     | __main__:main_worker:355 - ---> start train epoch28
2026-01-29 15:40:35.979 | INFO     | __main__:main_worker:429 - [28/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11245M, Data-Time:0.018, LR:0.0001, Train_Loss:-0.3013, total_loss:tensor([-0.3013], device='cuda:0'), ce_loss:0.3441189229488373, cluster_loss:0.08309459686279297, sep_loss:0.02530900575220585, soft_orth_loss:0.005237927194684744, local_consistency_loss:0.0008071722695603967, proto_loss:0.11444870382547379
2026-01-29 15:40:40.179 | INFO     | __main__:main_worker:429 - [28/100], remain:0d.00h.28m, It:[20/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0001, Train_Loss:-0.2355, total_loss:tensor([-0.2355], device='cuda:0'), ce_loss:0.41224783658981323, cluster_loss:0.0706423968076706, sep_loss:0.016862016171216965, soft_orth_loss:0.005231805145740509, local_consistency_loss:0.0009281287202611566, proto_loss:0.09366434812545776
2026-01-29 15:40:44.660 | INFO     | __main__:main_worker:429 - [28/100], remain:0d.00h.28m, It:[30/54], Max-Mem:11245M, Data-Time:0.009, LR:0.0001, Train_Loss:0.2125, total_loss:tensor([0.2125], device='cuda:0'), ce_loss:0.6307469010353088, cluster_loss:0.12196826934814453, sep_loss:0.026736220344901085, soft_orth_loss:0.005227826070040464, local_consistency_loss:0.0006421105354093015, proto_loss:0.1545744091272354
2026-01-29 15:40:48.789 | INFO     | __main__:main_worker:429 - [28/100], remain:0d.00h.27m, It:[40/54], Max-Mem:11245M, Data-Time:0.472, LR:0.0001, Train_Loss:-0.4819, total_loss:tensor([-0.4819], device='cuda:0'), ce_loss:0.24392753839492798, cluster_loss:0.07683653384447098, sep_loss:0.018706386908888817, soft_orth_loss:0.0052261254750192165, local_consistency_loss:0.0004728427156805992, proto_loss:0.10124189406633377
2026-01-29 15:40:53.946 | INFO     | __main__:main_worker:429 - [28/100], remain:0d.00h.28m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.4049, total_loss:tensor([-0.4049], device='cuda:0'), ce_loss:0.3035171627998352, cluster_loss:0.07150264084339142, sep_loss:0.01657135784626007, soft_orth_loss:0.005221571773290634, local_consistency_loss:0.00045109112397767603, proto_loss:0.09374666213989258
Evaluating: 100%|| 15/15 [00:08<00:00,  1.82it/s]
2026-01-29 15:41:03.577 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [28/100], Top1:83.333, Top3:100.000, Test_precision:0.7377,Test_recall:0.8433,Test_f1:0.7652,,Test_specificity:0.9242 Test_loss:0.453208
acc1: 83.3333, acc3: 100.0000, Precision: 0.7377, Recall: 0.8433, F1-Score: 0.7652, Specificity: 0.9242
2026-01-29 15:41:03.578 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:41:03.579 | INFO     | __main__:main_worker:355 - ---> start train epoch29
2026-01-29 15:41:12.838 | INFO     | __main__:main_worker:429 - [29/100], remain:0d.00h.28m, It:[10/54], Max-Mem:11245M, Data-Time:0.609, LR:0.0001, Train_Loss:0.0133, total_loss:tensor([0.0133], device='cuda:0'), ce_loss:0.5297248959541321, cluster_loss:0.09925961494445801, sep_loss:0.026732856407761574, soft_orth_loss:0.005213718395680189, local_consistency_loss:0.0006883793976157904, proto_loss:0.1318945735692978
2026-01-29 15:41:17.322 | INFO     | __main__:main_worker:429 - [29/100], remain:0d.00h.28m, It:[20/54], Max-Mem:11245M, Data-Time:0.732, LR:0.0001, Train_Loss:-0.1825, total_loss:tensor([-0.1825], device='cuda:0'), ce_loss:0.4388987720012665, cluster_loss:0.07310309261083603, sep_loss:0.0230108592659235, soft_orth_loss:0.005208880640566349, local_consistency_loss:0.0006515094428323209, proto_loss:0.10197433829307556
2026-01-29 15:41:21.549 | INFO     | __main__:main_worker:429 - [29/100], remain:0d.00h.27m, It:[30/54], Max-Mem:11245M, Data-Time:0.804, LR:0.0001, Train_Loss:0.1125, total_loss:tensor([0.1125], device='cuda:0'), ce_loss:0.575508713722229, cluster_loss:0.11211197823286057, sep_loss:0.029931580647826195, soft_orth_loss:0.005206340458244085, local_consistency_loss:0.0006145964725874364, proto_loss:0.14786450564861298
2026-01-29 15:41:25.787 | INFO     | __main__:main_worker:429 - [29/100], remain:0d.00h.27m, It:[40/54], Max-Mem:11245M, Data-Time:0.532, LR:0.0001, Train_Loss:0.2118, total_loss:tensor([0.2118], device='cuda:0'), ce_loss:0.6400449872016907, cluster_loss:0.10768084973096848, sep_loss:0.02862953580915928, soft_orth_loss:0.005203784443438053, local_consistency_loss:0.006482147611677647, proto_loss:0.14799632132053375
2026-01-29 15:41:30.308 | INFO     | __main__:main_worker:429 - [29/100], remain:0d.00h.27m, It:[50/54], Max-Mem:11245M, Data-Time:0.852, LR:0.0001, Train_Loss:0.0002, total_loss:tensor([0.0002], device='cuda:0'), ce_loss:0.517393171787262, cluster_loss:0.10470642149448395, sep_loss:0.025696387514472008, soft_orth_loss:0.005202227737754583, local_consistency_loss:0.0004801522591151297, proto_loss:0.13608518242835999
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
2026-01-29 15:41:39.857 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [29/100], Top1:84.402, Top3:100.000, Test_precision:0.7363,Test_recall:0.7423,Test_f1:0.7390,,Test_specificity:0.9048 Test_loss:0.374076
2026-01-29 15:41:39.858 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:41:39.859 | INFO     | __main__:main_worker:355 - ---> start train epoch30
acc1: 84.4017, acc3: 100.0000, Precision: 0.7363, Recall: 0.7423, F1-Score: 0.7390, Specificity: 0.9048
2026-01-29 15:41:49.528 | INFO     | __main__:main_worker:429 - [30/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11245M, Data-Time:1.359, LR:0.0001, Train_Loss:0.1610, total_loss:tensor([0.1610], device='cuda:0'), ce_loss:0.6374725699424744, cluster_loss:0.08312827348709106, sep_loss:0.03387491777539253, soft_orth_loss:0.0051976097747683525, local_consistency_loss:0.0009142759372480214, proto_loss:0.12311507016420364
2026-01-29 15:41:53.826 | INFO     | __main__:main_worker:429 - [30/100], remain:0d.00h.28m, It:[20/54], Max-Mem:11245M, Data-Time:0.525, LR:0.0001, Train_Loss:-0.3712, total_loss:tensor([-0.3712], device='cuda:0'), ce_loss:0.3206113278865814, cluster_loss:0.07042240351438522, sep_loss:0.02383149228990078, soft_orth_loss:0.005189853720366955, local_consistency_loss:0.0006339793908409774, proto_loss:0.10007772594690323
2026-01-29 15:41:58.358 | INFO     | __main__:main_worker:429 - [30/100], remain:0d.00h.28m, It:[30/54], Max-Mem:11245M, Data-Time:1.030, LR:0.0001, Train_Loss:-0.0164, total_loss:tensor([-0.0164], device='cuda:0'), ce_loss:0.556148886680603, cluster_loss:0.06507552415132523, sep_loss:0.023825155571103096, soft_orth_loss:0.005185150541365147, local_consistency_loss:0.0015470348298549652, proto_loss:0.09563286602497101
2026-01-29 15:42:02.655 | INFO     | __main__:main_worker:429 - [30/100], remain:0d.00h.27m, It:[40/54], Max-Mem:11245M, Data-Time:0.205, LR:0.0001, Train_Loss:0.5525, total_loss:tensor([0.5525], device='cuda:0'), ce_loss:0.8116594552993774, cluster_loss:0.15278998017311096, sep_loss:0.030925890430808067, soft_orth_loss:0.005182801280170679, local_consistency_loss:0.000845851784106344, proto_loss:0.1897445172071457
2026-01-29 15:42:07.826 | INFO     | __main__:main_worker:429 - [30/100], remain:0d.00h.28m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:0.9061, total_loss:tensor([0.9061], device='cuda:0'), ce_loss:0.9954320788383484, cluster_loss:0.18686437606811523, sep_loss:0.03481290489435196, soft_orth_loss:0.005181097891181707, local_consistency_loss:0.0005046587320975959, proto_loss:0.22736303508281708
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
acc1: 86.1111, acc3: 100.0000, Precision: 0.7709, Recall: 0.8649, F1-Score: 0.8028, Specificity: 0.9334
2026-01-29 15:42:17.383 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [30/100], Top1:86.111, Top3:100.000, Test_precision:0.7709,Test_recall:0.8649,Test_f1:0.8028,,Test_specificity:0.9334 Test_loss:0.373634
2026-01-29 15:42:17.384 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:42:27.335 | INFO     | __main__:main_worker:355 - ---> start train epoch31
2026-01-29 15:42:36.157 | INFO     | __main__:main_worker:429 - [31/100], remain:0d.00h.33m, It:[10/54], Max-Mem:11245M, Data-Time:0.834, LR:0.0001, Train_Loss:-0.3528, total_loss:tensor([-0.3528], device='cuda:0'), ce_loss:0.35652732849121094, cluster_loss:0.05579506978392601, sep_loss:0.019895056262612343, soft_orth_loss:0.0051753586158156395, local_consistency_loss:0.0006680648657493293, proto_loss:0.08153355121612549
2026-01-29 15:42:40.406 | INFO     | __main__:main_worker:429 - [31/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11245M, Data-Time:0.021, LR:0.0001, Train_Loss:-0.2648, total_loss:tensor([-0.2648], device='cuda:0'), ce_loss:0.3972306549549103, cluster_loss:0.07396473735570908, sep_loss:0.015438302420079708, soft_orth_loss:0.005170641466975212, local_consistency_loss:0.0007993974722921848, proto_loss:0.09537307918071747
2026-01-29 15:42:45.430 | INFO     | __main__:main_worker:429 - [31/100], remain:0d.00h.29m, It:[30/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:0.1330, total_loss:tensor([0.1330], device='cuda:0'), ce_loss:0.607107400894165, cluster_loss:0.10233650356531143, sep_loss:0.026946038007736206, soft_orth_loss:0.005167555529624224, local_consistency_loss:0.0005112222861498594, proto_loss:0.1349613219499588
2026-01-29 15:42:49.071 | INFO     | __main__:main_worker:429 - [31/100], remain:0d.00h.27m, It:[40/54], Max-Mem:11245M, Data-Time:0.019, LR:0.0001, Train_Loss:0.2566, total_loss:tensor([0.2566], device='cuda:0'), ce_loss:0.675037682056427, cluster_loss:0.11563532799482346, sep_loss:0.023601695895195007, soft_orth_loss:0.005160283297300339, local_consistency_loss:0.0007411930128000677, proto_loss:0.14513850212097168
2026-01-29 15:42:53.439 | INFO     | __main__:main_worker:429 - [31/100], remain:0d.00h.27m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:-0.3714, total_loss:tensor([-0.3714], device='cuda:0'), ce_loss:0.32627975940704346, cluster_loss:0.07306935638189316, sep_loss:0.019149791449308395, soft_orth_loss:0.005154917016625404, local_consistency_loss:0.0007803483167663217, proto_loss:0.09815441071987152
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
2026-01-29 15:43:03.324 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [31/100], Top1:84.615, Top3:100.000, Test_precision:0.7544,Test_recall:0.7388,Test_f1:0.7461,,Test_specificity:0.8998 Test_loss:0.403800
2026-01-29 15:43:03.325 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
acc1: 84.6154, acc3: 100.0000, Precision: 0.7544, Recall: 0.7388, F1-Score: 0.7461, Specificity: 0.8998
2026-01-29 15:43:03.326 | INFO     | __main__:main_worker:355 - ---> start train epoch32
2026-01-29 15:43:11.343 | INFO     | __main__:main_worker:429 - [32/100], remain:0d.00h.24m, It:[10/54], Max-Mem:11245M, Data-Time:0.133, LR:0.0001, Train_Loss:0.3861, total_loss:tensor([0.3861], device='cuda:0'), ce_loss:0.7520549297332764, cluster_loss:0.11211570352315903, sep_loss:0.033026065677404404, soft_orth_loss:0.005145861767232418, local_consistency_loss:0.0007793060503900051, proto_loss:0.15106692910194397
2026-01-29 15:43:15.799 | INFO     | __main__:main_worker:429 - [32/100], remain:0d.00h.25m, It:[20/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:0.1246, total_loss:tensor([0.1246], device='cuda:0'), ce_loss:0.6086854934692383, cluster_loss:0.09357354044914246, sep_loss:0.030929623171687126, soft_orth_loss:0.005140180699527264, local_consistency_loss:0.0005074871587567031, proto_loss:0.13015083968639374
2026-01-29 15:43:20.532 | INFO     | __main__:main_worker:429 - [32/100], remain:0d.00h.26m, It:[30/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:0.2866, total_loss:tensor([0.2866], device='cuda:0'), ce_loss:0.6844227910041809, cluster_loss:0.11248500645160675, sep_loss:0.03531159088015556, soft_orth_loss:0.005133137572556734, local_consistency_loss:0.001383852562867105, proto_loss:0.1543135941028595
2026-01-29 15:43:25.039 | INFO     | __main__:main_worker:429 - [32/100], remain:0d.00h.26m, It:[40/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:0.1272, total_loss:tensor([0.1272], device='cuda:0'), ce_loss:0.6116560697555542, cluster_loss:0.0934513732790947, sep_loss:0.030098769813776016, soft_orth_loss:0.00512767443433404, local_consistency_loss:0.0008632616954855621, proto_loss:0.1295410841703415
2026-01-29 15:43:29.519 | INFO     | __main__:main_worker:429 - [32/100], remain:0d.00h.26m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:0.4211, total_loss:tensor([0.4211], device='cuda:0'), ce_loss:0.7542511224746704, cluster_loss:0.1265588104724884, sep_loss:0.03635779395699501, soft_orth_loss:0.0051223719492554665, local_consistency_loss:0.0007726959884166718, proto_loss:0.16881167888641357
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-29 15:43:30.959 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 32 (LR=0.000080, momentum=0.85)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.8566
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.7921
2026-01-29 15:43:55.912 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating:   0%|          | 0/15 [00:00<?, ?it/s]  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.7811
Local prototype push completed!
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 85.0427, acc3: 100.0000, Precision: 0.7522, Recall: 0.7930, F1-Score: 0.7689, Specificity: 0.9160
2026-01-29 15:44:04.050 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [32/100], Top1:85.043, Top3:100.000, Test_precision:0.7522,Test_recall:0.7930,Test_f1:0.7689,,Test_specificity:0.9160 Test_loss:0.382482
2026-01-29 15:44:04.051 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:44:04.052 | INFO     | __main__:main_worker:355 - ---> start train epoch33
2026-01-29 15:44:13.988 | INFO     | __main__:main_worker:429 - [33/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11245M, Data-Time:1.573, LR:0.0001, Train_Loss:-0.0433, total_loss:tensor([-0.0433], device='cuda:0'), ce_loss:0.49414733052253723, cluster_loss:0.10717928409576416, sep_loss:0.02326245792210102, soft_orth_loss:0.005474182311445475, local_consistency_loss:0.0004725618346128613, proto_loss:0.13638848066329956
2026-01-29 15:44:18.442 | INFO     | __main__:main_worker:429 - [33/100], remain:0d.00h.28m, It:[20/54], Max-Mem:11245M, Data-Time:0.980, LR:0.0001, Train_Loss:0.0735, total_loss:tensor([0.0735], device='cuda:0'), ce_loss:0.567240297794342, cluster_loss:0.0997629389166832, sep_loss:0.031980182975530624, soft_orth_loss:0.0054679689928889275, local_consistency_loss:0.0012221253709867597, proto_loss:0.13843320310115814
2026-01-29 15:44:22.012 | INFO     | __main__:main_worker:429 - [33/100], remain:0d.00h.26m, It:[30/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:1.0563, total_loss:tensor([1.0563], device='cuda:0'), ce_loss:1.1177741289138794, cluster_loss:0.16690020263195038, sep_loss:0.034271858632564545, soft_orth_loss:0.005462699569761753, local_consistency_loss:0.0007033474976196885, proto_loss:0.2073381096124649
2026-01-29 15:44:25.643 | INFO     | __main__:main_worker:429 - [33/100], remain:0d.00h.24m, It:[40/54], Max-Mem:11245M, Data-Time:0.054, LR:0.0001, Train_Loss:-0.0314, total_loss:tensor([-0.0314], device='cuda:0'), ce_loss:0.5225537419319153, cluster_loss:0.08286555856466293, sep_loss:0.03115818463265896, soft_orth_loss:0.005458227824419737, local_consistency_loss:0.0005297539755702019, proto_loss:0.12001172453165054
2026-01-29 15:44:31.128 | INFO     | __main__:main_worker:429 - [33/100], remain:0d.00h.26m, It:[50/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0001, Train_Loss:0.2091, total_loss:tensor([0.2091], device='cuda:0'), ce_loss:0.6374069452285767, cluster_loss:0.11476397514343262, sep_loss:0.03231966495513916, soft_orth_loss:0.005457793362438679, local_consistency_loss:0.000847729854285717, proto_loss:0.15338915586471558
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
acc1: 83.5470, acc3: 100.0000, Precision: 0.7390, Recall: 0.8500, F1-Score: 0.7668, Specificity: 0.9294
2026-01-29 15:44:40.946 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [33/100], Top1:83.547, Top3:100.000, Test_precision:0.7390,Test_recall:0.8500,Test_f1:0.7668,,Test_specificity:0.9294 Test_loss:0.475933
2026-01-29 15:44:40.947 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:44:40.948 | INFO     | __main__:main_worker:355 - ---> start train epoch34
2026-01-29 15:44:50.049 | INFO     | __main__:main_worker:429 - [34/100], remain:0d.00h.26m, It:[10/54], Max-Mem:11245M, Data-Time:0.739, LR:0.0001, Train_Loss:-0.0340, total_loss:tensor([-0.0340], device='cuda:0'), ce_loss:0.5265352129936218, cluster_loss:0.08244942873716354, sep_loss:0.027087435126304626, soft_orth_loss:0.005457674153149128, local_consistency_loss:0.0008236546418629587, proto_loss:0.11581819504499435
2026-01-29 15:44:54.000 | INFO     | __main__:main_worker:429 - [34/100], remain:0d.00h.24m, It:[20/54], Max-Mem:11245M, Data-Time:0.517, LR:0.0001, Train_Loss:-0.1438, total_loss:tensor([-0.1438], device='cuda:0'), ce_loss:0.4655992090702057, cluster_loss:0.0688064843416214, sep_loss:0.032420564442873, soft_orth_loss:0.005455601029098034, local_consistency_loss:0.0012971545802429318, proto_loss:0.10797979682683945
2026-01-29 15:44:57.994 | INFO     | __main__:main_worker:429 - [34/100], remain:0d.00h.24m, It:[30/54], Max-Mem:11245M, Data-Time:0.518, LR:0.0001, Train_Loss:-0.0427, total_loss:tensor([-0.0427], device='cuda:0'), ce_loss:0.5025715231895447, cluster_loss:0.10219424217939377, sep_loss:0.02345030941069126, soft_orth_loss:0.005454081576317549, local_consistency_loss:0.0004358431906439364, proto_loss:0.13153447210788727
2026-01-29 15:45:02.750 | INFO     | __main__:main_worker:429 - [34/100], remain:0d.00h.24m, It:[40/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:2.8506, total_loss:tensor([2.8506], device='cuda:0'), ce_loss:1.972653865814209, cluster_loss:0.4104642868041992, sep_loss:0.03851012513041496, soft_orth_loss:0.005452536046504974, local_consistency_loss:0.0007234033546410501, proto_loss:0.4551503360271454
2026-01-29 15:45:07.751 | INFO     | __main__:main_worker:429 - [34/100], remain:0d.00h.25m, It:[50/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0001, Train_Loss:-0.1161, total_loss:tensor([-0.1161], device='cuda:0'), ce_loss:0.4982888102531433, cluster_loss:0.06942598521709442, sep_loss:0.02132239192724228, soft_orth_loss:0.005451628938317299, local_consistency_loss:0.0002601667365524918, proto_loss:0.09646017104387283
Evaluating: 100%|| 15/15 [00:08<00:00,  1.87it/s]
2026-01-29 15:45:17.100 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [34/100], Top1:85.897, Top3:100.000, Test_precision:0.7850,Test_recall:0.7538,Test_f1:0.7660,,Test_specificity:0.9084 Test_loss:0.400226
2026-01-29 15:45:17.101 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:45:17.101 | INFO     | __main__:main_worker:355 - ---> start train epoch35
acc1: 85.8974, acc3: 100.0000, Precision: 0.7850, Recall: 0.7538, F1-Score: 0.7660, Specificity: 0.9084
2026-01-29 15:45:24.920 | INFO     | __main__:main_worker:429 - [35/100], remain:0d.00h.24m, It:[10/54], Max-Mem:11245M, Data-Time:0.231, LR:0.0001, Train_Loss:-0.1622, total_loss:tensor([-0.1622], device='cuda:0'), ce_loss:0.4626501500606537, cluster_loss:0.07147202640771866, sep_loss:0.02413959987461567, soft_orth_loss:0.005446919240057468, local_consistency_loss:0.0007564369007013738, proto_loss:0.10181497782468796
2026-01-29 15:45:30.253 | INFO     | __main__:main_worker:429 - [35/100], remain:0d.00h.27m, It:[20/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:-0.1611, total_loss:tensor([-0.1611], device='cuda:0'), ce_loss:0.4572000801563263, cluster_loss:0.06423534452915192, sep_loss:0.02589740790426731, soft_orth_loss:0.005441919434815645, local_consistency_loss:0.011645306833088398, proto_loss:0.10721997916698456
2026-01-29 15:45:34.275 | INFO     | __main__:main_worker:429 - [35/100], remain:0d.00h.25m, It:[30/54], Max-Mem:11245M, Data-Time:0.399, LR:0.0001, Train_Loss:-0.3567, total_loss:tensor([-0.3567], device='cuda:0'), ce_loss:0.3513777554035187, cluster_loss:0.0657840222120285, sep_loss:0.01932266727089882, soft_orth_loss:0.005441003944724798, local_consistency_loss:0.00047354731941595674, proto_loss:0.09102123230695724
2026-01-29 15:45:38.396 | INFO     | __main__:main_worker:429 - [35/100], remain:0d.00h.25m, It:[40/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0001, Train_Loss:-0.1990, total_loss:tensor([-0.1990], device='cuda:0'), ce_loss:0.5247576236724854, cluster_loss:0.00021410558838397264, sep_loss:0.025318438187241554, soft_orth_loss:0.005437623709440231, local_consistency_loss:0.0007780379382893443, proto_loss:0.0317482054233551
2026-01-29 15:45:43.392 | INFO     | __main__:main_worker:429 - [35/100], remain:0d.00h.25m, It:[50/54], Max-Mem:11245M, Data-Time:0.852, LR:0.0001, Train_Loss:-0.2856, total_loss:tensor([-0.2856], device='cuda:0'), ce_loss:0.37337860465049744, cluster_loss:0.08610614389181137, sep_loss:0.018967097625136375, soft_orth_loss:0.005434626713395119, local_consistency_loss:0.0007052854052744806, proto_loss:0.11121315509080887
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 87.3932, acc3: 100.0000, Precision: 0.7795, Recall: 0.7991, F1-Score: 0.7866, Specificity: 0.9335
2026-01-29 15:45:52.899 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [35/100], Top1:87.393, Top3:100.000, Test_precision:0.7795,Test_recall:0.7991,Test_f1:0.7866,,Test_specificity:0.9335 Test_loss:0.340556
2026-01-29 15:45:52.900 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:46:02.915 | INFO     | __main__:main_worker:355 - ---> start train epoch36
2026-01-29 15:46:13.269 | INFO     | __main__:main_worker:429 - [36/100], remain:0d.00h.31m, It:[10/54], Max-Mem:11245M, Data-Time:1.721, LR:0.0001, Train_Loss:-0.1205, total_loss:tensor([-0.1205], device='cuda:0'), ce_loss:0.45602303743362427, cluster_loss:0.10519859939813614, sep_loss:0.020053565502166748, soft_orth_loss:0.00543195428326726, local_consistency_loss:0.0002491725026629865, proto_loss:0.13093328475952148
2026-01-29 15:46:17.389 | INFO     | __main__:main_worker:429 - [36/100], remain:0d.00h.27m, It:[20/54], Max-Mem:11245M, Data-Time:0.653, LR:0.0001, Train_Loss:-0.0545, total_loss:tensor([-0.0545], device='cuda:0'), ce_loss:0.5097012519836426, cluster_loss:0.08697573095560074, sep_loss:0.028628060594201088, soft_orth_loss:0.005427455063909292, local_consistency_loss:0.000804204901214689, proto_loss:0.12183545529842377
2026-01-29 15:46:21.530 | INFO     | __main__:main_worker:429 - [36/100], remain:0d.00h.25m, It:[30/54], Max-Mem:11245M, Data-Time:0.662, LR:0.0001, Train_Loss:-0.2127, total_loss:tensor([-0.2127], device='cuda:0'), ce_loss:0.42433542013168335, cluster_loss:0.08057611435651779, sep_loss:0.021715197712183, soft_orth_loss:0.005424031987786293, local_consistency_loss:0.001095055602490902, proto_loss:0.10881040245294571
2026-01-29 15:46:25.960 | INFO     | __main__:main_worker:429 - [36/100], remain:0d.00h.25m, It:[40/54], Max-Mem:11245M, Data-Time:0.894, LR:0.0001, Train_Loss:0.0252, total_loss:tensor([0.0252], device='cuda:0'), ce_loss:0.5803804397583008, cluster_loss:0.07128404825925827, sep_loss:0.028197411447763443, soft_orth_loss:0.005419320892542601, local_consistency_loss:0.0011626576306298375, proto_loss:0.10606344044208527
2026-01-29 15:46:29.618 | INFO     | __main__:main_worker:429 - [36/100], remain:0d.00h.24m, It:[50/54], Max-Mem:11245M, Data-Time:0.261, LR:0.0001, Train_Loss:0.3639, total_loss:tensor([0.3639], device='cuda:0'), ce_loss:0.7078356146812439, cluster_loss:0.1468670815229416, sep_loss:0.027473777532577515, soft_orth_loss:0.0054162596352398396, local_consistency_loss:0.00048309197882190347, proto_loss:0.1802402138710022
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 88.0342, acc3: 100.0000, Precision: 0.8240, Recall: 0.7789, F1-Score: 0.7914, Specificity: 0.9279
2026-01-29 15:46:39.370 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [36/100], Top1:88.034, Top3:100.000, Test_precision:0.8240,Test_recall:0.7789,Test_f1:0.7914,,Test_specificity:0.9279 Test_loss:0.334115
2026-01-29 15:46:39.371 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:46:39.372 | INFO     | __main__:main_worker:355 - ---> start train epoch37
2026-01-29 15:46:47.721 | INFO     | __main__:main_worker:429 - [37/100], remain:0d.00h.23m, It:[10/54], Max-Mem:11245M, Data-Time:0.031, LR:0.0001, Train_Loss:0.4177, total_loss:tensor([0.4177], device='cuda:0'), ce_loss:0.7645792365074158, cluster_loss:0.12776903808116913, sep_loss:0.02773318998515606, soft_orth_loss:0.005404653027653694, local_consistency_loss:0.0011271648108959198, proto_loss:0.1620340496301651
2026-01-29 15:46:51.727 | INFO     | __main__:main_worker:429 - [37/100], remain:0d.00h.22m, It:[20/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:0.3939, total_loss:tensor([0.3939], device='cuda:0'), ce_loss:0.7432118058204651, cluster_loss:0.13889555633068085, sep_loss:0.022425029426813126, soft_orth_loss:0.0054006800055503845, local_consistency_loss:0.0005202805623412132, proto_loss:0.16724152863025665
2026-01-29 15:46:56.893 | INFO     | __main__:main_worker:429 - [37/100], remain:0d.00h.24m, It:[30/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:0.0857, total_loss:tensor([0.0857], device='cuda:0'), ce_loss:0.6250728368759155, cluster_loss:0.06839784979820251, sep_loss:0.027896065264940262, soft_orth_loss:0.005400077439844608, local_consistency_loss:0.00041505644912831485, proto_loss:0.10210904479026794
2026-01-29 15:47:01.166 | INFO     | __main__:main_worker:429 - [37/100], remain:0d.00h.24m, It:[40/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:-0.2183, total_loss:tensor([-0.2183], device='cuda:0'), ce_loss:0.4173312485218048, cluster_loss:0.08175184577703476, sep_loss:0.025597555562853813, soft_orth_loss:0.0053965928964316845, local_consistency_loss:0.0005987161421217024, proto_loss:0.113344706594944
2026-01-29 15:47:05.490 | INFO     | __main__:main_worker:429 - [37/100], remain:0d.00h.24m, It:[50/54], Max-Mem:11245M, Data-Time:0.008, LR:0.0001, Train_Loss:-0.4764, total_loss:tensor([-0.4764], device='cuda:0'), ce_loss:0.2747313976287842, cluster_loss:0.07572370767593384, sep_loss:0.013182239606976509, soft_orth_loss:0.005393563769757748, local_consistency_loss:0.0007816061261110008, proto_loss:0.09508111327886581
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
acc1: 87.6068, acc3: 100.0000, Precision: 0.8169, Recall: 0.7664, F1-Score: 0.7805, Specificity: 0.9250
2026-01-29 15:47:15.152 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [37/100], Top1:87.607, Top3:100.000, Test_precision:0.8169,Test_recall:0.7664,Test_f1:0.7805,,Test_specificity:0.9250 Test_loss:0.357611
2026-01-29 15:47:15.153 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:47:15.153 | INFO     | __main__:main_worker:355 - ---> start train epoch38
2026-01-29 15:47:24.444 | INFO     | __main__:main_worker:429 - [38/100], remain:0d.00h.25m, It:[10/54], Max-Mem:11245M, Data-Time:1.116, LR:0.0001, Train_Loss:0.0866, total_loss:tensor([0.0866], device='cuda:0'), ce_loss:0.587607741355896, cluster_loss:0.09920906275510788, sep_loss:0.029157165437936783, soft_orth_loss:0.0053878407925367355, local_consistency_loss:0.00045581208541989326, proto_loss:0.13420988619327545
2026-01-29 15:47:29.238 | INFO     | __main__:main_worker:429 - [38/100], remain:0d.00h.25m, It:[20/54], Max-Mem:11245M, Data-Time:1.247, LR:0.0001, Train_Loss:-0.1493, total_loss:tensor([-0.1493], device='cuda:0'), ce_loss:0.4645324647426605, cluster_loss:0.08348935842514038, sep_loss:0.021209679543972015, soft_orth_loss:0.005385334603488445, local_consistency_loss:0.0014689341187477112, proto_loss:0.11155330389738083
2026-01-29 15:47:33.684 | INFO     | __main__:main_worker:429 - [38/100], remain:0d.00h.25m, It:[30/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0001, Train_Loss:-0.2577, total_loss:tensor([-0.2577], device='cuda:0'), ce_loss:0.43745100498199463, cluster_loss:0.05158357694745064, sep_loss:0.018656937405467033, soft_orth_loss:0.005380816292017698, local_consistency_loss:0.001389481476508081, proto_loss:0.07701081037521362
2026-01-29 15:47:37.843 | INFO     | __main__:main_worker:429 - [38/100], remain:0d.00h.24m, It:[40/54], Max-Mem:11245M, Data-Time:0.015, LR:0.0001, Train_Loss:-0.3801, total_loss:tensor([-0.3801], device='cuda:0'), ce_loss:0.330588698387146, cluster_loss:0.07783317565917969, sep_loss:0.01741875149309635, soft_orth_loss:0.0053781261667609215, local_consistency_loss:0.00030040612909942865, proto_loss:0.10093045979738235
2026-01-29 15:47:42.605 | INFO     | __main__:main_worker:429 - [38/100], remain:0d.00h.24m, It:[50/54], Max-Mem:11245M, Data-Time:0.027, LR:0.0001, Train_Loss:0.1962, total_loss:tensor([0.1962], device='cuda:0'), ce_loss:0.6297411322593689, cluster_loss:0.12352140992879868, sep_loss:0.027384787797927856, soft_orth_loss:0.005376065149903297, local_consistency_loss:0.0017560970736667514, proto_loss:0.15803837776184082
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 84.8291, acc3: 100.0000, Precision: 0.7570, Recall: 0.7525, F1-Score: 0.7527, Specificity: 0.9002
2026-01-29 15:47:52.081 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [38/100], Top1:84.829, Top3:100.000, Test_precision:0.7570,Test_recall:0.7525,Test_f1:0.7527,,Test_specificity:0.9002 Test_loss:0.411977
2026-01-29 15:47:52.084 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:47:52.085 | INFO     | __main__:main_worker:355 - ---> start train epoch39
2026-01-29 15:48:01.830 | INFO     | __main__:main_worker:429 - [39/100], remain:0d.00h.26m, It:[10/54], Max-Mem:11245M, Data-Time:1.218, LR:0.0001, Train_Loss:-0.2806, total_loss:tensor([-0.2806], device='cuda:0'), ce_loss:0.39087793231010437, cluster_loss:0.07922358810901642, sep_loss:0.01922803558409214, soft_orth_loss:0.005375445820391178, local_consistency_loss:0.0005897352821193635, proto_loss:0.10441680252552032
2026-01-29 15:48:05.954 | INFO     | __main__:main_worker:429 - [39/100], remain:0d.00h.24m, It:[20/54], Max-Mem:11245M, Data-Time:0.568, LR:0.0001, Train_Loss:-0.1587, total_loss:tensor([-0.1587], device='cuda:0'), ce_loss:0.4858088493347168, cluster_loss:0.06333974748849869, sep_loss:0.02099924348294735, soft_orth_loss:0.0053742993623018265, local_consistency_loss:0.0007038101903162897, proto_loss:0.09041710197925568
2026-01-29 15:48:10.227 | INFO     | __main__:main_worker:429 - [39/100], remain:0d.00h.23m, It:[30/54], Max-Mem:11245M, Data-Time:0.813, LR:0.0001, Train_Loss:-0.5007, total_loss:tensor([-0.5007], device='cuda:0'), ce_loss:0.2711368203163147, cluster_loss:0.06540212035179138, sep_loss:0.01568884216248989, soft_orth_loss:0.005372511222958565, local_consistency_loss:0.001262453617528081, proto_loss:0.087725929915905
2026-01-29 15:48:14.605 | INFO     | __main__:main_worker:429 - [39/100], remain:0d.00h.23m, It:[40/54], Max-Mem:11245M, Data-Time:0.898, LR:0.0001, Train_Loss:-0.2152, total_loss:tensor([-0.2152], device='cuda:0'), ce_loss:0.4132848381996155, cluster_loss:0.09139584749937057, sep_loss:0.02354673109948635, soft_orth_loss:0.005370785016566515, local_consistency_loss:0.0006223671371117234, proto_loss:0.12093573808670044
2026-01-29 15:48:18.707 | INFO     | __main__:main_worker:429 - [39/100], remain:0d.00h.23m, It:[50/54], Max-Mem:11245M, Data-Time:0.649, LR:0.0001, Train_Loss:-0.3255, total_loss:tensor([-0.3255], device='cuda:0'), ce_loss:0.345915824174881, cluster_loss:0.09037216752767563, sep_loss:0.02227122150361538, soft_orth_loss:0.005367979872971773, local_consistency_loss:0.0007850898546166718, proto_loss:0.1187964603304863
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
2026-01-29 15:48:28.669 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [39/100], Top1:85.897, Top3:100.000, Test_precision:0.7674,Test_recall:0.7552,Test_f1:0.7596,,Test_specificity:0.9138 Test_loss:0.344893
acc1: 85.8974, acc3: 100.0000, Precision: 0.7674, Recall: 0.7552, F1-Score: 0.7596, Specificity: 0.9138
2026-01-29 15:48:28.671 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:48:28.671 | INFO     | __main__:main_worker:355 - ---> start train epoch40
2026-01-29 15:48:38.223 | INFO     | __main__:main_worker:429 - [40/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11245M, Data-Time:2.053, LR:0.0001, Train_Loss:-0.3554, total_loss:tensor([-0.3554], device='cuda:0'), ce_loss:0.3456822335720062, cluster_loss:0.0790582075715065, sep_loss:0.018734563142061234, soft_orth_loss:0.005367387551814318, local_consistency_loss:0.0004718998388852924, proto_loss:0.10363206267356873
2026-01-29 15:48:42.662 | INFO     | __main__:main_worker:429 - [40/100], remain:0d.00h.26m, It:[20/54], Max-Mem:11245M, Data-Time:1.001, LR:0.0001, Train_Loss:-0.1278, total_loss:tensor([-0.1278], device='cuda:0'), ce_loss:0.4754386246204376, cluster_loss:0.08606156706809998, sep_loss:0.02473452128469944, soft_orth_loss:0.005359606817364693, local_consistency_loss:0.00026305028586648405, proto_loss:0.1164187416434288
2026-01-29 15:48:47.427 | INFO     | __main__:main_worker:429 - [40/100], remain:0d.00h.26m, It:[30/54], Max-Mem:11245M, Data-Time:1.321, LR:0.0001, Train_Loss:-0.1200, total_loss:tensor([-0.1200], device='cuda:0'), ce_loss:0.46999648213386536, cluster_loss:0.09581238031387329, sep_loss:0.02359992265701294, soft_orth_loss:0.005353249609470367, local_consistency_loss:0.0004673045186791569, proto_loss:0.12523286044597626
2026-01-29 15:48:51.336 | INFO     | __main__:main_worker:429 - [40/100], remain:0d.00h.24m, It:[40/54], Max-Mem:11245M, Data-Time:0.384, LR:0.0001, Train_Loss:0.0083, total_loss:tensor([0.0083], device='cuda:0'), ce_loss:0.6582802534103394, cluster_loss:0.00021766508871223778, sep_loss:0.031576745212078094, soft_orth_loss:0.005348371807485819, local_consistency_loss:0.0005519192782230675, proto_loss:0.03769470378756523
2026-01-29 15:48:55.056 | INFO     | __main__:main_worker:429 - [40/100], remain:0d.00h.23m, It:[50/54], Max-Mem:11245M, Data-Time:0.266, LR:0.0001, Train_Loss:-0.0002, total_loss:tensor([-0.0002], device='cuda:0'), ce_loss:0.5316734910011292, cluster_loss:0.11006458103656769, sep_loss:0.02143627218902111, soft_orth_loss:0.005347937345504761, local_consistency_loss:0.0007701429422013462, proto_loss:0.13761892914772034
2026-01-29 15:48:57.178 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 40 (LR=0.000069, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.8324
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.7247
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.7012
Local prototype push completed!
2026-01-29 15:49:21.413 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
acc1: 66.0256, acc3: 100.0000, Precision: 0.3780, Recall: 0.6003, F1-Score: 0.7914, Specificity: 0.7483
2026-01-29 15:49:29.637 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [40/100], Top1:66.026, Top3:100.000, Test_precision:0.3780,Test_recall:0.6003,Test_f1:0.7914,,Test_specificity:0.7483 Test_loss:3.560711
2026-01-29 15:49:29.639 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:49:39.681 | INFO     | __main__:main_worker:355 - ---> start train epoch41
2026-01-29 15:49:48.975 | INFO     | __main__:main_worker:429 - [41/100], remain:0d.00h.24m, It:[10/54], Max-Mem:11245M, Data-Time:0.377, LR:0.0001, Train_Loss:0.0882, total_loss:tensor([0.0882], device='cuda:0'), ce_loss:0.586579442024231, cluster_loss:0.09791593998670578, sep_loss:0.03339336812496185, soft_orth_loss:0.00626287842169404, local_consistency_loss:0.0013689994812011719, proto_loss:0.1389411836862564
2026-01-29 15:49:52.964 | INFO     | __main__:main_worker:429 - [41/100], remain:0d.00h.22m, It:[20/54], Max-Mem:11245M, Data-Time:0.526, LR:0.0001, Train_Loss:0.6131, total_loss:tensor([0.6131], device='cuda:0'), ce_loss:0.8843466639518738, cluster_loss:0.12389659881591797, sep_loss:0.03857437148690224, soft_orth_loss:0.006225894670933485, local_consistency_loss:0.0003740348620340228, proto_loss:0.16907089948654175
2026-01-29 15:49:56.719 | INFO     | __main__:main_worker:429 - [41/100], remain:0d.00h.21m, It:[30/54], Max-Mem:11245M, Data-Time:0.287, LR:0.0001, Train_Loss:-0.2103, total_loss:tensor([-0.2103], device='cuda:0'), ce_loss:0.40223225951194763, cluster_loss:0.10358526557683945, sep_loss:0.023457152768969536, soft_orth_loss:0.0062178135849535465, local_consistency_loss:0.0013278434053063393, proto_loss:0.1345880627632141
2026-01-29 15:50:01.303 | INFO     | __main__:main_worker:429 - [41/100], remain:0d.00h.22m, It:[40/54], Max-Mem:11245M, Data-Time:0.748, LR:0.0001, Train_Loss:0.0431, total_loss:tensor([0.0431], device='cuda:0'), ce_loss:0.5859540104866028, cluster_loss:0.08467340469360352, sep_loss:0.023011138662695885, soft_orth_loss:0.006216882728040218, local_consistency_loss:0.002427951665595174, proto_loss:0.1163293793797493
2026-01-29 15:50:05.914 | INFO     | __main__:main_worker:429 - [41/100], remain:0d.00h.22m, It:[50/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:0.2207, total_loss:tensor([0.2207], device='cuda:0'), ce_loss:0.648749053478241, cluster_loss:0.12378119677305222, sep_loss:0.02621602453291416, soft_orth_loss:0.006218872033059597, local_consistency_loss:0.0016163120744749904, proto_loss:0.15783239901065826
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
acc1: 86.7521, acc3: 100.0000, Precision: 0.7940, Recall: 0.7861, F1-Score: 0.7866, Specificity: 0.9266
2026-01-29 15:50:15.420 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [41/100], Top1:86.752, Top3:100.000, Test_precision:0.7940,Test_recall:0.7861,Test_f1:0.7866,,Test_specificity:0.9266 Test_loss:0.345855
2026-01-29 15:50:15.421 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:50:15.421 | INFO     | __main__:main_worker:355 - ---> start train epoch42
2026-01-29 15:50:23.684 | INFO     | __main__:main_worker:429 - [42/100], remain:0d.00h.24m, It:[10/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0001, Train_Loss:1.0111, total_loss:tensor([1.0111], device='cuda:0'), ce_loss:1.0712512731552124, cluster_loss:0.1781034916639328, sep_loss:0.03893133997917175, soft_orth_loss:0.006208986975252628, local_consistency_loss:0.0008867185679264367, proto_loss:0.2241305410861969
2026-01-29 15:50:29.370 | INFO     | __main__:main_worker:429 - [42/100], remain:0d.00h.26m, It:[20/54], Max-Mem:11245M, Data-Time:1.479, LR:0.0001, Train_Loss:0.3584, total_loss:tensor([0.3584], device='cuda:0'), ce_loss:0.7188589572906494, cluster_loss:0.1346835494041443, sep_loss:0.031193071976304054, soft_orth_loss:0.006209415849298239, local_consistency_loss:0.0005124841118231416, proto_loss:0.17259852588176727
2026-01-29 15:50:33.355 | INFO     | __main__:main_worker:429 - [42/100], remain:0d.00h.24m, It:[30/54], Max-Mem:11245M, Data-Time:0.518, LR:0.0001, Train_Loss:0.4088, total_loss:tensor([0.4088], device='cuda:0'), ce_loss:0.7709498405456543, cluster_loss:0.1171959787607193, sep_loss:0.029704628512263298, soft_orth_loss:0.006207779981195927, local_consistency_loss:0.0031924971845000982, proto_loss:0.156300887465477
2026-01-29 15:50:38.523 | INFO     | __main__:main_worker:429 - [42/100], remain:0d.00h.25m, It:[40/54], Max-Mem:11245M, Data-Time:1.689, LR:0.0001, Train_Loss:-0.0038, total_loss:tensor([-0.0038], device='cuda:0'), ce_loss:0.5588459372520447, cluster_loss:0.07961183041334152, sep_loss:0.025117743760347366, soft_orth_loss:0.006204620469361544, local_consistency_loss:0.004210231825709343, proto_loss:0.11514443159103394
2026-01-29 15:50:42.354 | INFO     | __main__:main_worker:429 - [42/100], remain:0d.00h.23m, It:[50/54], Max-Mem:11245M, Data-Time:0.442, LR:0.0001, Train_Loss:0.1265, total_loss:tensor([0.1265], device='cuda:0'), ce_loss:0.6206779479980469, cluster_loss:0.10038460791110992, sep_loss:0.025689417496323586, soft_orth_loss:0.006203266326338053, local_consistency_loss:0.0002814580511767417, proto_loss:0.13255874812602997
Evaluating: 100%|| 15/15 [00:08<00:00,  1.87it/s]
2026-01-29 15:50:51.693 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [42/100], Top1:85.470, Top3:100.000, Test_precision:0.7652,Test_recall:0.8249,Test_f1:0.7884,,Test_specificity:0.9208 Test_loss:0.374031
2026-01-29 15:50:51.694 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:50:51.695 | INFO     | __main__:main_worker:355 - ---> start train epoch43
acc1: 85.4701, acc3: 100.0000, Precision: 0.7652, Recall: 0.8249, F1-Score: 0.7884, Specificity: 0.9208
2026-01-29 15:51:00.558 | INFO     | __main__:main_worker:429 - [43/100], remain:0d.00h.22m, It:[10/54], Max-Mem:11245M, Data-Time:0.973, LR:0.0001, Train_Loss:0.1513, total_loss:tensor([0.1513], device='cuda:0'), ce_loss:0.6219942569732666, cluster_loss:0.10860331356525421, sep_loss:0.026651298627257347, soft_orth_loss:0.006201392505317926, local_consistency_loss:0.0031618487555533648, proto_loss:0.14461784064769745
2026-01-29 15:51:04.554 | INFO     | __main__:main_worker:429 - [43/100], remain:0d.00h.21m, It:[20/54], Max-Mem:11245M, Data-Time:0.534, LR:0.0001, Train_Loss:-0.1954, total_loss:tensor([-0.1954], device='cuda:0'), ce_loss:0.4672616720199585, cluster_loss:0.059705741703510284, sep_loss:0.024652451276779175, soft_orth_loss:0.006198338698595762, local_consistency_loss:0.0004190535400994122, proto_loss:0.09097558259963989
2026-01-29 15:51:08.759 | INFO     | __main__:main_worker:429 - [43/100], remain:0d.00h.21m, It:[30/54], Max-Mem:11245M, Data-Time:0.009, LR:0.0001, Train_Loss:0.3708, total_loss:tensor([0.3708], device='cuda:0'), ce_loss:0.7322954535484314, cluster_loss:0.1302749663591385, sep_loss:0.03159981593489647, soft_orth_loss:0.006196498870849609, local_consistency_loss:0.0007455560262314975, proto_loss:0.16881683468818665
2026-01-29 15:51:13.485 | INFO     | __main__:main_worker:429 - [43/100], remain:0d.00h.21m, It:[40/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0001, Train_Loss:-0.1759, total_loss:tensor([-0.1759], device='cuda:0'), ce_loss:0.5518749356269836, cluster_loss:0.00027751928428187966, sep_loss:0.025599053129553795, soft_orth_loss:0.0061945258639752865, local_consistency_loss:0.00014639319851994514, proto_loss:0.032217491418123245
2026-01-29 15:51:18.468 | INFO     | __main__:main_worker:429 - [43/100], remain:0d.00h.22m, It:[50/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:-0.1381, total_loss:tensor([-0.1381], device='cuda:0'), ce_loss:0.4608900249004364, cluster_loss:0.09001366794109344, sep_loss:0.029713887721300125, soft_orth_loss:0.006191394291818142, local_consistency_loss:0.0007262522703967988, proto_loss:0.12664519250392914
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
acc1: 86.7521, acc3: 100.0000, Precision: 0.7694, Recall: 0.7861, F1-Score: 0.7769, Specificity: 0.9253
2026-01-29 15:51:29.157 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [43/100], Top1:86.752, Top3:100.000, Test_precision:0.7694,Test_recall:0.7861,Test_f1:0.7769,,Test_specificity:0.9253 Test_loss:0.372692
2026-01-29 15:51:29.159 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:51:29.160 | INFO     | __main__:main_worker:355 - ---> start train epoch44
2026-01-29 15:51:37.756 | INFO     | __main__:main_worker:429 - [44/100], remain:0d.00h.24m, It:[10/54], Max-Mem:11245M, Data-Time:0.418, LR:0.0001, Train_Loss:0.8171, total_loss:tensor([0.8171], device='cuda:0'), ce_loss:0.9642852544784546, cluster_loss:0.1727789342403412, sep_loss:0.0322459414601326, soft_orth_loss:0.006185675505548716, local_consistency_loss:0.00013791881792712957, proto_loss:0.21134847402572632
2026-01-29 15:51:41.559 | INFO     | __main__:main_worker:429 - [44/100], remain:0d.00h.21m, It:[20/54], Max-Mem:11245M, Data-Time:0.210, LR:0.0001, Train_Loss:1.1887, total_loss:tensor([1.1887], device='cuda:0'), ce_loss:1.1419323682785034, cluster_loss:0.2134711742401123, sep_loss:0.039200831204652786, soft_orth_loss:0.006180999800562859, local_consistency_loss:0.0002997509727720171, proto_loss:0.25915277004241943
2026-01-29 15:51:46.430 | INFO     | __main__:main_worker:429 - [44/100], remain:0d.00h.22m, It:[30/54], Max-Mem:11245M, Data-Time:0.392, LR:0.0001, Train_Loss:-0.1847, total_loss:tensor([-0.1847], device='cuda:0'), ce_loss:0.48091137409210205, cluster_loss:0.05646086484193802, sep_loss:0.023492109030485153, soft_orth_loss:0.006176713388413191, local_consistency_loss:0.000596789235714823, proto_loss:0.08672647178173065
2026-01-29 15:51:51.365 | INFO     | __main__:main_worker:429 - [44/100], remain:0d.00h.23m, It:[40/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:0.3271, total_loss:tensor([0.3271], device='cuda:0'), ce_loss:0.7223482728004456, cluster_loss:0.1167808547616005, sep_loss:0.031190181151032448, soft_orth_loss:0.006171831861138344, local_consistency_loss:0.0009680669172666967, proto_loss:0.1551109403371811
2026-01-29 15:51:57.492 | INFO     | __main__:main_worker:429 - [44/100], remain:0d.00h.24m, It:[50/54], Max-Mem:11245M, Data-Time:0.007, LR:0.0001, Train_Loss:0.0216, total_loss:tensor([0.0216], device='cuda:0'), ce_loss:0.5456047654151917, cluster_loss:0.11390850692987442, sep_loss:0.020736683160066605, soft_orth_loss:0.006170624867081642, local_consistency_loss:0.0005523298168554902, proto_loss:0.14136815071105957
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
2026-01-29 15:52:07.034 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [44/100], Top1:86.538, Top3:100.000, Test_precision:0.7773,Test_recall:0.8221,Test_f1:0.7964,,Test_specificity:0.9301 Test_loss:0.359757
2026-01-29 15:52:07.035 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:52:07.036 | INFO     | __main__:main_worker:355 - ---> start train epoch45
acc1: 86.5385, acc3: 100.0000, Precision: 0.7773, Recall: 0.8221, F1-Score: 0.7964, Specificity: 0.9301
2026-01-29 15:52:15.236 | INFO     | __main__:main_worker:429 - [45/100], remain:0d.00h.18m, It:[10/54], Max-Mem:11245M, Data-Time:0.294, LR:0.0001, Train_Loss:-0.3043, total_loss:tensor([-0.3043], device='cuda:0'), ce_loss:0.407213032245636, cluster_loss:0.058625102043151855, sep_loss:0.020181572064757347, soft_orth_loss:0.006164464633911848, local_consistency_loss:0.0007145925774239004, proto_loss:0.08568572998046875
2026-01-29 15:52:19.775 | INFO     | __main__:main_worker:429 - [45/100], remain:0d.00h.20m, It:[20/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:0.5999, total_loss:tensor([0.5999], device='cuda:0'), ce_loss:0.8791456818580627, cluster_loss:0.1221964880824089, sep_loss:0.034242551773786545, soft_orth_loss:0.006162105593830347, local_consistency_loss:0.006227247416973114, proto_loss:0.16882839798927307
2026-01-29 15:52:23.839 | INFO     | __main__:main_worker:429 - [45/100], remain:0d.00h.20m, It:[30/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0001, Train_Loss:-0.0777, total_loss:tensor([-0.0777], device='cuda:0'), ce_loss:0.5119181275367737, cluster_loss:0.08378668129444122, sep_loss:0.027520745992660522, soft_orth_loss:0.0061616250313818455, local_consistency_loss:0.0004908290575258434, proto_loss:0.1179598793387413
2026-01-29 15:52:29.127 | INFO     | __main__:main_worker:429 - [45/100], remain:0d.00h.21m, It:[40/54], Max-Mem:11245M, Data-Time:0.020, LR:0.0001, Train_Loss:0.1668, total_loss:tensor([0.1668], device='cuda:0'), ce_loss:0.6094977259635925, cluster_loss:0.12947559356689453, sep_loss:0.027078872546553612, soft_orth_loss:0.006162441335618496, local_consistency_loss:0.0023494435008615255, proto_loss:0.16506633162498474
2026-01-29 15:52:32.742 | INFO     | __main__:main_worker:429 - [45/100], remain:0d.00h.20m, It:[50/54], Max-Mem:11245M, Data-Time:0.009, LR:0.0001, Train_Loss:-0.0026, total_loss:tensor([-0.0026], device='cuda:0'), ce_loss:0.5784633159637451, cluster_loss:0.07447300106287003, sep_loss:0.02147209644317627, soft_orth_loss:0.006160217337310314, local_consistency_loss:0.0007466349634341896, proto_loss:0.10285194963216782
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
2026-01-29 15:52:42.486 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [45/100], Top1:85.256, Top3:100.000, Test_precision:0.7568,Test_recall:0.8298,Test_f1:0.7823,,Test_specificity:0.9247 Test_loss:0.389685
acc1: 85.2564, acc3: 100.0000, Precision: 0.7568, Recall: 0.8298, F1-Score: 0.7823, Specificity: 0.9247
2026-01-29 15:52:42.488 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:52:52.727 | INFO     | __main__:main_worker:355 - ---> start train epoch46
2026-01-29 15:53:01.114 | INFO     | __main__:main_worker:429 - [46/100], remain:0d.00h.17m, It:[10/54], Max-Mem:11245M, Data-Time:0.121, LR:0.0001, Train_Loss:0.5294, total_loss:tensor([0.5294], device='cuda:0'), ce_loss:0.8125219941139221, cluster_loss:0.1425514668226242, sep_loss:0.034792542457580566, soft_orth_loss:0.006156592164188623, local_consistency_loss:0.0036930888891220093, proto_loss:0.18719369173049927
2026-01-29 15:53:05.178 | INFO     | __main__:main_worker:429 - [46/100], remain:0d.00h.18m, It:[20/54], Max-Mem:11245M, Data-Time:0.009, LR:0.0001, Train_Loss:0.4712, total_loss:tensor([0.4712], device='cuda:0'), ce_loss:0.7930641174316406, cluster_loss:0.1348867416381836, sep_loss:0.031749580055475235, soft_orth_loss:0.006152051966637373, local_consistency_loss:0.00033383246045559645, proto_loss:0.17312219738960266
2026-01-29 15:53:09.888 | INFO     | __main__:main_worker:429 - [46/100], remain:0d.00h.19m, It:[30/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0001, Train_Loss:0.2147, total_loss:tensor([0.2147], device='cuda:0'), ce_loss:0.635165810585022, cluster_loss:0.1299341917037964, sep_loss:0.03323027119040489, soft_orth_loss:0.006149011664092541, local_consistency_loss:0.00030266292742453516, proto_loss:0.16961613297462463
2026-01-29 15:53:15.259 | INFO     | __main__:main_worker:429 - [46/100], remain:0d.00h.21m, It:[40/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0001, Train_Loss:0.4194, total_loss:tensor([0.4194], device='cuda:0'), ce_loss:0.764264702796936, cluster_loss:0.12916678190231323, sep_loss:0.03412801772356033, soft_orth_loss:0.0061465161852538586, local_consistency_loss:0.0006289046141318977, proto_loss:0.17007021605968475
2026-01-29 15:53:21.541 | INFO     | __main__:main_worker:429 - [46/100], remain:0d.00h.22m, It:[50/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0001, Train_Loss:-0.3056, total_loss:tensor([-0.3056], device='cuda:0'), ce_loss:0.39637285470962524, cluster_loss:0.07223614305257797, sep_loss:0.01714547537267208, soft_orth_loss:0.0061453781090676785, local_consistency_loss:0.00040801908471621573, proto_loss:0.09593501687049866
Evaluating: 100%|| 15/15 [00:07<00:00,  1.88it/s]
acc1: 84.1880, acc3: 100.0000, Precision: 0.7414, Recall: 0.8338, F1-Score: 0.7706, Specificity: 0.9276
2026-01-29 15:53:30.860 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [46/100], Top1:84.188, Top3:100.000, Test_precision:0.7414,Test_recall:0.8338,Test_f1:0.7706,,Test_specificity:0.9276 Test_loss:0.444608
2026-01-29 15:53:30.861 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:53:30.861 | INFO     | __main__:main_worker:355 - ---> start train epoch47
2026-01-29 15:53:39.830 | INFO     | __main__:main_worker:429 - [47/100], remain:0d.00h.20m, It:[10/54], Max-Mem:11245M, Data-Time:0.778, LR:0.0001, Train_Loss:-0.0238, total_loss:tensor([-0.0238], device='cuda:0'), ce_loss:0.5228462219238281, cluster_loss:0.10550544410943985, sep_loss:0.026447823271155357, soft_orth_loss:0.0061420113779604435, local_consistency_loss:0.00046329223550856113, proto_loss:0.13855856657028198
2026-01-29 15:53:44.140 | INFO     | __main__:main_worker:429 - [47/100], remain:0d.00h.20m, It:[20/54], Max-Mem:11245M, Data-Time:0.811, LR:0.0001, Train_Loss:0.3233, total_loss:tensor([0.3233], device='cuda:0'), ce_loss:0.6983124613761902, cluster_loss:0.13623104989528656, sep_loss:0.03163712099194527, soft_orth_loss:0.006140411365777254, local_consistency_loss:0.0006762569537386298, proto_loss:0.17468483746051788
2026-01-29 15:53:47.924 | INFO     | __main__:main_worker:429 - [47/100], remain:0d.00h.19m, It:[30/54], Max-Mem:11245M, Data-Time:0.172, LR:0.0001, Train_Loss:-0.0582, total_loss:tensor([-0.0582], device='cuda:0'), ce_loss:0.5303665995597839, cluster_loss:0.0780840590596199, sep_loss:0.028689716011285782, soft_orth_loss:0.006139167584478855, local_consistency_loss:0.002049872186034918, proto_loss:0.11496281623840332
2026-01-29 15:53:52.805 | INFO     | __main__:main_worker:429 - [47/100], remain:0d.00h.20m, It:[40/54], Max-Mem:11245M, Data-Time:0.436, LR:0.0001, Train_Loss:-0.4695, total_loss:tensor([-0.4695], device='cuda:0'), ce_loss:0.3013448417186737, cluster_loss:0.06585120409727097, sep_loss:0.017574667930603027, soft_orth_loss:0.006138619501143694, local_consistency_loss:0.00022008873929735273, proto_loss:0.08978458493947983
2026-01-29 15:53:56.312 | INFO     | __main__:main_worker:429 - [47/100], remain:0d.00h.19m, It:[50/54], Max-Mem:11245M, Data-Time:0.009, LR:0.0001, Train_Loss:-0.4096, total_loss:tensor([-0.4096], device='cuda:0'), ce_loss:0.3310461938381195, cluster_loss:0.07812502235174179, sep_loss:0.012085750699043274, soft_orth_loss:0.006136870943009853, local_consistency_loss:0.00037467729998752475, proto_loss:0.0967223197221756
Evaluating: 100%|| 15/15 [00:08<00:00,  1.87it/s]
acc1: 86.3248, acc3: 100.0000, Precision: 0.7842, Recall: 0.7885, F1-Score: 0.7855, Specificity: 0.9186
2026-01-29 15:54:05.657 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [47/100], Top1:86.325, Top3:100.000, Test_precision:0.7842,Test_recall:0.7885,Test_f1:0.7855,,Test_specificity:0.9186 Test_loss:0.393339
2026-01-29 15:54:05.659 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:54:05.659 | INFO     | __main__:main_worker:355 - ---> start train epoch48
2026-01-29 15:54:14.589 | INFO     | __main__:main_worker:429 - [48/100], remain:0d.00h.22m, It:[10/54], Max-Mem:11245M, Data-Time:1.298, LR:0.0001, Train_Loss:-0.3331, total_loss:tensor([-0.3331], device='cuda:0'), ce_loss:0.37126925587654114, cluster_loss:0.07671789079904556, sep_loss:0.020472733303904533, soft_orth_loss:0.006132261827588081, local_consistency_loss:0.0003634561726357788, proto_loss:0.10368634015321732
2026-01-29 15:54:19.118 | INFO     | __main__:main_worker:429 - [48/100], remain:0d.00h.21m, It:[20/54], Max-Mem:11245M, Data-Time:1.038, LR:0.0001, Train_Loss:-0.2634, total_loss:tensor([-0.2634], device='cuda:0'), ce_loss:0.39541780948638916, cluster_loss:0.09169186651706696, sep_loss:0.021802350878715515, soft_orth_loss:0.006129544228315353, local_consistency_loss:0.00048749070265330374, proto_loss:0.12011125683784485
2026-01-29 15:54:23.667 | INFO     | __main__:main_worker:429 - [48/100], remain:0d.00h.21m, It:[30/54], Max-Mem:11245M, Data-Time:1.115, LR:0.0001, Train_Loss:-0.0375, total_loss:tensor([-0.0375], device='cuda:0'), ce_loss:0.5661088228225708, cluster_loss:0.0679972767829895, sep_loss:0.020156865939497948, soft_orth_loss:0.00612696772441268, local_consistency_loss:0.0032080374658107758, proto_loss:0.09748914837837219
2026-01-29 15:54:29.061 | INFO     | __main__:main_worker:429 - [48/100], remain:0d.00h.22m, It:[40/54], Max-Mem:11245M, Data-Time:1.895, LR:0.0001, Train_Loss:-0.1025, total_loss:tensor([-0.1025], device='cuda:0'), ce_loss:0.6003939509391785, cluster_loss:0.00021700542129110545, sep_loss:0.029822081327438354, soft_orth_loss:0.006124376319348812, local_consistency_loss:0.00011265518696745858, proto_loss:0.03627612069249153
2026-01-29 15:54:32.668 | INFO     | __main__:main_worker:429 - [48/100], remain:0d.00h.20m, It:[50/54], Max-Mem:11245M, Data-Time:0.141, LR:0.0001, Train_Loss:1.5165, total_loss:tensor([1.5165], device='cuda:0'), ce_loss:1.3455255031585693, cluster_loss:0.22059039771556854, sep_loss:0.03483448922634125, soft_orth_loss:0.006121339276432991, local_consistency_loss:0.0006999243050813675, proto_loss:0.26224616169929504
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-29 15:54:33.955 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 48 (LR=0.000056, momentum=0.85)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.8830
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.7064
2026-01-29 15:54:58.833 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating:   0%|          | 0/15 [00:00<?, ?it/s]  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.7049
Local prototype push completed!
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
acc1: 84.6154, acc3: 100.0000, Precision: 0.7317, Recall: 0.7308, F1-Score: 0.7307, Specificity: 0.9070
2026-01-29 15:55:07.072 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [48/100], Top1:84.615, Top3:100.000, Test_precision:0.7317,Test_recall:0.7308,Test_f1:0.7307,,Test_specificity:0.9070 Test_loss:0.417487
2026-01-29 15:55:07.074 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:55:07.075 | INFO     | __main__:main_worker:355 - ---> start train epoch49
2026-01-29 15:55:15.810 | INFO     | __main__:main_worker:429 - [49/100], remain:0d.00h.19m, It:[10/54], Max-Mem:11245M, Data-Time:0.797, LR:0.0001, Train_Loss:-0.0044, total_loss:tensor([-0.0044], device='cuda:0'), ce_loss:0.5557901263237, cluster_loss:0.08790609240531921, sep_loss:0.02958962693810463, soft_orth_loss:0.005751431919634342, local_consistency_loss:0.0002583453606348485, proto_loss:0.12350549548864365
2026-01-29 15:55:20.069 | INFO     | __main__:main_worker:429 - [49/100], remain:0d.00h.19m, It:[20/54], Max-Mem:11245M, Data-Time:0.637, LR:0.0001, Train_Loss:-0.2619, total_loss:tensor([-0.2619], device='cuda:0'), ce_loss:0.41885775327682495, cluster_loss:0.0756433829665184, sep_loss:0.020654475316405296, soft_orth_loss:0.005751708056777716, local_consistency_loss:0.0007839365280233324, proto_loss:0.10283350199460983
2026-01-29 15:55:24.483 | INFO     | __main__:main_worker:429 - [49/100], remain:0d.00h.19m, It:[30/54], Max-Mem:11245M, Data-Time:0.188, LR:0.0001, Train_Loss:0.2981, total_loss:tensor([0.2981], device='cuda:0'), ce_loss:0.7182467579841614, cluster_loss:0.10880398750305176, sep_loss:0.03224464878439903, soft_orth_loss:0.005747880786657333, local_consistency_loss:0.00019095838069915771, proto_loss:0.14698748290538788
2026-01-29 15:55:28.985 | INFO     | __main__:main_worker:429 - [49/100], remain:0d.00h.19m, It:[40/54], Max-Mem:11245M, Data-Time:0.724, LR:0.0001, Train_Loss:-0.0797, total_loss:tensor([-0.0797], device='cuda:0'), ce_loss:0.500159502029419, cluster_loss:0.08980362117290497, sep_loss:0.024658655747771263, soft_orth_loss:0.00574297783896327, local_consistency_loss:0.01032417081296444, proto_loss:0.13052941858768463
2026-01-29 15:55:34.203 | INFO     | __main__:main_worker:429 - [49/100], remain:0d.00h.20m, It:[50/54], Max-Mem:11245M, Data-Time:0.025, LR:0.0001, Train_Loss:-0.1523, total_loss:tensor([-0.1523], device='cuda:0'), ce_loss:0.4753687083721161, cluster_loss:0.08438080549240112, sep_loss:0.02297474630177021, soft_orth_loss:0.005741712171584368, local_consistency_loss:0.0004709884524345398, proto_loss:0.1135682538151741
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 82.6923, acc3: 100.0000, Precision: 0.7301, Recall: 0.7882, F1-Score: 0.7417, Specificity: 0.9053
2026-01-29 15:55:45.336 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [49/100], Top1:82.692, Top3:100.000, Test_precision:0.7301,Test_recall:0.7882,Test_f1:0.7417,,Test_specificity:0.9053 Test_loss:0.461594
2026-01-29 15:55:45.337 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:55:45.337 | INFO     | __main__:main_worker:355 - ---> start train epoch50
2026-01-29 15:55:53.614 | INFO     | __main__:main_worker:429 - [50/100], remain:0d.00h.21m, It:[10/54], Max-Mem:11245M, Data-Time:0.430, LR:0.0001, Train_Loss:0.2361, total_loss:tensor([0.2361], device='cuda:0'), ce_loss:0.6626852750778198, cluster_loss:0.12390746921300888, sep_loss:0.030208531767129898, soft_orth_loss:0.0057407584972679615, local_consistency_loss:0.0009403731673955917, proto_loss:0.1607971340417862
2026-01-29 15:55:59.577 | INFO     | __main__:main_worker:429 - [50/100], remain:0d.00h.23m, It:[20/54], Max-Mem:11245M, Data-Time:1.817, LR:0.0001, Train_Loss:0.4067, total_loss:tensor([0.4067], device='cuda:0'), ce_loss:0.755993127822876, cluster_loss:0.1369970738887787, sep_loss:0.025728320702910423, soft_orth_loss:0.005737786181271076, local_consistency_loss:0.004108887165784836, proto_loss:0.172572061419487
2026-01-29 15:56:04.364 | INFO     | __main__:main_worker:429 - [50/100], remain:0d.00h.22m, It:[30/54], Max-Mem:11245M, Data-Time:1.285, LR:0.0001, Train_Loss:0.5677, total_loss:tensor([0.5677], device='cuda:0'), ce_loss:0.8587055206298828, cluster_loss:0.13159894943237305, sep_loss:0.033783502876758575, soft_orth_loss:0.005732962861657143, local_consistency_loss:0.0005946169840171933, proto_loss:0.1717100292444229
2026-01-29 15:56:08.694 | INFO     | __main__:main_worker:429 - [50/100], remain:0d.00h.21m, It:[40/54], Max-Mem:11245M, Data-Time:0.837, LR:0.0001, Train_Loss:-0.0216, total_loss:tensor([-0.0216], device='cuda:0'), ce_loss:0.542307436466217, cluster_loss:0.09403777122497559, sep_loss:0.02668730728328228, soft_orth_loss:0.005729123018682003, local_consistency_loss:0.0004270869249012321, proto_loss:0.12688128650188446
2026-01-29 15:56:13.555 | INFO     | __main__:main_worker:429 - [50/100], remain:0d.00h.21m, It:[50/54], Max-Mem:11245M, Data-Time:1.393, LR:0.0001, Train_Loss:0.8117, total_loss:tensor([0.8117], device='cuda:0'), ce_loss:0.9897052049636841, cluster_loss:0.14617054164409637, sep_loss:0.037828121334314346, soft_orth_loss:0.005730218719691038, local_consistency_loss:0.0007964844699017704, proto_loss:0.1905253529548645
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
acc1: 84.1880, acc3: 100.0000, Precision: 0.7321, Recall: 0.7588, F1-Score: 0.7438, Specificity: 0.9101
2026-01-29 15:56:22.923 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [50/100], Top1:84.188, Top3:100.000, Test_precision:0.7321,Test_recall:0.7588,Test_f1:0.7438,,Test_specificity:0.9101 Test_loss:0.429975
2026-01-29 15:56:22.924 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:56:33.828 | INFO     | __main__:main_worker:355 - ---> start train epoch51
2026-01-29 15:56:42.105 | INFO     | __main__:main_worker:429 - [51/100], remain:0d.00h.19m, It:[10/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.0823, total_loss:tensor([-0.0823], device='cuda:0'), ce_loss:0.5429857969284058, cluster_loss:0.06396220624446869, sep_loss:0.02473296783864498, soft_orth_loss:0.005729495082050562, local_consistency_loss:0.0012060987064614892, proto_loss:0.09563077241182327
2026-01-29 15:56:45.752 | INFO     | __main__:main_worker:429 - [51/100], remain:0d.00h.17m, It:[20/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.0279, total_loss:tensor([-0.0279], device='cuda:0'), ce_loss:0.5432302355766296, cluster_loss:0.0872640311717987, sep_loss:0.030189862474799156, soft_orth_loss:0.005727891810238361, local_consistency_loss:0.0002627543581184, proto_loss:0.12344454228878021
2026-01-29 15:56:51.153 | INFO     | __main__:main_worker:429 - [51/100], remain:0d.00h.19m, It:[30/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0001, Train_Loss:-0.0190, total_loss:tensor([-0.0190], device='cuda:0'), ce_loss:0.5371471643447876, cluster_loss:0.09625845402479172, sep_loss:0.030680406838655472, soft_orth_loss:0.005724709946662188, local_consistency_loss:0.0004466738610062748, proto_loss:0.13311025500297546
2026-01-29 15:56:55.637 | INFO     | __main__:main_worker:429 - [51/100], remain:0d.00h.19m, It:[40/54], Max-Mem:11245M, Data-Time:0.021, LR:0.0001, Train_Loss:0.0305, total_loss:tensor([0.0305], device='cuda:0'), ce_loss:0.5806033611297607, cluster_loss:0.08666510879993439, sep_loss:0.030531346797943115, soft_orth_loss:0.00572441378608346, local_consistency_loss:0.00037813090602867305, proto_loss:0.1232990026473999
2026-01-29 15:56:59.352 | INFO     | __main__:main_worker:429 - [51/100], remain:0d.00h.18m, It:[50/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0001, Train_Loss:-0.4875, total_loss:tensor([-0.4875], device='cuda:0'), ce_loss:0.2947010099887848, cluster_loss:0.06415996700525284, sep_loss:0.020409731194376945, soft_orth_loss:0.005723345093429089, local_consistency_loss:0.000263390684267506, proto_loss:0.09055643528699875
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 85.2564, acc3: 100.0000, Precision: 0.7513, Recall: 0.8227, F1-Score: 0.7776, Specificity: 0.9325
2026-01-29 15:57:09.577 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [51/100], Top1:85.256, Top3:100.000, Test_precision:0.7513,Test_recall:0.8227,Test_f1:0.7776,,Test_specificity:0.9325 Test_loss:0.393627
2026-01-29 15:57:09.580 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:57:09.582 | INFO     | __main__:main_worker:355 - ---> start train epoch52
2026-01-29 15:57:17.881 | INFO     | __main__:main_worker:429 - [52/100], remain:0d.00h.19m, It:[10/54], Max-Mem:11245M, Data-Time:0.324, LR:0.0001, Train_Loss:1.0419, total_loss:tensor([1.0419], device='cuda:0'), ce_loss:1.111527442932129, cluster_loss:0.16552749276161194, sep_loss:0.03768282011151314, soft_orth_loss:0.005722307600080967, local_consistency_loss:0.000943704682867974, proto_loss:0.20987632870674133
2026-01-29 15:57:22.171 | INFO     | __main__:main_worker:429 - [52/100], remain:0d.00h.18m, It:[20/54], Max-Mem:11245M, Data-Time:0.185, LR:0.0001, Train_Loss:-0.4206, total_loss:tensor([-0.4206], device='cuda:0'), ce_loss:0.32679757475852966, cluster_loss:0.070689357817173, sep_loss:0.022540437057614326, soft_orth_loss:0.005722054746001959, local_consistency_loss:0.00024897916591726243, proto_loss:0.09920082241296768
2026-01-29 15:57:27.397 | INFO     | __main__:main_worker:429 - [52/100], remain:0d.00h.19m, It:[30/54], Max-Mem:11245M, Data-Time:1.054, LR:0.0001, Train_Loss:-0.0728, total_loss:tensor([-0.0728], device='cuda:0'), ce_loss:0.5041466355323792, cluster_loss:0.10204263776540756, sep_loss:0.025158170610666275, soft_orth_loss:0.005721303168684244, local_consistency_loss:0.00031303372816182673, proto_loss:0.1332351416349411
2026-01-29 15:57:31.085 | INFO     | __main__:main_worker:429 - [52/100], remain:0d.00h.18m, It:[40/54], Max-Mem:11245M, Data-Time:0.221, LR:0.0001, Train_Loss:0.3699, total_loss:tensor([0.3699], device='cuda:0'), ce_loss:0.7599493861198425, cluster_loss:0.12097197026014328, sep_loss:0.023917298763990402, soft_orth_loss:0.005722081754356623, local_consistency_loss:0.001401945250108838, proto_loss:0.15201328694820404
2026-01-29 15:57:35.445 | INFO     | __main__:main_worker:429 - [52/100], remain:0d.00h.18m, It:[50/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0000, Train_Loss:0.5738, total_loss:tensor([0.5738], device='cuda:0'), ce_loss:0.8588418960571289, cluster_loss:0.13425123691558838, sep_loss:0.0355728343129158, soft_orth_loss:0.0057221208699047565, local_consistency_loss:0.0004745035548694432, proto_loss:0.17602068185806274
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 85.2564, acc3: 100.0000, Precision: 0.7552, Recall: 0.7941, F1-Score: 0.7706, Specificity: 0.9153
2026-01-29 15:57:44.910 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [52/100], Top1:85.256, Top3:100.000, Test_precision:0.7552,Test_recall:0.7941,Test_f1:0.7706,,Test_specificity:0.9153 Test_loss:0.433039
2026-01-29 15:57:44.913 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:57:44.914 | INFO     | __main__:main_worker:355 - ---> start train epoch53
2026-01-29 15:57:54.807 | INFO     | __main__:main_worker:429 - [53/100], remain:0d.00h.23m, It:[10/54], Max-Mem:11245M, Data-Time:1.873, LR:0.0000, Train_Loss:-0.1018, total_loss:tensor([-0.1018], device='cuda:0'), ce_loss:0.5011553168296814, cluster_loss:0.0858558863401413, sep_loss:0.029534578323364258, soft_orth_loss:0.005722846835851669, local_consistency_loss:0.00029252012609504163, proto_loss:0.12140583246946335
2026-01-29 15:57:59.053 | INFO     | __main__:main_worker:429 - [53/100], remain:0d.00h.20m, It:[20/54], Max-Mem:11245M, Data-Time:0.803, LR:0.0000, Train_Loss:-0.2424, total_loss:tensor([-0.2424], device='cuda:0'), ce_loss:0.4273528456687927, cluster_loss:0.07588911056518555, sep_loss:0.027630919590592384, soft_orth_loss:0.005722058936953545, local_consistency_loss:0.00043944455683231354, proto_loss:0.10968153178691864
2026-01-29 15:58:02.618 | INFO     | __main__:main_worker:429 - [53/100], remain:0d.00h.18m, It:[30/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0000, Train_Loss:-0.1604, total_loss:tensor([-0.1604], device='cuda:0'), ce_loss:0.48766177892684937, cluster_loss:0.06853048503398895, sep_loss:0.02766025997698307, soft_orth_loss:0.005719734355807304, local_consistency_loss:0.0009032246889546514, proto_loss:0.1028137058019638
2026-01-29 15:58:07.632 | INFO     | __main__:main_worker:429 - [53/100], remain:0d.00h.19m, It:[40/54], Max-Mem:11245M, Data-Time:0.026, LR:0.0000, Train_Loss:-0.1625, total_loss:tensor([-0.1625], device='cuda:0'), ce_loss:0.4620683193206787, cluster_loss:0.0871678814291954, sep_loss:0.028769601136446, soft_orth_loss:0.005718589760363102, local_consistency_loss:0.000988826504908502, proto_loss:0.12264490127563477
2026-01-29 15:58:11.857 | INFO     | __main__:main_worker:429 - [53/100], remain:0d.00h.18m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.2314, total_loss:tensor([-0.2314], device='cuda:0'), ce_loss:0.4456367790699005, cluster_loss:0.0767853632569313, sep_loss:0.01808878593146801, soft_orth_loss:0.005717420019209385, local_consistency_loss:0.000424333120463416, proto_loss:0.10101590305566788
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
acc1: 88.0342, acc3: 100.0000, Precision: 0.7990, Recall: 0.8104, F1-Score: 0.8035, Specificity: 0.9332
2026-01-29 15:58:22.900 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [53/100], Top1:88.034, Top3:100.000, Test_precision:0.7990,Test_recall:0.8104,Test_f1:0.8035,,Test_specificity:0.9332 Test_loss:0.414086
2026-01-29 15:58:22.901 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:58:22.901 | INFO     | __main__:main_worker:355 - ---> start train epoch54
2026-01-29 15:58:33.006 | INFO     | __main__:main_worker:429 - [54/100], remain:0d.00h.21m, It:[10/54], Max-Mem:11245M, Data-Time:0.501, LR:0.0000, Train_Loss:-0.2452, total_loss:tensor([-0.2452], device='cuda:0'), ce_loss:0.423796147108078, cluster_loss:0.08102428168058395, sep_loss:0.02489476464688778, soft_orth_loss:0.005715027451515198, local_consistency_loss:0.00027277038316242397, proto_loss:0.11190684884786606
2026-01-29 15:58:38.719 | INFO     | __main__:main_worker:429 - [54/100], remain:0d.00h.22m, It:[20/54], Max-Mem:11245M, Data-Time:2.252, LR:0.0000, Train_Loss:0.0009, total_loss:tensor([0.0009], device='cuda:0'), ce_loss:0.5629740357398987, cluster_loss:0.0864335224032402, sep_loss:0.031975191086530685, soft_orth_loss:0.005712995305657387, local_consistency_loss:0.0005807594279758632, proto_loss:0.12470246106386185
2026-01-29 15:58:42.313 | INFO     | __main__:main_worker:429 - [54/100], remain:0d.00h.19m, It:[30/54], Max-Mem:11245M, Data-Time:0.083, LR:0.0000, Train_Loss:0.7009, total_loss:tensor([0.7009], device='cuda:0'), ce_loss:0.9073579907417297, cluster_loss:0.16090142726898193, sep_loss:0.0354497991502285, soft_orth_loss:0.005714007653295994, local_consistency_loss:0.00021619022300001234, proto_loss:0.2022814303636551
2026-01-29 15:58:47.532 | INFO     | __main__:main_worker:429 - [54/100], remain:0d.00h.20m, It:[40/54], Max-Mem:11245M, Data-Time:1.775, LR:0.0000, Train_Loss:0.0207, total_loss:tensor([0.0207], device='cuda:0'), ce_loss:0.5620037913322449, cluster_loss:0.09940382838249207, sep_loss:0.030322430655360222, soft_orth_loss:0.005714470986276865, local_consistency_loss:0.00041156477527692914, proto_loss:0.13585230708122253
2026-01-29 15:58:52.569 | INFO     | __main__:main_worker:429 - [54/100], remain:0d.00h.20m, It:[50/54], Max-Mem:11245M, Data-Time:1.606, LR:0.0000, Train_Loss:0.0096, total_loss:tensor([0.0096], device='cuda:0'), ce_loss:0.6818601489067078, cluster_loss:0.0002486509329173714, sep_loss:0.025726908817887306, soft_orth_loss:0.0057120597921311855, local_consistency_loss:0.0017516445368528366, proto_loss:0.033439263701438904
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
2026-01-29 15:59:02.108 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [54/100], Top1:87.821, Top3:100.000, Test_precision:0.8206,Test_recall:0.7912,Test_f1:0.7994,,Test_specificity:0.9281 Test_loss:0.377527
acc1: 87.8205, acc3: 100.0000, Precision: 0.8206, Recall: 0.7912, F1-Score: 0.7994, Specificity: 0.9281
2026-01-29 15:59:02.110 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 15:59:02.111 | INFO     | __main__:main_worker:355 - ---> start train epoch55
2026-01-29 15:59:10.283 | INFO     | __main__:main_worker:429 - [55/100], remain:0d.00h.17m, It:[10/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:0.3972, total_loss:tensor([0.3972], device='cuda:0'), ce_loss:0.7989640831947327, cluster_loss:0.09214296191930771, sep_loss:0.03741998225450516, soft_orth_loss:0.005710551515221596, local_consistency_loss:0.0006354455254040658, proto_loss:0.13590894639492035
2026-01-29 15:59:15.396 | INFO     | __main__:main_worker:429 - [55/100], remain:0d.00h.18m, It:[20/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.0633, total_loss:tensor([-0.0633], device='cuda:0'), ce_loss:0.5351052284240723, cluster_loss:0.08216571062803268, sep_loss:0.026997346431016922, soft_orth_loss:0.005710725672543049, local_consistency_loss:0.0006259093061089516, proto_loss:0.11549969762563705
2026-01-29 15:59:19.549 | INFO     | __main__:main_worker:429 - [55/100], remain:0d.00h.18m, It:[30/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:0.7735, total_loss:tensor([0.7735], device='cuda:0'), ce_loss:0.974867582321167, cluster_loss:0.13582949340343475, sep_loss:0.04287030175328255, soft_orth_loss:0.005710320547223091, local_consistency_loss:0.0005951410275883973, proto_loss:0.18500524759292603
2026-01-29 15:59:23.873 | INFO     | __main__:main_worker:429 - [55/100], remain:0d.00h.17m, It:[40/54], Max-Mem:11245M, Data-Time:0.015, LR:0.0000, Train_Loss:-0.2097, total_loss:tensor([-0.2097], device='cuda:0'), ce_loss:0.4515237510204315, cluster_loss:0.07963690161705017, sep_loss:0.023010091856122017, soft_orth_loss:0.005710091441869736, local_consistency_loss:0.0006738908705301583, proto_loss:0.10903097689151764
2026-01-29 15:59:27.987 | INFO     | __main__:main_worker:429 - [55/100], remain:0d.00h.17m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:0.2422, total_loss:tensor([0.2422], device='cuda:0'), ce_loss:0.6684820652008057, cluster_loss:0.12885800004005432, sep_loss:0.028144096955657005, soft_orth_loss:0.005709518678486347, local_consistency_loss:0.000482317031128332, proto_loss:0.16319392621517181
Evaluating: 100%|| 15/15 [00:08<00:00,  1.87it/s]
2026-01-29 15:59:38.658 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [55/100], Top1:85.897, Top3:100.000, Test_precision:0.7598,Test_recall:0.8354,Test_f1:0.7869,,Test_specificity:0.9314 Test_loss:0.403386
2026-01-29 15:59:38.659 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
acc1: 85.8974, acc3: 100.0000, Precision: 0.7598, Recall: 0.8354, F1-Score: 0.7869, Specificity: 0.9314
2026-01-29 15:59:48.593 | INFO     | __main__:main_worker:355 - ---> start train epoch56
2026-01-29 15:59:59.181 | INFO     | __main__:main_worker:429 - [56/100], remain:0d.00h.19m, It:[10/54], Max-Mem:11245M, Data-Time:1.499, LR:0.0000, Train_Loss:0.6275, total_loss:tensor([0.6275], device='cuda:0'), ce_loss:0.873761773109436, cluster_loss:0.15194785594940186, sep_loss:0.034661587327718735, soft_orth_loss:0.005702525842934847, local_consistency_loss:0.0005230672541074455, proto_loss:0.1928350329399109
2026-01-29 16:00:03.480 | INFO     | __main__:main_worker:429 - [56/100], remain:0d.00h.18m, It:[20/54], Max-Mem:11245M, Data-Time:0.806, LR:0.0000, Train_Loss:-0.3095, total_loss:tensor([-0.3095], device='cuda:0'), ce_loss:0.38801270723342896, cluster_loss:0.08173594623804092, sep_loss:0.022392336279153824, soft_orth_loss:0.005701765418052673, local_consistency_loss:0.0004570155870169401, proto_loss:0.11028707027435303
2026-01-29 16:00:08.023 | INFO     | __main__:main_worker:429 - [56/100], remain:0d.00h.18m, It:[30/54], Max-Mem:11245M, Data-Time:1.058, LR:0.0000, Train_Loss:0.3099, total_loss:tensor([0.3099], device='cuda:0'), ce_loss:0.7346813678741455, cluster_loss:0.10905881226062775, sep_loss:0.02922128513455391, soft_orth_loss:0.0057009439915418625, local_consistency_loss:0.00038556696381419897, proto_loss:0.14436660706996918
2026-01-29 16:00:12.487 | INFO     | __main__:main_worker:429 - [56/100], remain:0d.00h.17m, It:[40/54], Max-Mem:11245M, Data-Time:0.956, LR:0.0000, Train_Loss:-0.0804, total_loss:tensor([-0.0804], device='cuda:0'), ce_loss:0.5308043360710144, cluster_loss:0.07844151556491852, sep_loss:0.027007341384887695, soft_orth_loss:0.005700571462512016, local_consistency_loss:0.00022818891739007086, proto_loss:0.11137761920690536
2026-01-29 16:00:16.085 | INFO     | __main__:main_worker:429 - [56/100], remain:0d.00h.16m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:0.3622, total_loss:tensor([0.3622], device='cuda:0'), ce_loss:0.7906017899513245, cluster_loss:0.08132197707891464, sep_loss:0.03711181506514549, soft_orth_loss:0.005700354464352131, local_consistency_loss:0.0017822399968281388, proto_loss:0.12591639161109924
2026-01-29 16:00:17.367 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 56 (LR=0.000043, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.7228
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.6757
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.6257
Local prototype push completed!
2026-01-29 16:00:41.749 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 85.2564, acc3: 100.0000, Precision: 0.7556, Recall: 0.8312, F1-Score: 0.7816, Specificity: 0.9258
2026-01-29 16:00:49.906 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [56/100], Top1:85.256, Top3:100.000, Test_precision:0.7556,Test_recall:0.8312,Test_f1:0.7816,,Test_specificity:0.9258 Test_loss:0.442634
2026-01-29 16:00:49.907 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:00:49.907 | INFO     | __main__:main_worker:355 - ---> start train epoch57
2026-01-29 16:00:58.804 | INFO     | __main__:main_worker:429 - [57/100], remain:0d.00h.17m, It:[10/54], Max-Mem:11245M, Data-Time:0.980, LR:0.0000, Train_Loss:0.1652, total_loss:tensor([0.1652], device='cuda:0'), ce_loss:0.6430662870407104, cluster_loss:0.10932480543851852, sep_loss:0.02719363011419773, soft_orth_loss:0.00651637464761734, local_consistency_loss:0.0023822083603590727, proto_loss:0.1454170197248459
2026-01-29 16:01:03.250 | INFO     | __main__:main_worker:429 - [57/100], remain:0d.00h.17m, It:[20/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0000, Train_Loss:-0.1492, total_loss:tensor([-0.1492], device='cuda:0'), ce_loss:0.4759669303894043, cluster_loss:0.0894584134221077, sep_loss:0.024965673685073853, soft_orth_loss:0.006514177192002535, local_consistency_loss:0.00027026524185203016, proto_loss:0.12120852619409561
2026-01-29 16:01:08.613 | INFO     | __main__:main_worker:429 - [57/100], remain:0d.00h.18m, It:[30/54], Max-Mem:11245M, Data-Time:0.023, LR:0.0000, Train_Loss:0.6517, total_loss:tensor([0.6517], device='cuda:0'), ce_loss:0.8818483948707581, cluster_loss:0.15708278119564056, sep_loss:0.03514251112937927, soft_orth_loss:0.006509674713015556, local_consistency_loss:0.0003570348198991269, proto_loss:0.19909200072288513
2026-01-29 16:01:12.222 | INFO     | __main__:main_worker:429 - [57/100], remain:0d.00h.17m, It:[40/54], Max-Mem:11245M, Data-Time:0.029, LR:0.0000, Train_Loss:-0.2363, total_loss:tensor([-0.2363], device='cuda:0'), ce_loss:0.42937734723091125, cluster_loss:0.07938864082098007, sep_loss:0.026850754395127296, soft_orth_loss:0.006505785509943962, local_consistency_loss:0.002229452831670642, proto_loss:0.11497463285923004
2026-01-29 16:01:16.105 | INFO     | __main__:main_worker:429 - [57/100], remain:0d.00h.16m, It:[50/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0000, Train_Loss:0.5076, total_loss:tensor([0.5076], device='cuda:0'), ce_loss:0.8349424600601196, cluster_loss:0.1186671033501625, sep_loss:0.03821410611271858, soft_orth_loss:0.006504448596388102, local_consistency_loss:0.0008211953681893647, proto_loss:0.1642068475484848
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 87.1795, acc3: 100.0000, Precision: 0.7848, Recall: 0.8384, F1-Score: 0.8072, Specificity: 0.9333
2026-01-29 16:01:25.550 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [57/100], Top1:87.179, Top3:100.000, Test_precision:0.7848,Test_recall:0.8384,Test_f1:0.8072,,Test_specificity:0.9333 Test_loss:0.354248
2026-01-29 16:01:25.551 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:01:25.551 | INFO     | __main__:main_worker:355 - ---> start train epoch58
2026-01-29 16:01:35.345 | INFO     | __main__:main_worker:429 - [58/100], remain:0d.00h.18m, It:[10/54], Max-Mem:11245M, Data-Time:1.568, LR:0.0000, Train_Loss:-0.2599, total_loss:tensor([-0.2599], device='cuda:0'), ce_loss:0.43703895807266235, cluster_loss:0.0612584613263607, sep_loss:0.02861751616001129, soft_orth_loss:0.0065034544095396996, local_consistency_loss:0.0008080905536189675, proto_loss:0.09718752652406693
2026-01-29 16:01:40.205 | INFO     | __main__:main_worker:429 - [58/100], remain:0d.00h.18m, It:[20/54], Max-Mem:11245M, Data-Time:1.360, LR:0.0000, Train_Loss:-0.1879, total_loss:tensor([-0.1879], device='cuda:0'), ce_loss:0.4621009826660156, cluster_loss:0.08014225214719772, sep_loss:0.025360828265547752, soft_orth_loss:0.0065026357769966125, local_consistency_loss:0.0015320349484682083, proto_loss:0.1135377511382103
2026-01-29 16:01:43.970 | INFO     | __main__:main_worker:429 - [58/100], remain:0d.00h.16m, It:[30/54], Max-Mem:11245M, Data-Time:0.278, LR:0.0000, Train_Loss:0.0139, total_loss:tensor([0.0139], device='cuda:0'), ce_loss:0.5573471188545227, cluster_loss:0.10320066660642624, sep_loss:0.028729576617479324, soft_orth_loss:0.006499913986772299, local_consistency_loss:0.0003913491091225296, proto_loss:0.13882151246070862
2026-01-29 16:01:48.256 | INFO     | __main__:main_worker:429 - [58/100], remain:0d.00h.16m, It:[40/54], Max-Mem:11245M, Data-Time:0.159, LR:0.0000, Train_Loss:-0.4396, total_loss:tensor([-0.4396], device='cuda:0'), ce_loss:0.31620875000953674, cluster_loss:0.07882015407085419, sep_loss:0.01857808046042919, soft_orth_loss:0.00649691466242075, local_consistency_loss:0.0003320554969832301, proto_loss:0.1042272076010704
2026-01-29 16:01:52.772 | INFO     | __main__:main_worker:429 - [58/100], remain:0d.00h.16m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:0.6232, total_loss:tensor([0.6232], device='cuda:0'), ce_loss:0.8884543776512146, cluster_loss:0.13517847657203674, sep_loss:0.037969011813402176, soft_orth_loss:0.006495568435639143, local_consistency_loss:0.00029038378852419555, proto_loss:0.17993342876434326
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
2026-01-29 16:02:02.504 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [58/100], Top1:86.752, Top3:100.000, Test_precision:0.7755,Test_recall:0.8227,Test_f1:0.7940,,Test_specificity:0.9368 Test_loss:0.428234
2026-01-29 16:02:02.506 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:02:02.506 | INFO     | __main__:main_worker:355 - ---> start train epoch59
acc1: 86.7521, acc3: 100.0000, Precision: 0.7755, Recall: 0.8227, F1-Score: 0.7940, Specificity: 0.9368
2026-01-29 16:02:11.093 | INFO     | __main__:main_worker:429 - [59/100], remain:0d.00h.14m, It:[10/54], Max-Mem:11245M, Data-Time:0.526, LR:0.0000, Train_Loss:-0.3723, total_loss:tensor([-0.3723], device='cuda:0'), ce_loss:0.384168803691864, cluster_loss:0.05890155956149101, sep_loss:0.018304845318198204, soft_orth_loss:0.006494020111858845, local_consistency_loss:0.00011949880718020722, proto_loss:0.0838199257850647
2026-01-29 16:02:15.542 | INFO     | __main__:main_worker:429 - [59/100], remain:0d.00h.15m, It:[20/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0000, Train_Loss:0.0274, total_loss:tensor([0.0274], device='cuda:0'), ce_loss:0.5786859393119812, cluster_loss:0.09071514010429382, sep_loss:0.03132442757487297, soft_orth_loss:0.006493045948445797, local_consistency_loss:0.0005101414280943573, proto_loss:0.12904275953769684
2026-01-29 16:02:19.589 | INFO     | __main__:main_worker:429 - [59/100], remain:0d.00h.15m, It:[30/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.3360, total_loss:tensor([-0.3360], device='cuda:0'), ce_loss:0.4685625731945038, cluster_loss:0.00019053558935411274, sep_loss:0.027327388525009155, soft_orth_loss:0.006491959095001221, local_consistency_loss:0.000595354416873306, proto_loss:0.0346052348613739
2026-01-29 16:02:23.943 | INFO     | __main__:main_worker:429 - [59/100], remain:0d.00h.15m, It:[40/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:0.3636, total_loss:tensor([0.3636], device='cuda:0'), ce_loss:0.7380194664001465, cluster_loss:0.1354004293680191, sep_loss:0.02833588235080242, soft_orth_loss:0.006491298321634531, local_consistency_loss:0.0003017937415279448, proto_loss:0.17052941024303436
2026-01-29 16:02:28.353 | INFO     | __main__:main_worker:429 - [59/100], remain:0d.00h.15m, It:[50/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:0.2915, total_loss:tensor([0.2915], device='cuda:0'), ce_loss:0.7018015384674072, cluster_loss:0.12809400260448456, sep_loss:0.027704555541276932, soft_orth_loss:0.006491372361779213, local_consistency_loss:0.0011230563977733254, proto_loss:0.16341298818588257
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
2026-01-29 16:02:38.177 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [59/100], Top1:86.111, Top3:100.000, Test_precision:0.7700,Test_recall:0.7874,Test_f1:0.7778,,Test_specificity:0.9211 Test_loss:0.369307
2026-01-29 16:02:38.178 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:02:38.179 | INFO     | __main__:main_worker:355 - ---> start train epoch60
acc1: 86.1111, acc3: 100.0000, Precision: 0.7700, Recall: 0.7874, F1-Score: 0.7778, Specificity: 0.9211
2026-01-29 16:02:47.150 | INFO     | __main__:main_worker:429 - [60/100], remain:0d.00h.17m, It:[10/54], Max-Mem:11245M, Data-Time:0.519, LR:0.0000, Train_Loss:-0.1046, total_loss:tensor([-0.1046], device='cuda:0'), ce_loss:0.49451273679733276, cluster_loss:0.09544505923986435, sep_loss:0.02736676298081875, soft_orth_loss:0.006490881089121103, local_consistency_loss:0.0015086060157045722, proto_loss:0.13081131875514984
2026-01-29 16:02:51.565 | INFO     | __main__:main_worker:429 - [60/100], remain:0d.00h.16m, It:[20/54], Max-Mem:11245M, Data-Time:0.973, LR:0.0000, Train_Loss:0.2568, total_loss:tensor([0.2568], device='cuda:0'), ce_loss:0.6715739965438843, cluster_loss:0.13298527896404266, sep_loss:0.030341288074851036, soft_orth_loss:0.006490306928753853, local_consistency_loss:0.0006913991528563201, proto_loss:0.1705082654953003
2026-01-29 16:02:56.310 | INFO     | __main__:main_worker:429 - [60/100], remain:0d.00h.16m, It:[30/54], Max-Mem:11245M, Data-Time:1.266, LR:0.0000, Train_Loss:0.4802, total_loss:tensor([0.4802], device='cuda:0'), ce_loss:0.8085038661956787, cluster_loss:0.12940369546413422, sep_loss:0.036471374332904816, soft_orth_loss:0.006490025203675032, local_consistency_loss:0.00047979806549847126, proto_loss:0.17284490168094635
2026-01-29 16:03:00.540 | INFO     | __main__:main_worker:429 - [60/100], remain:0d.00h.16m, It:[40/54], Max-Mem:11245M, Data-Time:0.019, LR:0.0000, Train_Loss:-0.3267, total_loss:tensor([-0.3267], device='cuda:0'), ce_loss:0.3961009085178375, cluster_loss:0.06689228117465973, sep_loss:0.02414068952202797, soft_orth_loss:0.006490213330835104, local_consistency_loss:0.0010822052136063576, proto_loss:0.09860538691282272
2026-01-29 16:03:04.971 | INFO     | __main__:main_worker:429 - [60/100], remain:0d.00h.16m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:0.2127, total_loss:tensor([0.2127], device='cuda:0'), ce_loss:0.674040675163269, cluster_loss:0.1101045235991478, sep_loss:0.0298323817551136, soft_orth_loss:0.006489488296210766, local_consistency_loss:0.00016662159760016948, proto_loss:0.14659301936626434
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 86.5385, acc3: 100.0000, Precision: 0.7664, Recall: 0.8146, F1-Score: 0.7865, Specificity: 0.9327
2026-01-29 16:03:14.803 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [60/100], Top1:86.538, Top3:100.000, Test_precision:0.7664,Test_recall:0.8146,Test_f1:0.7865,,Test_specificity:0.9327 Test_loss:0.401042
2026-01-29 16:03:14.806 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:03:24.648 | INFO     | __main__:main_worker:355 - ---> start train epoch61
2026-01-29 16:03:34.382 | INFO     | __main__:main_worker:429 - [61/100], remain:0d.00h.16m, It:[10/54], Max-Mem:11245M, Data-Time:0.019, LR:0.0000, Train_Loss:0.5120, total_loss:tensor([0.5120], device='cuda:0'), ce_loss:0.8019901514053345, cluster_loss:0.15524940192699432, sep_loss:0.031063253059983253, soft_orth_loss:0.006485489662736654, local_consistency_loss:0.0015083421021699905, proto_loss:0.19430649280548096
2026-01-29 16:03:38.355 | INFO     | __main__:main_worker:429 - [61/100], remain:0d.00h.15m, It:[20/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.2672, total_loss:tensor([-0.2672], device='cuda:0'), ce_loss:0.4240695536136627, cluster_loss:0.0784127414226532, sep_loss:0.021406149491667747, soft_orth_loss:0.006481726188212633, local_consistency_loss:0.0002963901497423649, proto_loss:0.10659701377153397
2026-01-29 16:03:43.204 | INFO     | __main__:main_worker:429 - [61/100], remain:0d.00h.15m, It:[30/54], Max-Mem:11245M, Data-Time:0.851, LR:0.0000, Train_Loss:0.1754, total_loss:tensor([0.1754], device='cuda:0'), ce_loss:0.6475333571434021, cluster_loss:0.11824359744787216, sep_loss:0.02438216656446457, soft_orth_loss:0.006480137351900339, local_consistency_loss:0.00034843821777030826, proto_loss:0.14945434033870697
2026-01-29 16:03:47.523 | INFO     | __main__:main_worker:429 - [61/100], remain:0d.00h.15m, It:[40/54], Max-Mem:11245M, Data-Time:0.017, LR:0.0000, Train_Loss:0.1745, total_loss:tensor([0.1745], device='cuda:0'), ce_loss:0.6870537400245667, cluster_loss:0.0831950232386589, sep_loss:0.026663193479180336, soft_orth_loss:0.006479181349277496, local_consistency_loss:0.000981142628006637, proto_loss:0.1173185408115387
2026-01-29 16:03:51.561 | INFO     | __main__:main_worker:429 - [61/100], remain:0d.00h.15m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:0.4238, total_loss:tensor([0.4238], device='cuda:0'), ce_loss:0.785945475101471, cluster_loss:0.12092667073011398, sep_loss:0.03524142503738403, soft_orth_loss:0.006478197872638702, local_consistency_loss:0.000542554771527648, proto_loss:0.1631888449192047
Evaluating: 100%|| 15/15 [00:07<00:00,  1.88it/s]
2026-01-29 16:04:01.352 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [61/100], Top1:85.470, Top3:100.000, Test_precision:0.7666,Test_recall:0.8189,Test_f1:0.7880,,Test_specificity:0.9194 Test_loss:0.403772
2026-01-29 16:04:01.352 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:04:01.353 | INFO     | __main__:main_worker:355 - ---> start train epoch62
acc1: 85.4701, acc3: 100.0000, Precision: 0.7666, Recall: 0.8189, F1-Score: 0.7880, Specificity: 0.9194
2026-01-29 16:04:11.411 | INFO     | __main__:main_worker:429 - [62/100], remain:0d.00h.17m, It:[10/54], Max-Mem:11245M, Data-Time:1.621, LR:0.0000, Train_Loss:0.1947, total_loss:tensor([0.1947], device='cuda:0'), ce_loss:0.6717573404312134, cluster_loss:0.09700559824705124, sep_loss:0.0352691188454628, soft_orth_loss:0.006476623471826315, local_consistency_loss:0.0012530124513432384, proto_loss:0.14000435173511505
2026-01-29 16:04:15.543 | INFO     | __main__:main_worker:429 - [62/100], remain:0d.00h.15m, It:[20/54], Max-Mem:11245M, Data-Time:0.628, LR:0.0000, Train_Loss:-0.1659, total_loss:tensor([-0.1659], device='cuda:0'), ce_loss:0.47817882895469666, cluster_loss:0.07794894278049469, sep_loss:0.028456682339310646, soft_orth_loss:0.006475610658526421, local_consistency_loss:0.0017194238025695086, proto_loss:0.11460065841674805
2026-01-29 16:04:19.813 | INFO     | __main__:main_worker:429 - [62/100], remain:0d.00h.15m, It:[30/54], Max-Mem:11245M, Data-Time:0.587, LR:0.0000, Train_Loss:-0.4534, total_loss:tensor([-0.4534], device='cuda:0'), ce_loss:0.3175610899925232, cluster_loss:0.07529427856206894, sep_loss:0.01747790537774563, soft_orth_loss:0.006474625784903765, local_consistency_loss:0.0002567610645201057, proto_loss:0.09950357675552368
2026-01-29 16:04:23.489 | INFO     | __main__:main_worker:429 - [62/100], remain:0d.00h.14m, It:[40/54], Max-Mem:11245M, Data-Time:0.248, LR:0.0000, Train_Loss:0.0352, total_loss:tensor([0.0352], device='cuda:0'), ce_loss:0.5893887877464294, cluster_loss:0.09335881471633911, sep_loss:0.026176471263170242, soft_orth_loss:0.006473480258136988, local_consistency_loss:0.0004056853358633816, proto_loss:0.1264144480228424
2026-01-29 16:04:27.012 | INFO     | __main__:main_worker:429 - [62/100], remain:0d.00h.13m, It:[50/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.4182, total_loss:tensor([-0.4182], device='cuda:0'), ce_loss:0.33592894673347473, cluster_loss:0.07637874037027359, sep_loss:0.01978304050862789, soft_orth_loss:0.0064721619710326195, local_consistency_loss:5.142107329447754e-05, proto_loss:0.1026853695511818
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 86.9658, acc3: 100.0000, Precision: 0.7902, Recall: 0.8109, F1-Score: 0.7991, Specificity: 0.9265
2026-01-29 16:04:36.495 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [62/100], Top1:86.966, Top3:100.000, Test_precision:0.7902,Test_recall:0.8109,Test_f1:0.7991,,Test_specificity:0.9265 Test_loss:0.382330
2026-01-29 16:04:36.496 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:04:36.497 | INFO     | __main__:main_worker:355 - ---> start train epoch63
2026-01-29 16:04:45.130 | INFO     | __main__:main_worker:429 - [63/100], remain:0d.00h.14m, It:[10/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:0.5483, total_loss:tensor([0.5483], device='cuda:0'), ce_loss:0.8260814547538757, cluster_loss:0.1465705782175064, sep_loss:0.04024768993258476, soft_orth_loss:0.0064701116643846035, local_consistency_loss:0.0005282533820718527, proto_loss:0.1938166320323944
2026-01-29 16:04:50.294 | INFO     | __main__:main_worker:429 - [63/100], remain:0d.00h.15m, It:[20/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:0.3476, total_loss:tensor([0.3476], device='cuda:0'), ce_loss:0.7392662167549133, cluster_loss:0.13314533233642578, sep_loss:0.02330697886645794, soft_orth_loss:0.006468750070780516, local_consistency_loss:7.254251977428794e-05, proto_loss:0.16299359500408173
2026-01-29 16:04:53.941 | INFO     | __main__:main_worker:429 - [63/100], remain:0d.00h.14m, It:[30/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.2985, total_loss:tensor([-0.2985], device='cuda:0'), ce_loss:0.4198232591152191, cluster_loss:0.06410589069128036, sep_loss:0.0248724352568388, soft_orth_loss:0.006468662526458502, local_consistency_loss:0.00029812572756782174, proto_loss:0.09574511647224426
2026-01-29 16:04:57.804 | INFO     | __main__:main_worker:429 - [63/100], remain:0d.00h.13m, It:[40/54], Max-Mem:11245M, Data-Time:0.007, LR:0.0000, Train_Loss:0.0229, total_loss:tensor([0.0229], device='cuda:0'), ce_loss:0.5775109529495239, cluster_loss:0.09304843097925186, sep_loss:0.030549174174666405, soft_orth_loss:0.006468001287430525, local_consistency_loss:0.00025736968382261693, proto_loss:0.13032297790050507
2026-01-29 16:05:02.023 | INFO     | __main__:main_worker:429 - [63/100], remain:0d.00h.13m, It:[50/54], Max-Mem:11245M, Data-Time:0.007, LR:0.0000, Train_Loss:0.0785, total_loss:tensor([0.0785], device='cuda:0'), ce_loss:0.5999661087989807, cluster_loss:0.10359311103820801, sep_loss:0.029899973422288895, soft_orth_loss:0.006466884631663561, local_consistency_loss:0.00022532795264851302, proto_loss:0.14018529653549194
Evaluating: 100%|| 15/15 [00:07<00:00,  1.88it/s]
2026-01-29 16:05:11.515 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [63/100], Top1:85.470, Top3:100.000, Test_precision:0.7504,Test_recall:0.7826,Test_f1:0.7646,,Test_specificity:0.9211 Test_loss:0.388473
2026-01-29 16:05:11.516 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:05:11.516 | INFO     | __main__:main_worker:355 - ---> start train epoch64
acc1: 85.4701, acc3: 100.0000, Precision: 0.7504, Recall: 0.7826, F1-Score: 0.7646, Specificity: 0.9211
2026-01-29 16:05:19.844 | INFO     | __main__:main_worker:429 - [64/100], remain:0d.00h.12m, It:[10/54], Max-Mem:11245M, Data-Time:0.393, LR:0.0000, Train_Loss:0.1271, total_loss:tensor([0.1271], device='cuda:0'), ce_loss:0.624930202960968, cluster_loss:0.10930963605642319, sep_loss:0.0280798077583313, soft_orth_loss:0.006465395912528038, local_consistency_loss:0.0007373970001935959, proto_loss:0.14459224045276642
2026-01-29 16:05:23.670 | INFO     | __main__:main_worker:429 - [64/100], remain:0d.00h.12m, It:[20/54], Max-Mem:11245M, Data-Time:0.018, LR:0.0000, Train_Loss:0.1537, total_loss:tensor([0.1537], device='cuda:0'), ce_loss:0.6357817053794861, cluster_loss:0.10987081378698349, sep_loss:0.03204387053847313, soft_orth_loss:0.0064656659960746765, local_consistency_loss:0.0009153541177511215, proto_loss:0.14929568767547607
2026-01-29 16:05:28.019 | INFO     | __main__:main_worker:429 - [64/100], remain:0d.00h.12m, It:[30/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.2736, total_loss:tensor([-0.2736], device='cuda:0'), ce_loss:0.4062894284725189, cluster_loss:0.08915839344263077, sep_loss:0.023553406819701195, soft_orth_loss:0.0064656976610422134, local_consistency_loss:0.00046489780652336776, proto_loss:0.11964239925146103
2026-01-29 16:05:32.625 | INFO     | __main__:main_worker:429 - [64/100], remain:0d.00h.13m, It:[40/54], Max-Mem:11245M, Data-Time:0.015, LR:0.0000, Train_Loss:-0.1016, total_loss:tensor([-0.1016], device='cuda:0'), ce_loss:0.5052575469017029, cluster_loss:0.09723388403654099, sep_loss:0.022417834028601646, soft_orth_loss:0.006465165410190821, local_consistency_loss:0.00031796819530427456, proto_loss:0.12643484771251678
2026-01-29 16:05:36.618 | INFO     | __main__:main_worker:429 - [64/100], remain:0d.00h.13m, It:[50/54], Max-Mem:11245M, Data-Time:0.008, LR:0.0000, Train_Loss:-0.0970, total_loss:tensor([-0.0970], device='cuda:0'), ce_loss:0.518047571182251, cluster_loss:0.08145596086978912, sep_loss:0.030134165659546852, soft_orth_loss:0.006465305108577013, local_consistency_loss:0.0005253726267255843, proto_loss:0.11858080327510834
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-29 16:05:38.454 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 64 (LR=0.000031, momentum=0.85)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.7020
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.6411
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.6001
Local prototype push completed!
2026-01-29 16:06:02.944 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 79.9145, acc3: 100.0000, Precision: 0.6162, Recall: 0.6255, F1-Score: 0.6202, Specificity: 0.8913
2026-01-29 16:06:11.125 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [64/100], Top1:79.915, Top3:100.000, Test_precision:0.6162,Test_recall:0.6255,Test_f1:0.6202,,Test_specificity:0.8913 Test_loss:0.663332
2026-01-29 16:06:11.126 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:06:11.127 | INFO     | __main__:main_worker:355 - ---> start train epoch65
2026-01-29 16:06:20.946 | INFO     | __main__:main_worker:429 - [65/100], remain:0d.00h.16m, It:[10/54], Max-Mem:11245M, Data-Time:1.293, LR:0.0000, Train_Loss:0.0358, total_loss:tensor([0.0358], device='cuda:0'), ce_loss:0.5647510886192322, cluster_loss:0.11879902333021164, sep_loss:0.021571923047304153, soft_orth_loss:0.007100977934896946, local_consistency_loss:0.00020387452968861908, proto_loss:0.14767581224441528
2026-01-29 16:06:24.885 | INFO     | __main__:main_worker:429 - [65/100], remain:0d.00h.14m, It:[20/54], Max-Mem:11245M, Data-Time:0.447, LR:0.0000, Train_Loss:0.2477, total_loss:tensor([0.2477], device='cuda:0'), ce_loss:0.8363314270973206, cluster_loss:0.0003066125209443271, sep_loss:0.028421226888895035, soft_orth_loss:0.007094570901244879, local_consistency_loss:6.378220132319257e-05, proto_loss:0.035886190831661224
2026-01-29 16:06:29.009 | INFO     | __main__:main_worker:429 - [65/100], remain:0d.00h.13m, It:[30/54], Max-Mem:11245M, Data-Time:0.211, LR:0.0000, Train_Loss:-0.2165, total_loss:tensor([-0.2165], device='cuda:0'), ce_loss:0.43138253688812256, cluster_loss:0.09539895504713058, sep_loss:0.025858718901872635, soft_orth_loss:0.007090399041771889, local_consistency_loss:0.000333345087710768, proto_loss:0.12868142127990723
2026-01-29 16:06:32.948 | INFO     | __main__:main_worker:429 - [65/100], remain:0d.00h.13m, It:[40/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0000, Train_Loss:0.2083, total_loss:tensor([0.2083], device='cuda:0'), ce_loss:0.6751891374588013, cluster_loss:0.11059542745351791, sep_loss:0.02750113047659397, soft_orth_loss:0.007089508697390556, local_consistency_loss:0.0003960519970860332, proto_loss:0.14558212459087372
2026-01-29 16:06:37.829 | INFO     | __main__:main_worker:429 - [65/100], remain:0d.00h.13m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.4582, total_loss:tensor([-0.4582], device='cuda:0'), ce_loss:0.31960222125053406, cluster_loss:0.06573023647069931, sep_loss:0.024752264842391014, soft_orth_loss:0.00708926422521472, local_consistency_loss:6.140976620372385e-05, proto_loss:0.09763317555189133
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 83.1197, acc3: 100.0000, Precision: 0.7142, Recall: 0.7100, F1-Score: 0.7109, Specificity: 0.8999
2026-01-29 16:06:47.547 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [65/100], Top1:83.120, Top3:100.000, Test_precision:0.7142,Test_recall:0.7100,Test_f1:0.7109,,Test_specificity:0.8999 Test_loss:0.393420
2026-01-29 16:06:47.548 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:06:57.750 | INFO     | __main__:main_worker:355 - ---> start train epoch66
2026-01-29 16:07:06.767 | INFO     | __main__:main_worker:429 - [66/100], remain:0d.00h.14m, It:[10/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0000, Train_Loss:-0.3937, total_loss:tensor([-0.3937], device='cuda:0'), ce_loss:0.35821276903152466, cluster_loss:0.06665775179862976, sep_loss:0.025298437103629112, soft_orth_loss:0.007087914738804102, local_consistency_loss:7.149102020775899e-05, proto_loss:0.09911559522151947
2026-01-29 16:07:10.684 | INFO     | __main__:main_worker:429 - [66/100], remain:0d.00h.13m, It:[20/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.2579, total_loss:tensor([-0.2579], device='cuda:0'), ce_loss:0.4455948770046234, cluster_loss:0.06683740764856339, sep_loss:0.02302941493690014, soft_orth_loss:0.007086809724569321, local_consistency_loss:7.609463500557467e-05, proto_loss:0.09702972322702408
2026-01-29 16:07:14.744 | INFO     | __main__:main_worker:429 - [66/100], remain:0d.00h.12m, It:[30/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.0140, total_loss:tensor([-0.0140], device='cuda:0'), ce_loss:0.5465980172157288, cluster_loss:0.10039907693862915, sep_loss:0.030411098152399063, soft_orth_loss:0.007086306810379028, local_consistency_loss:0.00010507169645279646, proto_loss:0.13800154626369476
2026-01-29 16:07:19.410 | INFO     | __main__:main_worker:429 - [66/100], remain:0d.00h.13m, It:[40/54], Max-Mem:11245M, Data-Time:0.009, LR:0.0000, Train_Loss:-0.3127, total_loss:tensor([-0.3127], device='cuda:0'), ce_loss:0.39298972487449646, cluster_loss:0.0824362188577652, sep_loss:0.022089151665568352, soft_orth_loss:0.007086691912263632, local_consistency_loss:0.00037121903733350337, proto_loss:0.1119832843542099
2026-01-29 16:07:24.616 | INFO     | __main__:main_worker:429 - [66/100], remain:0d.00h.13m, It:[50/54], Max-Mem:11245M, Data-Time:0.008, LR:0.0000, Train_Loss:-0.3351, total_loss:tensor([-0.3351], device='cuda:0'), ce_loss:0.3775924742221832, cluster_loss:0.08191757649183273, sep_loss:0.02412145584821701, soft_orth_loss:0.007086646277457476, local_consistency_loss:9.310347377322614e-05, proto_loss:0.11321878433227539
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
2026-01-29 16:07:35.819 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [66/100], Top1:83.120, Top3:100.000, Test_precision:0.6987,Test_recall:0.7443,Test_f1:0.7147,,Test_specificity:0.9210 Test_loss:0.438509
2026-01-29 16:07:35.831 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:07:35.832 | INFO     | __main__:main_worker:355 - ---> start train epoch67
acc1: 83.1197, acc3: 100.0000, Precision: 0.6987, Recall: 0.7443, F1-Score: 0.7147, Specificity: 0.9210
2026-01-29 16:07:43.891 | INFO     | __main__:main_worker:429 - [67/100], remain:0d.00h.13m, It:[10/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.3497, total_loss:tensor([-0.3497], device='cuda:0'), ce_loss:0.37859824299812317, cluster_loss:0.07306624948978424, sep_loss:0.025058528408408165, soft_orth_loss:0.007085267920047045, local_consistency_loss:9.416965622222051e-05, proto_loss:0.10530421882867813
2026-01-29 16:07:48.136 | INFO     | __main__:main_worker:429 - [67/100], remain:0d.00h.12m, It:[20/54], Max-Mem:11245M, Data-Time:0.009, LR:0.0000, Train_Loss:-0.5045, total_loss:tensor([-0.5045], device='cuda:0'), ce_loss:0.31433311104774475, cluster_loss:0.05657438188791275, sep_loss:0.01590590924024582, soft_orth_loss:0.007083570118993521, local_consistency_loss:0.00010001298505812883, proto_loss:0.07966388016939163
2026-01-29 16:07:53.307 | INFO     | __main__:main_worker:429 - [67/100], remain:0d.00h.13m, It:[30/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.4623, total_loss:tensor([-0.4623], device='cuda:0'), ce_loss:0.30911439657211304, cluster_loss:0.07667364180088043, sep_loss:0.021018950268626213, soft_orth_loss:0.007083582226186991, local_consistency_loss:0.000235680490732193, proto_loss:0.10501185059547424
2026-01-29 16:07:58.763 | INFO     | __main__:main_worker:429 - [67/100], remain:0d.00h.14m, It:[40/54], Max-Mem:11245M, Data-Time:0.108, LR:0.0000, Train_Loss:-0.1474, total_loss:tensor([-0.1474], device='cuda:0'), ce_loss:0.48084041476249695, cluster_loss:0.09381275624036789, sep_loss:0.023148616775870323, soft_orth_loss:0.00708357198163867, local_consistency_loss:0.000571703480090946, proto_loss:0.12461665272712708
2026-01-29 16:08:02.892 | INFO     | __main__:main_worker:429 - [67/100], remain:0d.00h.13m, It:[50/54], Max-Mem:11245M, Data-Time:0.682, LR:0.0000, Train_Loss:0.1096, total_loss:tensor([0.1096], device='cuda:0'), ce_loss:0.6042338609695435, cluster_loss:0.12047480791807175, sep_loss:0.024907944723963737, soft_orth_loss:0.0070832460187375546, local_consistency_loss:0.0015714323380962014, proto_loss:0.15403743088245392
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 85.2564, acc3: 100.0000, Precision: 0.7355, Recall: 0.7680, F1-Score: 0.7490, Specificity: 0.9269
2026-01-29 16:08:12.399 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [67/100], Top1:85.256, Top3:100.000, Test_precision:0.7355,Test_recall:0.7680,Test_f1:0.7490,,Test_specificity:0.9269 Test_loss:0.372100
2026-01-29 16:08:12.399 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:08:12.400 | INFO     | __main__:main_worker:355 - ---> start train epoch68
2026-01-29 16:08:21.129 | INFO     | __main__:main_worker:429 - [68/100], remain:0d.00h.15m, It:[10/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:0.5521, total_loss:tensor([0.5521], device='cuda:0'), ce_loss:0.8448253273963928, cluster_loss:0.14419569075107574, sep_loss:0.03046935796737671, soft_orth_loss:0.0070815193466842175, local_consistency_loss:0.00033430501935072243, proto_loss:0.18208087980747223
2026-01-29 16:08:25.342 | INFO     | __main__:main_worker:429 - [68/100], remain:0d.00h.13m, It:[20/54], Max-Mem:11245M, Data-Time:0.728, LR:0.0000, Train_Loss:-0.0260, total_loss:tensor([-0.0260], device='cuda:0'), ce_loss:0.5395163297653198, cluster_loss:0.1044229045510292, sep_loss:0.02522270195186138, soft_orth_loss:0.0070809004828333855, local_consistency_loss:0.0017452320316806436, proto_loss:0.13847173750400543
2026-01-29 16:08:30.827 | INFO     | __main__:main_worker:429 - [68/100], remain:0d.00h.14m, It:[30/54], Max-Mem:11245M, Data-Time:0.492, LR:0.0000, Train_Loss:-0.1569, total_loss:tensor([-0.1569], device='cuda:0'), ce_loss:0.46140143275260925, cluster_loss:0.10142916440963745, sep_loss:0.026438308879733086, soft_orth_loss:0.007081199903041124, local_consistency_loss:0.0009480944136157632, proto_loss:0.13589677214622498
2026-01-29 16:08:35.903 | INFO     | __main__:main_worker:429 - [68/100], remain:0d.00h.14m, It:[40/54], Max-Mem:11245M, Data-Time:1.300, LR:0.0000, Train_Loss:-0.1877, total_loss:tensor([-0.1877], device='cuda:0'), ce_loss:0.4714578688144684, cluster_loss:0.08047299832105637, sep_loss:0.02441193163394928, soft_orth_loss:0.0070799863897264, local_consistency_loss:0.0006046833586879075, proto_loss:0.11256960034370422
2026-01-29 16:08:40.025 | INFO     | __main__:main_worker:429 - [68/100], remain:0d.00h.13m, It:[50/54], Max-Mem:11245M, Data-Time:0.596, LR:0.0000, Train_Loss:1.2181, total_loss:tensor([1.2181], device='cuda:0'), ce_loss:1.2358556985855103, cluster_loss:0.15258383750915527, sep_loss:0.04084775224328041, soft_orth_loss:0.007079915143549442, local_consistency_loss:0.000478213420137763, proto_loss:0.2009897083044052
Evaluating: 100%|| 15/15 [00:08<00:00,  1.80it/s]
acc1: 84.6154, acc3: 100.0000, Precision: 0.7229, Recall: 0.7660, F1-Score: 0.7398, Specificity: 0.9276
2026-01-29 16:08:49.759 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [68/100], Top1:84.615, Top3:100.000, Test_precision:0.7229,Test_recall:0.7660,Test_f1:0.7398,,Test_specificity:0.9276 Test_loss:0.397261
2026-01-29 16:08:49.760 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [1/100], Top1:88.034, Top-3:100.000
2026-01-29 16:08:49.760 | INFO     | __main__:main_worker:355 - ---> start train epoch69
2026-01-29 16:08:58.164 | INFO     | __main__:main_worker:429 - [69/100], remain:0d.00h.13m, It:[10/54], Max-Mem:11245M, Data-Time:0.232, LR:0.0000, Train_Loss:0.0085, total_loss:tensor([0.0085], device='cuda:0'), ce_loss:0.687725305557251, cluster_loss:0.00021907394693698734, sep_loss:0.029871150851249695, soft_orth_loss:0.007080283015966415, local_consistency_loss:0.000243203598074615, proto_loss:0.03741370886564255
2026-01-29 16:09:03.145 | INFO     | __main__:main_worker:429 - [69/100], remain:0d.00h.13m, It:[20/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0000, Train_Loss:-0.3753, total_loss:tensor([-0.3753], device='cuda:0'), ce_loss:0.4556955099105835, cluster_loss:0.0001827124215196818, sep_loss:0.024696096777915955, soft_orth_loss:0.00707980478182435, local_consistency_loss:0.00011089047620771453, proto_loss:0.032069504261016846
2026-01-29 16:09:08.134 | INFO     | __main__:main_worker:429 - [69/100], remain:0d.00h.13m, It:[30/54], Max-Mem:11245M, Data-Time:0.584, LR:0.0000, Train_Loss:0.2421, total_loss:tensor([0.2421], device='cuda:0'), ce_loss:0.7117005586624146, cluster_loss:0.09940533339977264, sep_loss:0.0274012740701437, soft_orth_loss:0.0070793647319078445, local_consistency_loss:0.0007676910026930273, proto_loss:0.13465365767478943
2026-01-29 16:09:12.601 | INFO     | __main__:main_worker:429 - [69/100], remain:0d.00h.13m, It:[40/54], Max-Mem:11245M, Data-Time:0.184, LR:0.0000, Train_Loss:-0.2906, total_loss:tensor([-0.2906], device='cuda:0'), ce_loss:0.3965921700000763, cluster_loss:0.09169027209281921, sep_loss:0.022892413660883904, soft_orth_loss:0.007078679744154215, local_consistency_loss:3.994984945165925e-05, proto_loss:0.12170131504535675
2026-01-29 16:09:17.161 | INFO     | __main__:main_worker:429 - [69/100], remain:0d.00h.12m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:-0.0907, total_loss:tensor([-0.0907], device='cuda:0'), ce_loss:0.49691808223724365, cluster_loss:0.1075531393289566, sep_loss:0.026108769699931145, soft_orth_loss:0.007078714203089476, local_consistency_loss:0.000268017960479483, proto_loss:0.1410086303949356
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
acc1: 88.2479, acc3: 100.0000, Precision: 0.8293, Recall: 0.7934, F1-Score: 0.8033, Specificity: 0.9327
2026-01-29 16:09:27.835 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [69/100], Top1:88.248, Top3:100.000, Test_precision:0.8293,Test_recall:0.7934,Test_f1:0.8033,,Test_specificity:0.9327 Test_loss:0.384188
2026-01-29 16:09:27.836 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:09:47.025 | INFO     | __main__:main_worker:355 - ---> start train epoch70
2026-01-29 16:09:56.363 | INFO     | __main__:main_worker:429 - [70/100], remain:0d.00h.12m, It:[10/54], Max-Mem:11245M, Data-Time:1.028, LR:0.0000, Train_Loss:-0.2152, total_loss:tensor([-0.2152], device='cuda:0'), ce_loss:0.47536909580230713, cluster_loss:0.07149674743413925, sep_loss:0.017667291685938835, soft_orth_loss:0.007079212460666895, local_consistency_loss:0.00020722593762911856, proto_loss:0.09645047783851624
2026-01-29 16:10:01.013 | INFO     | __main__:main_worker:429 - [70/100], remain:0d.00h.12m, It:[20/54], Max-Mem:11245M, Data-Time:1.220, LR:0.0000, Train_Loss:-0.1797, total_loss:tensor([-0.1797], device='cuda:0'), ce_loss:0.46944335103034973, cluster_loss:0.0889957919716835, sep_loss:0.022619526833295822, soft_orth_loss:0.007078839465975761, local_consistency_loss:0.00022320945572573692, proto_loss:0.11891736835241318
2026-01-29 16:10:04.936 | INFO     | __main__:main_worker:429 - [70/100], remain:0d.00h.11m, It:[30/54], Max-Mem:11245M, Data-Time:0.484, LR:0.0000, Train_Loss:0.5365, total_loss:tensor([0.5365], device='cuda:0'), ce_loss:0.8618060946464539, cluster_loss:0.11489887535572052, sep_loss:0.03892955929040909, soft_orth_loss:0.007078294642269611, local_consistency_loss:0.00043334788642823696, proto_loss:0.16134007275104523
2026-01-29 16:10:09.050 | INFO     | __main__:main_worker:429 - [70/100], remain:0d.00h.11m, It:[40/54], Max-Mem:11245M, Data-Time:0.204, LR:0.0000, Train_Loss:-0.2048, total_loss:tensor([-0.2048], device='cuda:0'), ce_loss:0.46906349062919617, cluster_loss:0.07279326766729355, sep_loss:0.026546508073806763, soft_orth_loss:0.00707754772156477, local_consistency_loss:0.00048400001833215356, proto_loss:0.10690131783485413
2026-01-29 16:10:13.834 | INFO     | __main__:main_worker:429 - [70/100], remain:0d.00h.11m, It:[50/54], Max-Mem:11245M, Data-Time:0.818, LR:0.0000, Train_Loss:-0.3001, total_loss:tensor([-0.3001], device='cuda:0'), ce_loss:0.42708197236061096, cluster_loss:0.06659746170043945, sep_loss:0.019396763294935226, soft_orth_loss:0.007076981943100691, local_consistency_loss:7.978555368026718e-05, proto_loss:0.09315099567174911
Evaluating: 100%|| 15/15 [00:08<00:00,  1.81it/s]
acc1: 84.1880, acc3: 100.0000, Precision: 0.7095, Recall: 0.7346, F1-Score: 0.7204, Specificity: 0.9188
2026-01-29 16:10:23.507 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [70/100], Top1:84.188, Top3:100.000, Test_precision:0.7095,Test_recall:0.7346,Test_f1:0.7204,,Test_specificity:0.9188 Test_loss:0.388281
2026-01-29 16:10:23.508 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:10:32.870 | INFO     | __main__:main_worker:355 - ---> start train epoch71
2026-01-29 16:10:40.912 | INFO     | __main__:main_worker:429 - [71/100], remain:0d.00h.11m, It:[10/54], Max-Mem:11245M, Data-Time:0.063, LR:0.0000, Train_Loss:-0.2580, total_loss:tensor([-0.2580], device='cuda:0'), ce_loss:0.4340144395828247, cluster_loss:0.07741522789001465, sep_loss:0.023719482123851776, soft_orth_loss:0.0070760720409452915, local_consistency_loss:0.0004284681344870478, proto_loss:0.10863924771547318
2026-01-29 16:10:46.015 | INFO     | __main__:main_worker:429 - [71/100], remain:0d.00h.12m, It:[20/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:0.4372, total_loss:tensor([0.4372], device='cuda:0'), ce_loss:0.7910803556442261, cluster_loss:0.128547802567482, sep_loss:0.03263038396835327, soft_orth_loss:0.007074825465679169, local_consistency_loss:0.00044872378930449486, proto_loss:0.16870172321796417
2026-01-29 16:10:50.360 | INFO     | __main__:main_worker:429 - [71/100], remain:0d.00h.11m, It:[30/54], Max-Mem:11245M, Data-Time:0.009, LR:0.0000, Train_Loss:-0.0786, total_loss:tensor([-0.0786], device='cuda:0'), ce_loss:0.5194832682609558, cluster_loss:0.09145238250494003, sep_loss:0.03007807396352291, soft_orth_loss:0.00707379961386323, local_consistency_loss:0.00099937804043293, proto_loss:0.12960363924503326
2026-01-29 16:10:53.888 | INFO     | __main__:main_worker:429 - [71/100], remain:0d.00h.11m, It:[40/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:0.2704, total_loss:tensor([0.2704], device='cuda:0'), ce_loss:0.7549249529838562, cluster_loss:0.06807327270507812, sep_loss:0.03963435813784599, soft_orth_loss:0.007073681335896254, local_consistency_loss:8.046939910855144e-05, proto_loss:0.11486177891492844
2026-01-29 16:10:58.119 | INFO     | __main__:main_worker:429 - [71/100], remain:0d.00h.10m, It:[50/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:0.2006, total_loss:tensor([0.2006], device='cuda:0'), ce_loss:0.6841267347335815, cluster_loss:0.0943102315068245, sep_loss:0.03525811433792114, soft_orth_loss:0.007073680404573679, local_consistency_loss:0.00019385646737646312, proto_loss:0.13683587312698364
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
2026-01-29 16:11:07.669 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [71/100], Top1:85.470, Top3:100.000, Test_precision:0.7406,Test_recall:0.7598,Test_f1:0.7472,,Test_specificity:0.9261 Test_loss:0.369452
2026-01-29 16:11:07.670 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:11:07.670 | INFO     | __main__:main_worker:355 - ---> start train epoch72
acc1: 85.4701, acc3: 100.0000, Precision: 0.7406, Recall: 0.7598, F1-Score: 0.7472, Specificity: 0.9261
2026-01-29 16:11:16.397 | INFO     | __main__:main_worker:429 - [72/100], remain:0d.00h.11m, It:[10/54], Max-Mem:11245M, Data-Time:0.579, LR:0.0000, Train_Loss:-0.1292, total_loss:tensor([-0.1292], device='cuda:0'), ce_loss:0.47769591212272644, cluster_loss:0.08938731998205185, sep_loss:0.0275148693472147, soft_orth_loss:0.007073081564158201, local_consistency_loss:0.01412192452698946, proto_loss:0.13809719681739807
2026-01-29 16:11:20.213 | INFO     | __main__:main_worker:429 - [72/100], remain:0d.00h.10m, It:[20/54], Max-Mem:11245M, Data-Time:0.065, LR:0.0000, Train_Loss:0.1320, total_loss:tensor([0.1320], device='cuda:0'), ce_loss:0.7618767023086548, cluster_loss:0.00021868546900805086, sep_loss:0.033154260367155075, soft_orth_loss:0.007072605192661285, local_consistency_loss:0.00035374119761399925, proto_loss:0.04079929366707802
2026-01-29 16:11:25.760 | INFO     | __main__:main_worker:429 - [72/100], remain:0d.00h.11m, It:[30/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0000, Train_Loss:0.4181, total_loss:tensor([0.4181], device='cuda:0'), ce_loss:0.7970125675201416, cluster_loss:0.10997410118579865, sep_loss:0.03577662631869316, soft_orth_loss:0.007072029169648886, local_consistency_loss:0.001981864683330059, proto_loss:0.15480463206768036
2026-01-29 16:11:30.093 | INFO     | __main__:main_worker:429 - [72/100], remain:0d.00h.11m, It:[40/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.2717, total_loss:tensor([-0.2717], device='cuda:0'), ce_loss:0.43277138471603394, cluster_loss:0.07401686161756516, sep_loss:0.022279130294919014, soft_orth_loss:0.007072038482874632, local_consistency_loss:8.551177597837523e-05, proto_loss:0.10345353931188583
2026-01-29 16:11:34.235 | INFO     | __main__:main_worker:429 - [72/100], remain:0d.00h.11m, It:[50/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.0312, total_loss:tensor([-0.0312], device='cuda:0'), ce_loss:0.5724420547485352, cluster_loss:0.0736885666847229, sep_loss:0.03034554235637188, soft_orth_loss:0.007071855943650007, local_consistency_loss:0.00021084332547616214, proto_loss:0.11131680756807327
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-29 16:11:36.565 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 72 (LR=0.000020, momentum=0.85)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.6851
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.6332
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.6645
Local prototype push completed!
2026-01-29 16:12:01.213 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
acc1: 84.4017, acc3: 100.0000, Precision: 0.7283, Recall: 0.7720, F1-Score: 0.7448, Specificity: 0.9190
2026-01-29 16:12:09.304 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [72/100], Top1:84.402, Top3:100.000, Test_precision:0.7283,Test_recall:0.7720,Test_f1:0.7448,,Test_specificity:0.9190 Test_loss:0.508175
2026-01-29 16:12:09.305 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:12:09.306 | INFO     | __main__:main_worker:355 - ---> start train epoch73
2026-01-29 16:12:18.777 | INFO     | __main__:main_worker:429 - [73/100], remain:0d.00h.11m, It:[10/54], Max-Mem:11245M, Data-Time:1.232, LR:0.0000, Train_Loss:-0.0246, total_loss:tensor([-0.0246], device='cuda:0'), ce_loss:0.667494535446167, cluster_loss:0.00033412346965633333, sep_loss:0.03073437511920929, soft_orth_loss:0.007663652300834656, local_consistency_loss:5.429442899185233e-05, proto_loss:0.03878644481301308
2026-01-29 16:12:22.535 | INFO     | __main__:main_worker:429 - [73/100], remain:0d.00h.10m, It:[20/54], Max-Mem:11245M, Data-Time:0.279, LR:0.0000, Train_Loss:0.0688, total_loss:tensor([0.0688], device='cuda:0'), ce_loss:0.6192827820777893, cluster_loss:0.08109090477228165, sep_loss:0.03480983525514603, soft_orth_loss:0.0076624141074717045, local_consistency_loss:9.595989104127511e-05, proto_loss:0.12365911900997162
2026-01-29 16:12:27.689 | INFO     | __main__:main_worker:429 - [73/100], remain:0d.00h.10m, It:[30/54], Max-Mem:11245M, Data-Time:1.644, LR:0.0000, Train_Loss:-0.0113, total_loss:tensor([-0.0113], device='cuda:0'), ce_loss:0.5654352307319641, cluster_loss:0.09137815237045288, sep_loss:0.027362262830138206, soft_orth_loss:0.007662181276828051, local_consistency_loss:0.0005566318868659437, proto_loss:0.12695923447608948
2026-01-29 16:12:32.646 | INFO     | __main__:main_worker:429 - [73/100], remain:0d.00h.11m, It:[40/54], Max-Mem:11245M, Data-Time:1.488, LR:0.0000, Train_Loss:0.4717, total_loss:tensor([0.4717], device='cuda:0'), ce_loss:0.8159118890762329, cluster_loss:0.12848083674907684, sep_loss:0.030178407207131386, soft_orth_loss:0.007661418057978153, local_consistency_loss:0.0002270577970193699, proto_loss:0.1665477305650711
2026-01-29 16:12:36.157 | INFO     | __main__:main_worker:429 - [73/100], remain:0d.00h.10m, It:[50/54], Max-Mem:11245M, Data-Time:0.052, LR:0.0000, Train_Loss:-0.5736, total_loss:tensor([-0.5736], device='cuda:0'), ce_loss:0.2579910457134247, cluster_loss:0.06978113204240799, sep_loss:0.01611238531768322, soft_orth_loss:0.007659883238375187, local_consistency_loss:0.0001976037019630894, proto_loss:0.09375100582838058
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
acc1: 87.1795, acc3: 100.0000, Precision: 0.7837, Recall: 0.8417, F1-Score: 0.8077, Specificity: 0.9345
2026-01-29 16:12:45.707 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [73/100], Top1:87.179, Top3:100.000, Test_precision:0.7837,Test_recall:0.8417,Test_f1:0.8077,,Test_specificity:0.9345 Test_loss:0.338233
2026-01-29 16:12:45.708 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:12:45.709 | INFO     | __main__:main_worker:355 - ---> start train epoch74
2026-01-29 16:12:55.717 | INFO     | __main__:main_worker:429 - [74/100], remain:0d.00h.12m, It:[10/54], Max-Mem:11245M, Data-Time:1.662, LR:0.0000, Train_Loss:-0.1068, total_loss:tensor([-0.1068], device='cuda:0'), ce_loss:0.5048662424087524, cluster_loss:0.08997540175914764, sep_loss:0.030320698395371437, soft_orth_loss:0.0076583134941756725, local_consistency_loss:0.00022152790916152298, proto_loss:0.12817592918872833
2026-01-29 16:13:00.825 | INFO     | __main__:main_worker:429 - [74/100], remain:0d.00h.12m, It:[20/54], Max-Mem:11245M, Data-Time:1.609, LR:0.0000, Train_Loss:-0.2601, total_loss:tensor([-0.2601], device='cuda:0'), ce_loss:0.41789522767066956, cluster_loss:0.09294428676366806, sep_loss:0.020941810682415962, soft_orth_loss:0.007657457608729601, local_consistency_loss:0.00013245870650280267, proto_loss:0.1216760128736496
2026-01-29 16:13:05.066 | INFO     | __main__:main_worker:429 - [74/100], remain:0d.00h.11m, It:[30/54], Max-Mem:11245M, Data-Time:0.727, LR:0.0000, Train_Loss:-0.2712, total_loss:tensor([-0.2712], device='cuda:0'), ce_loss:0.5169699788093567, cluster_loss:0.00019046779198106378, sep_loss:0.029184192419052124, soft_orth_loss:0.007656590081751347, local_consistency_loss:0.0001616479567019269, proto_loss:0.037192899733781815
2026-01-29 16:13:09.066 | INFO     | __main__:main_worker:429 - [74/100], remain:0d.00h.10m, It:[40/54], Max-Mem:11245M, Data-Time:0.586, LR:0.0000, Train_Loss:0.0331, total_loss:tensor([0.0331], device='cuda:0'), ce_loss:0.5805267691612244, cluster_loss:0.0983676090836525, sep_loss:0.030813036486506462, soft_orth_loss:0.00765588041394949, local_consistency_loss:0.0004464024386834353, proto_loss:0.13728292286396027
2026-01-29 16:13:13.410 | INFO     | __main__:main_worker:429 - [74/100], remain:0d.00h.10m, It:[50/54], Max-Mem:11245M, Data-Time:0.794, LR:0.0000, Train_Loss:0.1386, total_loss:tensor([0.1386], device='cuda:0'), ce_loss:0.617043137550354, cluster_loss:0.11651978641748428, sep_loss:0.036158930510282516, soft_orth_loss:0.007655883673578501, local_consistency_loss:0.00014959413965698332, proto_loss:0.1604841947555542
Evaluating: 100%|| 15/15 [00:07<00:00,  1.88it/s]
acc1: 87.3932, acc3: 100.0000, Precision: 0.7872, Recall: 0.8043, F1-Score: 0.7949, Specificity: 0.9288
2026-01-29 16:13:22.809 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [74/100], Top1:87.393, Top3:100.000, Test_precision:0.7872,Test_recall:0.8043,Test_f1:0.7949,,Test_specificity:0.9288 Test_loss:0.348043
2026-01-29 16:13:22.811 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:13:22.812 | INFO     | __main__:main_worker:355 - ---> start train epoch75
2026-01-29 16:13:31.685 | INFO     | __main__:main_worker:429 - [75/100], remain:0d.00h.11m, It:[10/54], Max-Mem:11245M, Data-Time:0.549, LR:0.0000, Train_Loss:-0.4764, total_loss:tensor([-0.4764], device='cuda:0'), ce_loss:0.32465600967407227, cluster_loss:0.06360400468111038, sep_loss:0.01765528880059719, soft_orth_loss:0.007656480651348829, local_consistency_loss:0.00037433195393532515, proto_loss:0.08929010480642319
2026-01-29 16:13:35.623 | INFO     | __main__:main_worker:429 - [75/100], remain:0d.00h.10m, It:[20/54], Max-Mem:11245M, Data-Time:0.207, LR:0.0000, Train_Loss:-0.1904, total_loss:tensor([-0.1904], device='cuda:0'), ce_loss:0.48783671855926514, cluster_loss:0.06929361820220947, sep_loss:0.023162370547652245, soft_orth_loss:0.0076567018404603004, local_consistency_loss:0.0006529721431434155, proto_loss:0.100765660405159
2026-01-29 16:13:39.917 | INFO     | __main__:main_worker:429 - [75/100], remain:0d.00h.09m, It:[30/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0000, Train_Loss:0.1857, total_loss:tensor([0.1857], device='cuda:0'), ce_loss:0.7956230044364929, cluster_loss:0.00023883879475761205, sep_loss:0.033418137580156326, soft_orth_loss:0.007656581234186888, local_consistency_loss:0.0001640773843973875, proto_loss:0.04147763550281525
2026-01-29 16:13:45.361 | INFO     | __main__:main_worker:429 - [75/100], remain:0d.00h.10m, It:[40/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0000, Train_Loss:-0.4670, total_loss:tensor([-0.4670], device='cuda:0'), ce_loss:0.33976370096206665, cluster_loss:0.05736813694238663, sep_loss:0.0168294794857502, soft_orth_loss:0.007656289264559746, local_consistency_loss:0.00020264550403226167, proto_loss:0.08205655962228775
2026-01-29 16:13:49.913 | INFO     | __main__:main_worker:429 - [75/100], remain:0d.00h.10m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.0404, total_loss:tensor([-0.0404], device='cuda:0'), ce_loss:0.5600511431694031, cluster_loss:0.08384048193693161, sep_loss:0.025870919227600098, soft_orth_loss:0.007656118832528591, local_consistency_loss:0.00016048307588789612, proto_loss:0.11752800643444061
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 87.1795, acc3: 100.0000, Precision: 0.7834, Recall: 0.8612, F1-Score: 0.8129, Specificity: 0.9363
2026-01-29 16:14:00.207 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [75/100], Top1:87.179, Top3:100.000, Test_precision:0.7834,Test_recall:0.8612,Test_f1:0.8129,,Test_specificity:0.9363 Test_loss:0.353432
2026-01-29 16:14:00.208 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:14:10.119 | INFO     | __main__:main_worker:355 - ---> start train epoch76
2026-01-29 16:14:21.205 | INFO     | __main__:main_worker:429 - [76/100], remain:0d.00h.11m, It:[10/54], Max-Mem:11245M, Data-Time:1.871, LR:0.0000, Train_Loss:-0.0989, total_loss:tensor([-0.0989], device='cuda:0'), ce_loss:0.5114414691925049, cluster_loss:0.08860013633966446, sep_loss:0.03109479881823063, soft_orth_loss:0.007656326051801443, local_consistency_loss:7.570476009277627e-05, proto_loss:0.12742695212364197
2026-01-29 16:14:25.887 | INFO     | __main__:main_worker:429 - [76/100], remain:0d.00h.10m, It:[20/54], Max-Mem:11245M, Data-Time:1.261, LR:0.0000, Train_Loss:0.3058, total_loss:tensor([0.3058], device='cuda:0'), ce_loss:0.7117551565170288, cluster_loss:0.13902819156646729, sep_loss:0.021081209182739258, soft_orth_loss:0.007656413596123457, local_consistency_loss:0.00019663326384034008, proto_loss:0.167962446808815
2026-01-29 16:14:29.501 | INFO     | __main__:main_worker:429 - [76/100], remain:0d.00h.09m, It:[30/54], Max-Mem:11245M, Data-Time:0.138, LR:0.0000, Train_Loss:-0.0057, total_loss:tensor([-0.0057], device='cuda:0'), ce_loss:0.5586292147636414, cluster_loss:0.10441011190414429, sep_loss:0.023512443527579308, soft_orth_loss:0.007656342349946499, local_consistency_loss:0.0004415273724589497, proto_loss:0.13602040708065033
2026-01-29 16:14:35.227 | INFO     | __main__:main_worker:429 - [76/100], remain:0d.00h.10m, It:[40/54], Max-Mem:11245M, Data-Time:2.284, LR:0.0000, Train_Loss:-0.0015, total_loss:tensor([-0.0015], device='cuda:0'), ce_loss:0.587609052658081, cluster_loss:0.0767139419913292, sep_loss:0.030229363590478897, soft_orth_loss:0.007656091824173927, local_consistency_loss:0.000437482085544616, proto_loss:0.11503688246011734
2026-01-29 16:14:38.910 | INFO     | __main__:main_worker:429 - [76/100], remain:0d.00h.09m, It:[50/54], Max-Mem:11245M, Data-Time:0.232, LR:0.0000, Train_Loss:0.5690, total_loss:tensor([0.5690], device='cuda:0'), ce_loss:0.8438026309013367, cluster_loss:0.15252624452114105, sep_loss:0.03258156776428223, soft_orth_loss:0.007655535824596882, local_consistency_loss:0.0001553759357193485, proto_loss:0.19291871786117554
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
acc1: 88.0342, acc3: 100.0000, Precision: 0.7991, Recall: 0.8401, F1-Score: 0.8171, Specificity: 0.9367
2026-01-29 16:14:48.429 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [76/100], Top1:88.034, Top3:100.000, Test_precision:0.7991,Test_recall:0.8401,Test_f1:0.8171,,Test_specificity:0.9367 Test_loss:0.349942
2026-01-29 16:14:48.432 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:14:48.434 | INFO     | __main__:main_worker:355 - ---> start train epoch77
2026-01-29 16:14:58.708 | INFO     | __main__:main_worker:429 - [77/100], remain:0d.00h.10m, It:[10/54], Max-Mem:11245M, Data-Time:1.366, LR:0.0000, Train_Loss:-0.0918, total_loss:tensor([-0.0918], device='cuda:0'), ce_loss:0.5120198130607605, cluster_loss:0.09571351110935211, sep_loss:0.02712136320769787, soft_orth_loss:0.007655378431081772, local_consistency_loss:0.00026557434466667473, proto_loss:0.13075582683086395
2026-01-29 16:15:02.275 | INFO     | __main__:main_worker:429 - [77/100], remain:0d.00h.08m, It:[20/54], Max-Mem:11245M, Data-Time:0.024, LR:0.0000, Train_Loss:-0.0542, total_loss:tensor([-0.0542], device='cuda:0'), ce_loss:0.5324642062187195, cluster_loss:0.09656908363103867, sep_loss:0.028631243854761124, soft_orth_loss:0.007655197288841009, local_consistency_loss:0.00024331535678356886, proto_loss:0.13309885561466217
2026-01-29 16:15:06.701 | INFO     | __main__:main_worker:429 - [77/100], remain:0d.00h.08m, It:[30/54], Max-Mem:11245M, Data-Time:0.482, LR:0.0000, Train_Loss:0.2402, total_loss:tensor([0.2402], device='cuda:0'), ce_loss:0.673975944519043, cluster_loss:0.12874391674995422, sep_loss:0.02899807132780552, soft_orth_loss:0.007655037567019463, local_consistency_loss:0.0004488012345973402, proto_loss:0.1658458411693573
2026-01-29 16:15:10.525 | INFO     | __main__:main_worker:429 - [77/100], remain:0d.00h.08m, It:[40/54], Max-Mem:11245M, Data-Time:0.197, LR:0.0000, Train_Loss:-0.1253, total_loss:tensor([-0.1253], device='cuda:0'), ce_loss:0.5314783453941345, cluster_loss:0.06742953509092331, sep_loss:0.023269733414053917, soft_orth_loss:0.007654822897166014, local_consistency_loss:0.00048399297520518303, proto_loss:0.09883808344602585
2026-01-29 16:15:14.191 | INFO     | __main__:main_worker:429 - [77/100], remain:0d.00h.08m, It:[50/54], Max-Mem:11245M, Data-Time:0.228, LR:0.0000, Train_Loss:-0.3522, total_loss:tensor([-0.3522], device='cuda:0'), ce_loss:0.38853880763053894, cluster_loss:0.07397971302270889, sep_loss:0.018978653475642204, soft_orth_loss:0.00765460217371583, local_consistency_loss:9.713426697999239e-05, proto_loss:0.10071010142564774
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 86.7521, acc3: 100.0000, Precision: 0.7873, Recall: 0.8284, F1-Score: 0.8052, Specificity: 0.9245
2026-01-29 16:15:24.585 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [77/100], Top1:86.752, Top3:100.000, Test_precision:0.7873,Test_recall:0.8284,Test_f1:0.8052,,Test_specificity:0.9245 Test_loss:0.350967
2026-01-29 16:15:24.586 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:15:24.587 | INFO     | __main__:main_worker:355 - ---> start train epoch78
2026-01-29 16:15:32.460 | INFO     | __main__:main_worker:429 - [78/100], remain:0d.00h.09m, It:[10/54], Max-Mem:11245M, Data-Time:0.312, LR:0.0000, Train_Loss:-0.2118, total_loss:tensor([-0.2118], device='cuda:0'), ce_loss:0.46806976199150085, cluster_loss:0.08079514652490616, sep_loss:0.018129520118236542, soft_orth_loss:0.007654184475541115, local_consistency_loss:0.00018196974997408688, proto_loss:0.10676082223653793
2026-01-29 16:15:37.216 | INFO     | __main__:main_worker:429 - [78/100], remain:0d.00h.09m, It:[20/54], Max-Mem:11245M, Data-Time:0.032, LR:0.0000, Train_Loss:-0.2246, total_loss:tensor([-0.2246], device='cuda:0'), ce_loss:0.5517615675926208, cluster_loss:0.00019362937018740922, sep_loss:0.025846391916275024, soft_orth_loss:0.007653485983610153, local_consistency_loss:6.505045166704804e-05, proto_loss:0.033758558332920074
2026-01-29 16:15:42.210 | INFO     | __main__:main_worker:429 - [78/100], remain:0d.00h.09m, It:[30/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:0.7059, total_loss:tensor([0.7059], device='cuda:0'), ce_loss:0.9100034236907959, cluster_loss:0.17211869359016418, sep_loss:0.0280348751693964, soft_orth_loss:0.007653139531612396, local_consistency_loss:0.00017793795268516988, proto_loss:0.20798464119434357
2026-01-29 16:15:46.577 | INFO     | __main__:main_worker:429 - [78/100], remain:0d.00h.09m, It:[40/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.3722, total_loss:tensor([-0.3722], device='cuda:0'), ce_loss:0.35649940371513367, cluster_loss:0.0865003764629364, sep_loss:0.022187581285834312, soft_orth_loss:0.00765313021838665, local_consistency_loss:0.00027375546051189303, proto_loss:0.11661484837532043
2026-01-29 16:15:51.366 | INFO     | __main__:main_worker:429 - [78/100], remain:0d.00h.09m, It:[50/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.2350, total_loss:tensor([-0.2350], device='cuda:0'), ce_loss:0.538000762462616, cluster_loss:0.00019943677762057632, sep_loss:0.031696002930402756, soft_orth_loss:0.007653264328837395, local_consistency_loss:0.0001948182616615668, proto_loss:0.03974352031946182
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 88.0342, acc3: 100.0000, Precision: 0.8052, Recall: 0.8670, F1-Score: 0.8311, Specificity: 0.9378
2026-01-29 16:16:00.883 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [78/100], Top1:88.034, Top3:100.000, Test_precision:0.8052,Test_recall:0.8670,Test_f1:0.8311,,Test_specificity:0.9378 Test_loss:0.335682
2026-01-29 16:16:00.886 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:16:00.888 | INFO     | __main__:main_worker:355 - ---> start train epoch79
2026-01-29 16:16:09.051 | INFO     | __main__:main_worker:429 - [79/100], remain:0d.00h.07m, It:[10/54], Max-Mem:11245M, Data-Time:0.557, LR:0.0000, Train_Loss:0.0933, total_loss:tensor([0.0933], device='cuda:0'), ce_loss:0.6112866401672363, cluster_loss:0.10673969984054565, sep_loss:0.028977064415812492, soft_orth_loss:0.00765320286154747, local_consistency_loss:0.00018535679555498064, proto_loss:0.14355532824993134
2026-01-29 16:16:13.524 | INFO     | __main__:main_worker:429 - [79/100], remain:0d.00h.08m, It:[20/54], Max-Mem:11245M, Data-Time:1.018, LR:0.0000, Train_Loss:-0.4590, total_loss:tensor([-0.4590], device='cuda:0'), ce_loss:0.3414533734321594, cluster_loss:0.05674859508872032, sep_loss:0.021461348980665207, soft_orth_loss:0.0076528205536305904, local_consistency_loss:5.1559789426391944e-05, proto_loss:0.08591432124376297
2026-01-29 16:16:17.369 | INFO     | __main__:main_worker:429 - [79/100], remain:0d.00h.07m, It:[30/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.0724, total_loss:tensor([-0.0724], device='cuda:0'), ce_loss:0.5303799510002136, cluster_loss:0.09079793840646744, sep_loss:0.027755683287978172, soft_orth_loss:0.0076523455791175365, local_consistency_loss:7.577042561024427e-05, proto_loss:0.12628173828125
2026-01-29 16:16:22.687 | INFO     | __main__:main_worker:429 - [79/100], remain:0d.00h.08m, It:[40/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.3395, total_loss:tensor([-0.3395], device='cuda:0'), ce_loss:0.3899792432785034, cluster_loss:0.08046648651361465, sep_loss:0.017519766464829445, soft_orth_loss:0.007652438711374998, local_consistency_loss:0.0007018327014520764, proto_loss:0.10634052008390427
2026-01-29 16:16:27.071 | INFO     | __main__:main_worker:429 - [79/100], remain:0d.00h.08m, It:[50/54], Max-Mem:11245M, Data-Time:0.017, LR:0.0000, Train_Loss:-0.5697, total_loss:tensor([-0.5697], device='cuda:0'), ce_loss:0.25836506485939026, cluster_loss:0.06789819151163101, sep_loss:0.021438026800751686, soft_orth_loss:0.007652582135051489, local_consistency_loss:0.0006217822665348649, proto_loss:0.09761057794094086
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
2026-01-29 16:16:36.559 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [79/100], Top1:87.179, Top3:100.000, Test_precision:0.7868,Test_recall:0.8120,Test_f1:0.7977,,Test_specificity:0.9306 Test_loss:0.359998
2026-01-29 16:16:36.560 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:16:36.561 | INFO     | __main__:main_worker:355 - ---> start train epoch80
acc1: 87.1795, acc3: 100.0000, Precision: 0.7868, Recall: 0.8120, F1-Score: 0.7977, Specificity: 0.9306
2026-01-29 16:16:45.973 | INFO     | __main__:main_worker:429 - [80/100], remain:0d.00h.08m, It:[10/54], Max-Mem:11245M, Data-Time:0.993, LR:0.0000, Train_Loss:0.3048, total_loss:tensor([0.3048], device='cuda:0'), ce_loss:0.7304741740226746, cluster_loss:0.11562950909137726, sep_loss:0.029761528596282005, soft_orth_loss:0.007652915548533201, local_consistency_loss:0.00013048388063907623, proto_loss:0.15317443013191223
2026-01-29 16:16:49.575 | INFO     | __main__:main_worker:429 - [80/100], remain:0d.00h.07m, It:[20/54], Max-Mem:11245M, Data-Time:0.164, LR:0.0000, Train_Loss:-0.0544, total_loss:tensor([-0.0544], device='cuda:0'), ce_loss:0.5365341901779175, cluster_loss:0.09848784655332565, sep_loss:0.023160284385085106, soft_orth_loss:0.007652696687728167, local_consistency_loss:0.0011123480508103967, proto_loss:0.13041317462921143
2026-01-29 16:16:53.367 | INFO     | __main__:main_worker:429 - [80/100], remain:0d.00h.07m, It:[30/54], Max-Mem:11245M, Data-Time:0.147, LR:0.0000, Train_Loss:-0.2438, total_loss:tensor([-0.2438], device='cuda:0'), ce_loss:0.4455855190753937, cluster_loss:0.07104611396789551, sep_loss:0.030260205268859863, soft_orth_loss:0.007652432657778263, local_consistency_loss:0.0004784558550454676, proto_loss:0.10943720489740372
2026-01-29 16:16:58.173 | INFO     | __main__:main_worker:429 - [80/100], remain:0d.00h.07m, It:[40/54], Max-Mem:11245M, Data-Time:0.650, LR:0.0000, Train_Loss:-0.2897, total_loss:tensor([-0.2897], device='cuda:0'), ce_loss:0.4081011712551117, cluster_loss:0.08508817851543427, sep_loss:0.02388828806579113, soft_orth_loss:0.007652209606021643, local_consistency_loss:4.990576417185366e-05, proto_loss:0.11667858064174652
2026-01-29 16:17:01.890 | INFO     | __main__:main_worker:429 - [80/100], remain:0d.00h.07m, It:[50/54], Max-Mem:11245M, Data-Time:0.267, LR:0.0000, Train_Loss:-0.5235, total_loss:tensor([-0.5235], device='cuda:0'), ce_loss:0.30342739820480347, cluster_loss:0.06418009102344513, sep_loss:0.012571063823997974, soft_orth_loss:0.007652147673070431, local_consistency_loss:0.0003393203660380095, proto_loss:0.08474262803792953
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-29 16:17:03.894 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 80 (LR=0.000011, momentum=0.85)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.6231
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.6196
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.6083
Local prototype push completed!
2026-01-29 16:17:27.799 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 85.2564, acc3: 100.0000, Precision: 0.7332, Recall: 0.7452, F1-Score: 0.7352, Specificity: 0.9249
2026-01-29 16:17:35.946 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [80/100], Top1:85.256, Top3:100.000, Test_precision:0.7332,Test_recall:0.7452,Test_f1:0.7352,,Test_specificity:0.9249 Test_loss:0.648220
2026-01-29 16:17:35.948 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:17:45.968 | INFO     | __main__:main_worker:355 - ---> start train epoch81
2026-01-29 16:17:55.839 | INFO     | __main__:main_worker:429 - [81/100], remain:0d.00h.08m, It:[10/54], Max-Mem:11245M, Data-Time:1.410, LR:0.0000, Train_Loss:-0.2123, total_loss:tensor([-0.2123], device='cuda:0'), ce_loss:0.5545551776885986, cluster_loss:0.00018528453074395657, sep_loss:0.0297707412391901, soft_orth_loss:0.00821803230792284, local_consistency_loss:7.21563192200847e-05, proto_loss:0.038246214389801025
2026-01-29 16:18:00.516 | INFO     | __main__:main_worker:429 - [81/100], remain:0d.00h.08m, It:[20/54], Max-Mem:11245M, Data-Time:1.209, LR:0.0000, Train_Loss:-0.0104, total_loss:tensor([-0.0104], device='cuda:0'), ce_loss:0.6080387234687805, cluster_loss:0.04533728212118149, sep_loss:0.04156763106584549, soft_orth_loss:0.00821599643677473, local_consistency_loss:0.00022196269128471613, proto_loss:0.09534286707639694
2026-01-29 16:18:04.484 | INFO     | __main__:main_worker:429 - [81/100], remain:0d.00h.07m, It:[30/54], Max-Mem:11245M, Data-Time:0.450, LR:0.0000, Train_Loss:0.1953, total_loss:tensor([0.1953], device='cuda:0'), ce_loss:0.6982030868530273, cluster_loss:0.07597843557596207, sep_loss:0.0408182255923748, soft_orth_loss:0.008214842528104782, local_consistency_loss:4.4761774915969e-05, proto_loss:0.12505626678466797
2026-01-29 16:18:10.148 | INFO     | __main__:main_worker:429 - [81/100], remain:0d.00h.08m, It:[40/54], Max-Mem:11245M, Data-Time:2.129, LR:0.0000, Train_Loss:0.0620, total_loss:tensor([0.0620], device='cuda:0'), ce_loss:0.5965395569801331, cluster_loss:0.09647376835346222, sep_loss:0.03524753451347351, soft_orth_loss:0.00821403507143259, local_consistency_loss:0.00034039816819131374, proto_loss:0.1402757465839386
2026-01-29 16:18:13.736 | INFO     | __main__:main_worker:429 - [81/100], remain:0d.00h.07m, It:[50/54], Max-Mem:11245M, Data-Time:0.184, LR:0.0000, Train_Loss:0.5036, total_loss:tensor([0.5036], device='cuda:0'), ce_loss:0.8569817543029785, cluster_loss:0.09444534033536911, sep_loss:0.043854232877492905, soft_orth_loss:0.008213898167014122, local_consistency_loss:0.004226623103022575, proto_loss:0.15074008703231812
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 86.7521, acc3: 100.0000, Precision: 0.7702, Recall: 0.8111, F1-Score: 0.7874, Specificity: 0.9332
2026-01-29 16:18:23.184 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [81/100], Top1:86.752, Top3:100.000, Test_precision:0.7702,Test_recall:0.8111,Test_f1:0.7874,,Test_specificity:0.9332 Test_loss:0.398007
2026-01-29 16:18:23.186 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:18:23.187 | INFO     | __main__:main_worker:355 - ---> start train epoch82
2026-01-29 16:18:32.299 | INFO     | __main__:main_worker:429 - [82/100], remain:0d.00h.07m, It:[10/54], Max-Mem:11245M, Data-Time:0.092, LR:0.0000, Train_Loss:0.0813, total_loss:tensor([0.0813], device='cuda:0'), ce_loss:0.613814651966095, cluster_loss:0.09158390760421753, sep_loss:0.03576532378792763, soft_orth_loss:0.008213014341890812, local_consistency_loss:0.0005714826402254403, proto_loss:0.13613373041152954
2026-01-29 16:18:37.315 | INFO     | __main__:main_worker:429 - [82/100], remain:0d.00h.07m, It:[20/54], Max-Mem:11245M, Data-Time:0.798, LR:0.0000, Train_Loss:-0.0033, total_loss:tensor([-0.0033], device='cuda:0'), ce_loss:0.5691496133804321, cluster_loss:0.08791804313659668, sep_loss:0.03372839465737343, soft_orth_loss:0.008212557062506676, local_consistency_loss:0.00013177687651477754, proto_loss:0.12999075651168823
2026-01-29 16:18:41.733 | INFO     | __main__:main_worker:429 - [82/100], remain:0d.00h.07m, It:[30/54], Max-Mem:11245M, Data-Time:0.905, LR:0.0000, Train_Loss:0.0801, total_loss:tensor([0.0801], device='cuda:0'), ce_loss:0.6181718111038208, cluster_loss:0.08665294945240021, sep_loss:0.03697114810347557, soft_orth_loss:0.008212422952055931, local_consistency_loss:0.000249508855631575, proto_loss:0.13208602368831635
2026-01-29 16:18:45.446 | INFO     | __main__:main_worker:429 - [82/100], remain:0d.00h.07m, It:[40/54], Max-Mem:11245M, Data-Time:0.021, LR:0.0000, Train_Loss:0.4141, total_loss:tensor([0.4141], device='cuda:0'), ce_loss:0.7881805300712585, cluster_loss:0.11331319808959961, sep_loss:0.03895832225680351, soft_orth_loss:0.008212549611926079, local_consistency_loss:0.0010055085876956582, proto_loss:0.1614895910024643
2026-01-29 16:18:49.843 | INFO     | __main__:main_worker:429 - [82/100], remain:0d.00h.06m, It:[50/54], Max-Mem:11245M, Data-Time:0.010, LR:0.0000, Train_Loss:0.4360, total_loss:tensor([0.4360], device='cuda:0'), ce_loss:0.7789703607559204, cluster_loss:0.1373809576034546, sep_loss:0.03361080586910248, soft_orth_loss:0.008214041590690613, local_consistency_loss:0.0004485652025323361, proto_loss:0.17965437471866608
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 85.2564, acc3: 100.0000, Precision: 0.7375, Recall: 0.7801, F1-Score: 0.7552, Specificity: 0.9266
2026-01-29 16:19:00.663 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [82/100], Top1:85.256, Top3:100.000, Test_precision:0.7375,Test_recall:0.7801,Test_f1:0.7552,,Test_specificity:0.9266 Test_loss:0.555231
2026-01-29 16:19:00.664 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:19:00.664 | INFO     | __main__:main_worker:355 - ---> start train epoch83
2026-01-29 16:19:10.555 | INFO     | __main__:main_worker:429 - [83/100], remain:0d.00h.08m, It:[10/54], Max-Mem:11245M, Data-Time:1.684, LR:0.0000, Train_Loss:0.0307, total_loss:tensor([0.0307], device='cuda:0'), ce_loss:0.6105219125747681, cluster_loss:0.08061327785253525, sep_loss:0.023938065394759178, soft_orth_loss:0.008211812004446983, local_consistency_loss:0.001153797609731555, proto_loss:0.11391695588827133
2026-01-29 16:19:14.528 | INFO     | __main__:main_worker:429 - [83/100], remain:0d.00h.07m, It:[20/54], Max-Mem:11245M, Data-Time:0.565, LR:0.0000, Train_Loss:0.2310, total_loss:tensor([0.2310], device='cuda:0'), ce_loss:0.692330002784729, cluster_loss:0.10876178741455078, sep_loss:0.030193258076906204, soft_orth_loss:0.008209628984332085, local_consistency_loss:0.00042121094884350896, proto_loss:0.1475858837366104
2026-01-29 16:19:18.451 | INFO     | __main__:main_worker:429 - [83/100], remain:0d.00h.06m, It:[30/54], Max-Mem:11245M, Data-Time:0.482, LR:0.0000, Train_Loss:0.0333, total_loss:tensor([0.0333], device='cuda:0'), ce_loss:0.582858145236969, cluster_loss:0.10414289683103561, sep_loss:0.02444469928741455, soft_orth_loss:0.008208862505853176, local_consistency_loss:0.00048438459634780884, proto_loss:0.13728085160255432
2026-01-29 16:19:23.211 | INFO     | __main__:main_worker:429 - [83/100], remain:0d.00h.06m, It:[40/54], Max-Mem:11245M, Data-Time:0.893, LR:0.0000, Train_Loss:-0.0549, total_loss:tensor([-0.0549], device='cuda:0'), ce_loss:0.5354346632957458, cluster_loss:0.10276774317026138, sep_loss:0.017527764663100243, soft_orth_loss:0.008208266459405422, local_consistency_loss:0.003046432277187705, proto_loss:0.13155020773410797
2026-01-29 16:19:27.677 | INFO     | __main__:main_worker:429 - [83/100], remain:0d.00h.06m, It:[50/54], Max-Mem:11245M, Data-Time:0.791, LR:0.0000, Train_Loss:-0.0446, total_loss:tensor([-0.0446], device='cuda:0'), ce_loss:0.5505703687667847, cluster_loss:0.08693787455558777, sep_loss:0.029362473636865616, soft_orth_loss:0.008207828737795353, local_consistency_loss:8.987398905446753e-05, proto_loss:0.12459804862737656
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 84.8291, acc3: 100.0000, Precision: 0.7196, Recall: 0.7430, F1-Score: 0.7280, Specificity: 0.9238
2026-01-29 16:19:37.130 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [83/100], Top1:84.829, Top3:100.000, Test_precision:0.7196,Test_recall:0.7430,Test_f1:0.7280,,Test_specificity:0.9238 Test_loss:0.414033
2026-01-29 16:19:37.131 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:19:37.132 | INFO     | __main__:main_worker:355 - ---> start train epoch84
2026-01-29 16:19:46.844 | INFO     | __main__:main_worker:429 - [84/100], remain:0d.00h.06m, It:[10/54], Max-Mem:11245M, Data-Time:1.252, LR:0.0000, Train_Loss:-0.0008, total_loss:tensor([-0.0008], device='cuda:0'), ce_loss:0.5781946778297424, cluster_loss:0.09337000548839569, sep_loss:0.022575009614229202, soft_orth_loss:0.008207248523831367, local_consistency_loss:8.79680083016865e-05, proto_loss:0.12424022704362869
2026-01-29 16:19:51.202 | INFO     | __main__:main_worker:429 - [84/100], remain:0d.00h.06m, It:[20/54], Max-Mem:11245M, Data-Time:0.922, LR:0.0000, Train_Loss:0.2938, total_loss:tensor([0.2938], device='cuda:0'), ce_loss:0.7310101985931396, cluster_loss:0.10193689912557602, sep_loss:0.029341792687773705, soft_orth_loss:0.008206873200833797, local_consistency_loss:0.008337407372891903, proto_loss:0.14782297611236572
2026-01-29 16:19:55.802 | INFO     | __main__:main_worker:429 - [84/100], remain:0d.00h.06m, It:[30/54], Max-Mem:11245M, Data-Time:1.176, LR:0.0000, Train_Loss:-0.3325, total_loss:tensor([-0.3325], device='cuda:0'), ce_loss:0.3863263726234436, cluster_loss:0.08301839232444763, sep_loss:0.02209210768342018, soft_orth_loss:0.008206488564610481, local_consistency_loss:0.00019639055244624615, proto_loss:0.11351337283849716
2026-01-29 16:20:00.940 | INFO     | __main__:main_worker:429 - [84/100], remain:0d.00h.06m, It:[40/54], Max-Mem:11245M, Data-Time:1.737, LR:0.0000, Train_Loss:0.0412, total_loss:tensor([0.0412], device='cuda:0'), ce_loss:0.5890688896179199, cluster_loss:0.09918966144323349, sep_loss:0.02816753461956978, soft_orth_loss:0.008206130936741829, local_consistency_loss:0.0007602109690196812, proto_loss:0.13632354140281677
2026-01-29 16:20:04.424 | INFO     | __main__:main_worker:429 - [84/100], remain:0d.00h.06m, It:[50/54], Max-Mem:11245M, Data-Time:0.082, LR:0.0000, Train_Loss:0.0254, total_loss:tensor([0.0254], device='cuda:0'), ce_loss:0.5754959583282471, cluster_loss:0.1043984442949295, sep_loss:0.026459669694304466, soft_orth_loss:0.008205551654100418, local_consistency_loss:0.00030708484700880945, proto_loss:0.13937073945999146
Evaluating: 100%|| 15/15 [00:08<00:00,  1.81it/s]
acc1: 84.6154, acc3: 100.0000, Precision: 0.7108, Recall: 0.7358, F1-Score: 0.7193, Specificity: 0.9249
2026-01-29 16:20:14.028 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [84/100], Top1:84.615, Top3:100.000, Test_precision:0.7108,Test_recall:0.7358,Test_f1:0.7193,,Test_specificity:0.9249 Test_loss:0.424588
2026-01-29 16:20:14.029 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:20:14.030 | INFO     | __main__:main_worker:355 - ---> start train epoch85
2026-01-29 16:20:22.197 | INFO     | __main__:main_worker:429 - [85/100], remain:0d.00h.05m, It:[10/54], Max-Mem:11245M, Data-Time:0.131, LR:0.0000, Train_Loss:1.0291, total_loss:tensor([1.0291], device='cuda:0'), ce_loss:1.0889055728912354, cluster_loss:0.18766935169696808, sep_loss:0.029424265027046204, soft_orth_loss:0.008204879239201546, local_consistency_loss:0.00012446014443412423, proto_loss:0.2254229485988617
2026-01-29 16:20:25.776 | INFO     | __main__:main_worker:429 - [85/100], remain:0d.00h.05m, It:[20/54], Max-Mem:11245M, Data-Time:0.182, LR:0.0000, Train_Loss:-0.0176, total_loss:tensor([-0.0176], device='cuda:0'), ce_loss:0.5962391495704651, cluster_loss:0.06774349510669708, sep_loss:0.025624265894293785, soft_orth_loss:0.008204495534300804, local_consistency_loss:0.0001701743167359382, proto_loss:0.10174243152141571
2026-01-29 16:20:30.516 | INFO     | __main__:main_worker:429 - [85/100], remain:0d.00h.05m, It:[30/54], Max-Mem:11245M, Data-Time:0.544, LR:0.0000, Train_Loss:-0.0448, total_loss:tensor([-0.0448], device='cuda:0'), ce_loss:0.5433703660964966, cluster_loss:0.09485366195440292, sep_loss:0.027072597295045853, soft_orth_loss:0.00820389948785305, local_consistency_loss:0.00026721818721853197, proto_loss:0.13039737939834595
2026-01-29 16:20:35.314 | INFO     | __main__:main_worker:429 - [85/100], remain:0d.00h.05m, It:[40/54], Max-Mem:11245M, Data-Time:0.847, LR:0.0000, Train_Loss:-0.0644, total_loss:tensor([-0.0644], device='cuda:0'), ce_loss:0.5220412611961365, cluster_loss:0.10220251232385635, sep_loss:0.026870444416999817, soft_orth_loss:0.008202924393117428, local_consistency_loss:0.0004945725086145103, proto_loss:0.13777045905590057
2026-01-29 16:20:40.571 | INFO     | __main__:main_worker:429 - [85/100], remain:0d.00h.05m, It:[50/54], Max-Mem:11245M, Data-Time:1.411, LR:0.0000, Train_Loss:-0.0593, total_loss:tensor([-0.0593], device='cuda:0'), ce_loss:0.5324342846870422, cluster_loss:0.09924516826868057, sep_loss:0.02424612082540989, soft_orth_loss:0.008202082477509975, local_consistency_loss:0.0003187201509717852, proto_loss:0.13201208412647247
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 85.8974, acc3: 100.0000, Precision: 0.7475, Recall: 0.7783, F1-Score: 0.7600, Specificity: 0.9285
2026-01-29 16:20:50.127 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [85/100], Top1:85.897, Top3:100.000, Test_precision:0.7475,Test_recall:0.7783,Test_f1:0.7600,,Test_specificity:0.9285 Test_loss:0.426665
2026-01-29 16:20:50.128 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:21:00.205 | INFO     | __main__:main_worker:355 - ---> start train epoch86
2026-01-29 16:21:08.537 | INFO     | __main__:main_worker:429 - [86/100], remain:0d.00h.05m, It:[10/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:0.0192, total_loss:tensor([0.0192], device='cuda:0'), ce_loss:0.5782203078269958, cluster_loss:0.09823848307132721, sep_loss:0.0274927020072937, soft_orth_loss:0.008201434276998043, local_consistency_loss:0.0003560936020221561, proto_loss:0.1342887133359909
2026-01-29 16:21:13.250 | INFO     | __main__:main_worker:429 - [86/100], remain:0d.00h.05m, It:[20/54], Max-Mem:11245M, Data-Time:0.017, LR:0.0000, Train_Loss:-0.0531, total_loss:tensor([-0.0531], device='cuda:0'), ce_loss:0.5507932901382446, cluster_loss:0.09092088043689728, sep_loss:0.021021591499447823, soft_orth_loss:0.008201304823160172, local_consistency_loss:0.0003367266326677054, proto_loss:0.1204805001616478
2026-01-29 16:21:17.301 | INFO     | __main__:main_worker:429 - [86/100], remain:0d.00h.05m, It:[30/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:-0.3746, total_loss:tensor([-0.3746], device='cuda:0'), ce_loss:0.36684659123420715, cluster_loss:0.0791473388671875, sep_loss:0.020411072298884392, soft_orth_loss:0.0082008708268404, local_consistency_loss:0.0007130877929739654, proto_loss:0.10847236961126328
2026-01-29 16:21:22.186 | INFO     | __main__:main_worker:429 - [86/100], remain:0d.00h.05m, It:[40/54], Max-Mem:11245M, Data-Time:1.417, LR:0.0000, Train_Loss:-0.3868, total_loss:tensor([-0.3868], device='cuda:0'), ce_loss:0.4572327435016632, cluster_loss:0.000181398238055408, sep_loss:0.022118285298347473, soft_orth_loss:0.008200339041650295, local_consistency_loss:7.880054909037426e-05, proto_loss:0.030578821897506714
2026-01-29 16:21:26.599 | INFO     | __main__:main_worker:429 - [86/100], remain:0d.00h.05m, It:[50/54], Max-Mem:11245M, Data-Time:0.910, LR:0.0000, Train_Loss:-0.1816, total_loss:tensor([-0.1816], device='cuda:0'), ce_loss:0.48383527994155884, cluster_loss:0.07803113013505936, sep_loss:0.023954248055815697, soft_orth_loss:0.008200055919587612, local_consistency_loss:0.00035429734271019697, proto_loss:0.11053973436355591
Evaluating: 100%|| 15/15 [00:08<00:00,  1.87it/s]
2026-01-29 16:21:35.993 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [86/100], Top1:86.325, Top3:100.000, Test_precision:0.7676,Test_recall:0.8001,Test_f1:0.7816,,Test_specificity:0.9273 Test_loss:0.412134
2026-01-29 16:21:35.994 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:21:35.995 | INFO     | __main__:main_worker:355 - ---> start train epoch87
acc1: 86.3248, acc3: 100.0000, Precision: 0.7676, Recall: 0.8001, F1-Score: 0.7816, Specificity: 0.9273
2026-01-29 16:21:44.797 | INFO     | __main__:main_worker:429 - [87/100], remain:0d.00h.05m, It:[10/54], Max-Mem:11245M, Data-Time:0.455, LR:0.0000, Train_Loss:-0.0558, total_loss:tensor([-0.0558], device='cuda:0'), ce_loss:0.5448764562606812, cluster_loss:0.08978738635778427, sep_loss:0.025155633687973022, soft_orth_loss:0.008198698982596397, local_consistency_loss:0.0008317847969010472, proto_loss:0.12397350370883942
2026-01-29 16:21:48.743 | INFO     | __main__:main_worker:429 - [87/100], remain:0d.00h.04m, It:[20/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0000, Train_Loss:-0.4439, total_loss:tensor([-0.4439], device='cuda:0'), ce_loss:0.35484153032302856, cluster_loss:0.061476774513721466, sep_loss:0.013873400166630745, soft_orth_loss:0.008198251947760582, local_consistency_loss:0.000477661844342947, proto_loss:0.08402609080076218
2026-01-29 16:21:53.640 | INFO     | __main__:main_worker:429 - [87/100], remain:0d.00h.05m, It:[30/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:0.0764, total_loss:tensor([0.0764], device='cuda:0'), ce_loss:0.6020492911338806, cluster_loss:0.10812515020370483, sep_loss:0.026297742500901222, soft_orth_loss:0.008197656832635403, local_consistency_loss:0.0010201456025242805, proto_loss:0.1436406970024109
2026-01-29 16:21:57.752 | INFO     | __main__:main_worker:429 - [87/100], remain:0d.00h.05m, It:[40/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:0.0976, total_loss:tensor([0.0976], device='cuda:0'), ce_loss:0.6294301748275757, cluster_loss:0.09236425161361694, sep_loss:0.031433019787073135, soft_orth_loss:0.008196383714675903, local_consistency_loss:0.0002768874110188335, proto_loss:0.13227054476737976
2026-01-29 16:22:02.464 | INFO     | __main__:main_worker:429 - [87/100], remain:0d.00h.05m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:-0.5460, total_loss:tensor([-0.5460], device='cuda:0'), ce_loss:0.2765505611896515, cluster_loss:0.07009387016296387, sep_loss:0.01715727709233761, soft_orth_loss:0.008195712231099606, local_consistency_loss:0.0006387281464412808, proto_loss:0.09608559310436249
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
2026-01-29 16:22:12.622 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [87/100], Top1:86.966, Top3:100.000, Test_precision:0.7792,Test_recall:0.8136,Test_f1:0.7940,,Test_specificity:0.9310 Test_loss:0.406402
acc1: 86.9658, acc3: 100.0000, Precision: 0.7792, Recall: 0.8136, F1-Score: 0.7940, Specificity: 0.9310
2026-01-29 16:22:12.623 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:22:12.623 | INFO     | __main__:main_worker:355 - ---> start train epoch88
2026-01-29 16:22:21.605 | INFO     | __main__:main_worker:429 - [88/100], remain:0d.00h.05m, It:[10/54], Max-Mem:11245M, Data-Time:1.076, LR:0.0000, Train_Loss:0.6990, total_loss:tensor([0.6990], device='cuda:0'), ce_loss:0.9349283576011658, cluster_loss:0.14478057622909546, sep_loss:0.031335242092609406, soft_orth_loss:0.008195232599973679, local_consistency_loss:0.0011495724320411682, proto_loss:0.18546062707901
2026-01-29 16:22:25.333 | INFO     | __main__:main_worker:429 - [88/100], remain:0d.00h.04m, It:[20/54], Max-Mem:11245M, Data-Time:0.215, LR:0.0000, Train_Loss:1.0779, total_loss:tensor([1.0779], device='cuda:0'), ce_loss:1.0646957159042358, cluster_loss:0.22635145485401154, sep_loss:0.034132324159145355, soft_orth_loss:0.00819483119994402, local_consistency_loss:0.00010941171058220789, proto_loss:0.26878800988197327
2026-01-29 16:22:30.102 | INFO     | __main__:main_worker:429 - [88/100], remain:0d.00h.04m, It:[30/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0000, Train_Loss:1.9440, total_loss:tensor([1.9440], device='cuda:0'), ce_loss:1.528843879699707, cluster_loss:0.2772037088871002, sep_loss:0.03751800209283829, soft_orth_loss:0.008194607682526112, local_consistency_loss:0.0031041547190397978, proto_loss:0.3260204493999481
2026-01-29 16:22:34.237 | INFO     | __main__:main_worker:429 - [88/100], remain:0d.00h.04m, It:[40/54], Max-Mem:11245M, Data-Time:0.663, LR:0.0000, Train_Loss:-0.5321, total_loss:tensor([-0.5321], device='cuda:0'), ce_loss:0.288095623254776, cluster_loss:0.06894197314977646, sep_loss:0.016587603837251663, soft_orth_loss:0.008194506168365479, local_consistency_loss:0.0001394954015268013, proto_loss:0.0938635841012001
2026-01-29 16:22:38.059 | INFO     | __main__:main_worker:429 - [88/100], remain:0d.00h.04m, It:[50/54], Max-Mem:11245M, Data-Time:0.090, LR:0.0000, Train_Loss:0.1598, total_loss:tensor([0.1598], device='cuda:0'), ce_loss:0.7006717324256897, cluster_loss:0.06292962282896042, sep_loss:0.03464220464229584, soft_orth_loss:0.008194360882043839, local_consistency_loss:0.0005862289690412581, proto_loss:0.10635241866111755
2026-01-29 16:22:40.597 | INFO     | __main__:main_worker:470 - ---> Pushing prototypes at epoch 88 (LR=0.000005, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.6129
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.6104
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.6222
Local prototype push completed!
2026-01-29 16:23:04.687 | INFO     | __main__:main_worker:475 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
2026-01-29 16:23:12.924 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [88/100], Top1:85.043, Top3:100.000, Test_precision:0.7660,Test_recall:0.8197,Test_f1:0.7862,,Test_specificity:0.9269 Test_loss:0.455300
2026-01-29 16:23:12.925 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:23:12.926 | INFO     | __main__:main_worker:355 - ---> start train epoch89
acc1: 85.0427, acc3: 100.0000, Precision: 0.7660, Recall: 0.8197, F1-Score: 0.7862, Specificity: 0.9269
2026-01-29 16:23:22.073 | INFO     | __main__:main_worker:429 - [89/100], remain:0d.00h.04m, It:[10/54], Max-Mem:11245M, Data-Time:0.738, LR:0.0000, Train_Loss:-0.0454, total_loss:tensor([-0.0454], device='cuda:0'), ce_loss:0.4728412330150604, cluster_loss:0.15476401150226593, sep_loss:0.021769577637314796, soft_orth_loss:0.00831338856369257, local_consistency_loss:0.001728808507323265, proto_loss:0.186575785279274
2026-01-29 16:23:26.085 | INFO     | __main__:main_worker:429 - [89/100], remain:0d.00h.04m, It:[20/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0000, Train_Loss:-0.5118, total_loss:tensor([-0.5118], device='cuda:0'), ce_loss:0.2729335427284241, cluster_loss:0.08921165764331818, sep_loss:0.018077967688441277, soft_orth_loss:0.008313442580401897, local_consistency_loss:0.0003609617706388235, proto_loss:0.11596402525901794
2026-01-29 16:23:29.912 | INFO     | __main__:main_worker:429 - [89/100], remain:0d.00h.04m, It:[30/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:0.3467, total_loss:tensor([0.3467], device='cuda:0'), ce_loss:0.7315672636032104, cluster_loss:0.130713552236557, sep_loss:0.033817362040281296, soft_orth_loss:0.00831334013491869, local_consistency_loss:0.0009736932697705925, proto_loss:0.1738179475069046
2026-01-29 16:23:34.012 | INFO     | __main__:main_worker:429 - [89/100], remain:0d.00h.04m, It:[40/54], Max-Mem:11245M, Data-Time:0.014, LR:0.0000, Train_Loss:-0.2622, total_loss:tensor([-0.2622], device='cuda:0'), ce_loss:0.4277805984020233, cluster_loss:0.08566383272409439, sep_loss:0.020613616332411766, soft_orth_loss:0.008313239552080631, local_consistency_loss:0.001120878616347909, proto_loss:0.11571156978607178
2026-01-29 16:23:38.578 | INFO     | __main__:main_worker:429 - [89/100], remain:0d.00h.04m, It:[50/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:-0.2076, total_loss:tensor([-0.2076], device='cuda:0'), ce_loss:0.437280535697937, cluster_loss:0.10333909839391708, sep_loss:0.022324567660689354, soft_orth_loss:0.008313060738146305, local_consistency_loss:0.0010498965857550502, proto_loss:0.13502661883831024
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
acc1: 86.9658, acc3: 100.0000, Precision: 0.7856, Recall: 0.8183, F1-Score: 0.8000, Specificity: 0.9289
2026-01-29 16:23:48.539 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [89/100], Top1:86.966, Top3:100.000, Test_precision:0.7856,Test_recall:0.8183,Test_f1:0.8000,,Test_specificity:0.9289 Test_loss:0.400245
2026-01-29 16:23:48.540 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
2026-01-29 16:23:48.540 | INFO     | __main__:main_worker:355 - ---> start train epoch90
2026-01-29 16:23:57.869 | INFO     | __main__:main_worker:429 - [90/100], remain:0d.00h.05m, It:[10/54], Max-Mem:11245M, Data-Time:0.015, LR:0.0000, Train_Loss:-0.2740, total_loss:tensor([-0.2740], device='cuda:0'), ce_loss:0.40081754326820374, cluster_loss:0.10119304805994034, sep_loss:0.02043195627629757, soft_orth_loss:0.008312663994729519, local_consistency_loss:0.00144775805529207, proto_loss:0.1313854157924652
2026-01-29 16:24:01.432 | INFO     | __main__:main_worker:429 - [90/100], remain:0d.00h.04m, It:[20/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.3690, total_loss:tensor([-0.3690], device='cuda:0'), ce_loss:0.3874989449977875, cluster_loss:0.06542861461639404, sep_loss:0.0205999743193388, soft_orth_loss:0.008312435820698738, local_consistency_loss:0.0009127170196734369, proto_loss:0.09525374323129654
2026-01-29 16:24:05.234 | INFO     | __main__:main_worker:429 - [90/100], remain:0d.00h.03m, It:[30/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.3003, total_loss:tensor([-0.3003], device='cuda:0'), ce_loss:0.40413084626197815, cluster_loss:0.08898162841796875, sep_loss:0.01750977709889412, soft_orth_loss:0.00831213966012001, local_consistency_loss:0.0010085466783493757, proto_loss:0.11581208556890488
2026-01-29 16:24:09.931 | INFO     | __main__:main_worker:429 - [90/100], remain:0d.00h.03m, It:[40/54], Max-Mem:11245M, Data-Time:0.699, LR:0.0000, Train_Loss:-0.3126, total_loss:tensor([-0.3126], device='cuda:0'), ce_loss:0.42771583795547485, cluster_loss:0.06229531764984131, sep_loss:0.019796106964349747, soft_orth_loss:0.008311823010444641, local_consistency_loss:0.0006269662990234792, proto_loss:0.09103021025657654
2026-01-29 16:24:14.955 | INFO     | __main__:main_worker:429 - [90/100], remain:0d.00h.03m, It:[50/54], Max-Mem:11245M, Data-Time:0.695, LR:0.0000, Train_Loss:0.0516, total_loss:tensor([0.0516], device='cuda:0'), ce_loss:0.7218190431594849, cluster_loss:0.0002385874540777877, sep_loss:0.02755666710436344, soft_orth_loss:0.008311566896736622, local_consistency_loss:0.0002457505906932056, proto_loss:0.03635257109999657
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
2026-01-29 16:24:25.172 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [90/100], Top1:88.248, Top3:100.000, Test_precision:0.8043,Test_recall:0.8663,Test_f1:0.8299,,Test_specificity:0.9417 Test_loss:0.365151
2026-01-29 16:24:25.173 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [69/100], Top1:88.248, Top-3:100.000
acc1: 88.2479, acc3: 100.0000, Precision: 0.8043, Recall: 0.8663, F1-Score: 0.8299, Specificity: 0.9417
2026-01-29 16:24:35.222 | INFO     | __main__:main_worker:355 - ---> start train epoch91
2026-01-29 16:24:45.059 | INFO     | __main__:main_worker:429 - [91/100], remain:0d.00h.04m, It:[10/54], Max-Mem:11245M, Data-Time:1.772, LR:0.0000, Train_Loss:-0.4385, total_loss:tensor([-0.4385], device='cuda:0'), ce_loss:0.3636346757411957, cluster_loss:0.05659409239888191, sep_loss:0.015056739561259747, soft_orth_loss:0.008311166428029537, local_consistency_loss:9.443073940929025e-05, proto_loss:0.08005642890930176
2026-01-29 16:24:49.506 | INFO     | __main__:main_worker:429 - [91/100], remain:0d.00h.04m, It:[20/54], Max-Mem:11245M, Data-Time:0.944, LR:0.0000, Train_Loss:-0.3247, total_loss:tensor([-0.3247], device='cuda:0'), ce_loss:0.4055040180683136, cluster_loss:0.07710935920476913, sep_loss:0.01727120578289032, soft_orth_loss:0.008310980163514614, local_consistency_loss:0.0001053063097060658, proto_loss:0.10279685258865356
2026-01-29 16:24:54.027 | INFO     | __main__:main_worker:429 - [91/100], remain:0d.00h.03m, It:[30/54], Max-Mem:11245M, Data-Time:0.910, LR:0.0000, Train_Loss:-0.2301, total_loss:tensor([-0.2301], device='cuda:0'), ce_loss:0.42233750224113464, cluster_loss:0.09453451633453369, sep_loss:0.020935500040650368, soft_orth_loss:0.008310897275805473, local_consistency_loss:0.012217732146382332, proto_loss:0.1359986513853073
2026-01-29 16:24:58.345 | INFO     | __main__:main_worker:429 - [91/100], remain:0d.00h.03m, It:[40/54], Max-Mem:11245M, Data-Time:0.873, LR:0.0000, Train_Loss:-0.4134, total_loss:tensor([-0.4134], device='cuda:0'), ce_loss:0.34446385502815247, cluster_loss:0.0830584391951561, sep_loss:0.015863358974456787, soft_orth_loss:0.008310775272548199, local_consistency_loss:0.0004940423532389104, proto_loss:0.10772661119699478
2026-01-29 16:25:02.476 | INFO     | __main__:main_worker:429 - [91/100], remain:0d.00h.03m, It:[50/54], Max-Mem:11245M, Data-Time:0.123, LR:0.0000, Train_Loss:-0.3698, total_loss:tensor([-0.3698], device='cuda:0'), ce_loss:0.37046462297439575, cluster_loss:0.07854761928319931, sep_loss:0.020538542419672012, soft_orth_loss:0.008310691453516483, local_consistency_loss:0.0011133713414892554, proto_loss:0.10851022601127625
Evaluating: 100%|| 15/15 [00:08<00:00,  1.84it/s]
2026-01-29 16:25:11.992 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [91/100], Top1:88.675, Top3:100.000, Test_precision:0.8068,Test_recall:0.8611,Test_f1:0.8299,,Test_specificity:0.9418 Test_loss:0.358761
2026-01-29 16:25:11.994 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
acc1: 88.6752, acc3: 100.0000, Precision: 0.8068, Recall: 0.8611, F1-Score: 0.8299, Specificity: 0.9418
2026-01-29 16:25:30.869 | INFO     | __main__:main_worker:355 - ---> start train epoch92
2026-01-29 16:25:40.070 | INFO     | __main__:main_worker:429 - [92/100], remain:0d.00h.03m, It:[10/54], Max-Mem:11245M, Data-Time:0.439, LR:0.0000, Train_Loss:0.0440, total_loss:tensor([0.0440], device='cuda:0'), ce_loss:0.5943529009819031, cluster_loss:0.09571833163499832, sep_loss:0.02953176200389862, soft_orth_loss:0.008310521952807903, local_consistency_loss:0.0005071765626780689, proto_loss:0.13406780362129211
2026-01-29 16:25:44.787 | INFO     | __main__:main_worker:429 - [92/100], remain:0d.00h.03m, It:[20/54], Max-Mem:11245M, Data-Time:1.189, LR:0.0000, Train_Loss:-0.4214, total_loss:tensor([-0.4214], device='cuda:0'), ce_loss:0.34294503927230835, cluster_loss:0.07381133735179901, sep_loss:0.02285749278962612, soft_orth_loss:0.008310424163937569, local_consistency_loss:6.971342372708023e-05, proto_loss:0.10504896938800812
2026-01-29 16:25:48.937 | INFO     | __main__:main_worker:429 - [92/100], remain:0d.00h.03m, It:[30/54], Max-Mem:11245M, Data-Time:0.624, LR:0.0000, Train_Loss:-0.4073, total_loss:tensor([-0.4073], device='cuda:0'), ce_loss:0.4440683126449585, cluster_loss:0.00019671958580147475, sep_loss:0.02297760359942913, soft_orth_loss:0.008310309611260891, local_consistency_loss:3.755608850042336e-05, proto_loss:0.03152218833565712
2026-01-29 16:25:52.652 | INFO     | __main__:main_worker:429 - [92/100], remain:0d.00h.03m, It:[40/54], Max-Mem:11245M, Data-Time:0.251, LR:0.0000, Train_Loss:-0.2443, total_loss:tensor([-0.2443], device='cuda:0'), ce_loss:0.43006590008735657, cluster_loss:0.09000702202320099, sep_loss:0.024377238005399704, soft_orth_loss:0.008310236968100071, local_consistency_loss:0.00023329803661908954, proto_loss:0.12292779982089996
2026-01-29 16:25:56.777 | INFO     | __main__:main_worker:429 - [92/100], remain:0d.00h.03m, It:[50/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:0.6901, total_loss:tensor([0.6901], device='cuda:0'), ce_loss:0.91221022605896, cluster_loss:0.1610322743654251, sep_loss:0.02921943925321102, soft_orth_loss:0.008310250006616116, local_consistency_loss:0.0006861467845737934, proto_loss:0.19924810528755188
Evaluating: 100%|| 15/15 [00:08<00:00,  1.78it/s]
2026-01-29 16:26:06.702 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [92/100], Top1:88.034, Top3:100.000, Test_precision:0.8014,Test_recall:0.8563,Test_f1:0.8247,,Test_specificity:0.9378 Test_loss:0.358833
acc1: 88.0342, acc3: 100.0000, Precision: 0.8014, Recall: 0.8563, F1-Score: 0.8247, Specificity: 0.9378
2026-01-29 16:26:06.703 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
2026-01-29 16:26:06.703 | INFO     | __main__:main_worker:355 - ---> start train epoch93
2026-01-29 16:26:17.261 | INFO     | __main__:main_worker:429 - [93/100], remain:0d.00h.03m, It:[10/54], Max-Mem:11245M, Data-Time:0.018, LR:0.0000, Train_Loss:-0.3317, total_loss:tensor([-0.3317], device='cuda:0'), ce_loss:0.4016607403755188, cluster_loss:0.07157062739133835, sep_loss:0.020058630034327507, soft_orth_loss:0.008310200646519661, local_consistency_loss:0.0025671867188066244, proto_loss:0.10250664502382278
2026-01-29 16:26:22.224 | INFO     | __main__:main_worker:429 - [93/100], remain:0d.00h.03m, It:[20/54], Max-Mem:11245M, Data-Time:0.019, LR:0.0000, Train_Loss:0.2631, total_loss:tensor([0.2631], device='cuda:0'), ce_loss:0.6923816204071045, cluster_loss:0.11922531574964523, sep_loss:0.031114870682358742, soft_orth_loss:0.00831013172864914, local_consistency_loss:0.005331067368388176, proto_loss:0.1639813780784607
2026-01-29 16:26:26.260 | INFO     | __main__:main_worker:429 - [93/100], remain:0d.00h.03m, It:[30/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0000, Train_Loss:0.7329, total_loss:tensor([0.7329], device='cuda:0'), ce_loss:0.9421088099479675, cluster_loss:0.15965603291988373, sep_loss:0.026658138260245323, soft_orth_loss:0.008310060016810894, local_consistency_loss:0.0018827799940481782, proto_loss:0.19650700688362122
2026-01-29 16:26:31.399 | INFO     | __main__:main_worker:429 - [93/100], remain:0d.00h.03m, It:[40/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.0758, total_loss:tensor([-0.0758], device='cuda:0'), ce_loss:0.518744170665741, cluster_loss:0.10346271097660065, sep_loss:0.023128312081098557, soft_orth_loss:0.008310013450682163, local_consistency_loss:0.0004389137029647827, proto_loss:0.13533996045589447
2026-01-29 16:26:36.123 | INFO     | __main__:main_worker:429 - [93/100], remain:0d.00h.03m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.3723, total_loss:tensor([-0.3723], device='cuda:0'), ce_loss:0.35845309495925903, cluster_loss:0.08847832679748535, sep_loss:0.019795959815382957, soft_orth_loss:0.008310048840939999, local_consistency_loss:0.0003485359775368124, proto_loss:0.11693287640810013
Evaluating: 100%|| 15/15 [00:08<00:00,  1.87it/s]
acc1: 87.8205, acc3: 100.0000, Precision: 0.8014, Recall: 0.8390, F1-Score: 0.8180, Specificity: 0.9336
2026-01-29 16:26:46.455 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [93/100], Top1:87.821, Top3:100.000, Test_precision:0.8014,Test_recall:0.8390,Test_f1:0.8180,,Test_specificity:0.9336 Test_loss:0.352155
2026-01-29 16:26:46.456 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
2026-01-29 16:26:46.456 | INFO     | __main__:main_worker:355 - ---> start train epoch94
2026-01-29 16:26:55.035 | INFO     | __main__:main_worker:429 - [94/100], remain:0d.00h.02m, It:[10/54], Max-Mem:11245M, Data-Time:0.060, LR:0.0000, Train_Loss:-0.1742, total_loss:tensor([-0.1742], device='cuda:0'), ce_loss:0.46956878900527954, cluster_loss:0.08772864192724228, sep_loss:0.025062555447220802, soft_orth_loss:0.008310127072036266, local_consistency_loss:0.004935907665640116, proto_loss:0.12603722512722015
2026-01-29 16:27:00.035 | INFO     | __main__:main_worker:429 - [94/100], remain:0d.00h.02m, It:[20/54], Max-Mem:11245M, Data-Time:0.476, LR:0.0000, Train_Loss:-0.2493, total_loss:tensor([-0.2493], device='cuda:0'), ce_loss:0.45188337564468384, cluster_loss:0.06764250248670578, sep_loss:0.027144575491547585, soft_orth_loss:0.008310023695230484, local_consistency_loss:9.505767957307398e-05, proto_loss:0.10319215059280396
2026-01-29 16:27:04.702 | INFO     | __main__:main_worker:429 - [94/100], remain:0d.00h.02m, It:[30/54], Max-Mem:11245M, Data-Time:0.993, LR:0.0000, Train_Loss:-0.3933, total_loss:tensor([-0.3933], device='cuda:0'), ce_loss:0.38822463154792786, cluster_loss:0.05825323611497879, sep_loss:0.01638343185186386, soft_orth_loss:0.008309881202876568, local_consistency_loss:4.135576091357507e-05, proto_loss:0.08298790454864502
2026-01-29 16:27:09.242 | INFO     | __main__:main_worker:429 - [94/100], remain:0d.00h.02m, It:[40/54], Max-Mem:11245M, Data-Time:1.107, LR:0.0000, Train_Loss:0.1666, total_loss:tensor([0.1666], device='cuda:0'), ce_loss:0.6438773274421692, cluster_loss:0.11346220970153809, sep_loss:0.031324353069067, soft_orth_loss:0.00830977875739336, local_consistency_loss:0.0020225036423653364, proto_loss:0.15511885285377502
2026-01-29 16:27:13.079 | INFO     | __main__:main_worker:429 - [94/100], remain:0d.00h.02m, It:[50/54], Max-Mem:11245M, Data-Time:0.419, LR:0.0000, Train_Loss:-0.0067, total_loss:tensor([-0.0067], device='cuda:0'), ce_loss:0.5573524236679077, cluster_loss:0.10557384788990021, sep_loss:0.02410375326871872, soft_orth_loss:0.008309707045555115, local_consistency_loss:0.0006868472555652261, proto_loss:0.13867415487766266
Evaluating: 100%|| 15/15 [00:08<00:00,  1.82it/s]
acc1: 88.2479, acc3: 100.0000, Precision: 0.8033, Recall: 0.8575, F1-Score: 0.8264, Specificity: 0.9388
2026-01-29 16:27:22.627 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [94/100], Top1:88.248, Top3:100.000, Test_precision:0.8033,Test_recall:0.8575,Test_f1:0.8264,,Test_specificity:0.9388 Test_loss:0.348578
2026-01-29 16:27:22.628 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
2026-01-29 16:27:22.628 | INFO     | __main__:main_worker:355 - ---> start train epoch95
2026-01-29 16:27:32.896 | INFO     | __main__:main_worker:429 - [95/100], remain:0d.00h.02m, It:[10/54], Max-Mem:11245M, Data-Time:1.662, LR:0.0000, Train_Loss:0.1020, total_loss:tensor([0.1020], device='cuda:0'), ce_loss:0.618971586227417, cluster_loss:0.10481836646795273, sep_loss:0.028835957869887352, soft_orth_loss:0.008309640921652317, local_consistency_loss:0.0011970236664637923, proto_loss:0.14316099882125854
2026-01-29 16:27:37.616 | INFO     | __main__:main_worker:429 - [95/100], remain:0d.00h.02m, It:[20/54], Max-Mem:11245M, Data-Time:0.862, LR:0.0000, Train_Loss:-0.6562, total_loss:tensor([-0.6562], device='cuda:0'), ce_loss:0.2168123573064804, cluster_loss:0.06828559935092926, sep_loss:0.013117081485688686, soft_orth_loss:0.008309655822813511, local_consistency_loss:0.0002677839365787804, proto_loss:0.0899801179766655
2026-01-29 16:27:42.343 | INFO     | __main__:main_worker:429 - [95/100], remain:0d.00h.02m, It:[30/54], Max-Mem:11245M, Data-Time:1.219, LR:0.0000, Train_Loss:-0.2289, total_loss:tensor([-0.2289], device='cuda:0'), ce_loss:0.4838865399360657, cluster_loss:0.06108243018388748, sep_loss:0.018369346857070923, soft_orth_loss:0.00830959901213646, local_consistency_loss:5.864161721547134e-05, proto_loss:0.08782001584768295
2026-01-29 16:27:46.606 | INFO     | __main__:main_worker:429 - [95/100], remain:0d.00h.02m, It:[40/54], Max-Mem:11245M, Data-Time:0.792, LR:0.0000, Train_Loss:0.6515, total_loss:tensor([0.6515], device='cuda:0'), ce_loss:0.8967720866203308, cluster_loss:0.14485366642475128, sep_loss:0.0389392152428627, soft_orth_loss:0.00830954872071743, local_consistency_loss:0.0004484705568756908, proto_loss:0.1925508975982666
2026-01-29 16:27:51.113 | INFO     | __main__:main_worker:429 - [95/100], remain:0d.00h.02m, It:[50/54], Max-Mem:11245M, Data-Time:0.946, LR:0.0000, Train_Loss:0.3677, total_loss:tensor([0.3677], device='cuda:0'), ce_loss:0.7599973678588867, cluster_loss:0.12518838047981262, sep_loss:0.027587970718741417, soft_orth_loss:0.008309552446007729, local_consistency_loss:0.0006216565379872918, proto_loss:0.1617075651884079
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
2026-01-29 16:28:00.627 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [95/100], Top1:87.607, Top3:100.000, Test_precision:0.7999,Test_recall:0.8365,Test_f1:0.8162,,Test_specificity:0.9316 Test_loss:0.340272
acc1: 87.6068, acc3: 100.0000, Precision: 0.7999, Recall: 0.8365, F1-Score: 0.8162, Specificity: 0.9316
2026-01-29 16:28:00.628 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
2026-01-29 16:28:10.255 | INFO     | __main__:main_worker:355 - ---> start train epoch96
2026-01-29 16:28:18.943 | INFO     | __main__:main_worker:429 - [96/100], remain:0d.00h.01m, It:[10/54], Max-Mem:11245M, Data-Time:0.547, LR:0.0000, Train_Loss:0.0691, total_loss:tensor([0.0691], device='cuda:0'), ce_loss:0.6032647490501404, cluster_loss:0.10585290193557739, sep_loss:0.024131033569574356, soft_orth_loss:0.008309508673846722, local_consistency_loss:0.0012167092645540833, proto_loss:0.1395101547241211
2026-01-29 16:28:23.250 | INFO     | __main__:main_worker:429 - [96/100], remain:0d.00h.01m, It:[20/54], Max-Mem:11245M, Data-Time:0.816, LR:0.0000, Train_Loss:-0.3929, total_loss:tensor([-0.3929], device='cuda:0'), ce_loss:0.37432917952537537, cluster_loss:0.06280012428760529, sep_loss:0.02302977256476879, soft_orth_loss:0.00830951239913702, local_consistency_loss:0.00015906975022517145, proto_loss:0.09429848194122314
2026-01-29 16:28:26.892 | INFO     | __main__:main_worker:429 - [96/100], remain:0d.00h.01m, It:[30/54], Max-Mem:11245M, Data-Time:0.022, LR:0.0000, Train_Loss:-0.4417, total_loss:tensor([-0.4417], device='cuda:0'), ce_loss:0.34547126293182373, cluster_loss:0.06761941313743591, sep_loss:0.016859274357557297, soft_orth_loss:0.00830950029194355, local_consistency_loss:0.0004612538614310324, proto_loss:0.09324944019317627
2026-01-29 16:28:31.564 | INFO     | __main__:main_worker:429 - [96/100], remain:0d.00h.01m, It:[40/54], Max-Mem:11245M, Data-Time:0.574, LR:0.0000, Train_Loss:-0.3870, total_loss:tensor([-0.3870], device='cuda:0'), ce_loss:0.3721110224723816, cluster_loss:0.07234351336956024, sep_loss:0.017298810184001923, soft_orth_loss:0.008309482596814632, local_consistency_loss:0.0010397083824500442, proto_loss:0.0989915132522583
2026-01-29 16:28:35.387 | INFO     | __main__:main_worker:429 - [96/100], remain:0d.00h.01m, It:[50/54], Max-Mem:11245M, Data-Time:0.011, LR:0.0000, Train_Loss:0.5948, total_loss:tensor([0.5948], device='cuda:0'), ce_loss:0.8735674619674683, cluster_loss:0.13660673797130585, sep_loss:0.034776028245687485, soft_orth_loss:0.008309442549943924, local_consistency_loss:0.0034415756817907095, proto_loss:0.1831337809562683
2026-01-29 16:28:37.598 | INFO     | __main__:main_worker:488 - ---> Skipping prototype push: epoch > push_end(88)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
2026-01-29 16:28:45.698 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [96/100], Top1:87.607, Top3:100.000, Test_precision:0.7940,Test_recall:0.8379,Test_f1:0.8131,,Test_specificity:0.9330 Test_loss:0.343006
2026-01-29 16:28:45.699 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
2026-01-29 16:28:45.699 | INFO     | __main__:main_worker:355 - ---> start train epoch97
acc1: 87.6068, acc3: 100.0000, Precision: 0.7940, Recall: 0.8379, F1-Score: 0.8131, Specificity: 0.9330
2026-01-29 16:28:55.368 | INFO     | __main__:main_worker:429 - [97/100], remain:0d.00h.01m, It:[10/54], Max-Mem:11245M, Data-Time:0.832, LR:0.0000, Train_Loss:1.2224, total_loss:tensor([1.2224], device='cuda:0'), ce_loss:1.160088062286377, cluster_loss:0.21614444255828857, sep_loss:0.03934745490550995, soft_orth_loss:0.008309422992169857, local_consistency_loss:0.00015401974087581038, proto_loss:0.26395535469055176
2026-01-29 16:28:59.381 | INFO     | __main__:main_worker:429 - [97/100], remain:0d.00h.01m, It:[20/54], Max-Mem:11245M, Data-Time:0.600, LR:0.0000, Train_Loss:-0.3260, total_loss:tensor([-0.3260], device='cuda:0'), ce_loss:0.3909551799297333, cluster_loss:0.08314180374145508, sep_loss:0.02222130261361599, soft_orth_loss:0.00830942764878273, local_consistency_loss:0.000365422893082723, proto_loss:0.11403796076774597
2026-01-29 16:29:03.356 | INFO     | __main__:main_worker:429 - [97/100], remain:0d.00h.01m, It:[30/54], Max-Mem:11245M, Data-Time:0.441, LR:0.0000, Train_Loss:-0.1126, total_loss:tensor([-0.1126], device='cuda:0'), ce_loss:0.5656024217605591, cluster_loss:0.052790384739637375, sep_loss:0.01887347735464573, soft_orth_loss:0.00830948818475008, local_consistency_loss:0.00010143285908270627, proto_loss:0.08007478713989258
2026-01-29 16:29:07.926 | INFO     | __main__:main_worker:429 - [97/100], remain:0d.00h.01m, It:[40/54], Max-Mem:11245M, Data-Time:0.880, LR:0.0000, Train_Loss:-0.4078, total_loss:tensor([-0.4078], device='cuda:0'), ce_loss:0.34785130620002747, cluster_loss:0.07795301824808121, sep_loss:0.020297227427363396, soft_orth_loss:0.008309506811201572, local_consistency_loss:0.0015058136777952313, proto_loss:0.10806556791067123
2026-01-29 16:29:11.945 | INFO     | __main__:main_worker:429 - [97/100], remain:0d.00h.01m, It:[50/54], Max-Mem:11245M, Data-Time:0.608, LR:0.0000, Train_Loss:0.0907, total_loss:tensor([0.0907], device='cuda:0'), ce_loss:0.5965372920036316, cluster_loss:0.1261066198348999, sep_loss:0.019063789397478104, soft_orth_loss:0.008309487253427505, local_consistency_loss:0.0019925988744944334, proto_loss:0.15547248721122742
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
2026-01-29 16:29:21.312 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [97/100], Top1:87.607, Top3:100.000, Test_precision:0.7964,Test_recall:0.8439,Test_f1:0.8170,,Test_specificity:0.9330 Test_loss:0.357384
acc1: 87.6068, acc3: 100.0000, Precision: 0.7964, Recall: 0.8439, F1-Score: 0.8170, Specificity: 0.9330
2026-01-29 16:29:21.313 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
2026-01-29 16:29:21.314 | INFO     | __main__:main_worker:355 - ---> start train epoch98
2026-01-29 16:29:30.844 | INFO     | __main__:main_worker:429 - [98/100], remain:0d.00h.01m, It:[10/54], Max-Mem:11245M, Data-Time:1.451, LR:0.0000, Train_Loss:0.0612, total_loss:tensor([0.0612], device='cuda:0'), ce_loss:0.6072877645492554, cluster_loss:0.09138748794794083, sep_loss:0.03265554457902908, soft_orth_loss:0.008309480734169483, local_consistency_loss:0.00010656411905074492, proto_loss:0.13245907425880432
2026-01-29 16:29:34.454 | INFO     | __main__:main_worker:429 - [98/100], remain:0d.00h.00m, It:[20/54], Max-Mem:11245M, Data-Time:0.186, LR:0.0000, Train_Loss:0.1026, total_loss:tensor([0.1026], device='cuda:0'), ce_loss:0.6137356162071228, cluster_loss:0.10734038800001144, sep_loss:0.03175758197903633, soft_orth_loss:0.008309475146234035, local_consistency_loss:0.000295320205623284, proto_loss:0.14770276844501495
2026-01-29 16:29:38.824 | INFO     | __main__:main_worker:429 - [98/100], remain:0d.00h.00m, It:[30/54], Max-Mem:11245M, Data-Time:0.509, LR:0.0000, Train_Loss:-0.0442, total_loss:tensor([-0.0442], device='cuda:0'), ce_loss:0.5590255260467529, cluster_loss:0.08089234679937363, sep_loss:0.02964170090854168, soft_orth_loss:0.008309462107717991, local_consistency_loss:0.0001567878935020417, proto_loss:0.11900030076503754
2026-01-29 16:29:43.350 | INFO     | __main__:main_worker:429 - [98/100], remain:0d.00h.00m, It:[40/54], Max-Mem:11245M, Data-Time:0.019, LR:0.0000, Train_Loss:-0.2076, total_loss:tensor([-0.2076], device='cuda:0'), ce_loss:0.4722159802913666, cluster_loss:0.07370512187480927, sep_loss:0.025260120630264282, soft_orth_loss:0.008309421129524708, local_consistency_loss:0.0003726118302438408, proto_loss:0.10764727741479874
2026-01-29 16:29:48.289 | INFO     | __main__:main_worker:429 - [98/100], remain:0d.00h.00m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.0577, total_loss:tensor([-0.0577], device='cuda:0'), ce_loss:0.5358380079269409, cluster_loss:0.09003333002328873, sep_loss:0.03101666085422039, soft_orth_loss:0.00830939132720232, local_consistency_loss:0.0014530437765643, proto_loss:0.13081242144107819
Evaluating: 100%|| 15/15 [00:07<00:00,  1.88it/s]
acc1: 88.0342, acc3: 100.0000, Precision: 0.7995, Recall: 0.8489, F1-Score: 0.8208, Specificity: 0.9369
2026-01-29 16:29:57.570 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [98/100], Top1:88.034, Top3:100.000, Test_precision:0.7995,Test_recall:0.8489,Test_f1:0.8208,,Test_specificity:0.9369 Test_loss:0.344091
2026-01-29 16:29:57.570 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
2026-01-29 16:29:57.571 | INFO     | __main__:main_worker:355 - ---> start train epoch99
2026-01-29 16:30:06.679 | INFO     | __main__:main_worker:429 - [99/100], remain:0d.00h.00m, It:[10/54], Max-Mem:11245M, Data-Time:0.018, LR:0.0000, Train_Loss:-0.0585, total_loss:tensor([-0.0585], device='cuda:0'), ce_loss:0.5207952260971069, cluster_loss:0.10924070328474045, sep_loss:0.024562975391745567, soft_orth_loss:0.0083093186840415, local_consistency_loss:0.0002376242628088221, proto_loss:0.14235062897205353
2026-01-29 16:30:12.091 | INFO     | __main__:main_worker:429 - [99/100], remain:0d.00h.00m, It:[20/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:0.1008, total_loss:tensor([0.1008], device='cuda:0'), ce_loss:0.6206195950508118, cluster_loss:0.10647086054086685, sep_loss:0.026366660371422768, soft_orth_loss:0.00830929633229971, local_consistency_loss:0.0002096605021506548, proto_loss:0.1413564682006836
2026-01-29 16:30:15.637 | INFO     | __main__:main_worker:429 - [99/100], remain:0d.00h.00m, It:[30/54], Max-Mem:11245M, Data-Time:0.013, LR:0.0000, Train_Loss:-0.3100, total_loss:tensor([-0.3100], device='cuda:0'), ce_loss:0.41110724210739136, cluster_loss:0.07451213896274567, sep_loss:0.02276485040783882, soft_orth_loss:0.008309283293783665, local_consistency_loss:0.00032596351229585707, proto_loss:0.1059122309088707
2026-01-29 16:30:19.814 | INFO     | __main__:main_worker:429 - [99/100], remain:0d.00h.00m, It:[40/54], Max-Mem:11245M, Data-Time:0.016, LR:0.0000, Train_Loss:0.9841, total_loss:tensor([0.9841], device='cuda:0'), ce_loss:1.0819032192230225, cluster_loss:0.17006491124629974, sep_loss:0.030523432418704033, soft_orth_loss:0.008309255354106426, local_consistency_loss:4.479237395571545e-05, proto_loss:0.20894239842891693
2026-01-29 16:30:23.793 | INFO     | __main__:main_worker:429 - [99/100], remain:0d.00h.00m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.1669, total_loss:tensor([-0.1669], device='cuda:0'), ce_loss:0.4777527153491974, cluster_loss:0.0909818634390831, sep_loss:0.02387031726539135, soft_orth_loss:0.008309255354106426, local_consistency_loss:0.00013717399269808084, proto_loss:0.12329860776662827
Evaluating: 100%|| 15/15 [00:07<00:00,  1.89it/s]
acc1: 87.8205, acc3: 100.0000, Precision: 0.8014, Recall: 0.8390, F1-Score: 0.8180, Specificity: 0.9336
2026-01-29 16:30:34.756 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [99/100], Top1:87.821, Top3:100.000, Test_precision:0.8014,Test_recall:0.8390,Test_f1:0.8180,,Test_specificity:0.9336 Test_loss:0.343103
2026-01-29 16:30:34.757 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
2026-01-29 16:30:34.758 | INFO     | __main__:main_worker:355 - ---> start train epoch100
2026-01-29 16:30:43.590 | INFO     | __main__:main_worker:429 - [100/100], remain:0d.00h.00m, It:[10/54], Max-Mem:11245M, Data-Time:0.254, LR:0.0000, Train_Loss:-0.1298, total_loss:tensor([-0.1298], device='cuda:0'), ce_loss:0.6110624670982361, cluster_loss:0.00021218361507635564, sep_loss:0.02690521813929081, soft_orth_loss:0.008309248834848404, local_consistency_loss:8.861610695021227e-05, proto_loss:0.03551526740193367
2026-01-29 16:30:48.069 | INFO     | __main__:main_worker:429 - [100/100], remain:0d.00h.00m, It:[20/54], Max-Mem:11245M, Data-Time:0.752, LR:0.0000, Train_Loss:-0.2353, total_loss:tensor([-0.2353], device='cuda:0'), ce_loss:0.4506671726703644, cluster_loss:0.08213096112012863, sep_loss:0.02040993422269821, soft_orth_loss:0.008309214375913143, local_consistency_loss:0.00032130753970704973, proto_loss:0.1111714169383049
2026-01-29 16:30:52.458 | INFO     | __main__:main_worker:429 - [100/100], remain:0d.00h.00m, It:[30/54], Max-Mem:11245M, Data-Time:0.359, LR:0.0000, Train_Loss:0.0591, total_loss:tensor([0.0591], device='cuda:0'), ce_loss:0.597946286201477, cluster_loss:0.10243283957242966, sep_loss:0.025222662836313248, soft_orth_loss:0.008309203200042248, local_consistency_loss:0.0028973757289350033, proto_loss:0.13886208832263947
2026-01-29 16:30:57.535 | INFO     | __main__:main_worker:429 - [100/100], remain:0d.00h.00m, It:[40/54], Max-Mem:11245M, Data-Time:0.879, LR:0.0000, Train_Loss:-0.3174, total_loss:tensor([-0.3174], device='cuda:0'), ce_loss:0.4042820930480957, cluster_loss:0.07523512840270996, sep_loss:0.022661348804831505, soft_orth_loss:0.008309190161526203, local_consistency_loss:0.0014874580083414912, proto_loss:0.1076931282877922
2026-01-29 16:31:01.077 | INFO     | __main__:main_worker:429 - [100/100], remain:0d.00h.00m, It:[50/54], Max-Mem:11245M, Data-Time:0.012, LR:0.0000, Train_Loss:0.0676, total_loss:tensor([0.0676], device='cuda:0'), ce_loss:0.6038299798965454, cluster_loss:0.10187729448080063, sep_loss:0.02773178555071354, soft_orth_loss:0.008309181779623032, local_consistency_loss:0.0004653620708268136, proto_loss:0.1383836269378662
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
acc1: 88.0342, acc3: 100.0000, Precision: 0.8033, Recall: 0.8638, F1-Score: 0.8285, Specificity: 0.9388
2026-01-29 16:31:11.453 | INFO     | __main__:main_worker:496 - 	Eval-Epoch: [100/100], Top1:88.034, Top3:100.000, Test_precision:0.8033,Test_recall:0.8638,Test_f1:0.8285,,Test_specificity:0.9388 Test_loss:0.349689
2026-01-29 16:31:11.454 | INFO     | __main__:main_worker:507 - 	Best Top1 at epoch [91/100], Top1:88.675, Top-3:100.000
2026-01-29 16:31:20.886 | INFO     | __main__:main_worker:547 - Training of experiment: HiFuse_Small_1e-5-0.05/ft_progressive_v3_eval is done.
2026-01-29 16:31:20.893 | INFO     | __main__:main_worker:549 - 	Best Top1 at epoch [91/100], Top1:88.675, Top3:100.000
/home/backup/lh/KD/mae_lite/tools/train.py:554: DeprecationWarning: The 'stop()' method is deprecated, please use 'remove()' instead
  logger.stop()

Process finished with exit code 0
