/home/backup/lh/anaconda3/bin/python3 /home/backup/lh/KD/mae_lite/tools/train.py 
2026-01-26 04:47:35.919 | INFO     | __main__:main_worker:221 - gpuid: 0, args: <>Namespace(dist_backend='nccl', dist_url=None, batch_size=32, max_epoch=100, devices='0', eval=True, exp_file='/home/backup/lh/KD/projects/eval_tools/finetuning_progressive_v3_exp.py', ckpt='/home/backup/lh/KD/outputs/HiFuse_Small_1e-5-0.05/ft_transfer_eval/867last_epoch_best_ckpt.checkpoints.tar', amp=False, exp_options=None, world_size=1)
/home/backup/lh/KD/mae_lite/tools/train.py:222: DeprecationWarning: The 'ansi' parameter is deprecated, please use 'colors' instead
  logger.opt(ansi=True).info(
2026-01-26 04:47:35.923 | INFO     | __main__:main_worker:222 - Used experiment configs:
======================  ========================================================================================================
config key              value
======================  ========================================================================================================
batch_size              32
max_epoch               100
seed                    0
data_format             image
clip_grad               1.0
clip_mode               norm
output_dir              /home/backup/lh/KD/outputs
print_interval          10
dump_interval           5
eval_interval           1
enable_tensorboard      True
dataset                 MyDataSet
transform               typical_imagenet_transform
image_size              224
encoder_arch            HiFuse_Small
pretrained              False
num_classes             3
global_pool             True
img_size                224
input_size              <class 'NoneType'>
crop_pct                <class 'NoneType'>
mean                    <class 'NoneType'>
std                     <class 'NoneType'>
interpolation
validation_batch_size   <class 'NoneType'>
validation_dataset      MyDataSet
test_dataset            MyDataSet
test_batch_size         <class 'NoneType'>
opt                     adamw
opt_eps                 1e-08
opt_betas               (0.9, 0.999)
momentum                0.9
weight_decay            0.05
sched                   warmcos
basic_lr_per_img        3.125e-06
lr_noise                <class 'NoneType'>
lr_noise_pct            0.67
lr_noise_std            1.0
lr_cycle_mul            1.0
lr_cycle_decay          0.5
lr_cycle_limit          1
lr_k_decay              1.0
warmup_lr_per_img       3.125e-06
min_lr_per_img          3.125e-07
epochs                  100
epoch_repeats           0
start_epoch             <class 'NoneType'>
decay_epochs            <class 'NoneType'>
warmup_epochs           3
cooldown_epochs         5
patience_epochs         10
decay_rate              0.1
no_aug                  False
scale                   (0.08, 1.0)
ratio                   (0.75, 1.3333333333333333)
hflip                   0.5
vflip                   0.0
color_jitter            0.4
aa                      rand-m9-mstd0.5-inc1
reprob                  0.25
remode                  pixel
recount                 1
resplit                 False
mixup                   0.0
cutmix                  0.0
cutmix_minmax           <class 'NoneType'>
mixup_prob              1.0
mixup_switch_prob       0.5
mixup_mode              batch
mixup_off_epoch         0
smoothing               0.1
train_interpolation     bicubic
drop                    0.0
drop_connect            <class 'NoneType'>
drop_path               0.1
drop_block              <class 'NoneType'>
bn_tf                   False
bn_momentum             <class 'NoneType'>
bn_eps                  <class 'NoneType'>
sync_bn                 False
dist_bn                 reduce
model_ema               True
model_ema_force_cpu     False
model_ema_decay         0.9998
num_workers             10
weights_prefix
layer_decay             1.0
warmup_lr               1e-06
min_lr                  1e-06
attn_drop_rate          0.0
pretrain_exp_name       HiFuse_Small_1e-5-0.05
save_folder_prefix      ft_progressive_v3_
use_enhanced_model      True
enhancement_reduction   0.0625
backbone_lr_scale       0.05
mhf_lr_scale            0.2
enhancement_lr_scale    3.0
head_lr_scale           2.0
freeze_backbone_epochs  3
push_start_epoch        12
push_interval           8
push_end_epoch          88
push_momentum           0.85
stage1_ckpt_path        <class 'NoneType'>
loss_weights            {'clst_scale': 0.8, 'sep_scale': 0.2, 'orth_scale': 0.02, 'local_consistency_scale': 0.1, 'margin': 0.4}
======================  ========================================================================================================
/home/backup/lh/KD/mae_lite/tools/train.py:229: DeprecationWarning: The 'ansi' parameter is deprecated, please use 'colors' instead
  logger.opt(ansi=True).info("<yellow>Environment info:</yellow>\n<blue>{}</blue>".format(collect_env_info()))
/home/backup/lh/KD/mae_lite/utils/env.py:48: UserWarning: Current path is possibly not a valid git repository.
  warnings.warn("Current path is possibly not a valid git repository.")
2026-01-26 04:47:36.498 | INFO     | __main__:main_worker:229 - Environment info:
----------------------  --------------------------------------------------------------------------
sys.platform            linux
Python                  3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
numpy                   1.24.3
Pillow                  9.4.0
PyTorch                 2.1.0 @/home/backup/lh/anaconda3/lib/python3.11/site-packages/torch
PyTorch debug build     False
CUDA available          True
GPU 0                   NVIDIA GeForce RTX 3090
CUDA_HOME               /usr
NVCC                    Build cuda_12.0.r12.0/compiler.32267302_0
torchvision             0.16.0 @/home/backup/lh/anaconda3/lib/python3.11/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.8.1
----------------------  --------------------------------------------------------------------------
Git status: unknown
----------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.1.1 (Git Hash 64f6bcbcbab628e96f33a62c3e975f8535a7bde4)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-invalid-partial-specialization -Wno-unused-private-field -Wno-aligned-allocation-unavailable -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.1.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

2026-01-26 04:47:37.169609: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-26 04:47:38.291523: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
220 images were found in the dataset.
1753 images for training.
468 images for validation.
[main_model_enhanced] MHF Enhancement: Enabled (reduction=0.0625)
2026-01-26 04:47:41.570 | INFO     | projects.eval_tools.finetuning_mae_exp:get_model:106 - Using enhanced model: HiFuse_Small_Enhanced (reduction=0.0625)
2026-01-26 04:47:41.841 | INFO     | finetuning_progressive_v3_exp:get_model:108 - [Exp] Loss weights adjusted:
2026-01-26 04:47:41.841 | INFO     | finetuning_progressive_v3_exp:get_model:109 -   sep_scale: 0.12 -> 0.2
2026-01-26 04:47:41.841 | INFO     | finetuning_progressive_v3_exp:get_model:110 -   orth_scale: 0.08 -> 0.02
2026-01-26 04:47:41.842 | INFO     | finetuning_progressive_v3_exp:get_model:111 -   local_consistency_scale: 0.05 -> 0.1
2026-01-26 04:47:41.843 | INFO     | finetuning_progressive_v3_exp:get_model:112 -   margin: 0.3 -> 0.4
2026-01-26 04:47:41.845 | INFO     | finetuning_progressive_v3_exp:get_model:108 - [Exp] Loss weights adjusted:
2026-01-26 04:47:41.845 | INFO     | finetuning_progressive_v3_exp:get_model:109 -   sep_scale: 0.12 -> 0.2
2026-01-26 04:47:41.846 | INFO     | finetuning_progressive_v3_exp:get_model:110 -   orth_scale: 0.08 -> 0.02
2026-01-26 04:47:41.846 | INFO     | finetuning_progressive_v3_exp:get_model:111 -   local_consistency_scale: 0.05 -> 0.1
2026-01-26 04:47:41.846 | INFO     | finetuning_progressive_v3_exp:get_model:112 -   margin: 0.3 -> 0.4
2026-01-26 04:47:41.855 | INFO     | __main__:main_worker:256 - Illustration of model strcutures:
Model(
  (model): main_model_enhanced(
    (downsample_layers): ModuleList(
      (0): Sequential(
        (0): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
        (1): LayerNorm()
      )
      (1): Sequential(
        (0): LayerNorm()
        (1): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
      )
      (2): Sequential(
        (0): LayerNorm()
        (1): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
      )
      (3): Sequential(
        (0): LayerNorm()
        (1): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
      )
    )
    (stages): ModuleList(
      (0): Sequential(
        (0): Block(
          (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=96, out_features=384, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=384, out_features=96, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=96, out_features=384, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=384, out_features=96, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=96, out_features=384, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=384, out_features=96, bias=True)
          (drop_path): Identity()
        )
      )
      (1): Sequential(
        (0): Block(
          (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=192, out_features=768, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=768, out_features=192, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=192, out_features=768, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=768, out_features=192, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=192, out_features=768, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=768, out_features=192, bias=True)
          (drop_path): Identity()
        )
      )
      (2): Sequential(
        (0): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (3): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (4): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (5): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (6): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (7): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (8): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
      )
      (3): Sequential(
        (0): Block(
          (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
          (drop_path): Identity()
        )
      )
    )
    (conv_norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
    (patch_embed): PatchEmbed(
      (proj): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
      (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
    )
    (pos_drop): Dropout(p=0, inplace=False)
    (meta_tokenlize): PatchEmbed(
      (proj): Conv2d(96, 768, kernel_size=(16, 16), stride=(16, 16))
      (norm): Identity()
    )
    (layers1): BasicLayer(
      (blocks): ModuleList(
        (0): SwinTransformerBlock(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
        (1): SwinTransformerBlock(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
    )
    (layers2): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=192, out_features=192, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=768, out_features=192, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
    (layers3): BasicLayer(
      (blocks): ModuleList(
        (0-5): 6 x SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=384, out_features=384, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=1536, out_features=384, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
    )
    (layers4): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): DropPath()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=1536, out_features=768, bias=False)
        (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
      )
    )
    (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (avgpool): AdaptiveAvgPool1d(output_size=1)
    (head): HeadOptimal(
      (proj): Sequential(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (2): Dropout(p=0.1, inplace=False)
      )
      (proto_manager): DynamicPrototypeManagerOptimal()
      (mixed_attn): MixedAttentionBlockOptimal(
        (cross_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
        )
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
        )
        (light_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
        )
        (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (gate): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=True)
          (1): GELU(approximate='none')
          (2): Linear(in_features=768, out_features=3, bias=True)
        )
      )
      (ffn): Sequential(
        (0): Linear(in_features=768, out_features=3072, bias=True)
        (1): GELU(approximate='none')
        (2): Dropout(p=0.1, inplace=False)
        (3): Linear(in_features=3072, out_features=768, bias=True)
        (4): Dropout(p=0.1, inplace=False)
      )
      (ffn_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (proto_loss_fn): OptimalPrototypeLoss()
    )
    (fu1): MHF_block_v2(
      (att_conv): Sequential(
        (0): Conv2d(192, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(96, 6, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(6, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(192, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(288, 48, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(48, 48, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(288, 96, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.0, inplace=False)
      (enhancement): EnhancementModuleLite(
        (channel_att): Sequential(
          (0): AdaptiveAvgPool2d(output_size=1)
          (1): Conv2d(96, 8, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): ReLU(inplace=True)
          (3): Conv2d(8, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (4): Sigmoid()
        )
        (spatial_att): Sequential(
          (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): Sigmoid()
        )
      )
    )
    (fu2): MHF_block_v2(
      (att_conv): Sequential(
        (0): Conv2d(384, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(192, 12, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(12, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(384, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(576, 96, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(576, 192, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.1, inplace=False)
      (enhancement): EnhancementModuleLite(
        (channel_att): Sequential(
          (0): AdaptiveAvgPool2d(output_size=1)
          (1): Conv2d(192, 12, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): ReLU(inplace=True)
          (3): Conv2d(12, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (4): Sigmoid()
        )
        (spatial_att): Sequential(
          (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): Sigmoid()
        )
      )
    )
    (fu3): MHF_block_v2(
      (att_conv): Sequential(
        (0): Conv2d(768, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(384, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(24, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(768, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(1152, 192, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(1152, 384, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.2, inplace=False)
      (enhancement): EnhancementModuleLite(
        (channel_att): Sequential(
          (0): AdaptiveAvgPool2d(output_size=1)
          (1): Conv2d(384, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): ReLU(inplace=True)
          (3): Conv2d(24, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (4): Sigmoid()
        )
        (spatial_att): Sequential(
          (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): Sigmoid()
        )
      )
    )
    (fu4): MHF_block_v2(
      (att_conv): Sequential(
        (0): Conv2d(1536, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(768, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(48, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(1536, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(2304, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(2304, 384, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(2304, 768, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.2, inplace=False)
      (enhancement): EnhancementModuleLite(
        (channel_att): Sequential(
          (0): AdaptiveAvgPool2d(output_size=1)
          (1): Conv2d(768, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (2): ReLU(inplace=True)
          (3): Conv2d(48, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (4): Sigmoid()
        )
        (spatial_att): Sequential(
          (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (1): Sigmoid()
        )
      )
    )
  )
  (train_loss_fn): LabelSmoothingCrossEntropy()
  (ema_model): ModelEmaV2(
    (module): main_model_enhanced(
      (downsample_layers): ModuleList(
        (0): Sequential(
          (0): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
          (1): LayerNorm()
        )
        (1): Sequential(
          (0): LayerNorm()
          (1): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
        )
        (2): Sequential(
          (0): LayerNorm()
          (1): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
        )
        (3): Sequential(
          (0): LayerNorm()
          (1): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
        )
      )
      (stages): ModuleList(
        (0): Sequential(
          (0): Block(
            (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=384, out_features=96, bias=True)
            (drop_path): Identity()
          )
          (1): Block(
            (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=384, out_features=96, bias=True)
            (drop_path): Identity()
          )
          (2): Block(
            (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=384, out_features=96, bias=True)
            (drop_path): Identity()
          )
        )
        (1): Sequential(
          (0): Block(
            (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=768, out_features=192, bias=True)
            (drop_path): Identity()
          )
          (1): Block(
            (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=768, out_features=192, bias=True)
            (drop_path): Identity()
          )
          (2): Block(
            (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=768, out_features=192, bias=True)
            (drop_path): Identity()
          )
        )
        (2): Sequential(
          (0): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (1): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (2): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (3): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (4): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (5): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (6): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (7): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
          (8): Block(
            (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
            (drop_path): Identity()
          )
        )
        (3): Sequential(
          (0): Block(
            (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
            (drop_path): Identity()
          )
          (1): Block(
            (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
            (drop_path): Identity()
          )
          (2): Block(
            (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
            (norm): LayerNorm()
            (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
            (drop_path): Identity()
          )
        )
      )
      (conv_norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0, inplace=False)
      (meta_tokenlize): PatchEmbed(
        (proj): Conv2d(96, 768, kernel_size=(16, 16), stride=(16, 16))
        (norm): Identity()
      )
      (layers1): BasicLayer(
        (blocks): ModuleList(
          (0): SwinTransformerBlock(
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=96, out_features=96, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): Identity()
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
          (1): SwinTransformerBlock(
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=96, out_features=96, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): DropPath()
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
        )
      )
      (layers2): BasicLayer(
        (blocks): ModuleList(
          (0-1): 2 x SwinTransformerBlock(
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=192, out_features=192, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): DropPath()
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
        )
        (downsample): PatchMerging(
          (reduction): Linear(in_features=384, out_features=192, bias=False)
          (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
        )
      )
      (layers3): BasicLayer(
        (blocks): ModuleList(
          (0-5): 6 x SwinTransformerBlock(
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): DropPath()
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
        )
        (downsample): PatchMerging(
          (reduction): Linear(in_features=768, out_features=384, bias=False)
          (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
      (layers4): BasicLayer(
        (blocks): ModuleList(
          (0-1): 2 x SwinTransformerBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (attn_drop): Dropout(p=0, inplace=False)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (proj_drop): Dropout(p=0, inplace=False)
              (softmax): Softmax(dim=-1)
            )
            (drop_path): DropPath()
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0, inplace=False)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0, inplace=False)
            )
          )
        )
        (downsample): PatchMerging(
          (reduction): Linear(in_features=1536, out_features=768, bias=False)
          (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
        )
      )
      (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (avgpool): AdaptiveAvgPool1d(output_size=1)
      (head): HeadOptimal(
        (proj): Sequential(
          (0): Linear(in_features=768, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): Dropout(p=0.1, inplace=False)
        )
        (proto_manager): DynamicPrototypeManagerOptimal()
        (mixed_attn): MixedAttentionBlockOptimal(
          (cross_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (light_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (norm3): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (gate): Sequential(
            (0): Linear(in_features=2304, out_features=768, bias=True)
            (1): GELU(approximate='none')
            (2): Linear(in_features=768, out_features=3, bias=True)
          )
        )
        (ffn): Sequential(
          (0): Linear(in_features=768, out_features=3072, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=3072, out_features=768, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
        (ffn_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (proto_loss_fn): OptimalPrototypeLoss()
      )
      (fu1): MHF_block_v2(
        (att_conv): Sequential(
          (0): Conv2d(192, 2, kernel_size=(1, 1), stride=(1, 1))
          (1): Sigmoid()
        )
        (maxpool): AdaptiveMaxPool2d(output_size=1)
        (avgpool): AdaptiveAvgPool2d(output_size=1)
        (se): Sequential(
          (0): Conv2d(96, 6, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): ReLU()
          (2): Conv2d(6, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
        )
        (sigmoid): Sigmoid()
        (spatial): Conv(
          (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
          (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_x): Conv(
          (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_g): Conv(
          (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (norm1): LayerNorm()
        (norm2): LayerNorm()
        (chan): Conv(
          (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W): Conv(
          (conv): Conv2d(192, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (gelu): GELU(approximate='none')
        (residual): Residual(
          (relu): ReLU(inplace=True)
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv1): Conv(
            (conv): Conv2d(288, 48, kernel_size=(1, 1), stride=(1, 1))
          )
          (bn2): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv(
            (conv): Conv2d(48, 48, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          )
          (bn3): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv(
            (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
          )
          (skip_layer): Conv(
            (conv): Conv2d(288, 96, kernel_size=(1, 1), stride=(1, 1))
          )
        )
        (dropout): Dropout2d(p=0.0, inplace=False)
        (enhancement): EnhancementModuleLite(
          (channel_att): Sequential(
            (0): AdaptiveAvgPool2d(output_size=1)
            (1): Conv2d(96, 8, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (2): ReLU(inplace=True)
            (3): Conv2d(8, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (4): Sigmoid()
          )
          (spatial_att): Sequential(
            (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): Sigmoid()
          )
        )
      )
      (fu2): MHF_block_v2(
        (att_conv): Sequential(
          (0): Conv2d(384, 2, kernel_size=(1, 1), stride=(1, 1))
          (1): Sigmoid()
        )
        (maxpool): AdaptiveMaxPool2d(output_size=1)
        (avgpool): AdaptiveAvgPool2d(output_size=1)
        (se): Sequential(
          (0): Conv2d(192, 12, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): ReLU()
          (2): Conv2d(12, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
        )
        (sigmoid): Sigmoid()
        (spatial): Conv(
          (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
          (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_x): Conv(
          (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_g): Conv(
          (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (norm1): LayerNorm()
        (norm2): LayerNorm()
        (chan): Conv(
          (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W): Conv(
          (conv): Conv2d(384, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (gelu): GELU(approximate='none')
        (residual): Residual(
          (relu): ReLU(inplace=True)
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv1): Conv(
            (conv): Conv2d(576, 96, kernel_size=(1, 1), stride=(1, 1))
          )
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv(
            (conv): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          )
          (bn3): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv(
            (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
          )
          (skip_layer): Conv(
            (conv): Conv2d(576, 192, kernel_size=(1, 1), stride=(1, 1))
          )
        )
        (dropout): Dropout2d(p=0.1, inplace=False)
        (enhancement): EnhancementModuleLite(
          (channel_att): Sequential(
            (0): AdaptiveAvgPool2d(output_size=1)
            (1): Conv2d(192, 12, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (2): ReLU(inplace=True)
            (3): Conv2d(12, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (4): Sigmoid()
          )
          (spatial_att): Sequential(
            (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): Sigmoid()
          )
        )
      )
      (fu3): MHF_block_v2(
        (att_conv): Sequential(
          (0): Conv2d(768, 2, kernel_size=(1, 1), stride=(1, 1))
          (1): Sigmoid()
        )
        (maxpool): AdaptiveMaxPool2d(output_size=1)
        (avgpool): AdaptiveAvgPool2d(output_size=1)
        (se): Sequential(
          (0): Conv2d(384, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): ReLU()
          (2): Conv2d(24, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)
        )
        (sigmoid): Sigmoid()
        (spatial): Conv(
          (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
          (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_x): Conv(
          (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_g): Conv(
          (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (norm1): LayerNorm()
        (norm2): LayerNorm()
        (chan): Conv(
          (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W): Conv(
          (conv): Conv2d(768, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (gelu): GELU(approximate='none')
        (residual): Residual(
          (relu): ReLU(inplace=True)
          (bn1): BatchNorm2d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv1): Conv(
            (conv): Conv2d(1152, 192, kernel_size=(1, 1), stride=(1, 1))
          )
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv(
            (conv): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          )
          (bn3): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv(
            (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
          )
          (skip_layer): Conv(
            (conv): Conv2d(1152, 384, kernel_size=(1, 1), stride=(1, 1))
          )
        )
        (dropout): Dropout2d(p=0.2, inplace=False)
        (enhancement): EnhancementModuleLite(
          (channel_att): Sequential(
            (0): AdaptiveAvgPool2d(output_size=1)
            (1): Conv2d(384, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (2): ReLU(inplace=True)
            (3): Conv2d(24, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (4): Sigmoid()
          )
          (spatial_att): Sequential(
            (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): Sigmoid()
          )
        )
      )
      (fu4): MHF_block_v2(
        (att_conv): Sequential(
          (0): Conv2d(1536, 2, kernel_size=(1, 1), stride=(1, 1))
          (1): Sigmoid()
        )
        (maxpool): AdaptiveMaxPool2d(output_size=1)
        (avgpool): AdaptiveAvgPool2d(output_size=1)
        (se): Sequential(
          (0): Conv2d(768, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): ReLU()
          (2): Conv2d(48, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
        )
        (sigmoid): Sigmoid()
        (spatial): Conv(
          (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
          (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_x): Conv(
          (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W_g): Conv(
          (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
          (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (norm1): LayerNorm()
        (norm2): LayerNorm()
        (chan): Conv(
          (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (W): Conv(
          (conv): Conv2d(1536, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (relu): ReLU(inplace=True)
          (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (gelu): GELU(approximate='none')
        (residual): Residual(
          (relu): ReLU(inplace=True)
          (bn1): BatchNorm2d(2304, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv1): Conv(
            (conv): Conv2d(2304, 384, kernel_size=(1, 1), stride=(1, 1))
          )
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv(
            (conv): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          )
          (bn3): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv(
            (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
          )
          (skip_layer): Conv(
            (conv): Conv2d(2304, 768, kernel_size=(1, 1), stride=(1, 1))
          )
        )
        (dropout): Dropout2d(p=0.2, inplace=False)
        (enhancement): EnhancementModuleLite(
          (channel_att): Sequential(
            (0): AdaptiveAvgPool2d(output_size=1)
            (1): Conv2d(768, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (2): ReLU(inplace=True)
            (3): Conv2d(48, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (4): Sigmoid()
          )
          (spatial_att): Sequential(
            (0): Conv2d(2, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): Sigmoid()
          )
        )
      )
    )
  )
)
2026-01-26 04:47:41.856 | INFO     | projects.eval_tools.finetuning_mae_exp:get_optimizer:141 - Using differential learning rates:
2026-01-26 04:47:41.856 | INFO     | projects.eval_tools.finetuning_mae_exp:get_optimizer:142 -   backbone: 0.05x, mhf: 0.2x, enhancement: 3.0x, head: 2.0x
2026-01-26 04:47:41.857 | INFO     | finetuning_progressive_v3_exp:get_model:108 - [Exp] Loss weights adjusted:
2026-01-26 04:47:41.857 | INFO     | finetuning_progressive_v3_exp:get_model:109 -   sep_scale: 0.12 -> 0.2
2026-01-26 04:47:41.858 | INFO     | finetuning_progressive_v3_exp:get_model:110 -   orth_scale: 0.08 -> 0.02
2026-01-26 04:47:41.858 | INFO     | finetuning_progressive_v3_exp:get_model:111 -   local_consistency_scale: 0.05 -> 0.1
2026-01-26 04:47:41.859 | INFO     | finetuning_progressive_v3_exp:get_model:112 -   margin: 0.3 -> 0.4
Parameter groups for differential learning rate:
  - backbone: 305 tensors, 56,940,186 params (51.6%), lr=5.00e-06
  - mhf_original: 164 tensors, 21,889,848 params (19.8%), lr=2.00e-05
  - enhancement: 16 tensors, 98,380 params (0.1%), lr=3.00e-04
  - head: 84 tensors, 31,477,830 params (28.5%), lr=2.00e-04
2026-01-26 04:47:42.287 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_current_state:111 - Loading stage1 weights from: /home/backup/lh/KD/outputs/HiFuse_Small_1e-5-0.05/ft_transfer_eval/867last_epoch_best_ckpt.checkpoints.tar
2026-01-26 04:47:43.791 | INFO     | finetuning_progressive_v3_exp:get_model:108 - [Exp] Loss weights adjusted:
2026-01-26 04:47:43.792 | INFO     | finetuning_progressive_v3_exp:get_model:109 -   sep_scale: 0.12 -> 0.2
2026-01-26 04:47:43.792 | INFO     | finetuning_progressive_v3_exp:get_model:110 -   orth_scale: 0.08 -> 0.02
2026-01-26 04:47:43.793 | INFO     | finetuning_progressive_v3_exp:get_model:111 -   local_consistency_scale: 0.05 -> 0.1
2026-01-26 04:47:43.793 | INFO     | finetuning_progressive_v3_exp:get_model:112 -   margin: 0.3 -> 0.4
2026-01-26 04:47:44.000 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_model_weights_stage2:172 - Successfully loaded 679 parameters
2026-01-26 04:47:44.001 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_model_weights_stage2:173 - Skipped 679 parameters (shape mismatch or not in target)
2026-01-26 04:47:44.144 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_current_state:113 - Loaded keys: 647
2026-01-26 04:47:44.145 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_current_state:114 - Missing keys (new modules): ['ema_model.module.downsample_layers.0.0.weight', 'ema_model.module.downsample_layers.0.0.bias', 'ema_model.module.downsample_layers.0.1.weight', 'ema_model.module.downsample_layers.0.1.bias', 'ema_model.module.downsample_layers.1.0.weight', 'ema_model.module.downsample_layers.1.0.bias', 'ema_model.module.downsample_layers.1.1.weight', 'ema_model.module.downsample_layers.1.1.bias', 'ema_model.module.downsample_layers.2.0.weight', 'ema_model.module.downsample_layers.2.0.bias']...
2026-01-26 04:47:44.145 | INFO     | projects.eval_tools.finetuning_stage2_exp:set_current_state:115 - Unexpected keys: []...
2026-01-26 04:47:44.145 | INFO     | __main__:main_worker:315 - Training start...
2026-01-26 04:47:44.149 | INFO     | __main__:main_worker:340 - Backbone frozen for first 3 epochs (Head warmup)
[main_model_enhanced] Backbone frozen: 353 parameter tensors
2026-01-26 04:47:50.258 | INFO     | __main__:main_worker:349 - ---> start train epoch1
2026-01-26 04:47:55.905 | INFO     | __main__:main_worker:423 - [1/100], remain:0d.00h.50m, It:[10/54], Max-Mem:8351M, Data-Time:0.017, LR:0.0000, Train_Loss:0.5485, total_loss:tensor([0.5485], device='cuda:0'), ce_loss:0.7569361925125122, cluster_loss:0.11554258316755295, sep_loss:0.03492545709013939, soft_orth_loss:0.005161466542631388, local_consistency_loss:0.0070760734379291534, proto_loss:0.16270557045936584
2026-01-26 04:48:00.072 | INFO     | __main__:main_worker:423 - [1/100], remain:0d.00h.43m, It:[20/54], Max-Mem:8351M, Data-Time:1.501, LR:0.0000, Train_Loss:0.8360, total_loss:tensor([0.8360], device='cuda:0'), ce_loss:0.9250367283821106, cluster_loss:0.14926938712596893, sep_loss:0.03633531183004379, soft_orth_loss:0.0051605892367661, local_consistency_loss:0.008175563998520374, proto_loss:0.19894084334373474
2026-01-26 04:48:05.829 | INFO     | __main__:main_worker:423 - [1/100], remain:0d.00h.45m, It:[30/54], Max-Mem:8351M, Data-Time:3.107, LR:0.0000, Train_Loss:0.1260, total_loss:tensor([0.1260], device='cuda:0'), ce_loss:0.5009614825248718, cluster_loss:0.0784100815653801, sep_loss:0.031155938282608986, soft_orth_loss:0.005159262102097273, local_consistency_loss:0.0029548134189099073, proto_loss:0.11768008768558502
2026-01-26 04:48:11.625 | INFO     | __main__:main_worker:423 - [1/100], remain:0d.00h.47m, It:[40/54], Max-Mem:8351M, Data-Time:3.091, LR:0.0000, Train_Loss:0.1612, total_loss:tensor([0.1612], device='cuda:0'), ce_loss:0.5140250325202942, cluster_loss:0.08918628841638565, sep_loss:0.03126397356390953, soft_orth_loss:0.005156747065484524, local_consistency_loss:0.003477267688140273, proto_loss:0.1290842592716217
2026-01-26 04:48:18.136 | INFO     | __main__:main_worker:423 - [1/100], remain:0d.00h.49m, It:[50/54], Max-Mem:8351M, Data-Time:3.871, LR:0.0000, Train_Loss:0.3153, total_loss:tensor([0.3153], device='cuda:0'), ce_loss:0.6177659034729004, cluster_loss:0.09218227118253708, sep_loss:0.03671252727508545, soft_orth_loss:0.0051537309773266315, local_consistency_loss:0.0021958646830171347, proto_loss:0.13624440133571625
Evaluating: 100%|| 15/15 [00:09<00:00,  1.65it/s]
acc1: 83.5470, acc3: 100.0000, Precision: 0.7342, Recall: 0.8180, F1-Score: 0.7592, Specificity: 0.9204
2026-01-26 04:48:28.214 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [1/100], Top1:83.547, Top3:100.000, Test_precision:0.7342,Test_recall:0.8180,Test_f1:0.7592,,Test_specificity:0.9204 Test_loss:0.383484
2026-01-26 04:48:28.215 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [1/100], Top1:83.547, Top-3:100.000
2026-01-26 04:48:30.795 | INFO     | __main__:main_worker:349 - ---> start train epoch2
2026-01-26 04:48:41.324 | INFO     | __main__:main_worker:423 - [2/100], remain:0d.00h.52m, It:[10/54], Max-Mem:8351M, Data-Time:2.386, LR:0.0000, Train_Loss:0.4886, total_loss:tensor([0.4886], device='cuda:0'), ce_loss:0.7163933515548706, cluster_loss:0.12108425050973892, sep_loss:0.03131425008177757, soft_orth_loss:0.005150735843926668, local_consistency_loss:0.003216017736122012, proto_loss:0.16076524555683136
2026-01-26 04:48:46.781 | INFO     | __main__:main_worker:423 - [2/100], remain:0d.00h.50m, It:[20/54], Max-Mem:8351M, Data-Time:2.311, LR:0.0000, Train_Loss:0.2438, total_loss:tensor([0.2438], device='cuda:0'), ce_loss:0.5503019690513611, cluster_loss:0.11338906735181808, sep_loss:0.03007829189300537, soft_orth_loss:0.00514456070959568, local_consistency_loss:0.0023879853542894125, proto_loss:0.15099991858005524
2026-01-26 04:48:51.592 | INFO     | __main__:main_worker:423 - [2/100], remain:0d.00h.47m, It:[30/54], Max-Mem:8351M, Data-Time:1.303, LR:0.0001, Train_Loss:-0.1255, total_loss:tensor([-0.1255], device='cuda:0'), ce_loss:0.3477727770805359, cluster_loss:0.059724755585193634, sep_loss:0.024744946509599686, soft_orth_loss:0.005137565080076456, local_consistency_loss:0.0033800327219069004, proto_loss:0.0929872989654541
2026-01-26 04:48:56.151 | INFO     | __main__:main_worker:423 - [2/100], remain:0d.00h.45m, It:[40/54], Max-Mem:8351M, Data-Time:0.794, LR:0.0001, Train_Loss:0.1081, total_loss:tensor([0.1081], device='cuda:0'), ce_loss:0.48117244243621826, cluster_loss:0.08924223482608795, sep_loss:0.02948499657213688, soft_orth_loss:0.005130859557539225, local_consistency_loss:0.0014998911647126079, proto_loss:0.1253579705953598
2026-01-26 04:49:00.814 | INFO     | __main__:main_worker:423 - [2/100], remain:0d.00h.44m, It:[50/54], Max-Mem:8351M, Data-Time:1.390, LR:0.0001, Train_Loss:0.6897, total_loss:tensor([0.6897], device='cuda:0'), ce_loss:0.8509187698364258, cluster_loss:0.1231914535164833, sep_loss:0.040532149374485016, soft_orth_loss:0.005124569404870272, local_consistency_loss:0.002510066842660308, proto_loss:0.17135824263095856
Evaluating: 100%|| 15/15 [00:08<00:00,  1.69it/s]
acc1: 83.7607, acc3: 100.0000, Precision: 0.7352, Recall: 0.8178, F1-Score: 0.7616, Specificity: 0.9226
2026-01-26 04:49:12.534 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [2/100], Top1:83.761, Top3:100.000, Test_precision:0.7352,Test_recall:0.8178,Test_f1:0.7616,,Test_specificity:0.9226 Test_loss:0.364825
2026-01-26 04:49:12.535 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [2/100], Top1:83.761, Top-3:100.000
2026-01-26 04:49:24.668 | INFO     | __main__:main_worker:349 - ---> start train epoch3
2026-01-26 04:49:36.216 | INFO     | __main__:main_worker:423 - [3/100], remain:0d.00h.46m, It:[10/54], Max-Mem:8351M, Data-Time:2.707, LR:0.0001, Train_Loss:0.2123, total_loss:tensor([0.2123], device='cuda:0'), ce_loss:0.5597558617591858, cluster_loss:0.08239967375993729, sep_loss:0.03272328898310661, soft_orth_loss:0.005107250530272722, local_consistency_loss:0.0029716272838413715, proto_loss:0.12320183962583542
2026-01-26 04:49:40.568 | INFO     | __main__:main_worker:423 - [3/100], remain:0d.00h.42m, It:[20/54], Max-Mem:8351M, Data-Time:1.749, LR:0.0001, Train_Loss:0.3386, total_loss:tensor([0.3386], device='cuda:0'), ce_loss:0.6112276315689087, cluster_loss:0.10720508545637131, sep_loss:0.03441017493605614, soft_orth_loss:0.005098598077893257, local_consistency_loss:0.012725532054901123, proto_loss:0.15943938493728638
2026-01-26 04:49:45.648 | INFO     | __main__:main_worker:423 - [3/100], remain:0d.00h.42m, It:[30/54], Max-Mem:8351M, Data-Time:2.295, LR:0.0001, Train_Loss:0.5859, total_loss:tensor([0.5859], device='cuda:0'), ce_loss:0.7797338366508484, cluster_loss:0.12045539915561676, sep_loss:0.04133769869804382, soft_orth_loss:0.005086409859359264, local_consistency_loss:0.001971511635929346, proto_loss:0.16885101795196533
2026-01-26 04:49:51.315 | INFO     | __main__:main_worker:423 - [3/100], remain:0d.00h.44m, It:[40/54], Max-Mem:8351M, Data-Time:2.908, LR:0.0001, Train_Loss:0.2546, total_loss:tensor([0.2546], device='cuda:0'), ce_loss:0.5782604813575745, cluster_loss:0.1007051020860672, sep_loss:0.027181610465049744, soft_orth_loss:0.005076154135167599, local_consistency_loss:0.002277709310874343, proto_loss:0.1352405697107315
2026-01-26 04:49:54.590 | INFO     | __main__:main_worker:423 - [3/100], remain:0d.00h.40m, It:[50/54], Max-Mem:8351M, Data-Time:0.725, LR:0.0001, Train_Loss:0.4783, total_loss:tensor([0.4783], device='cuda:0'), ce_loss:0.7193517088890076, cluster_loss:0.10826480388641357, sep_loss:0.037926532328128815, soft_orth_loss:0.005066263023763895, local_consistency_loss:0.0026670482475310564, proto_loss:0.15392464399337769
Evaluating: 100%|| 15/15 [00:07<00:00,  2.00it/s]
acc1: 84.8291, acc3: 100.0000, Precision: 0.7656, Recall: 0.7797, F1-Score: 0.7721, Specificity: 0.9112
2026-01-26 04:50:03.492 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [3/100], Top1:84.829, Top3:100.000, Test_precision:0.7656,Test_recall:0.7797,Test_f1:0.7721,,Test_specificity:0.9112 Test_loss:0.384632
2026-01-26 04:50:03.494 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [3/100], Top1:84.829, Top-3:100.000
[main_model_enhanced] Backbone unfrozen: 353 parameter tensors
2026-01-26 04:50:36.325 | INFO     | __main__:main_worker:349 - ---> start train epoch4
2026-01-26 04:50:36.332 | INFO     | __main__:main_worker:358 - Backbone unfrozen at epoch 4 (Head warmup completed)
2026-01-26 04:50:46.327 | INFO     | __main__:main_worker:423 - [4/100], remain:0d.00h.49m, It:[10/54], Max-Mem:11251M, Data-Time:2.031, LR:0.0001, Train_Loss:0.4301, total_loss:tensor([0.4301], device='cuda:0'), ce_loss:0.6942582130432129, cluster_loss:0.10235335677862167, sep_loss:0.03668130561709404, soft_orth_loss:0.005053163506090641, local_consistency_loss:0.0016288465121760964, proto_loss:0.14571666717529297
2026-01-26 04:50:50.401 | INFO     | __main__:main_worker:423 - [4/100], remain:0d.00h.42m, It:[20/54], Max-Mem:11251M, Data-Time:0.688, LR:0.0001, Train_Loss:0.4676, total_loss:tensor([0.4676], device='cuda:0'), ce_loss:0.7238658666610718, cluster_loss:0.09832167625427246, sep_loss:0.03864870220422745, soft_orth_loss:0.005045025143772364, local_consistency_loss:0.0015051579102873802, proto_loss:0.1435205489397049
2026-01-26 04:50:54.387 | INFO     | __main__:main_worker:423 - [4/100], remain:0d.00h.39m, It:[30/54], Max-Mem:11251M, Data-Time:0.542, LR:0.0001, Train_Loss:0.3551, total_loss:tensor([0.3551], device='cuda:0'), ce_loss:0.6605298519134521, cluster_loss:0.08555682003498077, sep_loss:0.0349961593747139, soft_orth_loss:0.005033671855926514, local_consistency_loss:0.0021175004076212645, proto_loss:0.12770415842533112
2026-01-26 04:50:58.295 | INFO     | __main__:main_worker:423 - [4/100], remain:0d.00h.37m, It:[40/54], Max-Mem:11251M, Data-Time:0.428, LR:0.0001, Train_Loss:0.1459, total_loss:tensor([0.1459], device='cuda:0'), ce_loss:0.5124165415763855, cluster_loss:0.08726781606674194, sep_loss:0.030909759923815727, soft_orth_loss:0.005025002174079418, local_consistency_loss:0.0022655983921140432, proto_loss:0.1254681795835495
2026-01-26 04:51:03.294 | INFO     | __main__:main_worker:423 - [4/100], remain:0d.00h.38m, It:[50/54], Max-Mem:11251M, Data-Time:1.591, LR:0.0001, Train_Loss:0.1923, total_loss:tensor([0.1923], device='cuda:0'), ce_loss:0.572499692440033, cluster_loss:0.0656496211886406, sep_loss:0.026720119640231133, soft_orth_loss:0.0050228494219481945, local_consistency_loss:0.004284086637198925, proto_loss:0.10167667269706726
Evaluating: 100%|| 15/15 [00:07<00:00,  2.01it/s]
2026-01-26 04:51:12.094 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [4/100], Top1:83.547, Top3:100.000, Test_precision:0.7503,Test_recall:0.7171,Test_f1:0.7303,,Test_specificity:0.8858 Test_loss:0.497732
acc1: 83.5470, acc3: 100.0000, Precision: 0.7503, Recall: 0.7171, F1-Score: 0.7303, Specificity: 0.8858
2026-01-26 04:51:12.095 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [3/100], Top1:84.829, Top-3:100.000
2026-01-26 04:51:12.096 | INFO     | __main__:main_worker:349 - ---> start train epoch5
2026-01-26 04:51:19.583 | INFO     | __main__:main_worker:423 - [5/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11251M, Data-Time:0.212, LR:0.0001, Train_Loss:0.4872, total_loss:tensor([0.4872], device='cuda:0'), ce_loss:0.7347930073738098, cluster_loss:0.1008739247918129, sep_loss:0.03974315524101257, soft_orth_loss:0.00501913670450449, local_consistency_loss:0.0015184893272817135, proto_loss:0.14715470373630524
2026-01-26 04:51:24.415 | INFO     | __main__:main_worker:423 - [5/100], remain:0d.00h.35m, It:[20/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0001, Train_Loss:0.2787, total_loss:tensor([0.2787], device='cuda:0'), ce_loss:0.5898667573928833, cluster_loss:0.10362682491540909, sep_loss:0.030468899756669998, soft_orth_loss:0.005014820024371147, local_consistency_loss:0.0034915884025394917, proto_loss:0.14260214567184448
2026-01-26 04:51:28.002 | INFO     | __main__:main_worker:423 - [5/100], remain:0d.00h.33m, It:[30/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.6672, total_loss:tensor([0.6672], device='cuda:0'), ce_loss:0.8336084485054016, cluster_loss:0.13189204037189484, sep_loss:0.03502507135272026, soft_orth_loss:0.00501067191362381, local_consistency_loss:0.0034084224607795477, proto_loss:0.17533619701862335
2026-01-26 04:51:33.479 | INFO     | __main__:main_worker:423 - [5/100], remain:0d.00h.36m, It:[40/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0001, Train_Loss:0.3503, total_loss:tensor([0.3503], device='cuda:0'), ce_loss:0.6361759305000305, cluster_loss:0.11090978235006332, sep_loss:0.030596906319260597, soft_orth_loss:0.005006278865039349, local_consistency_loss:0.0012037294218316674, proto_loss:0.1477167010307312
2026-01-26 04:51:37.904 | INFO     | __main__:main_worker:423 - [5/100], remain:0d.00h.36m, It:[50/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0001, Train_Loss:0.7289, total_loss:tensor([0.7289], device='cuda:0'), ce_loss:0.8662060499191284, cluster_loss:0.14711689949035645, sep_loss:0.032300304621458054, soft_orth_loss:0.005001804791390896, local_consistency_loss:0.0018208656692877412, proto_loss:0.18623986840248108
Evaluating: 100%|| 15/15 [00:08<00:00,  1.69it/s]
acc1: 86.3248, acc3: 100.0000, Precision: 0.7690, Recall: 0.8330, F1-Score: 0.7944, Specificity: 0.9321
2026-01-26 04:51:48.083 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [5/100], Top1:86.325, Top3:100.000, Test_precision:0.7690,Test_recall:0.8330,Test_f1:0.7944,,Test_specificity:0.9321 Test_loss:0.351779
2026-01-26 04:51:48.085 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [5/100], Top1:86.325, Top-3:100.000
2026-01-26 04:52:33.664 | INFO     | __main__:main_worker:349 - ---> start train epoch6
2026-01-26 04:52:43.355 | INFO     | __main__:main_worker:423 - [6/100], remain:0d.00h.40m, It:[10/54], Max-Mem:11251M, Data-Time:0.315, LR:0.0001, Train_Loss:0.1911, total_loss:tensor([0.1911], device='cuda:0'), ce_loss:0.5420107841491699, cluster_loss:0.09139799326658249, sep_loss:0.031374167650938034, soft_orth_loss:0.004997947718948126, local_consistency_loss:0.002001057146117091, proto_loss:0.1297711730003357
2026-01-26 04:52:48.949 | INFO     | __main__:main_worker:423 - [6/100], remain:0d.00h.43m, It:[20/54], Max-Mem:11251M, Data-Time:0.356, LR:0.0001, Train_Loss:0.4498, total_loss:tensor([0.4498], device='cuda:0'), ce_loss:0.7016745805740356, cluster_loss:0.11547660827636719, sep_loss:0.03146716579794884, soft_orth_loss:0.004993488546460867, local_consistency_loss:0.0019475050503388047, proto_loss:0.15388476848602295
2026-01-26 04:52:55.429 | INFO     | __main__:main_worker:423 - [6/100], remain:0d.00h.47m, It:[30/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.1014, total_loss:tensor([-0.1014], device='cuda:0'), ce_loss:0.36929231882095337, cluster_loss:0.06612493097782135, sep_loss:0.022545410320162773, soft_orth_loss:0.004991019610315561, local_consistency_loss:0.0025767728220671415, proto_loss:0.0962381362915039
2026-01-26 04:53:01.935 | INFO     | __main__:main_worker:423 - [6/100], remain:0d.00h.48m, It:[40/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.5445, total_loss:tensor([0.5445], device='cuda:0'), ce_loss:0.7556923031806946, cluster_loss:0.1254386305809021, sep_loss:0.03486398234963417, soft_orth_loss:0.004988323897123337, local_consistency_loss:0.0016005050856620073, proto_loss:0.1668914407491684
2026-01-26 04:53:06.859 | INFO     | __main__:main_worker:423 - [6/100], remain:0d.00h.47m, It:[50/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.1478, total_loss:tensor([0.1478], device='cuda:0'), ce_loss:0.510434091091156, cluster_loss:0.09296230226755142, sep_loss:0.0292207058519125, soft_orth_loss:0.004984616301953793, local_consistency_loss:0.0038198314141482115, proto_loss:0.13098746538162231
Evaluating: 100%|| 15/15 [00:10<00:00,  1.50it/s]
2026-01-26 04:53:20.789 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [6/100], Top1:86.752, Top3:100.000, Test_precision:0.7776,Test_recall:0.8163,Test_f1:0.7947,,Test_specificity:0.9276 Test_loss:0.350818
2026-01-26 04:53:20.790 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
acc1: 86.7521, acc3: 100.0000, Precision: 0.7776, Recall: 0.8163, F1-Score: 0.7947, Specificity: 0.9276
2026-01-26 04:53:39.140 | INFO     | __main__:main_worker:349 - ---> start train epoch7
2026-01-26 04:53:52.070 | INFO     | __main__:main_worker:423 - [7/100], remain:0d.01h.09m, It:[10/54], Max-Mem:11251M, Data-Time:1.786, LR:0.0001, Train_Loss:0.3961, total_loss:tensor([0.3961], device='cuda:0'), ce_loss:0.6930907964706421, cluster_loss:0.0835530161857605, sep_loss:0.035667628049850464, soft_orth_loss:0.004975511692464352, local_consistency_loss:0.0034005765337496996, proto_loss:0.12759673595428467
2026-01-26 04:53:58.562 | INFO     | __main__:main_worker:423 - [7/100], remain:0d.01h.01m, It:[20/54], Max-Mem:11251M, Data-Time:1.607, LR:0.0001, Train_Loss:0.5417, total_loss:tensor([0.5417], device='cuda:0'), ce_loss:0.7741414308547974, cluster_loss:0.10468857735395432, sep_loss:0.03748103231191635, soft_orth_loss:0.004969845525920391, local_consistency_loss:0.0018640634370967746, proto_loss:0.1490035206079483
2026-01-26 04:54:06.214 | INFO     | __main__:main_worker:423 - [7/100], remain:0d.01h.02m, It:[30/54], Max-Mem:11251M, Data-Time:1.398, LR:0.0001, Train_Loss:0.3403, total_loss:tensor([0.3403], device='cuda:0'), ce_loss:0.6312751770019531, cluster_loss:0.1060069352388382, sep_loss:0.03491970896720886, soft_orth_loss:0.004962695296853781, local_consistency_loss:0.0015807681484147906, proto_loss:0.1474701166152954
2026-01-26 04:54:13.181 | INFO     | __main__:main_worker:423 - [7/100], remain:0d.01h.00m, It:[40/54], Max-Mem:11251M, Data-Time:1.278, LR:0.0001, Train_Loss:0.4179, total_loss:tensor([0.4179], device='cuda:0'), ce_loss:0.6893883943557739, cluster_loss:0.10556967556476593, sep_loss:0.03348269313573837, soft_orth_loss:0.004953952506184578, local_consistency_loss:0.0016217675292864442, proto_loss:0.14562807977199554
2026-01-26 04:54:20.060 | INFO     | __main__:main_worker:423 - [7/100], remain:0d.00h.59m, It:[50/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:0.0455, total_loss:tensor([0.0455], device='cuda:0'), ce_loss:0.47232773900032043, cluster_loss:0.060744550079107285, sep_loss:0.031153028830885887, soft_orth_loss:0.004947173409163952, local_consistency_loss:0.0035898808855563402, proto_loss:0.10043463110923767
Evaluating: 100%|| 15/15 [00:12<00:00,  1.25it/s]
acc1: 85.2564, acc3: 100.0000, Precision: 0.7451, Recall: 0.7765, F1-Score: 0.7583, Specificity: 0.9189
2026-01-26 04:54:35.953 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [7/100], Top1:85.256, Top3:100.000, Test_precision:0.7451,Test_recall:0.7765,Test_f1:0.7583,,Test_specificity:0.9189 Test_loss:0.366666
2026-01-26 04:54:35.954 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 04:54:35.954 | INFO     | __main__:main_worker:349 - ---> start train epoch8
2026-01-26 04:54:48.811 | INFO     | __main__:main_worker:423 - [8/100], remain:0d.00h.48m, It:[10/54], Max-Mem:11251M, Data-Time:1.804, LR:0.0001, Train_Loss:0.2045, total_loss:tensor([0.2045], device='cuda:0'), ce_loss:0.5617758631706238, cluster_loss:0.08030291646718979, sep_loss:0.03546111285686493, soft_orth_loss:0.004934079945087433, local_consistency_loss:0.0023360333871096373, proto_loss:0.12303414195775986
2026-01-26 04:54:54.548 | INFO     | __main__:main_worker:423 - [8/100], remain:0d.00h.47m, It:[20/54], Max-Mem:11251M, Data-Time:1.208, LR:0.0001, Train_Loss:0.2483, total_loss:tensor([0.2483], device='cuda:0'), ce_loss:0.6062206625938416, cluster_loss:0.07178512960672379, sep_loss:0.03284535929560661, soft_orth_loss:0.0049287788569927216, local_consistency_loss:0.002103205770254135, proto_loss:0.11166247725486755
2026-01-26 04:55:00.702 | INFO     | __main__:main_worker:423 - [8/100], remain:0d.00h.48m, It:[30/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.1291, total_loss:tensor([0.1291], device='cuda:0'), ce_loss:0.5147174596786499, cluster_loss:0.08222072571516037, sep_loss:0.028791366145014763, soft_orth_loss:0.004928488750010729, local_consistency_loss:0.0013281963765621185, proto_loss:0.11726878583431244
2026-01-26 04:55:07.674 | INFO     | __main__:main_worker:423 - [8/100], remain:0d.00h.50m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:1.0171, total_loss:tensor([1.0171], device='cuda:0'), ce_loss:1.050319790840149, cluster_loss:0.1637379676103592, sep_loss:0.03802311047911644, soft_orth_loss:0.004923650529235601, local_consistency_loss:0.0022400168236345053, proto_loss:0.20892475545406342
2026-01-26 04:55:12.840 | INFO     | __main__:main_worker:423 - [8/100], remain:0d.00h.48m, It:[50/54], Max-Mem:11251M, Data-Time:0.008, LR:0.0001, Train_Loss:0.3027, total_loss:tensor([0.3027], device='cuda:0'), ce_loss:0.7255327105522156, cluster_loss:0.00023522719857282937, sep_loss:0.03308913856744766, soft_orth_loss:0.004919767379760742, local_consistency_loss:0.0020577043760567904, proto_loss:0.040301837027072906
2026-01-26 04:55:14.960 | INFO     | __main__:main_worker:482 - ---> Skipping prototype push: epoch < push_start(12)
Evaluating: 100%|| 15/15 [00:09<00:00,  1.63it/s]
acc1: 83.9744, acc3: 100.0000, Precision: 0.7371, Recall: 0.8127, F1-Score: 0.7630, Specificity: 0.9279
2026-01-26 04:55:24.183 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [8/100], Top1:83.974, Top3:100.000, Test_precision:0.7371,Test_recall:0.8127,Test_f1:0.7630,,Test_specificity:0.9279 Test_loss:0.403511
2026-01-26 04:55:24.185 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 04:55:24.185 | INFO     | __main__:main_worker:349 - ---> start train epoch9
2026-01-26 04:55:35.172 | INFO     | __main__:main_worker:423 - [9/100], remain:0d.00h.35m, It:[10/54], Max-Mem:11251M, Data-Time:0.876, LR:0.0001, Train_Loss:0.6644, total_loss:tensor([0.6644], device='cuda:0'), ce_loss:0.8170166015625, cluster_loss:0.1527070850133896, sep_loss:0.03148826211690903, soft_orth_loss:0.004919645842164755, local_consistency_loss:0.0025085583329200745, proto_loss:0.1916235387325287
2026-01-26 04:55:39.669 | INFO     | __main__:main_worker:423 - [9/100], remain:0d.00h.35m, It:[20/54], Max-Mem:11251M, Data-Time:1.004, LR:0.0001, Train_Loss:0.2779, total_loss:tensor([0.2779], device='cuda:0'), ce_loss:0.610654354095459, cluster_loss:0.0907292291522026, sep_loss:0.03055020235478878, soft_orth_loss:0.004917015787214041, local_consistency_loss:0.002124250400811434, proto_loss:0.12832069396972656
2026-01-26 04:55:44.464 | INFO     | __main__:main_worker:423 - [9/100], remain:0d.00h.36m, It:[30/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0001, Train_Loss:0.3305, total_loss:tensor([0.3305], device='cuda:0'), ce_loss:0.6376990675926208, cluster_loss:0.10135092586278915, sep_loss:0.03043527342379093, soft_orth_loss:0.004912594333291054, local_consistency_loss:0.0014800680801272392, proto_loss:0.13817887008190155
2026-01-26 04:55:49.824 | INFO     | __main__:main_worker:423 - [9/100], remain:0d.00h.38m, It:[40/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0001, Train_Loss:0.1583, total_loss:tensor([0.1583], device='cuda:0'), ce_loss:0.6255484819412231, cluster_loss:0.0002150125365005806, sep_loss:0.031020445749163628, soft_orth_loss:0.004904609173536301, local_consistency_loss:0.002438432304188609, proto_loss:0.03857850283384323
2026-01-26 04:55:54.908 | INFO     | __main__:main_worker:423 - [9/100], remain:0d.00h.38m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.0822, total_loss:tensor([0.0822], device='cuda:0'), ce_loss:0.5723535418510437, cluster_loss:0.0002178841968998313, sep_loss:0.031161600723862648, soft_orth_loss:0.004894891753792763, local_consistency_loss:0.0015295457560569048, proto_loss:0.03780391812324524
Evaluating: 100%|| 15/15 [00:09<00:00,  1.53it/s]
2026-01-26 04:56:08.327 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [9/100], Top1:86.538, Top3:100.000, Test_precision:0.7875,Test_recall:0.8017,Test_f1:0.7941,,Test_specificity:0.9208 Test_loss:0.347824
acc1: 86.5385, acc3: 100.0000, Precision: 0.7875, Recall: 0.8017, F1-Score: 0.7941, Specificity: 0.9208
2026-01-26 04:56:08.329 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 04:56:08.329 | INFO     | __main__:main_worker:349 - ---> start train epoch10
2026-01-26 04:56:18.482 | INFO     | __main__:main_worker:423 - [10/100], remain:0d.00h.44m, It:[10/54], Max-Mem:11251M, Data-Time:1.809, LR:0.0001, Train_Loss:0.5632, total_loss:tensor([0.5632], device='cuda:0'), ce_loss:0.7695744037628174, cluster_loss:0.12824714183807373, sep_loss:0.03517508506774902, soft_orth_loss:0.004886214155703783, local_consistency_loss:0.0019337621051818132, proto_loss:0.17024220526218414
2026-01-26 04:56:23.617 | INFO     | __main__:main_worker:423 - [10/100], remain:0d.00h.42m, It:[20/54], Max-Mem:11251M, Data-Time:1.561, LR:0.0001, Train_Loss:0.6283, total_loss:tensor([0.6283], device='cuda:0'), ce_loss:0.8303796648979187, cluster_loss:0.11973290890455246, sep_loss:0.030989835038781166, soft_orth_loss:0.004883802495896816, local_consistency_loss:0.002085658023133874, proto_loss:0.15769219398498535
2026-01-26 04:56:28.701 | INFO     | __main__:main_worker:423 - [10/100], remain:0d.00h.41m, It:[30/54], Max-Mem:11251M, Data-Time:0.810, LR:0.0001, Train_Loss:0.2348, total_loss:tensor([0.2348], device='cuda:0'), ce_loss:0.5915305018424988, cluster_loss:0.08385782688856125, sep_loss:0.028969744220376015, soft_orth_loss:0.0048822565004229546, local_consistency_loss:0.001894818851724267, proto_loss:0.11960463970899582
2026-01-26 04:56:33.840 | INFO     | __main__:main_worker:423 - [10/100], remain:0d.00h.41m, It:[40/54], Max-Mem:11251M, Data-Time:1.615, LR:0.0001, Train_Loss:0.1471, total_loss:tensor([0.1471], device='cuda:0'), ce_loss:0.5276179313659668, cluster_loss:0.08058875799179077, sep_loss:0.03387072682380676, soft_orth_loss:0.004877851810306311, local_consistency_loss:0.00157894566655159, proto_loss:0.12091627717018127
2026-01-26 04:56:39.355 | INFO     | __main__:main_worker:423 - [10/100], remain:0d.00h.41m, It:[50/54], Max-Mem:11251M, Data-Time:1.996, LR:0.0001, Train_Loss:0.6520, total_loss:tensor([0.6520], device='cuda:0'), ce_loss:0.9661793112754822, cluster_loss:0.0006223614909686148, sep_loss:0.04150403290987015, soft_orth_loss:0.004871625918895006, local_consistency_loss:0.004761315416544676, proto_loss:0.05175933614373207
Evaluating: 100%|| 15/15 [00:08<00:00,  1.74it/s]
2026-01-26 04:56:49.264 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [10/100], Top1:83.974, Top3:100.000, Test_precision:0.7618,Test_recall:0.7920,Test_f1:0.7750,,Test_specificity:0.9005 Test_loss:0.385805
acc1: 83.9744, acc3: 100.0000, Precision: 0.7618, Recall: 0.7920, F1-Score: 0.7750, Specificity: 0.9005
2026-01-26 04:56:49.265 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 04:56:58.655 | INFO     | __main__:main_worker:349 - ---> start train epoch11
2026-01-26 04:57:08.514 | INFO     | __main__:main_worker:423 - [11/100], remain:0d.00h.45m, It:[10/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:-0.0723, total_loss:tensor([-0.0723], device='cuda:0'), ce_loss:0.38451430201530457, cluster_loss:0.08131571114063263, sep_loss:0.021672850474715233, soft_orth_loss:0.0048622069880366325, local_consistency_loss:0.0015717670321464539, proto_loss:0.10942253470420837
2026-01-26 04:57:13.666 | INFO     | __main__:main_worker:423 - [11/100], remain:0d.00h.42m, It:[20/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.4943, total_loss:tensor([0.4943], device='cuda:0'), ce_loss:0.7252808213233948, cluster_loss:0.12838567793369293, sep_loss:0.0328056775033474, soft_orth_loss:0.0048553794622421265, local_consistency_loss:0.0012062464375048876, proto_loss:0.16725298762321472
2026-01-26 04:57:18.309 | INFO     | __main__:main_worker:423 - [11/100], remain:0d.00h.40m, It:[30/54], Max-Mem:11251M, Data-Time:0.748, LR:0.0001, Train_Loss:0.0603, total_loss:tensor([0.0603], device='cuda:0'), ce_loss:0.4893563985824585, cluster_loss:0.06758031994104385, sep_loss:0.027019033208489418, soft_orth_loss:0.004848891869187355, local_consistency_loss:0.001660131267271936, proto_loss:0.1011083722114563
2026-01-26 04:57:23.528 | INFO     | __main__:main_worker:423 - [11/100], remain:0d.00h.40m, It:[40/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0001, Train_Loss:-0.0632, total_loss:tensor([-0.0632], device='cuda:0'), ce_loss:0.40451881289482117, cluster_loss:0.06809503585100174, sep_loss:0.024511901661753654, soft_orth_loss:0.004846327006816864, local_consistency_loss:0.0009413400548510253, proto_loss:0.09839460998773575
2026-01-26 04:57:29.295 | INFO     | __main__:main_worker:423 - [11/100], remain:0d.00h.41m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.2438, total_loss:tensor([0.2438], device='cuda:0'), ce_loss:0.5935232639312744, cluster_loss:0.08312057703733444, sep_loss:0.03389035165309906, soft_orth_loss:0.004841294139623642, local_consistency_loss:0.00388924777507782, proto_loss:0.12574146687984467
Evaluating: 100%|| 15/15 [00:08<00:00,  1.73it/s]
acc1: 82.4786, acc3: 100.0000, Precision: 0.7316, Recall: 0.8518, F1-Score: 0.7555, Specificity: 0.9300
2026-01-26 04:57:39.440 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [11/100], Top1:82.479, Top3:100.000, Test_precision:0.7316,Test_recall:0.8518,Test_f1:0.7555,,Test_specificity:0.9300 Test_loss:0.443106
2026-01-26 04:57:39.441 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 04:57:39.441 | INFO     | __main__:main_worker:349 - ---> start train epoch12
2026-01-26 04:57:47.568 | INFO     | __main__:main_worker:423 - [12/100], remain:0d.00h.28m, It:[10/54], Max-Mem:11251M, Data-Time:0.243, LR:0.0001, Train_Loss:0.5147, total_loss:tensor([0.5147], device='cuda:0'), ce_loss:0.7469429969787598, cluster_loss:0.12240532785654068, sep_loss:0.033467456698417664, soft_orth_loss:0.004829863086342812, local_consistency_loss:0.0012296433560550213, proto_loss:0.1619323045015335
2026-01-26 04:57:51.925 | INFO     | __main__:main_worker:423 - [12/100], remain:0d.00h.31m, It:[20/54], Max-Mem:11251M, Data-Time:0.432, LR:0.0001, Train_Loss:0.6962, total_loss:tensor([0.6962], device='cuda:0'), ce_loss:0.8659439086914062, cluster_loss:0.12915627658367157, sep_loss:0.03524882718920708, soft_orth_loss:0.004825979936867952, local_consistency_loss:0.0023943211417645216, proto_loss:0.17162540555000305
2026-01-26 04:57:56.246 | INFO     | __main__:main_worker:423 - [12/100], remain:0d.00h.31m, It:[30/54], Max-Mem:11251M, Data-Time:0.439, LR:0.0001, Train_Loss:0.0077, total_loss:tensor([0.0077], device='cuda:0'), ce_loss:0.4305714964866638, cluster_loss:0.08404635637998581, sep_loss:0.03155278414487839, soft_orth_loss:0.004821473732590675, local_consistency_loss:0.0015752807958051562, proto_loss:0.12199589610099792
2026-01-26 04:58:00.977 | INFO     | __main__:main_worker:423 - [12/100], remain:0d.00h.33m, It:[40/54], Max-Mem:11251M, Data-Time:0.916, LR:0.0001, Train_Loss:0.1437, total_loss:tensor([0.1437], device='cuda:0'), ce_loss:0.5237367749214172, cluster_loss:0.09462499618530273, sep_loss:0.024779099971055984, soft_orth_loss:0.00482074823230505, local_consistency_loss:0.001643686555325985, proto_loss:0.1258685290813446
2026-01-26 04:58:04.935 | INFO     | __main__:main_worker:423 - [12/100], remain:0d.00h.32m, It:[50/54], Max-Mem:11251M, Data-Time:0.368, LR:0.0001, Train_Loss:0.8235, total_loss:tensor([0.8235], device='cuda:0'), ce_loss:1.0995526313781738, cluster_loss:0.0003709104785230011, sep_loss:0.03803505003452301, soft_orth_loss:0.004821601789444685, local_consistency_loss:0.0013344822218641639, proto_loss:0.044562045484781265
Evaluating: 100%|| 15/15 [00:07<00:00,  1.98it/s]
acc1: 85.8974, acc3: 100.0000, Precision: 0.7864, Recall: 0.7895, F1-Score: 0.7871, Specificity: 0.9164
2026-01-26 04:58:13.942 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [12/100], Top1:85.897, Top3:100.000, Test_precision:0.7864,Test_recall:0.7895,Test_f1:0.7871,,Test_specificity:0.9164 Test_loss:0.359865
2026-01-26 04:58:13.943 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 04:58:13.944 | INFO     | __main__:main_worker:349 - ---> start train epoch13
2026-01-26 04:58:22.970 | INFO     | __main__:main_worker:423 - [13/100], remain:0d.00h.34m, It:[10/54], Max-Mem:11251M, Data-Time:1.072, LR:0.0001, Train_Loss:0.8655, total_loss:tensor([0.8655], device='cuda:0'), ce_loss:0.9473353028297424, cluster_loss:0.16463445127010345, sep_loss:0.03649003058671951, soft_orth_loss:0.00481770746409893, local_consistency_loss:0.001763398409821093, proto_loss:0.20770560204982758
2026-01-26 04:58:26.536 | INFO     | __main__:main_worker:423 - [13/100], remain:0d.00h.30m, It:[20/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.1549, total_loss:tensor([0.1549], device='cuda:0'), ce_loss:0.5272708535194397, cluster_loss:0.09236922115087509, sep_loss:0.03207213804125786, soft_orth_loss:0.0048099299892783165, local_consistency_loss:0.001593549968674779, proto_loss:0.1308448314666748
2026-01-26 04:58:30.249 | INFO     | __main__:main_worker:423 - [13/100], remain:0d.00h.30m, It:[30/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0001, Train_Loss:0.2342, total_loss:tensor([0.2342], device='cuda:0'), ce_loss:0.586175799369812, cluster_loss:0.09446267038583755, sep_loss:0.028307586908340454, soft_orth_loss:0.004803569056093693, local_consistency_loss:0.0014622951857745647, proto_loss:0.12903612852096558
2026-01-26 04:58:34.325 | INFO     | __main__:main_worker:423 - [13/100], remain:0d.00h.30m, It:[40/54], Max-Mem:11251M, Data-Time:0.021, LR:0.0001, Train_Loss:0.8370, total_loss:tensor([0.8370], device='cuda:0'), ce_loss:0.9158617854118347, cluster_loss:0.17478621006011963, sep_loss:0.03555670380592346, soft_orth_loss:0.004798549693077803, local_consistency_loss:0.002946738852187991, proto_loss:0.21808819472789764
2026-01-26 04:58:38.839 | INFO     | __main__:main_worker:423 - [13/100], remain:0d.00h.31m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:-0.3210, total_loss:tensor([-0.3210], device='cuda:0'), ce_loss:0.23136770725250244, cluster_loss:0.07204829901456833, sep_loss:0.016160745173692703, soft_orth_loss:0.0047950646840035915, local_consistency_loss:0.0007299554999917746, proto_loss:0.09373407065868378
Evaluating: 100%|| 15/15 [00:07<00:00,  1.95it/s]
acc1: 85.8974, acc3: 100.0000, Precision: 0.7680, Recall: 0.8085, F1-Score: 0.7856, Specificity: 0.9236
2026-01-26 04:58:48.449 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [13/100], Top1:85.897, Top3:100.000, Test_precision:0.7680,Test_recall:0.8085,Test_f1:0.7856,,Test_specificity:0.9236 Test_loss:0.356490
2026-01-26 04:58:48.450 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 04:58:48.450 | INFO     | __main__:main_worker:349 - ---> start train epoch14
2026-01-26 04:58:56.667 | INFO     | __main__:main_worker:423 - [14/100], remain:0d.00h.27m, It:[10/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0001, Train_Loss:-0.2654, total_loss:tensor([-0.2654], device='cuda:0'), ce_loss:0.2627517580986023, cluster_loss:0.07777657359838486, sep_loss:0.017970478162169456, soft_orth_loss:0.004783104173839092, local_consistency_loss:0.0010815962450578809, proto_loss:0.10161174833774567
2026-01-26 04:59:01.196 | INFO     | __main__:main_worker:423 - [14/100], remain:0d.00h.30m, It:[20/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0001, Train_Loss:0.8273, total_loss:tensor([0.8273], device='cuda:0'), ce_loss:0.9246993064880371, cluster_loss:0.15572890639305115, sep_loss:0.04279268905520439, soft_orth_loss:0.004777431488037109, local_consistency_loss:0.001201833481900394, proto_loss:0.20450086891651154
2026-01-26 04:59:05.277 | INFO     | __main__:main_worker:423 - [14/100], remain:0d.00h.30m, It:[30/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:0.2965, total_loss:tensor([0.2965], device='cuda:0'), ce_loss:0.6495974659919739, cluster_loss:0.07050935178995132, sep_loss:0.03623982518911362, soft_orth_loss:0.004773176275193691, local_consistency_loss:0.0019959539640694857, proto_loss:0.11351830512285233
2026-01-26 04:59:10.262 | INFO     | __main__:main_worker:423 - [14/100], remain:0d.00h.32m, It:[40/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:0.2203, total_loss:tensor([0.2203], device='cuda:0'), ce_loss:0.5671342611312866, cluster_loss:0.10441489517688751, sep_loss:0.028472501784563065, soft_orth_loss:0.00476733548566699, local_consistency_loss:0.0015036306576803327, proto_loss:0.13915835320949554
2026-01-26 04:59:15.962 | INFO     | __main__:main_worker:423 - [14/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:1.7605, total_loss:tensor([1.7605], device='cuda:0'), ce_loss:1.4858256578445435, cluster_loss:0.25234875082969666, sep_loss:0.03709254413843155, soft_orth_loss:0.004758704919368029, local_consistency_loss:0.0015498459106311202, proto_loss:0.29574984312057495
Evaluating: 100%|| 15/15 [00:09<00:00,  1.60it/s]
2026-01-26 04:59:28.517 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [14/100], Top1:86.538, Top3:100.000, Test_precision:0.7824,Test_recall:0.7646,Test_f1:0.7710,,Test_specificity:0.9201 Test_loss:0.401878
2026-01-26 04:59:28.517 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 04:59:28.518 | INFO     | __main__:main_worker:349 - ---> start train epoch15
acc1: 86.5385, acc3: 100.0000, Precision: 0.7824, Recall: 0.7646, F1-Score: 0.7710, Specificity: 0.9201
2026-01-26 04:59:38.072 | INFO     | __main__:main_worker:423 - [15/100], remain:0d.00h.36m, It:[10/54], Max-Mem:11251M, Data-Time:0.943, LR:0.0001, Train_Loss:0.8629, total_loss:tensor([0.8629], device='cuda:0'), ce_loss:0.9460771083831787, cluster_loss:0.16115038096904755, sep_loss:0.041511401534080505, soft_orth_loss:0.004752801731228828, local_consistency_loss:0.0013548108981922269, proto_loss:0.20876939594745636
2026-01-26 04:59:43.812 | INFO     | __main__:main_worker:423 - [15/100], remain:0d.00h.40m, It:[20/54], Max-Mem:11251M, Data-Time:1.932, LR:0.0001, Train_Loss:0.6381, total_loss:tensor([0.6381], device='cuda:0'), ce_loss:0.8269988894462585, cluster_loss:0.12785513699054718, sep_loss:0.03919165953993797, soft_orth_loss:0.004749496001750231, local_consistency_loss:0.0010988150024786592, proto_loss:0.17289510369300842
2026-01-26 04:59:49.157 | INFO     | __main__:main_worker:423 - [15/100], remain:0d.00h.40m, It:[30/54], Max-Mem:11251M, Data-Time:1.527, LR:0.0001, Train_Loss:0.0533, total_loss:tensor([0.0533], device='cuda:0'), ce_loss:0.5616843104362488, cluster_loss:0.00021706917323172092, sep_loss:0.033338386565446854, soft_orth_loss:0.0047438801266252995, local_consistency_loss:0.0016179856611415744, proto_loss:0.03991732373833656
2026-01-26 04:59:54.320 | INFO     | __main__:main_worker:423 - [15/100], remain:0d.00h.39m, It:[40/54], Max-Mem:11251M, Data-Time:1.254, LR:0.0001, Train_Loss:-0.1610, total_loss:tensor([-0.1610], device='cuda:0'), ce_loss:0.33327290415763855, cluster_loss:0.07908501476049423, sep_loss:0.023506147786974907, soft_orth_loss:0.004739114549010992, local_consistency_loss:0.0010523836826905608, proto_loss:0.10838266462087631
2026-01-26 04:59:58.787 | INFO     | __main__:main_worker:423 - [15/100], remain:0d.00h.38m, It:[50/54], Max-Mem:11251M, Data-Time:0.958, LR:0.0001, Train_Loss:0.2568, total_loss:tensor([0.2568], device='cuda:0'), ce_loss:0.6052875518798828, cluster_loss:0.09315699338912964, sep_loss:0.03102496825158596, soft_orth_loss:0.004735350608825684, local_consistency_loss:0.0013421245384961367, proto_loss:0.1302594244480133
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
acc1: 82.4786, acc3: 100.0000, Precision: 0.7249, Recall: 0.7879, F1-Score: 0.7405, Specificity: 0.9064
2026-01-26 05:00:09.507 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [15/100], Top1:82.479, Top3:100.000, Test_precision:0.7249,Test_recall:0.7879,Test_f1:0.7405,,Test_specificity:0.9064 Test_loss:0.441208
2026-01-26 05:00:09.508 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 05:00:18.649 | INFO     | __main__:main_worker:349 - ---> start train epoch16
2026-01-26 05:00:29.485 | INFO     | __main__:main_worker:423 - [16/100], remain:0d.00h.47m, It:[10/54], Max-Mem:11251M, Data-Time:1.809, LR:0.0001, Train_Loss:0.1467, total_loss:tensor([0.1467], device='cuda:0'), ce_loss:0.5322254300117493, cluster_loss:0.09316333383321762, sep_loss:0.027089476585388184, soft_orth_loss:0.004731041844934225, local_consistency_loss:0.0012793659698218107, proto_loss:0.12626321613788605
2026-01-26 05:00:33.385 | INFO     | __main__:main_worker:423 - [16/100], remain:0d.00h.37m, It:[20/54], Max-Mem:11251M, Data-Time:0.446, LR:0.0001, Train_Loss:0.2136, total_loss:tensor([0.2136], device='cuda:0'), ce_loss:0.5574276447296143, cluster_loss:0.10250544548034668, sep_loss:0.03297848626971245, soft_orth_loss:0.004726567305624485, local_consistency_loss:0.0061850412748754025, proto_loss:0.14639554917812347
2026-01-26 05:00:38.246 | INFO     | __main__:main_worker:423 - [16/100], remain:0d.00h.37m, It:[30/54], Max-Mem:11251M, Data-Time:0.021, LR:0.0001, Train_Loss:0.4528, total_loss:tensor([0.4528], device='cuda:0'), ce_loss:0.7147009372711182, cluster_loss:0.11715050786733627, sep_loss:0.03451176732778549, soft_orth_loss:0.00472270417958498, local_consistency_loss:0.0011016716016456485, proto_loss:0.15748664736747742
2026-01-26 05:00:43.719 | INFO     | __main__:main_worker:423 - [16/100], remain:0d.00h.38m, It:[40/54], Max-Mem:11251M, Data-Time:1.084, LR:0.0001, Train_Loss:0.0090, total_loss:tensor([0.0090], device='cuda:0'), ce_loss:0.4466695189476013, cluster_loss:0.08002980798482895, sep_loss:0.02830563858151436, soft_orth_loss:0.004719298332929611, local_consistency_loss:0.003497800324112177, proto_loss:0.11655255407094955
2026-01-26 05:00:49.212 | INFO     | __main__:main_worker:423 - [16/100], remain:0d.00h.38m, It:[50/54], Max-Mem:11251M, Data-Time:1.391, LR:0.0001, Train_Loss:0.3485, total_loss:tensor([0.3485], device='cuda:0'), ce_loss:0.6621334552764893, cluster_loss:0.0979936346411705, sep_loss:0.034923527389764786, soft_orth_loss:0.004714454989880323, local_consistency_loss:0.0013957205228507519, proto_loss:0.13902734220027924
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-26 05:00:50.552 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 16 (LR=0.000096, momentum=0.85)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.3286
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.2602
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.2348
Local prototype push completed!
2026-01-26 05:01:18.555 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:09<00:00,  1.53it/s]
acc1: 84.8291, acc3: 100.0000, Precision: 0.7256, Recall: 0.7262, F1-Score: 0.7202, Specificity: 0.9149
2026-01-26 05:01:28.408 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [16/100], Top1:84.829, Top3:100.000, Test_precision:0.7256,Test_recall:0.7262,Test_f1:0.7202,,Test_specificity:0.9149 Test_loss:0.385078
2026-01-26 05:01:28.409 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 05:01:28.410 | INFO     | __main__:main_worker:349 - ---> start train epoch17
2026-01-26 05:01:37.850 | INFO     | __main__:main_worker:423 - [17/100], remain:0d.00h.34m, It:[10/54], Max-Mem:11251M, Data-Time:0.500, LR:0.0001, Train_Loss:0.5745, total_loss:tensor([0.5745], device='cuda:0'), ce_loss:0.7689546942710876, cluster_loss:0.15345878899097443, sep_loss:0.026255697011947632, soft_orth_loss:0.004960467107594013, local_consistency_loss:0.0019548735581338406, proto_loss:0.18662981688976288
2026-01-26 05:01:41.941 | INFO     | __main__:main_worker:423 - [17/100], remain:0d.00h.32m, It:[20/54], Max-Mem:11251M, Data-Time:0.027, LR:0.0001, Train_Loss:-0.0015, total_loss:tensor([-0.0015], device='cuda:0'), ce_loss:0.4233761131763458, cluster_loss:0.08438003063201904, sep_loss:0.028363032266497612, soft_orth_loss:0.004955464042723179, local_consistency_loss:0.013948442414402962, proto_loss:0.13164697587490082
2026-01-26 05:01:46.211 | INFO     | __main__:main_worker:423 - [17/100], remain:0d.00h.31m, It:[30/54], Max-Mem:11251M, Data-Time:0.817, LR:0.0001, Train_Loss:0.5124, total_loss:tensor([0.5124], device='cuda:0'), ce_loss:0.7514954209327698, cluster_loss:0.10675680637359619, sep_loss:0.03384727984666824, soft_orth_loss:0.00494465883821249, local_consistency_loss:0.017952924594283104, proto_loss:0.16350165009498596
2026-01-26 05:01:50.438 | INFO     | __main__:main_worker:423 - [17/100], remain:0d.00h.31m, It:[40/54], Max-Mem:11251M, Data-Time:0.462, LR:0.0001, Train_Loss:0.1997, total_loss:tensor([0.1997], device='cuda:0'), ce_loss:0.5492473840713501, cluster_loss:0.10858286917209625, sep_loss:0.03200611099600792, soft_orth_loss:0.004937199875712395, local_consistency_loss:0.001408651820383966, proto_loss:0.14693483710289001
2026-01-26 05:01:54.783 | INFO     | __main__:main_worker:423 - [17/100], remain:0d.00h.31m, It:[50/54], Max-Mem:11251M, Data-Time:0.502, LR:0.0001, Train_Loss:0.2819, total_loss:tensor([0.2819], device='cuda:0'), ce_loss:0.6243318915367126, cluster_loss:0.09071297943592072, sep_loss:0.033377643674612045, soft_orth_loss:0.004939911421388388, local_consistency_loss:0.003112482838332653, proto_loss:0.1321430206298828
Evaluating: 100%|| 15/15 [00:07<00:00,  1.98it/s]
acc1: 84.1880, acc3: 100.0000, Precision: 0.7457, Recall: 0.8409, F1-Score: 0.7687, Specificity: 0.9263
2026-01-26 05:02:03.714 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [17/100], Top1:84.188, Top3:100.000, Test_precision:0.7457,Test_recall:0.8409,Test_f1:0.7687,,Test_specificity:0.9263 Test_loss:0.416783
2026-01-26 05:02:03.716 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 05:02:03.717 | INFO     | __main__:main_worker:349 - ---> start train epoch18
2026-01-26 05:02:13.031 | INFO     | __main__:main_worker:423 - [18/100], remain:0d.00h.33m, It:[10/54], Max-Mem:11251M, Data-Time:1.110, LR:0.0001, Train_Loss:-0.0991, total_loss:tensor([-0.0991], device='cuda:0'), ce_loss:0.3829669654369354, cluster_loss:0.08161075413227081, sep_loss:0.018836265429854393, soft_orth_loss:0.004940120968967676, local_consistency_loss:0.002368670655414462, proto_loss:0.10775581747293472
2026-01-26 05:02:16.848 | INFO     | __main__:main_worker:423 - [18/100], remain:0d.00h.30m, It:[20/54], Max-Mem:11251M, Data-Time:0.314, LR:0.0001, Train_Loss:1.0986, total_loss:tensor([1.0986], device='cuda:0'), ce_loss:1.127049207687378, cluster_loss:0.14993630349636078, sep_loss:0.04136619344353676, soft_orth_loss:0.004928926005959511, local_consistency_loss:0.0026173186488449574, proto_loss:0.19884873926639557
2026-01-26 05:02:21.902 | INFO     | __main__:main_worker:423 - [18/100], remain:0d.00h.32m, It:[30/54], Max-Mem:11251M, Data-Time:0.817, LR:0.0001, Train_Loss:0.0546, total_loss:tensor([0.0546], device='cuda:0'), ce_loss:0.46073633432388306, cluster_loss:0.09882209450006485, sep_loss:0.029898453503847122, soft_orth_loss:0.004924212582409382, local_consistency_loss:0.0021872760262340307, proto_loss:0.1358320415019989
2026-01-26 05:02:26.258 | INFO     | __main__:main_worker:423 - [18/100], remain:0d.00h.32m, It:[40/54], Max-Mem:11251M, Data-Time:0.149, LR:0.0001, Train_Loss:0.3524, total_loss:tensor([0.3524], device='cuda:0'), ce_loss:0.6834444403648376, cluster_loss:0.08232676237821579, sep_loss:0.036492619663476944, soft_orth_loss:0.0049216668121516705, local_consistency_loss:0.001366390846669674, proto_loss:0.12510743737220764
2026-01-26 05:02:30.757 | INFO     | __main__:main_worker:423 - [18/100], remain:0d.00h.32m, It:[50/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0001, Train_Loss:0.4443, total_loss:tensor([0.4443], device='cuda:0'), ce_loss:0.7217797040939331, cluster_loss:0.10637249052524567, sep_loss:0.0358336865901947, soft_orth_loss:0.004919924773275852, local_consistency_loss:0.0018786464352160692, proto_loss:0.1490047574043274
Evaluating: 100%|| 15/15 [00:08<00:00,  1.73it/s]
2026-01-26 05:02:41.200 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [18/100], Top1:84.615, Top3:100.000, Test_precision:0.7470,Test_recall:0.7898,Test_f1:0.7618,,Test_specificity:0.9130 Test_loss:0.391192
acc1: 84.6154, acc3: 100.0000, Precision: 0.7470, Recall: 0.7898, F1-Score: 0.7618, Specificity: 0.9130
2026-01-26 05:02:41.201 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 05:02:41.201 | INFO     | __main__:main_worker:349 - ---> start train epoch19
2026-01-26 05:02:50.538 | INFO     | __main__:main_worker:423 - [19/100], remain:0d.00h.35m, It:[10/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.6587, total_loss:tensor([0.6587], device='cuda:0'), ce_loss:0.8634070158004761, cluster_loss:0.11490457504987717, sep_loss:0.0361611470580101, soft_orth_loss:0.004918229300528765, local_consistency_loss:0.0020208393689244986, proto_loss:0.1580047905445099
2026-01-26 05:02:56.841 | INFO     | __main__:main_worker:423 - [19/100], remain:0d.00h.40m, It:[20/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0001, Train_Loss:0.2091, total_loss:tensor([0.2091], device='cuda:0'), ce_loss:0.5689609050750732, cluster_loss:0.09749501943588257, sep_loss:0.03470059856772423, soft_orth_loss:0.00491168349981308, local_consistency_loss:0.0009394668159075081, proto_loss:0.13804678618907928
2026-01-26 05:03:02.632 | INFO     | __main__:main_worker:423 - [19/100], remain:0d.00h.40m, It:[30/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.5660, total_loss:tensor([0.5660], device='cuda:0'), ce_loss:0.9247630834579468, cluster_loss:0.0002618254511617124, sep_loss:0.03702091798186302, soft_orth_loss:0.004902768414467573, local_consistency_loss:0.0039578708820044994, proto_loss:0.04614338278770447
2026-01-26 05:03:07.200 | INFO     | __main__:main_worker:423 - [19/100], remain:0d.00h.38m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.6914, total_loss:tensor([0.6914], device='cuda:0'), ce_loss:0.8697271943092346, cluster_loss:0.13262565433979034, sep_loss:0.032619670033454895, soft_orth_loss:0.004891152959316969, local_consistency_loss:0.003376948181539774, proto_loss:0.17351342737674713
2026-01-26 05:03:12.382 | INFO     | __main__:main_worker:423 - [19/100], remain:0d.00h.38m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.2225, total_loss:tensor([0.2225], device='cuda:0'), ce_loss:0.5825155377388, cluster_loss:0.09347083419561386, sep_loss:0.034976959228515625, soft_orth_loss:0.004883354529738426, local_consistency_loss:0.0020069540478289127, proto_loss:0.13533809781074524
Evaluating: 100%|| 15/15 [00:09<00:00,  1.53it/s]
2026-01-26 05:03:26.040 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [19/100], Top1:81.197, Top3:100.000, Test_precision:0.7042,Test_recall:0.7925,Test_f1:0.7272,,Test_specificity:0.9168 Test_loss:0.537924
acc1: 81.1966, acc3: 100.0000, Precision: 0.7042, Recall: 0.7925, F1-Score: 0.7272, Specificity: 0.9168
2026-01-26 05:03:26.041 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 05:03:26.042 | INFO     | __main__:main_worker:349 - ---> start train epoch20
2026-01-26 05:03:35.977 | INFO     | __main__:main_worker:423 - [20/100], remain:0d.00h.35m, It:[10/54], Max-Mem:11251M, Data-Time:1.186, LR:0.0001, Train_Loss:0.4593, total_loss:tensor([0.4593], device='cuda:0'), ce_loss:0.7506922483444214, cluster_loss:0.09288041293621063, sep_loss:0.034800659865140915, soft_orth_loss:0.00487443758174777, local_consistency_loss:0.0021850373595952988, proto_loss:0.13474054634571075
2026-01-26 05:03:42.315 | INFO     | __main__:main_worker:423 - [20/100], remain:0d.00h.40m, It:[20/54], Max-Mem:11251M, Data-Time:2.793, LR:0.0001, Train_Loss:0.2584, total_loss:tensor([0.2584], device='cuda:0'), ce_loss:0.5997278094291687, cluster_loss:0.10459230095148087, sep_loss:0.03284547105431557, soft_orth_loss:0.004860009532421827, local_consistency_loss:0.0010315245017409325, proto_loss:0.14332930743694305
2026-01-26 05:03:47.416 | INFO     | __main__:main_worker:423 - [20/100], remain:0d.00h.38m, It:[30/54], Max-Mem:11251M, Data-Time:1.545, LR:0.0001, Train_Loss:0.3692, total_loss:tensor([0.3692], device='cuda:0'), ce_loss:0.6958125233650208, cluster_loss:0.08471125364303589, sep_loss:0.037297770380973816, soft_orth_loss:0.004842489026486874, local_consistency_loss:0.000820743094664067, proto_loss:0.1276722550392151
2026-01-26 05:03:51.835 | INFO     | __main__:main_worker:423 - [20/100], remain:0d.00h.36m, It:[40/54], Max-Mem:11251M, Data-Time:0.849, LR:0.0001, Train_Loss:1.0036, total_loss:tensor([1.0036], device='cuda:0'), ce_loss:1.0434539318084717, cluster_loss:0.16919270157814026, sep_loss:0.040016911923885345, soft_orth_loss:0.004830071236938238, local_consistency_loss:0.0018089873483404517, proto_loss:0.21584868431091309
2026-01-26 05:03:56.513 | INFO     | __main__:main_worker:423 - [20/100], remain:0d.00h.35m, It:[50/54], Max-Mem:11251M, Data-Time:1.095, LR:0.0001, Train_Loss:0.5207, total_loss:tensor([0.5207], device='cuda:0'), ce_loss:0.9032040238380432, cluster_loss:0.00026516319485381246, sep_loss:0.03232382610440254, soft_orth_loss:0.004822395741939545, local_consistency_loss:0.0019920344930142164, proto_loss:0.03940341994166374
Evaluating: 100%|| 15/15 [00:08<00:00,  1.82it/s]
acc1: 86.5385, acc3: 100.0000, Precision: 0.7804, Recall: 0.8443, F1-Score: 0.8064, Specificity: 0.9289
2026-01-26 05:04:06.467 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [20/100], Top1:86.538, Top3:100.000, Test_precision:0.7804,Test_recall:0.8443,Test_f1:0.8064,,Test_specificity:0.9289 Test_loss:0.354105
2026-01-26 05:04:06.468 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 05:04:15.601 | INFO     | __main__:main_worker:349 - ---> start train epoch21
2026-01-26 05:04:27.719 | INFO     | __main__:main_worker:423 - [21/100], remain:0d.00h.49m, It:[10/54], Max-Mem:11251M, Data-Time:3.414, LR:0.0001, Train_Loss:-0.0528, total_loss:tensor([-0.0528], device='cuda:0'), ce_loss:0.4171943962574005, cluster_loss:0.07572317123413086, sep_loss:0.027692198753356934, soft_orth_loss:0.004809441044926643, local_consistency_loss:0.004122348502278328, proto_loss:0.11234715580940247
2026-01-26 05:04:31.715 | INFO     | __main__:main_worker:423 - [21/100], remain:0d.00h.38m, It:[20/54], Max-Mem:11251M, Data-Time:0.557, LR:0.0001, Train_Loss:-0.1189, total_loss:tensor([-0.1189], device='cuda:0'), ce_loss:0.3785974681377411, cluster_loss:0.07510864734649658, sep_loss:0.02380918525159359, soft_orth_loss:0.0047990186139941216, local_consistency_loss:0.002080920385196805, proto_loss:0.10579776763916016
2026-01-26 05:04:36.763 | INFO     | __main__:main_worker:423 - [21/100], remain:0d.00h.37m, It:[30/54], Max-Mem:11251M, Data-Time:1.607, LR:0.0001, Train_Loss:0.1847, total_loss:tensor([0.1847], device='cuda:0'), ce_loss:0.5522729158401489, cluster_loss:0.1043110117316246, sep_loss:0.030924571678042412, soft_orth_loss:0.004793921485543251, local_consistency_loss:0.001539714983664453, proto_loss:0.14156922698020935
2026-01-26 05:04:43.985 | INFO     | __main__:main_worker:423 - [21/100], remain:0d.00h.40m, It:[40/54], Max-Mem:11251M, Data-Time:3.666, LR:0.0001, Train_Loss:-0.1963, total_loss:tensor([-0.1963], device='cuda:0'), ce_loss:0.331482857465744, cluster_loss:0.07644850015640259, sep_loss:0.018004843965172768, soft_orth_loss:0.004789397120475769, local_consistency_loss:0.0010328239295631647, proto_loss:0.10027556121349335
2026-01-26 05:04:49.257 | INFO     | __main__:main_worker:423 - [21/100], remain:0d.00h.39m, It:[50/54], Max-Mem:11251M, Data-Time:1.789, LR:0.0001, Train_Loss:-0.0559, total_loss:tensor([-0.0559], device='cuda:0'), ce_loss:0.3962526321411133, cluster_loss:0.09845855087041855, sep_loss:0.02567189745604992, soft_orth_loss:0.004785890690982342, local_consistency_loss:0.0016957245534285903, proto_loss:0.1306120604276657
Evaluating: 100%|| 15/15 [00:09<00:00,  1.61it/s]
2026-01-26 05:04:59.935 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [21/100], Top1:85.684, Top3:100.000, Test_precision:0.7627,Test_recall:0.8214,Test_f1:0.7860,,Test_specificity:0.9246 Test_loss:0.402186
2026-01-26 05:04:59.935 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 05:04:59.936 | INFO     | __main__:main_worker:349 - ---> start train epoch22
acc1: 85.6838, acc3: 100.0000, Precision: 0.7627, Recall: 0.8214, F1-Score: 0.7860, Specificity: 0.9246
2026-01-26 05:05:07.950 | INFO     | __main__:main_worker:423 - [22/100], remain:0d.00h.25m, It:[10/54], Max-Mem:11251M, Data-Time:0.197, LR:0.0001, Train_Loss:-0.0330, total_loss:tensor([-0.0330], device='cuda:0'), ce_loss:0.4203813076019287, cluster_loss:0.09536654502153397, sep_loss:0.02125806175172329, soft_orth_loss:0.004782659467309713, local_consistency_loss:0.0026217715349048376, proto_loss:0.12402904033660889
2026-01-26 05:05:12.167 | INFO     | __main__:main_worker:423 - [22/100], remain:0d.00h.27m, It:[20/54], Max-Mem:11251M, Data-Time:0.270, LR:0.0001, Train_Loss:0.9991, total_loss:tensor([0.9991], device='cuda:0'), ce_loss:1.0471152067184448, cluster_loss:0.1668540984392166, sep_loss:0.038514431565999985, soft_orth_loss:0.004775128792971373, local_consistency_loss:0.0008317842148244381, proto_loss:0.21097543835639954
2026-01-26 05:05:16.883 | INFO     | __main__:main_worker:423 - [22/100], remain:0d.00h.28m, It:[30/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0001, Train_Loss:0.4155, total_loss:tensor([0.4155], device='cuda:0'), ce_loss:0.7113446593284607, cluster_loss:0.10203903168439865, sep_loss:0.03785746917128563, soft_orth_loss:0.0047709038481116295, local_consistency_loss:0.0011359526542946696, proto_loss:0.14580334722995758
2026-01-26 05:05:21.301 | INFO     | __main__:main_worker:423 - [22/100], remain:0d.00h.29m, It:[40/54], Max-Mem:11251M, Data-Time:0.022, LR:0.0001, Train_Loss:0.1647, total_loss:tensor([0.1647], device='cuda:0'), ce_loss:0.5643810033798218, cluster_loss:0.08177489042282104, sep_loss:0.03284718468785286, soft_orth_loss:0.004764978773891926, local_consistency_loss:0.0010052024153992534, proto_loss:0.12039225548505783
2026-01-26 05:05:25.596 | INFO     | __main__:main_worker:423 - [22/100], remain:0d.00h.29m, It:[50/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.1003, total_loss:tensor([0.1003], device='cuda:0'), ce_loss:0.509170651435852, cluster_loss:0.10088646411895752, sep_loss:0.023510096594691277, soft_orth_loss:0.004758066032081842, local_consistency_loss:0.0004503249656409025, proto_loss:0.12960495054721832
Evaluating: 100%|| 15/15 [00:07<00:00,  2.02it/s]
2026-01-26 05:05:36.082 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [22/100], Top1:85.897, Top3:100.000, Test_precision:0.7670,Test_recall:0.8159,Test_f1:0.7876,,Test_specificity:0.9266 Test_loss:0.404464
acc1: 85.8974, acc3: 100.0000, Precision: 0.7670, Recall: 0.8159, F1-Score: 0.7876, Specificity: 0.9266
2026-01-26 05:05:36.083 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [6/100], Top1:86.752, Top-3:100.000
2026-01-26 05:05:36.084 | INFO     | __main__:main_worker:349 - ---> start train epoch23
2026-01-26 05:05:45.392 | INFO     | __main__:main_worker:423 - [23/100], remain:0d.00h.31m, It:[10/54], Max-Mem:11251M, Data-Time:1.212, LR:0.0001, Train_Loss:0.1819, total_loss:tensor([0.1819], device='cuda:0'), ce_loss:0.550426721572876, cluster_loss:0.11324365437030792, sep_loss:0.024672651663422585, soft_orth_loss:0.004745760932564735, local_consistency_loss:0.001470876857638359, proto_loss:0.14413295686244965
2026-01-26 05:05:49.454 | INFO     | __main__:main_worker:423 - [23/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0001, Train_Loss:0.6754, total_loss:tensor([0.6754], device='cuda:0'), ce_loss:0.8571501970291138, cluster_loss:0.13438072800636292, sep_loss:0.03903248906135559, soft_orth_loss:0.004733512178063393, local_consistency_loss:0.0010679379338398576, proto_loss:0.17921467125415802
2026-01-26 05:05:54.138 | INFO     | __main__:main_worker:423 - [23/100], remain:0d.00h.30m, It:[30/54], Max-Mem:11251M, Data-Time:1.265, LR:0.0001, Train_Loss:-0.0356, total_loss:tensor([-0.0356], device='cuda:0'), ce_loss:0.4456008970737457, cluster_loss:0.06856756657361984, sep_loss:0.028923312202095985, soft_orth_loss:0.004724699072539806, local_consistency_loss:0.0007624512072652578, proto_loss:0.10297802090644836
2026-01-26 05:05:58.332 | INFO     | __main__:main_worker:423 - [23/100], remain:0d.00h.29m, It:[40/54], Max-Mem:11251M, Data-Time:0.788, LR:0.0001, Train_Loss:0.4167, total_loss:tensor([0.4167], device='cuda:0'), ce_loss:0.8346001505851746, cluster_loss:0.00023609395429957658, sep_loss:0.03392312675714493, soft_orth_loss:0.0047182305715978146, local_consistency_loss:0.0010892924619838595, proto_loss:0.03996674343943596
2026-01-26 05:06:01.895 | INFO     | __main__:main_worker:423 - [23/100], remain:0d.00h.28m, It:[50/54], Max-Mem:11251M, Data-Time:0.164, LR:0.0001, Train_Loss:0.4465, total_loss:tensor([0.4465], device='cuda:0'), ce_loss:0.71160888671875, cluster_loss:0.1313154697418213, sep_loss:0.02997151017189026, soft_orth_loss:0.004713230766355991, local_consistency_loss:0.0008436062489636242, proto_loss:0.16684381663799286
Evaluating: 100%|| 15/15 [00:08<00:00,  1.77it/s]
2026-01-26 05:06:11.692 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [23/100], Top1:86.966, Top3:100.000, Test_precision:0.8020,Test_recall:0.7886,Test_f1:0.7913,,Test_specificity:0.9264 Test_loss:0.339201
acc1: 86.9658, acc3: 100.0000, Precision: 0.8020, Recall: 0.7886, F1-Score: 0.7913, Specificity: 0.9264
2026-01-26 05:06:11.693 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [23/100], Top1:86.966, Top-3:100.000
2026-01-26 05:06:29.365 | INFO     | __main__:main_worker:349 - ---> start train epoch24
2026-01-26 05:06:39.359 | INFO     | __main__:main_worker:423 - [24/100], remain:0d.00h.40m, It:[10/54], Max-Mem:11251M, Data-Time:0.019, LR:0.0001, Train_Loss:0.3746, total_loss:tensor([0.3746], device='cuda:0'), ce_loss:0.6748195886611938, cluster_loss:0.11635901033878326, sep_loss:0.03269679471850395, soft_orth_loss:0.004707155283540487, local_consistency_loss:0.001514341332949698, proto_loss:0.1552773118019104
2026-01-26 05:06:44.342 | INFO     | __main__:main_worker:423 - [24/100], remain:0d.00h.37m, It:[20/54], Max-Mem:11251M, Data-Time:0.803, LR:0.0001, Train_Loss:0.2283, total_loss:tensor([0.2283], device='cuda:0'), ce_loss:0.6018100380897522, cluster_loss:0.09255187958478928, sep_loss:0.030702227726578712, soft_orth_loss:0.0047031245194375515, local_consistency_loss:0.001698508276604116, proto_loss:0.12965573370456696
2026-01-26 05:06:49.035 | INFO     | __main__:main_worker:423 - [24/100], remain:0d.00h.35m, It:[30/54], Max-Mem:11251M, Data-Time:0.066, LR:0.0001, Train_Loss:-0.1884, total_loss:tensor([-0.1884], device='cuda:0'), ce_loss:0.3424842059612274, cluster_loss:0.06898921728134155, sep_loss:0.02675672434270382, soft_orth_loss:0.004695031326264143, local_consistency_loss:0.0012231807922944427, proto_loss:0.10166415572166443
2026-01-26 05:06:54.120 | INFO     | __main__:main_worker:423 - [24/100], remain:0d.00h.34m, It:[40/54], Max-Mem:11251M, Data-Time:0.925, LR:0.0001, Train_Loss:1.1925, total_loss:tensor([1.1925], device='cuda:0'), ce_loss:1.1472856998443604, cluster_loss:0.19811056554317474, sep_loss:0.03891723230481148, soft_orth_loss:0.004682535771280527, local_consistency_loss:0.0021534606348723173, proto_loss:0.2438637912273407
2026-01-26 05:06:59.252 | INFO     | __main__:main_worker:423 - [24/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:0.0879, total_loss:tensor([0.0879], device='cuda:0'), ce_loss:0.5095430016517639, cluster_loss:0.08734185993671417, sep_loss:0.03207695484161377, soft_orth_loss:0.004673751071095467, local_consistency_loss:0.0014567346079275012, proto_loss:0.1255493015050888
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-26 05:07:03.024 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 24 (LR=0.000089, momentum=0.85)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.2454
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.1809
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.1524
Local prototype push completed!
2026-01-26 05:07:31.025 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.79it/s]
acc1: 87.1795, acc3: 100.0000, Precision: 0.7697, Recall: 0.8358, F1-Score: 0.7911, Specificity: 0.9386
2026-01-26 05:07:39.439 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [24/100], Top1:87.179, Top3:100.000, Test_precision:0.7697,Test_recall:0.8358,Test_f1:0.7911,,Test_specificity:0.9386 Test_loss:0.359272
2026-01-26 05:07:39.440 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
2026-01-26 05:07:57.228 | INFO     | __main__:main_worker:349 - ---> start train epoch25
2026-01-26 05:08:08.866 | INFO     | __main__:main_worker:423 - [25/100], remain:0d.00h.40m, It:[10/54], Max-Mem:11251M, Data-Time:2.532, LR:0.0001, Train_Loss:0.5484, total_loss:tensor([0.5484], device='cuda:0'), ce_loss:0.7870632410049438, cluster_loss:0.12339826673269272, sep_loss:0.0354883074760437, soft_orth_loss:0.004849449265748262, local_consistency_loss:0.0012860860442742705, proto_loss:0.1650221198797226
2026-01-26 05:08:14.224 | INFO     | __main__:main_worker:423 - [25/100], remain:0d.00h.38m, It:[20/54], Max-Mem:11251M, Data-Time:1.856, LR:0.0001, Train_Loss:0.6228, total_loss:tensor([0.6228], device='cuda:0'), ce_loss:0.7970256209373474, cluster_loss:0.15386757254600525, sep_loss:0.04123353958129883, soft_orth_loss:0.004850177560001612, local_consistency_loss:0.002233401406556368, proto_loss:0.20218469202518463
2026-01-26 05:08:19.736 | INFO     | __main__:main_worker:423 - [25/100], remain:0d.00h.37m, It:[30/54], Max-Mem:11251M, Data-Time:2.009, LR:0.0001, Train_Loss:-0.0392, total_loss:tensor([-0.0392], device='cuda:0'), ce_loss:0.43606334924697876, cluster_loss:0.08696338534355164, sep_loss:0.018625913187861443, soft_orth_loss:0.0048505705781280994, local_consistency_loss:0.002776539186015725, proto_loss:0.11321641504764557
2026-01-26 05:08:24.626 | INFO     | __main__:main_worker:423 - [25/100], remain:0d.00h.36m, It:[40/54], Max-Mem:11251M, Data-Time:1.356, LR:0.0001, Train_Loss:0.2395, total_loss:tensor([0.2395], device='cuda:0'), ce_loss:0.5941299200057983, cluster_loss:0.11347706615924835, sep_loss:0.026840779930353165, soft_orth_loss:0.00485133146867156, local_consistency_loss:0.0005020320531912148, proto_loss:0.14567120373249054
2026-01-26 05:08:29.818 | INFO     | __main__:main_worker:423 - [25/100], remain:0d.00h.35m, It:[50/54], Max-Mem:11251M, Data-Time:1.693, LR:0.0001, Train_Loss:0.4233, total_loss:tensor([0.4233], device='cuda:0'), ce_loss:0.7121948599815369, cluster_loss:0.11028685420751572, sep_loss:0.038422442972660065, soft_orth_loss:0.0048458632081747055, local_consistency_loss:0.001408710959367454, proto_loss:0.15496386587619781
Evaluating: 100%|| 15/15 [00:07<00:00,  2.07it/s]
2026-01-26 05:08:38.359 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [25/100], Top1:84.615, Top3:100.000, Test_precision:0.7495,Test_recall:0.8394,Test_f1:0.7781,,Test_specificity:0.9256 Test_loss:0.406554
2026-01-26 05:08:38.360 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
acc1: 84.6154, acc3: 100.0000, Precision: 0.7495, Recall: 0.8394, F1-Score: 0.7781, Specificity: 0.9256
2026-01-26 05:08:56.344 | INFO     | __main__:main_worker:349 - ---> start train epoch26
2026-01-26 05:09:05.053 | INFO     | __main__:main_worker:423 - [26/100], remain:0d.00h.32m, It:[10/54], Max-Mem:11251M, Data-Time:1.113, LR:0.0001, Train_Loss:0.3611, total_loss:tensor([0.3611], device='cuda:0'), ce_loss:0.6736891865730286, cluster_loss:0.10851524025201797, sep_loss:0.03641491010785103, soft_orth_loss:0.004839527420699596, local_consistency_loss:0.0011805671965703368, proto_loss:0.15095025300979614
2026-01-26 05:09:09.043 | INFO     | __main__:main_worker:423 - [26/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.0248, total_loss:tensor([0.0248], device='cuda:0'), ce_loss:0.47787919640541077, cluster_loss:0.07946660369634628, sep_loss:0.03108670376241207, soft_orth_loss:0.004836373962461948, local_consistency_loss:0.0016605638666078448, proto_loss:0.11705024540424347
2026-01-26 05:09:13.663 | INFO     | __main__:main_worker:423 - [26/100], remain:0d.00h.29m, It:[30/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0001, Train_Loss:-0.1819, total_loss:tensor([-0.1819], device='cuda:0'), ce_loss:0.3504592478275299, cluster_loss:0.07799811661243439, sep_loss:0.01881181076169014, soft_orth_loss:0.004831438418477774, local_consistency_loss:0.0008808754500932992, proto_loss:0.10252223908901215
2026-01-26 05:09:18.841 | INFO     | __main__:main_worker:423 - [26/100], remain:0d.00h.30m, It:[40/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:0.8797, total_loss:tensor([0.8797], device='cuda:0'), ce_loss:0.972094714641571, cluster_loss:0.16463778913021088, sep_loss:0.03533167764544487, soft_orth_loss:0.004826809745281935, local_consistency_loss:0.002571354852989316, proto_loss:0.2073676437139511
2026-01-26 05:09:23.302 | INFO     | __main__:main_worker:423 - [26/100], remain:0d.00h.30m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:-0.0181, total_loss:tensor([-0.0181], device='cuda:0'), ce_loss:0.462127685546875, cluster_loss:0.07499565929174423, sep_loss:0.02478978969156742, soft_orth_loss:0.004824896343052387, local_consistency_loss:0.0009869541972875595, proto_loss:0.10559730231761932
Evaluating: 100%|| 15/15 [00:07<00:00,  2.04it/s]
acc1: 86.9658, acc3: 100.0000, Precision: 0.7851, Recall: 0.8257, F1-Score: 0.8028, Specificity: 0.9300
2026-01-26 05:09:32.201 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [26/100], Top1:86.966, Top3:100.000, Test_precision:0.7851,Test_recall:0.8257,Test_f1:0.8028,,Test_specificity:0.9300 Test_loss:0.334379
2026-01-26 05:09:32.201 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
2026-01-26 05:09:32.202 | INFO     | __main__:main_worker:349 - ---> start train epoch27
2026-01-26 05:09:43.646 | INFO     | __main__:main_worker:423 - [27/100], remain:0d.00h.39m, It:[10/54], Max-Mem:11251M, Data-Time:2.591, LR:0.0001, Train_Loss:0.1650, total_loss:tensor([0.1650], device='cuda:0'), ce_loss:0.5557884573936462, cluster_loss:0.10033831745386124, sep_loss:0.02860754169523716, soft_orth_loss:0.004823104944080114, local_consistency_loss:0.00221787067130208, proto_loss:0.1359868347644806
2026-01-26 05:09:48.136 | INFO     | __main__:main_worker:423 - [27/100], remain:0d.00h.34m, It:[20/54], Max-Mem:11251M, Data-Time:0.953, LR:0.0001, Train_Loss:0.2858, total_loss:tensor([0.2858], device='cuda:0'), ce_loss:0.6497145295143127, cluster_loss:0.09397227317094803, sep_loss:0.026865461841225624, soft_orth_loss:0.004826003219932318, local_consistency_loss:0.0021341301035135984, proto_loss:0.12779787182807922
2026-01-26 05:09:53.446 | INFO     | __main__:main_worker:423 - [27/100], remain:0d.00h.34m, It:[30/54], Max-Mem:11251M, Data-Time:1.475, LR:0.0001, Train_Loss:0.2240, total_loss:tensor([0.2240], device='cuda:0'), ce_loss:0.6322439908981323, cluster_loss:0.06715475767850876, sep_loss:0.03131658956408501, soft_orth_loss:0.0048241689801216125, local_consistency_loss:0.0023615628015249968, proto_loss:0.10565707832574844
2026-01-26 05:09:59.345 | INFO     | __main__:main_worker:423 - [27/100], remain:0d.00h.35m, It:[40/54], Max-Mem:11251M, Data-Time:2.261, LR:0.0001, Train_Loss:0.1335, total_loss:tensor([0.1335], device='cuda:0'), ce_loss:0.5396413207054138, cluster_loss:0.0928981825709343, sep_loss:0.03304450958967209, soft_orth_loss:0.004822127055376768, local_consistency_loss:0.001056553446687758, proto_loss:0.13182136416435242
2026-01-26 05:10:05.254 | INFO     | __main__:main_worker:423 - [27/100], remain:0d.00h.35m, It:[50/54], Max-Mem:11251M, Data-Time:2.407, LR:0.0001, Train_Loss:0.5499, total_loss:tensor([0.5499], device='cuda:0'), ce_loss:0.7880797982215881, cluster_loss:0.12999053299427032, sep_loss:0.03258151933550835, soft_orth_loss:0.004819395951926708, local_consistency_loss:0.0010518633062019944, proto_loss:0.16844330728054047
Evaluating: 100%|| 15/15 [00:09<00:00,  1.62it/s]
acc1: 85.2564, acc3: 100.0000, Precision: 0.7565, Recall: 0.8158, F1-Score: 0.7800, Specificity: 0.9219
2026-01-26 05:10:15.801 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [27/100], Top1:85.256, Top3:100.000, Test_precision:0.7565,Test_recall:0.8158,Test_f1:0.7800,,Test_specificity:0.9219 Test_loss:0.374056
2026-01-26 05:10:15.801 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
2026-01-26 05:10:15.802 | INFO     | __main__:main_worker:349 - ---> start train epoch28
2026-01-26 05:10:25.911 | INFO     | __main__:main_worker:423 - [28/100], remain:0d.00h.32m, It:[10/54], Max-Mem:11251M, Data-Time:0.039, LR:0.0001, Train_Loss:-0.1355, total_loss:tensor([-0.1355], device='cuda:0'), ce_loss:0.3711149990558624, cluster_loss:0.08116312325000763, sep_loss:0.02915167808532715, soft_orth_loss:0.004822544287890196, local_consistency_loss:0.0011552477953955531, proto_loss:0.11629259586334229
2026-01-26 05:10:31.069 | INFO     | __main__:main_worker:423 - [28/100], remain:0d.00h.32m, It:[20/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.1541, total_loss:tensor([-0.1541], device='cuda:0'), ce_loss:0.38038328289985657, cluster_loss:0.07147283852100372, sep_loss:0.018655037507414818, soft_orth_loss:0.004824406933039427, local_consistency_loss:0.0023835168685764074, proto_loss:0.0973358005285263
2026-01-26 05:10:36.531 | INFO     | __main__:main_worker:423 - [28/100], remain:0d.00h.33m, It:[30/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.3110, total_loss:tensor([0.3110], device='cuda:0'), ce_loss:0.6395601630210876, cluster_loss:0.12065138667821884, sep_loss:0.027766356244683266, soft_orth_loss:0.004822618328034878, local_consistency_loss:0.0006723487749695778, proto_loss:0.1539127081632614
2026-01-26 05:10:40.640 | INFO     | __main__:main_worker:423 - [28/100], remain:0d.00h.31m, It:[40/54], Max-Mem:11251M, Data-Time:0.558, LR:0.0001, Train_Loss:-0.2379, total_loss:tensor([-0.2379], device='cuda:0'), ce_loss:0.3061909079551697, cluster_loss:0.08439323306083679, sep_loss:0.021951520815491676, soft_orth_loss:0.004820641130208969, local_consistency_loss:0.0010750319343060255, proto_loss:0.11224041879177094
2026-01-26 05:10:46.402 | INFO     | __main__:main_worker:423 - [28/100], remain:0d.00h.32m, It:[50/54], Max-Mem:11251M, Data-Time:0.651, LR:0.0001, Train_Loss:-0.2062, total_loss:tensor([-0.2062], device='cuda:0'), ce_loss:0.3350498378276825, cluster_loss:0.0857558622956276, sep_loss:0.015170334838330746, soft_orth_loss:0.004817895591259003, local_consistency_loss:0.0010252492502331734, proto_loss:0.10676934570074081
Evaluating: 100%|| 15/15 [00:09<00:00,  1.50it/s]
2026-01-26 05:10:58.234 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [28/100], Top1:83.547, Top3:100.000, Test_precision:0.7375,Test_recall:0.8139,Test_f1:0.7598,,Test_specificity:0.9154 Test_loss:0.404212
acc1: 83.5470, acc3: 100.0000, Precision: 0.7375, Recall: 0.8139, F1-Score: 0.7598, Specificity: 0.9154
2026-01-26 05:10:58.235 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
2026-01-26 05:10:58.236 | INFO     | __main__:main_worker:349 - ---> start train epoch29
2026-01-26 05:11:08.288 | INFO     | __main__:main_worker:423 - [29/100], remain:0d.00h.27m, It:[10/54], Max-Mem:11251M, Data-Time:0.566, LR:0.0001, Train_Loss:0.3360, total_loss:tensor([0.3360], device='cuda:0'), ce_loss:0.6582292318344116, cluster_loss:0.11759231239557266, sep_loss:0.029762906953692436, soft_orth_loss:0.004812632221728563, local_consistency_loss:0.0017188162310048938, proto_loss:0.15388666093349457
2026-01-26 05:11:14.008 | INFO     | __main__:main_worker:423 - [29/100], remain:0d.00h.31m, It:[20/54], Max-Mem:11251M, Data-Time:2.085, LR:0.0001, Train_Loss:0.0035, total_loss:tensor([0.0035], device='cuda:0'), ce_loss:0.4822910726070404, cluster_loss:0.07633600383996964, sep_loss:0.02439955435693264, soft_orth_loss:0.0048066722229123116, local_consistency_loss:0.0008010702440515161, proto_loss:0.10634330660104752
2026-01-26 05:11:19.411 | INFO     | __main__:main_worker:423 - [29/100], remain:0d.00h.32m, It:[30/54], Max-Mem:11251M, Data-Time:1.888, LR:0.0001, Train_Loss:0.3119, total_loss:tensor([0.3119], device='cuda:0'), ce_loss:0.637091338634491, cluster_loss:0.11892712116241455, sep_loss:0.03346247598528862, soft_orth_loss:0.004799325950443745, local_consistency_loss:0.001115121180191636, proto_loss:0.15830405056476593
2026-01-26 05:11:24.922 | INFO     | __main__:main_worker:423 - [29/100], remain:0d.00h.32m, It:[40/54], Max-Mem:11251M, Data-Time:1.038, LR:0.0001, Train_Loss:0.3925, total_loss:tensor([0.3925], device='cuda:0'), ce_loss:0.7006008625030518, cluster_loss:0.10849785059690475, sep_loss:0.03317395597696304, soft_orth_loss:0.004794558044523001, local_consistency_loss:0.005484820809215307, proto_loss:0.15195117890834808
2026-01-26 05:11:30.905 | INFO     | __main__:main_worker:423 - [29/100], remain:0d.00h.33m, It:[50/54], Max-Mem:11251M, Data-Time:1.552, LR:0.0001, Train_Loss:0.2293, total_loss:tensor([0.2293], device='cuda:0'), ce_loss:0.6042600274085999, cluster_loss:0.10209689289331436, sep_loss:0.02994622103869915, soft_orth_loss:0.004787869285792112, local_consistency_loss:0.0007436209707520902, proto_loss:0.13757459819316864
Evaluating: 100%|| 15/15 [00:08<00:00,  1.79it/s]
acc1: 82.2650, acc3: 100.0000, Precision: 0.7253, Recall: 0.7933, F1-Score: 0.7380, Specificity: 0.9070
2026-01-26 05:11:40.982 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [29/100], Top1:82.265, Top3:100.000, Test_precision:0.7253,Test_recall:0.7933,Test_f1:0.7380,,Test_specificity:0.9070 Test_loss:0.414472
2026-01-26 05:11:40.983 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
2026-01-26 05:11:40.984 | INFO     | __main__:main_worker:349 - ---> start train epoch30
2026-01-26 05:11:53.509 | INFO     | __main__:main_worker:423 - [30/100], remain:0d.00h.39m, It:[10/54], Max-Mem:11251M, Data-Time:2.669, LR:0.0001, Train_Loss:0.4282, total_loss:tensor([0.4282], device='cuda:0'), ce_loss:0.7424770593643188, cluster_loss:0.09053047746419907, sep_loss:0.04098367691040039, soft_orth_loss:0.004777318798005581, local_consistency_loss:0.0013094067107886076, proto_loss:0.1376008838415146
2026-01-26 05:11:59.215 | INFO     | __main__:main_worker:423 - [30/100], remain:0d.00h.37m, It:[20/54], Max-Mem:11251M, Data-Time:1.931, LR:0.0001, Train_Loss:0.0373, total_loss:tensor([0.0373], device='cuda:0'), ce_loss:0.4899906516075134, cluster_loss:0.0851878896355629, sep_loss:0.030961645767092705, soft_orth_loss:0.004766952712088823, local_consistency_loss:0.0008719495381228626, proto_loss:0.12178844213485718
2026-01-26 05:12:04.286 | INFO     | __main__:main_worker:423 - [30/100], remain:0d.00h.35m, It:[30/54], Max-Mem:11251M, Data-Time:1.590, LR:0.0001, Train_Loss:0.1759, total_loss:tensor([0.1759], device='cuda:0'), ce_loss:0.6065855622291565, cluster_loss:0.06803679466247559, sep_loss:0.029213864356279373, soft_orth_loss:0.0047588348388671875, local_consistency_loss:0.0022121677175164223, proto_loss:0.1042216569185257
2026-01-26 05:12:08.399 | INFO     | __main__:main_worker:423 - [30/100], remain:0d.00h.32m, It:[40/54], Max-Mem:11251M, Data-Time:0.402, LR:0.0001, Train_Loss:0.5291, total_loss:tensor([0.5291], device='cuda:0'), ce_loss:0.7709599137306213, cluster_loss:0.1332722008228302, sep_loss:0.03543001040816307, soft_orth_loss:0.004753831308335066, local_consistency_loss:0.000920190301258117, proto_loss:0.1743762344121933
2026-01-26 05:12:13.091 | INFO     | __main__:main_worker:423 - [30/100], remain:0d.00h.31m, It:[50/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:1.0023, total_loss:tensor([1.0023], device='cuda:0'), ce_loss:1.0418455600738525, cluster_loss:0.1789315789937973, sep_loss:0.03918040916323662, soft_orth_loss:0.004752142354846001, local_consistency_loss:0.0011827768757939339, proto_loss:0.22404691576957703
Evaluating: 100%|| 15/15 [00:07<00:00,  2.02it/s]
2026-01-26 05:12:21.922 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [30/100], Top1:83.974, Top3:100.000, Test_precision:0.7406,Test_recall:0.8319,Test_f1:0.7677,,Test_specificity:0.9242 Test_loss:0.400922
2026-01-26 05:12:21.923 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
acc1: 83.9744, acc3: 100.0000, Precision: 0.7406, Recall: 0.8319, F1-Score: 0.7677, Specificity: 0.9242
2026-01-26 05:12:46.109 | INFO     | __main__:main_worker:349 - ---> start train epoch31
2026-01-26 05:12:54.314 | INFO     | __main__:main_worker:423 - [31/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11251M, Data-Time:0.241, LR:0.0001, Train_Loss:-0.1183, total_loss:tensor([-0.1183], device='cuda:0'), ce_loss:0.4107285141944885, cluster_loss:0.07026731967926025, sep_loss:0.021994564682245255, soft_orth_loss:0.004751697648316622, local_consistency_loss:0.0014577716356143355, proto_loss:0.09847135096788406
2026-01-26 05:12:59.438 | INFO     | __main__:main_worker:423 - [31/100], remain:0d.00h.31m, It:[20/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:0.0493, total_loss:tensor([0.0493], device='cuda:0'), ce_loss:0.5144956707954407, cluster_loss:0.07977583259344101, sep_loss:0.023837756365537643, soft_orth_loss:0.004749136045575142, local_consistency_loss:0.0011207188945263624, proto_loss:0.10948343575000763
2026-01-26 05:13:04.370 | INFO     | __main__:main_worker:423 - [31/100], remain:0d.00h.30m, It:[30/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.2353, total_loss:tensor([0.2353], device='cuda:0'), ce_loss:0.6148689389228821, cluster_loss:0.10065224021673203, sep_loss:0.028122305870056152, soft_orth_loss:0.004743976052850485, local_consistency_loss:0.0008735472219996154, proto_loss:0.13439208269119263
2026-01-26 05:13:07.881 | INFO     | __main__:main_worker:423 - [31/100], remain:0d.00h.28m, It:[40/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:0.4417, total_loss:tensor([0.4417], device='cuda:0'), ce_loss:0.7320328950881958, cluster_loss:0.12480193376541138, sep_loss:0.026682615280151367, soft_orth_loss:0.004736325237900019, local_consistency_loss:0.0006432543741539121, proto_loss:0.15686412155628204
2026-01-26 05:13:12.199 | INFO     | __main__:main_worker:423 - [31/100], remain:0d.00h.27m, It:[50/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:-0.1420, total_loss:tensor([-0.1420], device='cuda:0'), ce_loss:0.38080069422721863, cluster_loss:0.08303380012512207, sep_loss:0.023237764835357666, soft_orth_loss:0.004731071647256613, local_consistency_loss:0.0007058534538373351, proto_loss:0.11170849204063416
Evaluating: 100%|| 15/15 [00:07<00:00,  1.89it/s]
acc1: 85.8974, acc3: 100.0000, Precision: 0.7729, Recall: 0.7812, F1-Score: 0.7768, Specificity: 0.9128
2026-01-26 05:13:21.806 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [31/100], Top1:85.897, Top3:100.000, Test_precision:0.7729,Test_recall:0.7812,Test_f1:0.7768,,Test_specificity:0.9128 Test_loss:0.387097
2026-01-26 05:13:21.807 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
2026-01-26 05:13:21.808 | INFO     | __main__:main_worker:349 - ---> start train epoch32
2026-01-26 05:13:29.388 | INFO     | __main__:main_worker:423 - [32/100], remain:0d.00h.23m, It:[10/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.5968, total_loss:tensor([0.5968], device='cuda:0'), ce_loss:0.8369672894477844, cluster_loss:0.11537759751081467, sep_loss:0.03852459043264389, soft_orth_loss:0.0047260005958378315, local_consistency_loss:0.0007071906584315002, proto_loss:0.15933538973331451
2026-01-26 05:13:34.109 | INFO     | __main__:main_worker:423 - [32/100], remain:0d.00h.26m, It:[20/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.2157, total_loss:tensor([0.2157], device='cuda:0'), ce_loss:0.6094052791595459, cluster_loss:0.090816430747509, sep_loss:0.03218379244208336, soft_orth_loss:0.004725148435682058, local_consistency_loss:0.0008602230227552354, proto_loss:0.1285855919122696
2026-01-26 05:13:38.656 | INFO     | __main__:main_worker:423 - [32/100], remain:0d.00h.26m, It:[30/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.3504, total_loss:tensor([0.3504], device='cuda:0'), ce_loss:0.6773048043251038, cluster_loss:0.11005505174398422, sep_loss:0.035149432718753815, soft_orth_loss:0.004722183104604483, local_consistency_loss:0.0007625529542565346, proto_loss:0.15068921446800232
2026-01-26 05:13:44.066 | INFO     | __main__:main_worker:423 - [32/100], remain:0d.00h.27m, It:[40/54], Max-Mem:11251M, Data-Time:0.027, LR:0.0001, Train_Loss:0.2956, total_loss:tensor([0.2956], device='cuda:0'), ce_loss:0.6584752798080444, cluster_loss:0.09545742720365524, sep_loss:0.033365972340106964, soft_orth_loss:0.0047215246595442295, local_consistency_loss:0.0009422196308150887, proto_loss:0.13448713719844818
2026-01-26 05:13:50.291 | INFO     | __main__:main_worker:423 - [32/100], remain:0d.00h.29m, It:[50/54], Max-Mem:11251M, Data-Time:0.018, LR:0.0001, Train_Loss:0.4881, total_loss:tensor([0.4881], device='cuda:0'), ce_loss:0.7596926689147949, cluster_loss:0.1180424913764, sep_loss:0.038800597190856934, soft_orth_loss:0.004719390068203211, local_consistency_loss:0.000723603880032897, proto_loss:0.16228608787059784
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-26 05:13:52.211 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 32 (LR=0.000080, momentum=0.85)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.1841
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.1131
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.0664
Local prototype push completed!
2026-01-26 05:14:22.139 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.69it/s]
acc1: 80.5556, acc3: 100.0000, Precision: 0.6985, Recall: 0.7208, F1-Score: 0.7020, Specificity: 0.8829
2026-01-26 05:14:31.041 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [32/100], Top1:80.556, Top3:100.000, Test_precision:0.6985,Test_recall:0.7208,Test_f1:0.7020,,Test_specificity:0.8829 Test_loss:0.525170
2026-01-26 05:14:31.042 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
2026-01-26 05:14:31.043 | INFO     | __main__:main_worker:349 - ---> start train epoch33
2026-01-26 05:14:41.841 | INFO     | __main__:main_worker:423 - [33/100], remain:0d.00h.37m, It:[10/54], Max-Mem:11251M, Data-Time:2.550, LR:0.0001, Train_Loss:0.1782, total_loss:tensor([0.1782], device='cuda:0'), ce_loss:0.5812389850616455, cluster_loss:0.09696607291698456, sep_loss:0.029594389721751213, soft_orth_loss:0.004938026424497366, local_consistency_loss:0.00034365392639301717, proto_loss:0.13184213638305664
2026-01-26 05:14:47.652 | INFO     | __main__:main_worker:423 - [33/100], remain:0d.00h.35m, It:[20/54], Max-Mem:11251M, Data-Time:2.300, LR:0.0001, Train_Loss:0.2355, total_loss:tensor([0.2355], device='cuda:0'), ce_loss:0.6044808626174927, cluster_loss:0.10392426699399948, sep_loss:0.036398958414793015, soft_orth_loss:0.004936192650347948, local_consistency_loss:0.0009701097733341157, proto_loss:0.14622952044010162
2026-01-26 05:14:51.974 | INFO     | __main__:main_worker:423 - [33/100], remain:0d.00h.32m, It:[30/54], Max-Mem:11251M, Data-Time:0.748, LR:0.0001, Train_Loss:0.9470, total_loss:tensor([0.9470], device='cuda:0'), ce_loss:1.0417158603668213, cluster_loss:0.14982222020626068, sep_loss:0.037137340754270554, soft_orth_loss:0.0049309986643493176, local_consistency_loss:0.001072001876309514, proto_loss:0.19296257197856903
2026-01-26 05:14:56.869 | INFO     | __main__:main_worker:423 - [33/100], remain:0d.00h.31m, It:[40/54], Max-Mem:11251M, Data-Time:0.530, LR:0.0001, Train_Loss:0.1475, total_loss:tensor([0.1475], device='cuda:0'), ce_loss:0.562598466873169, cluster_loss:0.08891408890485764, sep_loss:0.03512852266430855, soft_orth_loss:0.004925422370433807, local_consistency_loss:0.001521261059679091, proto_loss:0.1304892897605896
2026-01-26 05:15:02.734 | INFO     | __main__:main_worker:423 - [33/100], remain:0d.00h.32m, It:[50/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.5167, total_loss:tensor([0.5167], device='cuda:0'), ce_loss:0.7804489135742188, cluster_loss:0.11928728967905045, sep_loss:0.03761642053723335, soft_orth_loss:0.004921278916299343, local_consistency_loss:0.0007497313781641424, proto_loss:0.16257472336292267
Evaluating: 100%|| 15/15 [00:09<00:00,  1.54it/s]
acc1: 83.5470, acc3: 100.0000, Precision: 0.7444, Recall: 0.8695, F1-Score: 0.7691, Specificity: 0.9347
2026-01-26 05:15:14.867 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [33/100], Top1:83.547, Top3:100.000, Test_precision:0.7444,Test_recall:0.8695,Test_f1:0.7691,,Test_specificity:0.9347 Test_loss:0.450954
2026-01-26 05:15:14.868 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
2026-01-26 05:15:14.869 | INFO     | __main__:main_worker:349 - ---> start train epoch34
2026-01-26 05:15:26.431 | INFO     | __main__:main_worker:423 - [34/100], remain:0d.00h.33m, It:[10/54], Max-Mem:11251M, Data-Time:2.016, LR:0.0001, Train_Loss:0.2479, total_loss:tensor([0.2479], device='cuda:0'), ce_loss:0.6364604830741882, cluster_loss:0.08697469532489777, sep_loss:0.03438403084874153, soft_orth_loss:0.004919711034744978, local_consistency_loss:0.0008440932142548263, proto_loss:0.12712252140045166
2026-01-26 05:15:31.554 | INFO     | __main__:main_worker:423 - [34/100], remain:0d.00h.31m, It:[20/54], Max-Mem:11251M, Data-Time:1.583, LR:0.0001, Train_Loss:0.3015, total_loss:tensor([0.3015], device='cuda:0'), ce_loss:0.6616265773773193, cluster_loss:0.09454464167356491, sep_loss:0.037541426718235016, soft_orth_loss:0.004913975950330496, local_consistency_loss:0.0006420830613933504, proto_loss:0.13764211535453796
2026-01-26 05:15:35.374 | INFO     | __main__:main_worker:423 - [34/100], remain:0d.00h.28m, It:[30/54], Max-Mem:11251M, Data-Time:0.431, LR:0.0001, Train_Loss:0.1599, total_loss:tensor([0.1599], device='cuda:0'), ce_loss:0.558301568031311, cluster_loss:0.10075278580188751, sep_loss:0.0275803804397583, soft_orth_loss:0.0049084266647696495, local_consistency_loss:0.009688518941402435, proto_loss:0.14293012022972107
2026-01-26 05:15:41.177 | INFO     | __main__:main_worker:423 - [34/100], remain:0d.00h.29m, It:[40/54], Max-Mem:11251M, Data-Time:2.280, LR:0.0001, Train_Loss:2.1418, total_loss:tensor([2.1418], device='cuda:0'), ce_loss:1.669696569442749, cluster_loss:0.31548747420310974, sep_loss:0.03984348103404045, soft_orth_loss:0.004900054074823856, local_consistency_loss:0.0023390098940581083, proto_loss:0.36257001757621765
2026-01-26 05:15:46.390 | INFO     | __main__:main_worker:423 - [34/100], remain:0d.00h.29m, It:[50/54], Max-Mem:11251M, Data-Time:1.714, LR:0.0001, Train_Loss:0.1038, total_loss:tensor([0.1038], device='cuda:0'), ce_loss:0.5611869096755981, cluster_loss:0.07233352214097977, sep_loss:0.028944993391633034, soft_orth_loss:0.0048927683383226395, local_consistency_loss:0.0012939273146912456, proto_loss:0.10746520757675171
Evaluating: 100%|| 15/15 [00:10<00:00,  1.49it/s]
acc1: 85.6838, acc3: 100.0000, Precision: 0.7539, Recall: 0.7815, F1-Score: 0.7660, Specificity: 0.9195
2026-01-26 05:15:57.830 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [34/100], Top1:85.684, Top3:100.000, Test_precision:0.7539,Test_recall:0.7815,Test_f1:0.7660,,Test_specificity:0.9195 Test_loss:0.377296
2026-01-26 05:15:57.832 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
2026-01-26 05:15:57.834 | INFO     | __main__:main_worker:349 - ---> start train epoch35
2026-01-26 05:16:05.991 | INFO     | __main__:main_worker:423 - [35/100], remain:0d.00h.23m, It:[10/54], Max-Mem:11251M, Data-Time:0.475, LR:0.0001, Train_Loss:0.1435, total_loss:tensor([0.1435], device='cuda:0'), ce_loss:0.583979606628418, cluster_loss:0.07642336189746857, sep_loss:0.02933379076421261, soft_orth_loss:0.0048906197771430016, local_consistency_loss:0.0011894298950210214, proto_loss:0.11183720827102661
2026-01-26 05:16:10.781 | INFO     | __main__:main_worker:423 - [35/100], remain:0d.00h.25m, It:[20/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0001, Train_Loss:0.1339, total_loss:tensor([0.1339], device='cuda:0'), ce_loss:0.5733423829078674, cluster_loss:0.07026145607233047, sep_loss:0.02858942560851574, soft_orth_loss:0.004889974370598793, local_consistency_loss:0.011919296346604824, proto_loss:0.1156601533293724
2026-01-26 05:16:14.779 | INFO     | __main__:main_worker:423 - [35/100], remain:0d.00h.24m, It:[30/54], Max-Mem:11251M, Data-Time:0.569, LR:0.0001, Train_Loss:-0.1487, total_loss:tensor([-0.1487], device='cuda:0'), ce_loss:0.3981133699417114, cluster_loss:0.07110150903463364, sep_loss:0.022528840228915215, soft_orth_loss:0.004889116622507572, local_consistency_loss:0.0007706088363192976, proto_loss:0.09929007291793823
2026-01-26 05:16:18.605 | INFO     | __main__:main_worker:423 - [35/100], remain:0d.00h.23m, It:[40/54], Max-Mem:11251M, Data-Time:0.315, LR:0.0001, Train_Loss:0.0272, total_loss:tensor([0.0272], device='cuda:0'), ce_loss:0.594612717628479, cluster_loss:0.0002164374163839966, sep_loss:0.028296682983636856, soft_orth_loss:0.0048901960253715515, local_consistency_loss:0.0011513071367517114, proto_loss:0.034554623067379
2026-01-26 05:16:23.522 | INFO     | __main__:main_worker:423 - [35/100], remain:0d.00h.24m, It:[50/54], Max-Mem:11251M, Data-Time:1.021, LR:0.0001, Train_Loss:-0.1325, total_loss:tensor([-0.1325], device='cuda:0'), ce_loss:0.3979029953479767, cluster_loss:0.08339089155197144, sep_loss:0.020944738760590553, soft_orth_loss:0.004891134798526764, local_consistency_loss:0.0006355005316436291, proto_loss:0.10986226052045822
Evaluating: 100%|| 15/15 [00:07<00:00,  1.99it/s]
2026-01-26 05:16:32.581 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [35/100], Top1:85.684, Top3:100.000, Test_precision:0.7526,Test_recall:0.7903,Test_f1:0.7675,,Test_specificity:0.9204 Test_loss:0.387237
2026-01-26 05:16:32.581 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [24/100], Top1:87.179, Top-3:100.000
acc1: 85.6838, acc3: 100.0000, Precision: 0.7526, Recall: 0.7903, F1-Score: 0.7675, Specificity: 0.9204
2026-01-26 05:16:54.229 | INFO     | __main__:main_worker:349 - ---> start train epoch36
2026-01-26 05:17:04.303 | INFO     | __main__:main_worker:423 - [36/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11251M, Data-Time:1.768, LR:0.0001, Train_Loss:0.1445, total_loss:tensor([0.1445], device='cuda:0'), ce_loss:0.5529650449752808, cluster_loss:0.1086634173989296, sep_loss:0.02641208842396736, soft_orth_loss:0.0048871408216655254, local_consistency_loss:0.0009372887434437871, proto_loss:0.1408999264240265
2026-01-26 05:17:08.228 | INFO     | __main__:main_worker:423 - [36/100], remain:0d.00h.26m, It:[20/54], Max-Mem:11251M, Data-Time:0.502, LR:0.0001, Train_Loss:0.1871, total_loss:tensor([0.1871], device='cuda:0'), ce_loss:0.5982290506362915, cluster_loss:0.08885116875171661, sep_loss:0.032252050936222076, soft_orth_loss:0.0048797233030200005, local_consistency_loss:0.0014571690699085593, proto_loss:0.12744010984897614
2026-01-26 05:17:12.251 | INFO     | __main__:main_worker:423 - [36/100], remain:0d.00h.24m, It:[30/54], Max-Mem:11251M, Data-Time:0.572, LR:0.0001, Train_Loss:-0.0102, total_loss:tensor([-0.0102], device='cuda:0'), ce_loss:0.475183367729187, cluster_loss:0.08677393198013306, sep_loss:0.024043094366788864, soft_orth_loss:0.004873976577073336, local_consistency_loss:0.001296464935876429, proto_loss:0.11698747426271439
2026-01-26 05:17:16.512 | INFO     | __main__:main_worker:423 - [36/100], remain:0d.00h.24m, It:[40/54], Max-Mem:11251M, Data-Time:0.844, LR:0.0001, Train_Loss:0.5803, total_loss:tensor([0.5803], device='cuda:0'), ce_loss:0.8366158604621887, cluster_loss:0.1083221361041069, sep_loss:0.040057454258203506, soft_orth_loss:0.004871988203376532, local_consistency_loss:0.0019433115376159549, proto_loss:0.15519489347934723
2026-01-26 05:17:20.098 | INFO     | __main__:main_worker:423 - [36/100], remain:0d.00h.23m, It:[50/54], Max-Mem:11251M, Data-Time:0.197, LR:0.0001, Train_Loss:0.3103, total_loss:tensor([0.3103], device='cuda:0'), ce_loss:0.6440385580062866, cluster_loss:0.1285785287618637, sep_loss:0.027729785069823265, soft_orth_loss:0.004872365854680538, local_consistency_loss:0.0004745523037854582, proto_loss:0.1616552323102951
Evaluating: 100%|| 15/15 [00:08<00:00,  1.77it/s]
acc1: 87.3932, acc3: 100.0000, Precision: 0.7980, Recall: 0.7876, F1-Score: 0.7888, Specificity: 0.9286
2026-01-26 05:17:29.927 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [36/100], Top1:87.393, Top3:100.000, Test_precision:0.7980,Test_recall:0.7876,Test_f1:0.7888,,Test_specificity:0.9286 Test_loss:0.380980
2026-01-26 05:17:29.928 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [36/100], Top1:87.393, Top-3:100.000
2026-01-26 05:17:47.684 | INFO     | __main__:main_worker:349 - ---> start train epoch37
2026-01-26 05:17:56.264 | INFO     | __main__:main_worker:423 - [37/100], remain:0d.00h.23m, It:[10/54], Max-Mem:11251M, Data-Time:0.022, LR:0.0001, Train_Loss:0.8317, total_loss:tensor([0.8317], device='cuda:0'), ce_loss:0.9680933952331543, cluster_loss:0.15422020852565765, sep_loss:0.029611339792609215, soft_orth_loss:0.004870535805821419, local_consistency_loss:0.0023199119605123997, proto_loss:0.19102199375629425
2026-01-26 05:18:01.182 | INFO     | __main__:main_worker:423 - [37/100], remain:0d.00h.25m, It:[20/54], Max-Mem:11251M, Data-Time:0.287, LR:0.0001, Train_Loss:0.5874, total_loss:tensor([0.5874], device='cuda:0'), ce_loss:0.8132495284080505, cluster_loss:0.14547298848628998, sep_loss:0.029124734923243523, soft_orth_loss:0.004863050766289234, local_consistency_loss:0.000689651002176106, proto_loss:0.18015043437480927
2026-01-26 05:18:07.555 | INFO     | __main__:main_worker:423 - [37/100], remain:0d.00h.28m, It:[30/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0001, Train_Loss:0.3422, total_loss:tensor([0.3422], device='cuda:0'), ce_loss:0.7219870686531067, cluster_loss:0.07358553260564804, sep_loss:0.03442389518022537, soft_orth_loss:0.004856821149587631, local_consistency_loss:0.0012529550585895777, proto_loss:0.11411920934915543
2026-01-26 05:18:12.984 | INFO     | __main__:main_worker:423 - [37/100], remain:0d.00h.29m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:-0.0557, total_loss:tensor([-0.0557], device='cuda:0'), ce_loss:0.4425336718559265, cluster_loss:0.08416610956192017, sep_loss:0.02992783486843109, soft_orth_loss:0.004852219484746456, local_consistency_loss:0.0011934444773942232, proto_loss:0.12013960629701614
2026-01-26 05:18:18.919 | INFO     | __main__:main_worker:423 - [37/100], remain:0d.00h.29m, It:[50/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.2317, total_loss:tensor([-0.2317], device='cuda:0'), ce_loss:0.34066417813301086, cluster_loss:0.07882825285196304, sep_loss:0.019332824274897575, soft_orth_loss:0.004847703035920858, local_consistency_loss:0.00128727569244802, proto_loss:0.10429605841636658
Evaluating: 100%|| 15/15 [00:08<00:00,  1.71it/s]
2026-01-26 05:18:29.840 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [37/100], Top1:85.470, Top3:100.000, Test_precision:0.7626,Test_recall:0.7609,Test_f1:0.7614,,Test_specificity:0.9123 Test_loss:0.382708
acc1: 85.4701, acc3: 100.0000, Precision: 0.7626, Recall: 0.7609, F1-Score: 0.7614, Specificity: 0.9123
2026-01-26 05:18:29.841 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [36/100], Top1:87.393, Top-3:100.000
2026-01-26 05:18:29.842 | INFO     | __main__:main_worker:349 - ---> start train epoch38
2026-01-26 05:18:41.247 | INFO     | __main__:main_worker:423 - [38/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11251M, Data-Time:1.702, LR:0.0001, Train_Loss:0.7835, total_loss:tensor([0.7835], device='cuda:0'), ce_loss:0.9349890351295471, cluster_loss:0.15013384819030762, sep_loss:0.03492080792784691, soft_orth_loss:0.004842475056648254, local_consistency_loss:0.0019076040480285883, proto_loss:0.19180473685264587
2026-01-26 05:18:47.431 | INFO     | __main__:main_worker:423 - [38/100], remain:0d.00h.32m, It:[20/54], Max-Mem:11251M, Data-Time:2.051, LR:0.0001, Train_Loss:0.0084, total_loss:tensor([0.0084], device='cuda:0'), ce_loss:0.4938298463821411, cluster_loss:0.08678104728460312, sep_loss:0.022234976291656494, soft_orth_loss:0.004838463384658098, local_consistency_loss:0.0008900450775399804, proto_loss:0.11474453657865524
2026-01-26 05:18:52.132 | INFO     | __main__:main_worker:423 - [38/100], remain:0d.00h.30m, It:[30/54], Max-Mem:11251M, Data-Time:0.018, LR:0.0001, Train_Loss:0.0512, total_loss:tensor([0.0512], device='cuda:0'), ce_loss:0.5420977473258972, cluster_loss:0.06109619140625, sep_loss:0.031679652631282806, soft_orth_loss:0.004833558574318886, local_consistency_loss:0.0011024439008906484, proto_loss:0.09871184825897217
2026-01-26 05:18:56.171 | INFO     | __main__:main_worker:423 - [38/100], remain:0d.00h.28m, It:[40/54], Max-Mem:11251M, Data-Time:0.017, LR:0.0001, Train_Loss:-0.0939, total_loss:tensor([-0.0939], device='cuda:0'), ce_loss:0.4233914613723755, cluster_loss:0.08717886358499527, sep_loss:0.02275429107248783, soft_orth_loss:0.004829594865441322, local_consistency_loss:0.0008699957397766411, proto_loss:0.11563274264335632
2026-01-26 05:19:02.116 | INFO     | __main__:main_worker:423 - [38/100], remain:0d.00h.28m, It:[50/54], Max-Mem:11251M, Data-Time:0.632, LR:0.0001, Train_Loss:0.5044, total_loss:tensor([0.5044], device='cuda:0'), ce_loss:0.7608451843261719, cluster_loss:0.14068087935447693, sep_loss:0.029305268079042435, soft_orth_loss:0.004826997872442007, local_consistency_loss:0.003082351293414831, proto_loss:0.17789548635482788
Evaluating: 100%|| 15/15 [00:09<00:00,  1.57it/s]
2026-01-26 05:19:14.493 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [38/100], Top1:83.761, Top3:100.000, Test_precision:0.7455,Test_recall:0.7543,Test_f1:0.7489,,Test_specificity:0.8978 Test_loss:0.396774
acc1: 83.7607, acc3: 100.0000, Precision: 0.7455, Recall: 0.7543, F1-Score: 0.7489, Specificity: 0.8978
2026-01-26 05:19:14.494 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [36/100], Top1:87.393, Top-3:100.000
2026-01-26 05:19:14.494 | INFO     | __main__:main_worker:349 - ---> start train epoch39
2026-01-26 05:19:24.740 | INFO     | __main__:main_worker:423 - [39/100], remain:0d.00h.26m, It:[10/54], Max-Mem:11251M, Data-Time:0.914, LR:0.0001, Train_Loss:0.0010, total_loss:tensor([0.0010], device='cuda:0'), ce_loss:0.4951721131801605, cluster_loss:0.0826164186000824, sep_loss:0.022382019087672234, soft_orth_loss:0.004821042995899916, local_consistency_loss:0.000739459996111691, proto_loss:0.11055894196033478
2026-01-26 05:19:29.942 | INFO     | __main__:main_worker:423 - [39/100], remain:0d.00h.27m, It:[20/54], Max-Mem:11251M, Data-Time:1.682, LR:0.0001, Train_Loss:0.1208, total_loss:tensor([0.1208], device='cuda:0'), ce_loss:0.5828661918640137, cluster_loss:0.06637328118085861, sep_loss:0.032631468027830124, soft_orth_loss:0.004814674612134695, local_consistency_loss:0.001996800070628524, proto_loss:0.10581622272729874
2026-01-26 05:19:35.480 | INFO     | __main__:main_worker:423 - [39/100], remain:0d.00h.28m, It:[30/54], Max-Mem:11251M, Data-Time:1.724, LR:0.0001, Train_Loss:-0.2228, total_loss:tensor([-0.2228], device='cuda:0'), ce_loss:0.35583963990211487, cluster_loss:0.07224694639444351, sep_loss:0.021116435527801514, soft_orth_loss:0.004807464778423309, local_consistency_loss:0.0010826223297044635, proto_loss:0.09925346821546555
2026-01-26 05:19:41.286 | INFO     | __main__:main_worker:423 - [39/100], remain:0d.00h.28m, It:[40/54], Max-Mem:11251M, Data-Time:1.406, LR:0.0001, Train_Loss:0.1408, total_loss:tensor([0.1408], device='cuda:0'), ce_loss:0.5540959239006042, cluster_loss:0.11032334715127945, sep_loss:0.026908254250884056, soft_orth_loss:0.0047996691428124905, local_consistency_loss:0.0007838054443709552, proto_loss:0.14281506836414337
2026-01-26 05:19:46.760 | INFO     | __main__:main_worker:423 - [39/100], remain:0d.00h.28m, It:[50/54], Max-Mem:11251M, Data-Time:1.929, LR:0.0001, Train_Loss:-0.1024, total_loss:tensor([-0.1024], device='cuda:0'), ce_loss:0.4120437204837799, cluster_loss:0.09022589027881622, sep_loss:0.026318788528442383, soft_orth_loss:0.004797010216861963, local_consistency_loss:0.0010375239653512836, proto_loss:0.12237921357154846
Evaluating: 100%|| 15/15 [00:07<00:00,  2.01it/s]
2026-01-26 05:19:56.892 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [39/100], Top1:85.470, Top3:100.000, Test_precision:0.7714,Test_recall:0.7562,Test_f1:0.7621,,Test_specificity:0.9107 Test_loss:0.357641
2026-01-26 05:19:56.893 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [36/100], Top1:87.393, Top-3:100.000
2026-01-26 05:19:56.893 | INFO     | __main__:main_worker:349 - ---> start train epoch40
acc1: 85.4701, acc3: 100.0000, Precision: 0.7714, Recall: 0.7562, F1-Score: 0.7621, Specificity: 0.9107
2026-01-26 05:20:06.095 | INFO     | __main__:main_worker:423 - [40/100], remain:0d.00h.29m, It:[10/54], Max-Mem:11251M, Data-Time:1.836, LR:0.0001, Train_Loss:-0.0633, total_loss:tensor([-0.0633], device='cuda:0'), ce_loss:0.4456770122051239, cluster_loss:0.08495638519525528, sep_loss:0.026462817564606667, soft_orth_loss:0.004799910355359316, local_consistency_loss:0.0006283874972723424, proto_loss:0.11684750020503998
2026-01-26 05:20:10.282 | INFO     | __main__:main_worker:423 - [40/100], remain:0d.00h.25m, It:[20/54], Max-Mem:11251M, Data-Time:0.713, LR:0.0001, Train_Loss:0.1148, total_loss:tensor([0.1148], device='cuda:0'), ce_loss:0.5638352036476135, cluster_loss:0.08529940992593765, sep_loss:0.029259532690048218, soft_orth_loss:0.004797301255166531, local_consistency_loss:0.0006962129846215248, proto_loss:0.12005245685577393
2026-01-26 05:20:14.888 | INFO     | __main__:main_worker:423 - [40/100], remain:0d.00h.25m, It:[30/54], Max-Mem:11251M, Data-Time:1.113, LR:0.0001, Train_Loss:0.3167, total_loss:tensor([0.3167], device='cuda:0'), ce_loss:0.6635329723358154, cluster_loss:0.11867435276508331, sep_loss:0.028994888067245483, soft_orth_loss:0.00479109026491642, local_consistency_loss:0.0005931029445491731, proto_loss:0.1530534327030182
2026-01-26 05:20:18.977 | INFO     | __main__:main_worker:423 - [40/100], remain:0d.00h.24m, It:[40/54], Max-Mem:11251M, Data-Time:0.019, LR:0.0001, Train_Loss:0.0923, total_loss:tensor([0.0923], device='cuda:0'), ce_loss:0.6429632306098938, cluster_loss:0.00020331679843366146, sep_loss:0.03368851915001869, soft_orth_loss:0.004788275342434645, local_consistency_loss:0.0008178193238563836, proto_loss:0.03949793055653572
2026-01-26 05:20:23.068 | INFO     | __main__:main_worker:423 - [40/100], remain:0d.00h.23m, It:[50/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:0.1546, total_loss:tensor([0.1546], device='cuda:0'), ce_loss:0.5655829906463623, cluster_loss:0.11330912262201309, sep_loss:0.023787133395671844, soft_orth_loss:0.004785421770066023, local_consistency_loss:0.0007004644721746445, proto_loss:0.14258213341236115
2026-01-26 05:20:24.564 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 40 (LR=0.000069, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.1833
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.0603
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.0585
Local prototype push completed!
2026-01-26 05:20:48.088 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:07<00:00,  2.02it/s]
acc1: 85.0427, acc3: 100.0000, Precision: 0.7541, Recall: 0.8485, F1-Score: 0.7851, Specificity: 0.9309
2026-01-26 05:20:55.552 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [40/100], Top1:85.043, Top3:100.000, Test_precision:0.7541,Test_recall:0.8485,Test_f1:0.7851,,Test_specificity:0.9309 Test_loss:0.408876
2026-01-26 05:20:55.553 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [36/100], Top1:87.393, Top-3:100.000
2026-01-26 05:21:04.485 | INFO     | __main__:main_worker:349 - ---> start train epoch41
2026-01-26 05:21:16.298 | INFO     | __main__:main_worker:423 - [41/100], remain:0d.00h.32m, It:[10/54], Max-Mem:11251M, Data-Time:1.525, LR:0.0001, Train_Loss:0.0543, total_loss:tensor([0.0543], device='cuda:0'), ce_loss:0.5239089727401733, cluster_loss:0.08356329798698425, sep_loss:0.0304081030189991, soft_orth_loss:0.005019663833081722, local_consistency_loss:0.0009630238637328148, proto_loss:0.11995408684015274
2026-01-26 05:21:21.595 | INFO     | __main__:main_worker:423 - [41/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11251M, Data-Time:1.577, LR:0.0001, Train_Loss:1.0983, total_loss:tensor([1.0983], device='cuda:0'), ce_loss:1.1015582084655762, cluster_loss:0.18528664112091064, sep_loss:0.04389142617583275, soft_orth_loss:0.005014216993004084, local_consistency_loss:0.0011475856881588697, proto_loss:0.23533986508846283
2026-01-26 05:21:26.156 | INFO     | __main__:main_worker:423 - [41/100], remain:0d.00h.27m, It:[30/54], Max-Mem:11251M, Data-Time:0.914, LR:0.0001, Train_Loss:-0.0407, total_loss:tensor([-0.0407], device='cuda:0'), ce_loss:0.4558938145637512, cluster_loss:0.09003185480833054, sep_loss:0.027523158118128777, soft_orth_loss:0.005001358222216368, local_consistency_loss:0.0006859034183435142, proto_loss:0.12324227392673492
2026-01-26 05:21:30.807 | INFO     | __main__:main_worker:423 - [41/100], remain:0d.00h.26m, It:[40/54], Max-Mem:11251M, Data-Time:0.757, LR:0.0001, Train_Loss:0.3043, total_loss:tensor([0.3043], device='cuda:0'), ce_loss:0.6902033090591431, cluster_loss:0.08896751701831818, sep_loss:0.029330268502235413, soft_orth_loss:0.005000272765755653, local_consistency_loss:0.0009107176447287202, proto_loss:0.12420877069234848
2026-01-26 05:21:36.218 | INFO     | __main__:main_worker:423 - [41/100], remain:0d.00h.27m, It:[50/54], Max-Mem:11251M, Data-Time:0.062, LR:0.0001, Train_Loss:0.2970, total_loss:tensor([0.2970], device='cuda:0'), ce_loss:0.6560327410697937, cluster_loss:0.11466478556394577, sep_loss:0.028806043788790703, soft_orth_loss:0.004998066462576389, local_consistency_loss:0.0010375009151175618, proto_loss:0.14950640499591827
Evaluating: 100%|| 15/15 [00:09<00:00,  1.50it/s]
2026-01-26 05:21:48.123 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [41/100], Top1:86.325, Top3:100.000, Test_precision:0.7873,Test_recall:0.8020,Test_f1:0.7935,,Test_specificity:0.9224 Test_loss:0.347607
acc1: 86.3248, acc3: 100.0000, Precision: 0.7873, Recall: 0.8020, F1-Score: 0.7935, Specificity: 0.9224
2026-01-26 05:21:48.123 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [36/100], Top1:87.393, Top-3:100.000
2026-01-26 05:21:48.124 | INFO     | __main__:main_worker:349 - ---> start train epoch42
2026-01-26 05:21:57.501 | INFO     | __main__:main_worker:423 - [42/100], remain:0d.00h.27m, It:[10/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0001, Train_Loss:1.1594, total_loss:tensor([1.1594], device='cuda:0'), ce_loss:1.1613868474960327, cluster_loss:0.17083057761192322, sep_loss:0.04279520735144615, soft_orth_loss:0.004992853384464979, local_consistency_loss:0.001596311922185123, proto_loss:0.22021496295928955
2026-01-26 05:22:03.603 | INFO     | __main__:main_worker:423 - [42/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11251M, Data-Time:2.215, LR:0.0001, Train_Loss:0.4803, total_loss:tensor([0.4803], device='cuda:0'), ce_loss:0.758080005645752, cluster_loss:0.12474413216114044, sep_loss:0.039333973079919815, soft_orth_loss:0.004979492165148258, local_consistency_loss:0.0006029668729752302, proto_loss:0.1696605533361435
2026-01-26 05:22:08.950 | INFO     | __main__:main_worker:423 - [42/100], remain:0d.00h.28m, It:[30/54], Max-Mem:11251M, Data-Time:1.713, LR:0.0001, Train_Loss:0.5058, total_loss:tensor([0.5058], device='cuda:0'), ce_loss:0.7831496596336365, cluster_loss:0.12622372806072235, sep_loss:0.030923916026949883, soft_orth_loss:0.004977890755981207, local_consistency_loss:0.0011589835630729795, proto_loss:0.1632845252752304
2026-01-26 05:22:15.497 | INFO     | __main__:main_worker:423 - [42/100], remain:0d.00h.30m, It:[40/54], Max-Mem:11251M, Data-Time:3.061, LR:0.0001, Train_Loss:0.2678, total_loss:tensor([0.2678], device='cuda:0'), ce_loss:0.6574184894561768, cluster_loss:0.09517127275466919, sep_loss:0.030907852575182915, soft_orth_loss:0.004981017205864191, local_consistency_loss:0.0013751510996371508, proto_loss:0.13243529200553894
2026-01-26 05:22:20.696 | INFO     | __main__:main_worker:423 - [42/100], remain:0d.00h.29m, It:[50/54], Max-Mem:11251M, Data-Time:1.345, LR:0.0001, Train_Loss:0.3910, total_loss:tensor([0.3910], device='cuda:0'), ce_loss:0.7188056111335754, cluster_loss:0.11221452057361603, sep_loss:0.03382394090294838, soft_orth_loss:0.004977717064321041, local_consistency_loss:0.0008495306828990579, proto_loss:0.15186570584774017
Evaluating: 100%|| 15/15 [00:08<00:00,  1.87it/s]
2026-01-26 05:22:30.086 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [42/100], Top1:84.829, Top3:100.000, Test_precision:0.7775,Test_recall:0.7701,Test_f1:0.7737,,Test_specificity:0.9022 Test_loss:0.356456
acc1: 84.8291, acc3: 100.0000, Precision: 0.7775, Recall: 0.7701, F1-Score: 0.7737, Specificity: 0.9022
2026-01-26 05:22:30.087 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [36/100], Top1:87.393, Top-3:100.000
2026-01-26 05:22:30.087 | INFO     | __main__:main_worker:349 - ---> start train epoch43
2026-01-26 05:22:41.396 | INFO     | __main__:main_worker:423 - [43/100], remain:0d.00h.29m, It:[10/54], Max-Mem:11251M, Data-Time:2.166, LR:0.0001, Train_Loss:0.5768, total_loss:tensor([0.5768], device='cuda:0'), ce_loss:0.8305620551109314, cluster_loss:0.1266113966703415, sep_loss:0.03063376247882843, soft_orth_loss:0.0049733868800103664, local_consistency_loss:0.0024325859267264605, proto_loss:0.16465112566947937
2026-01-26 05:22:46.608 | INFO     | __main__:main_worker:423 - [43/100], remain:0d.00h.27m, It:[20/54], Max-Mem:11251M, Data-Time:1.556, LR:0.0001, Train_Loss:-0.0213, total_loss:tensor([-0.0213], device='cuda:0'), ce_loss:0.49735671281814575, cluster_loss:0.06641647964715958, sep_loss:0.029310936108231544, soft_orth_loss:0.00497092679142952, local_consistency_loss:0.0010842750780284405, proto_loss:0.10178261250257492
2026-01-26 05:22:51.246 | INFO     | __main__:main_worker:423 - [43/100], remain:0d.00h.26m, It:[30/54], Max-Mem:11251M, Data-Time:0.557, LR:0.0001, Train_Loss:0.3644, total_loss:tensor([0.3644], device='cuda:0'), ce_loss:0.692416250705719, cluster_loss:0.12092571705579758, sep_loss:0.032846562564373016, soft_orth_loss:0.0049683027900755405, local_consistency_loss:0.0007597451913170516, proto_loss:0.1595003306865692
2026-01-26 05:22:57.316 | INFO     | __main__:main_worker:423 - [43/100], remain:0d.00h.27m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.0429, total_loss:tensor([0.0429], device='cuda:0'), ce_loss:0.6188421845436096, cluster_loss:0.0002921166305895895, sep_loss:0.029830995947122574, soft_orth_loss:0.004965992644429207, local_consistency_loss:0.0006972648552618921, proto_loss:0.03578637167811394
2026-01-26 05:23:01.831 | INFO     | __main__:main_worker:423 - [43/100], remain:0d.00h.26m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:-0.0101, total_loss:tensor([-0.0101], device='cuda:0'), ce_loss:0.4798915684223175, cluster_loss:0.08786209672689438, sep_loss:0.030228054150938988, soft_orth_loss:0.0049657090567052364, local_consistency_loss:0.0009481724700890481, proto_loss:0.12400403618812561
Evaluating: 100%|| 15/15 [00:09<00:00,  1.54it/s]
2026-01-26 05:23:15.813 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [43/100], Top1:88.462, Top3:100.000, Test_precision:0.8095,Test_recall:0.8424,Test_f1:0.8242,,Test_specificity:0.9373 Test_loss:0.300625
acc1: 88.4615, acc3: 100.0000, Precision: 0.8095, Recall: 0.8424, F1-Score: 0.8242, Specificity: 0.9373
2026-01-26 05:23:15.814 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:23:40.811 | INFO     | __main__:main_worker:349 - ---> start train epoch44
2026-01-26 05:23:51.492 | INFO     | __main__:main_worker:423 - [44/100], remain:0d.00h.37m, It:[10/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0001, Train_Loss:0.8059, total_loss:tensor([0.8059], device='cuda:0'), ce_loss:0.9384263157844543, cluster_loss:0.1661587804555893, sep_loss:0.03451903536915779, soft_orth_loss:0.004963426850736141, local_consistency_loss:0.0006550825200974941, proto_loss:0.20629632472991943
2026-01-26 05:23:55.890 | INFO     | __main__:main_worker:423 - [44/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0001, Train_Loss:1.2831, total_loss:tensor([1.2831], device='cuda:0'), ce_loss:1.1923060417175293, cluster_loss:0.22116465866565704, sep_loss:0.03935743495821953, soft_orth_loss:0.004960347432643175, local_consistency_loss:0.0009526551002636552, proto_loss:0.2664351165294647
2026-01-26 05:24:03.978 | INFO     | __main__:main_worker:423 - [44/100], remain:0d.00h.32m, It:[30/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.0425, total_loss:tensor([-0.0425], device='cuda:0'), ce_loss:0.4978128671646118, cluster_loss:0.05899732932448387, sep_loss:0.026255657896399498, soft_orth_loss:0.004957649391144514, local_consistency_loss:0.0006417363183572888, proto_loss:0.09085236489772797
2026-01-26 05:24:12.130 | INFO     | __main__:main_worker:423 - [44/100], remain:0d.00h.34m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.3558, total_loss:tensor([0.3558], device='cuda:0'), ce_loss:0.701870858669281, cluster_loss:0.10905332863330841, sep_loss:0.033070821315050125, soft_orth_loss:0.00495488103479147, local_consistency_loss:0.0006565357907675207, proto_loss:0.14773555099964142
2026-01-26 05:24:17.850 | INFO     | __main__:main_worker:423 - [44/100], remain:0d.00h.33m, It:[50/54], Max-Mem:11251M, Data-Time:0.008, LR:0.0001, Train_Loss:0.1290, total_loss:tensor([0.1290], device='cuda:0'), ce_loss:0.5564321875572205, cluster_loss:0.11184566468000412, sep_loss:0.022728491574525833, soft_orth_loss:0.004952663090080023, local_consistency_loss:0.0011533296201378107, proto_loss:0.14068016409873962
Evaluating: 100%|| 15/15 [00:07<00:00,  1.97it/s]
2026-01-26 05:24:28.036 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [44/100], Top1:86.325, Top3:100.000, Test_precision:0.7777,Test_recall:0.8242,Test_f1:0.7976,,Test_specificity:0.9282 Test_loss:0.325222
2026-01-26 05:24:28.037 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:24:28.038 | INFO     | __main__:main_worker:349 - ---> start train epoch45
acc1: 86.3248, acc3: 100.0000, Precision: 0.7777, Recall: 0.8242, F1-Score: 0.7976, Specificity: 0.9282
2026-01-26 05:24:40.440 | INFO     | __main__:main_worker:423 - [45/100], remain:0d.00h.39m, It:[10/54], Max-Mem:11251M, Data-Time:0.019, LR:0.0001, Train_Loss:-0.1438, total_loss:tensor([-0.1438], device='cuda:0'), ce_loss:0.42326977849006653, cluster_loss:0.06649652868509293, sep_loss:0.024008505046367645, soft_orth_loss:0.004951896145939827, local_consistency_loss:0.0011904205894097686, proto_loss:0.09664735198020935
2026-01-26 05:24:48.629 | INFO     | __main__:main_worker:423 - [45/100], remain:0d.00h.39m, It:[20/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:0.7422, total_loss:tensor([0.7422], device='cuda:0'), ce_loss:0.9313979744911194, cluster_loss:0.12755678594112396, sep_loss:0.036484796553850174, soft_orth_loss:0.004949338734149933, local_consistency_loss:0.007102876901626587, proto_loss:0.17609378695487976
2026-01-26 05:24:56.443 | INFO     | __main__:main_worker:423 - [45/100], remain:0d.00h.39m, It:[30/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:-0.0005, total_loss:tensor([-0.0005], device='cuda:0'), ce_loss:0.5017313957214355, cluster_loss:0.08088183403015137, sep_loss:0.026952361688017845, soft_orth_loss:0.004948130343109369, local_consistency_loss:0.000351944676367566, proto_loss:0.11313427239656448
2026-01-26 05:25:02.948 | INFO     | __main__:main_worker:423 - [45/100], remain:0d.00h.36m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.3313, total_loss:tensor([0.3313], device='cuda:0'), ce_loss:0.6599525213241577, cluster_loss:0.13245359063148499, sep_loss:0.03041686676442623, soft_orth_loss:0.004947435576468706, local_consistency_loss:0.0024690604768693447, proto_loss:0.17028695344924927
2026-01-26 05:25:11.298 | INFO     | __main__:main_worker:423 - [45/100], remain:0d.00h.37m, It:[50/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0001, Train_Loss:0.1988, total_loss:tensor([0.1988], device='cuda:0'), ce_loss:0.6385371685028076, cluster_loss:0.0782310739159584, sep_loss:0.027116386219859123, soft_orth_loss:0.0049484772607684135, local_consistency_loss:0.001857567229308188, proto_loss:0.11215350031852722
Evaluating: 100%|| 15/15 [00:12<00:00,  1.23it/s]
acc1: 85.2564, acc3: 100.0000, Precision: 0.7776, Recall: 0.8215, F1-Score: 0.7952, Specificity: 0.9121
2026-01-26 05:25:26.583 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [45/100], Top1:85.256, Top3:100.000, Test_precision:0.7776,Test_recall:0.8215,Test_f1:0.7952,,Test_specificity:0.9121 Test_loss:0.354619
2026-01-26 05:25:26.584 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:25:36.452 | INFO     | __main__:main_worker:349 - ---> start train epoch46
2026-01-26 05:25:48.215 | INFO     | __main__:main_worker:423 - [46/100], remain:0d.00h.28m, It:[10/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0001, Train_Loss:1.0993, total_loss:tensor([1.0993], device='cuda:0'), ce_loss:1.0879769325256348, cluster_loss:0.17719988524913788, sep_loss:0.037154655903577805, soft_orth_loss:0.004948764573782682, local_consistency_loss:0.02992001175880432, proto_loss:0.24922332167625427
2026-01-26 05:25:57.880 | INFO     | __main__:main_worker:423 - [46/100], remain:0d.00h.37m, It:[20/54], Max-Mem:11251M, Data-Time:0.017, LR:0.0001, Train_Loss:0.4804, total_loss:tensor([0.4804], device='cuda:0'), ce_loss:0.7644550800323486, cluster_loss:0.12757326662540436, sep_loss:0.034303341060876846, soft_orth_loss:0.0049418979324400425, local_consistency_loss:0.001031559775583446, proto_loss:0.167850062251091
2026-01-26 05:26:06.172 | INFO     | __main__:main_worker:423 - [46/100], remain:0d.00h.37m, It:[30/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.0087, total_loss:tensor([0.0087], device='cuda:0'), ce_loss:0.4774010479450226, cluster_loss:0.10081138461828232, sep_loss:0.03397545590996742, soft_orth_loss:0.00493830069899559, local_consistency_loss:0.0008795643225312233, proto_loss:0.14060471951961517
2026-01-26 05:26:11.671 | INFO     | __main__:main_worker:423 - [46/100], remain:0d.00h.34m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.4238, total_loss:tensor([0.4238], device='cuda:0'), ce_loss:0.7363669872283936, cluster_loss:0.11630205065011978, sep_loss:0.03714320436120033, soft_orth_loss:0.004937565885484219, local_consistency_loss:0.0011018833611160517, proto_loss:0.15948469936847687
2026-01-26 05:26:21.173 | INFO     | __main__:main_worker:423 - [46/100], remain:0d.00h.36m, It:[50/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:-0.1418, total_loss:tensor([-0.1418], device='cuda:0'), ce_loss:0.43070071935653687, cluster_loss:0.0695844367146492, sep_loss:0.01836930215358734, soft_orth_loss:0.0049390727654099464, local_consistency_loss:0.0011181578738614917, proto_loss:0.09401097148656845
Evaluating: 100%|| 15/15 [00:10<00:00,  1.37it/s]
acc1: 85.0427, acc3: 100.0000, Precision: 0.7483, Recall: 0.8147, F1-Score: 0.7732, Specificity: 0.9254
2026-01-26 05:26:35.174 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [46/100], Top1:85.043, Top3:100.000, Test_precision:0.7483,Test_recall:0.8147,Test_f1:0.7732,,Test_specificity:0.9254 Test_loss:0.373676
2026-01-26 05:26:35.175 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:26:35.175 | INFO     | __main__:main_worker:349 - ---> start train epoch47
2026-01-26 05:26:49.331 | INFO     | __main__:main_worker:423 - [47/100], remain:0d.00h.32m, It:[10/54], Max-Mem:11251M, Data-Time:1.672, LR:0.0001, Train_Loss:0.1294, total_loss:tensor([0.1294], device='cuda:0'), ce_loss:0.5596563220024109, cluster_loss:0.10721482336521149, sep_loss:0.028076589107513428, soft_orth_loss:0.0049412185326218605, local_consistency_loss:0.0005571446381509304, proto_loss:0.14078977704048157
2026-01-26 05:26:57.612 | INFO     | __main__:main_worker:423 - [47/100], remain:0d.00h.35m, It:[20/54], Max-Mem:11251M, Data-Time:0.028, LR:0.0001, Train_Loss:0.2483, total_loss:tensor([0.2483], device='cuda:0'), ce_loss:0.6192894577980042, cluster_loss:0.11786432564258575, sep_loss:0.03421909362077713, soft_orth_loss:0.004942265804857016, local_consistency_loss:0.0016551262233406305, proto_loss:0.15868082642555237
2026-01-26 05:27:05.236 | INFO     | __main__:main_worker:423 - [47/100], remain:0d.00h.35m, It:[30/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0001, Train_Loss:0.0897, total_loss:tensor([0.0897], device='cuda:0'), ce_loss:0.5522520542144775, cluster_loss:0.0904427096247673, sep_loss:0.028532369062304497, soft_orth_loss:0.004941935651004314, local_consistency_loss:0.0007298908312804997, proto_loss:0.12464690208435059
2026-01-26 05:27:10.909 | INFO     | __main__:main_worker:423 - [47/100], remain:0d.00h.33m, It:[40/54], Max-Mem:11251M, Data-Time:0.017, LR:0.0001, Train_Loss:-0.2836, total_loss:tensor([-0.2836], device='cuda:0'), ce_loss:0.330763578414917, cluster_loss:0.07394369691610336, sep_loss:0.01911485753953457, soft_orth_loss:0.004942907486110926, local_consistency_loss:0.0006096034776419401, proto_loss:0.09861107170581818
2026-01-26 05:27:19.125 | INFO     | __main__:main_worker:423 - [47/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.2279, total_loss:tensor([-0.2279], device='cuda:0'), ce_loss:0.3706829249858856, cluster_loss:0.07862786203622818, sep_loss:0.012842248193919659, soft_orth_loss:0.00494307791814208, local_consistency_loss:0.0005733344005420804, proto_loss:0.09698652476072311
Evaluating: 100%|| 15/15 [00:11<00:00,  1.26it/s]
acc1: 85.0427, acc3: 100.0000, Precision: 0.7729, Recall: 0.7874, F1-Score: 0.7796, Specificity: 0.9077
2026-01-26 05:27:34.041 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [47/100], Top1:85.043, Top3:100.000, Test_precision:0.7729,Test_recall:0.7874,Test_f1:0.7796,,Test_specificity:0.9077 Test_loss:0.359491
2026-01-26 05:27:34.042 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:27:34.042 | INFO     | __main__:main_worker:349 - ---> start train epoch48
2026-01-26 05:27:48.427 | INFO     | __main__:main_worker:423 - [48/100], remain:0d.00h.37m, It:[10/54], Max-Mem:11251M, Data-Time:2.192, LR:0.0001, Train_Loss:-0.3014, total_loss:tensor([-0.3014], device='cuda:0'), ce_loss:0.3174102008342743, cluster_loss:0.07444562017917633, sep_loss:0.02039307914674282, soft_orth_loss:0.004940608516335487, local_consistency_loss:0.0007615868235006928, proto_loss:0.100540891289711
2026-01-26 05:27:56.771 | INFO     | __main__:main_worker:423 - [48/100], remain:0d.00h.37m, It:[20/54], Max-Mem:11251M, Data-Time:0.019, LR:0.0001, Train_Loss:-0.2516, total_loss:tensor([-0.2516], device='cuda:0'), ce_loss:0.3395078182220459, cluster_loss:0.08422931283712387, sep_loss:0.020354729145765305, soft_orth_loss:0.004938814323395491, local_consistency_loss:0.0010990370064973831, proto_loss:0.11062188446521759
2026-01-26 05:28:03.377 | INFO     | __main__:main_worker:423 - [48/100], remain:0d.00h.35m, It:[30/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.0186, total_loss:tensor([-0.0186], device='cuda:0'), ce_loss:0.5049333572387695, cluster_loss:0.07675402611494064, sep_loss:0.021425409242510796, soft_orth_loss:0.004937276244163513, local_consistency_loss:0.0008371549774892628, proto_loss:0.10395386815071106
2026-01-26 05:28:11.392 | INFO     | __main__:main_worker:423 - [48/100], remain:0d.00h.35m, It:[40/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:-0.0006, total_loss:tensor([-0.0006], device='cuda:0'), ce_loss:0.5980108976364136, cluster_loss:0.00021476438269019127, sep_loss:0.029091909527778625, soft_orth_loss:0.004935950040817261, local_consistency_loss:0.0010671180207282305, proto_loss:0.03530973941087723
2026-01-26 05:28:19.580 | INFO     | __main__:main_worker:423 - [48/100], remain:0d.00h.35m, It:[50/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0001, Train_Loss:1.0531, total_loss:tensor([1.0531], device='cuda:0'), ce_loss:1.0882530212402344, cluster_loss:0.1815715879201889, sep_loss:0.035218797624111176, soft_orth_loss:0.00493493489921093, local_consistency_loss:0.0013130742590874434, proto_loss:0.22303839027881622
2026-01-26 05:28:22.569 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 48 (LR=0.000056, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.0921
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.0103
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.9870
Local prototype push completed!
2026-01-26 05:28:53.608 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:09<00:00,  1.57it/s]
2026-01-26 05:29:03.183 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [48/100], Top1:86.325, Top3:100.000, Test_precision:0.7735,Test_recall:0.8247,Test_f1:0.7944,,Test_specificity:0.9253 Test_loss:0.357821
acc1: 86.3248, acc3: 100.0000, Precision: 0.7735, Recall: 0.8247, F1-Score: 0.7944, Specificity: 0.9253
2026-01-26 05:29:03.184 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:29:03.184 | INFO     | __main__:main_worker:349 - ---> start train epoch49
2026-01-26 05:29:16.325 | INFO     | __main__:main_worker:423 - [49/100], remain:0d.00h.36m, It:[10/54], Max-Mem:11251M, Data-Time:0.019, LR:0.0001, Train_Loss:0.1196, total_loss:tensor([0.1196], device='cuda:0'), ce_loss:0.5727311372756958, cluster_loss:0.08932170271873474, sep_loss:0.03131028637290001, soft_orth_loss:0.005078362300992012, local_consistency_loss:0.000665938772726804, proto_loss:0.12637628614902496
2026-01-26 05:29:24.460 | INFO     | __main__:main_worker:423 - [49/100], remain:0d.00h.36m, It:[20/54], Max-Mem:11251M, Data-Time:0.025, LR:0.0001, Train_Loss:-0.1554, total_loss:tensor([-0.1554], device='cuda:0'), ce_loss:0.41854730248451233, cluster_loss:0.06763284653425217, sep_loss:0.02629048191010952, soft_orth_loss:0.005078599322587252, local_consistency_loss:0.001022560871206224, proto_loss:0.10002449154853821
2026-01-26 05:29:32.670 | INFO     | __main__:main_worker:423 - [49/100], remain:0d.00h.36m, It:[30/54], Max-Mem:11251M, Data-Time:0.017, LR:0.0001, Train_Loss:0.4123, total_loss:tensor([0.4123], device='cuda:0'), ce_loss:0.7477082014083862, cluster_loss:0.10401678085327148, sep_loss:0.035835664719343185, soft_orth_loss:0.005079822614789009, local_consistency_loss:0.0007261574501171708, proto_loss:0.1456584334373474
2026-01-26 05:29:38.344 | INFO     | __main__:main_worker:423 - [49/100], remain:0d.00h.33m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.2259, total_loss:tensor([0.2259], device='cuda:0'), ce_loss:0.6266795992851257, cluster_loss:0.1064721867442131, sep_loss:0.02802952565252781, soft_orth_loss:0.005079183261841536, local_consistency_loss:0.002286535454913974, proto_loss:0.14186742901802063
2026-01-26 05:29:46.533 | INFO     | __main__:main_worker:423 - [49/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0001, Train_Loss:-0.0022, total_loss:tensor([-0.0022], device='cuda:0'), ce_loss:0.503879725933075, cluster_loss:0.08059050887823105, sep_loss:0.02964084781706333, soft_orth_loss:0.005077377427369356, local_consistency_loss:0.0004947368870489299, proto_loss:0.11580346524715424
Evaluating: 100%|| 15/15 [00:09<00:00,  1.56it/s]
2026-01-26 05:29:59.222 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [49/100], Top1:83.120, Top3:100.000, Test_precision:0.7384,Test_recall:0.7965,Test_f1:0.7498,,Test_specificity:0.9059 Test_loss:0.415009
2026-01-26 05:29:59.223 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:29:59.223 | INFO     | __main__:main_worker:349 - ---> start train epoch50
acc1: 83.1197, acc3: 100.0000, Precision: 0.7384, Recall: 0.7965, F1-Score: 0.7498, Specificity: 0.9059
2026-01-26 05:30:12.365 | INFO     | __main__:main_worker:423 - [50/100], remain:0d.00h.39m, It:[10/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:0.5037, total_loss:tensor([0.5037], device='cuda:0'), ce_loss:0.7668921947479248, cluster_loss:0.14369045197963715, sep_loss:0.03219131380319595, soft_orth_loss:0.0050705778412520885, local_consistency_loss:0.0011757977772504091, proto_loss:0.1821281462907791
2026-01-26 05:30:20.477 | INFO     | __main__:main_worker:423 - [50/100], remain:0d.00h.37m, It:[20/54], Max-Mem:11251M, Data-Time:0.036, LR:0.0001, Train_Loss:0.4440, total_loss:tensor([0.4440], device='cuda:0'), ce_loss:0.7448318004608154, cluster_loss:0.1357273906469345, sep_loss:0.025499364361166954, soft_orth_loss:0.0050664679147303104, local_consistency_loss:0.0005807580309920013, proto_loss:0.1668739765882492
2026-01-26 05:30:28.545 | INFO     | __main__:main_worker:423 - [50/100], remain:0d.00h.36m, It:[30/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:0.7087, total_loss:tensor([0.7087], device='cuda:0'), ce_loss:0.9097809195518494, cluster_loss:0.13573844730854034, sep_loss:0.03580911085009575, soft_orth_loss:0.005063708871603012, local_consistency_loss:0.0015903313178569078, proto_loss:0.1782016009092331
2026-01-26 05:30:34.682 | INFO     | __main__:main_worker:423 - [50/100], remain:0d.00h.34m, It:[40/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:0.2245, total_loss:tensor([0.2245], device='cuda:0'), ce_loss:0.6275988817214966, cluster_loss:0.10562646389007568, sep_loss:0.029706835746765137, soft_orth_loss:0.005064123310148716, local_consistency_loss:0.0007469803094863892, proto_loss:0.14114440977573395
2026-01-26 05:30:42.284 | INFO     | __main__:main_worker:423 - [50/100], remain:0d.00h.34m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.7382, total_loss:tensor([0.7382], device='cuda:0'), ce_loss:0.9263426065444946, cluster_loss:0.13844721019268036, sep_loss:0.037075724452733994, soft_orth_loss:0.005066069308668375, local_consistency_loss:0.0006323614506982267, proto_loss:0.1812213659286499
Evaluating: 100%|| 15/15 [00:07<00:00,  1.94it/s]
2026-01-26 05:30:53.042 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [50/100], Top1:84.829, Top3:100.000, Test_precision:0.7481,Test_recall:0.7849,Test_f1:0.7618,,Test_specificity:0.9136 Test_loss:0.374874
2026-01-26 05:30:53.043 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
acc1: 84.8291, acc3: 100.0000, Precision: 0.7481, Recall: 0.7849, F1-Score: 0.7618, Specificity: 0.9136
2026-01-26 05:31:15.418 | INFO     | __main__:main_worker:349 - ---> start train epoch51
2026-01-26 05:31:24.757 | INFO     | __main__:main_worker:423 - [51/100], remain:0d.00h.22m, It:[10/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0001, Train_Loss:0.0570, total_loss:tensor([0.0570], device='cuda:0'), ce_loss:0.5653613805770874, cluster_loss:0.0644611120223999, sep_loss:0.028004346415400505, soft_orth_loss:0.0050668311305344105, local_consistency_loss:0.0011935664806514978, proto_loss:0.09872586280107498
2026-01-26 05:31:32.922 | INFO     | __main__:main_worker:423 - [51/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11251M, Data-Time:0.019, LR:0.0001, Train_Loss:0.1478, total_loss:tensor([0.1478], device='cuda:0'), ce_loss:0.5872455835342407, cluster_loss:0.09544219076633453, sep_loss:0.03129756078124046, soft_orth_loss:0.005065344274044037, local_consistency_loss:0.000346791377523914, proto_loss:0.13215188682079315
2026-01-26 05:31:41.043 | INFO     | __main__:main_worker:423 - [51/100], remain:0d.00h.30m, It:[30/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:0.0657, total_loss:tensor([0.0657], device='cuda:0'), ce_loss:0.5262865424156189, cluster_loss:0.10108893364667892, sep_loss:0.030369574204087257, soft_orth_loss:0.005063578952103853, local_consistency_loss:0.0006545339711010456, proto_loss:0.13717661798000336
2026-01-26 05:31:46.381 | INFO     | __main__:main_worker:423 - [51/100], remain:0d.00h.28m, It:[40/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:0.1510, total_loss:tensor([0.1510], device='cuda:0'), ce_loss:0.5919499397277832, cluster_loss:0.09384641796350479, sep_loss:0.030840782448649406, soft_orth_loss:0.0050633070059120655, local_consistency_loss:0.0005612648092210293, proto_loss:0.1303117722272873
2026-01-26 05:31:54.437 | INFO     | __main__:main_worker:423 - [51/100], remain:0d.00h.29m, It:[50/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0001, Train_Loss:-0.3165, total_loss:tensor([-0.3165], device='cuda:0'), ce_loss:0.3220347464084625, cluster_loss:0.0654558315873146, sep_loss:0.021666960790753365, soft_orth_loss:0.005062442272901535, local_consistency_loss:0.0005745727103203535, proto_loss:0.09275980293750763
Evaluating: 100%|| 15/15 [00:08<00:00,  1.72it/s]
2026-01-26 05:32:06.158 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [51/100], Top1:87.393, Top3:100.000, Test_precision:0.7808,Test_recall:0.8697,Test_f1:0.8127,,Test_specificity:0.9444 Test_loss:0.352786
acc1: 87.3932, acc3: 100.0000, Precision: 0.7808, Recall: 0.8697, F1-Score: 0.8127, Specificity: 0.9444
2026-01-26 05:32:06.161 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:32:06.162 | INFO     | __main__:main_worker:349 - ---> start train epoch52
2026-01-26 05:32:19.319 | INFO     | __main__:main_worker:423 - [52/100], remain:0d.00h.37m, It:[10/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0001, Train_Loss:1.1004, total_loss:tensor([1.1004], device='cuda:0'), ce_loss:1.129536509513855, cluster_loss:0.17191728949546814, sep_loss:0.03784139081835747, soft_orth_loss:0.005062219221144915, local_consistency_loss:0.0012526372447609901, proto_loss:0.21607354283332825
2026-01-26 05:32:24.803 | INFO     | __main__:main_worker:423 - [52/100], remain:0d.00h.30m, It:[20/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0001, Train_Loss:-0.3029, total_loss:tensor([-0.3029], device='cuda:0'), ce_loss:0.3209736943244934, cluster_loss:0.07396621257066727, sep_loss:0.02251710556447506, soft_orth_loss:0.005062014330178499, local_consistency_loss:0.0004369125817902386, proto_loss:0.1019822433590889
2026-01-26 05:32:32.627 | INFO     | __main__:main_worker:423 - [52/100], remain:0d.00h.31m, It:[30/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0001, Train_Loss:0.0403, total_loss:tensor([0.0403], device='cuda:0'), ce_loss:0.5142685770988464, cluster_loss:0.1040741354227066, sep_loss:0.023977696895599365, soft_orth_loss:0.005062042735517025, local_consistency_loss:0.0007900019409134984, proto_loss:0.1339038759469986
2026-01-26 05:32:40.795 | INFO     | __main__:main_worker:423 - [52/100], remain:0d.00h.31m, It:[40/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0001, Train_Loss:0.4807, total_loss:tensor([0.4807], device='cuda:0'), ce_loss:0.7880840301513672, cluster_loss:0.1228671595454216, sep_loss:0.024188987910747528, soft_orth_loss:0.005061862524598837, local_consistency_loss:0.000646867323666811, proto_loss:0.15276488661766052
2026-01-26 05:32:47.563 | INFO     | __main__:main_worker:423 - [52/100], remain:0d.00h.31m, It:[50/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:0.9499, total_loss:tensor([0.9499], device='cuda:0'), ce_loss:1.0476787090301514, cluster_loss:0.1553633064031601, sep_loss:0.03830479085445404, soft_orth_loss:0.005060489289462566, local_consistency_loss:0.0012042425805702806, proto_loss:0.19993282854557037
Evaluating: 100%|| 15/15 [00:09<00:00,  1.62it/s]
2026-01-26 05:32:59.075 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [52/100], Top1:85.256, Top3:100.000, Test_precision:0.7583,Test_recall:0.8182,Test_f1:0.7798,,Test_specificity:0.9205 Test_loss:0.361438
acc1: 85.2564, acc3: 100.0000, Precision: 0.7583, Recall: 0.8182, F1-Score: 0.7798, Specificity: 0.9205
2026-01-26 05:32:59.075 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:32:59.076 | INFO     | __main__:main_worker:349 - ---> start train epoch53
2026-01-26 05:33:12.097 | INFO     | __main__:main_worker:423 - [53/100], remain:0d.00h.33m, It:[10/54], Max-Mem:11251M, Data-Time:0.032, LR:0.0000, Train_Loss:-0.0390, total_loss:tensor([-0.0390], device='cuda:0'), ce_loss:0.4846384823322296, cluster_loss:0.08037984371185303, sep_loss:0.0285472571849823, soft_orth_loss:0.005060919560492039, local_consistency_loss:0.0005380244110710919, proto_loss:0.11452604085206985
2026-01-26 05:33:20.261 | INFO     | __main__:main_worker:423 - [53/100], remain:0d.00h.33m, It:[20/54], Max-Mem:11251M, Data-Time:0.025, LR:0.0000, Train_Loss:-0.0572, total_loss:tensor([-0.0572], device='cuda:0'), ce_loss:0.47074565291404724, cluster_loss:0.08082219213247299, sep_loss:0.029191432520747185, soft_orth_loss:0.005060115829110146, local_consistency_loss:0.0011238004080951214, proto_loss:0.11619754135608673
2026-01-26 05:33:26.046 | INFO     | __main__:main_worker:423 - [53/100], remain:0d.00h.30m, It:[30/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.0954, total_loss:tensor([-0.0954], device='cuda:0'), ce_loss:0.45604440569877625, cluster_loss:0.0723361000418663, sep_loss:0.02881759963929653, soft_orth_loss:0.0050586313009262085, local_consistency_loss:0.0009580709156580269, proto_loss:0.10717040300369263
2026-01-26 05:33:33.870 | INFO     | __main__:main_worker:423 - [53/100], remain:0d.00h.30m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.2493, total_loss:tensor([0.2493], device='cuda:0'), ce_loss:0.6241142153739929, cluster_loss:0.12658503651618958, sep_loss:0.028515595942735672, soft_orth_loss:0.005056545604020357, local_consistency_loss:0.0007739016436971724, proto_loss:0.1609310805797577
2026-01-26 05:33:42.102 | INFO     | __main__:main_worker:423 - [53/100], remain:0d.00h.31m, It:[50/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.0392, total_loss:tensor([-0.0392], device='cuda:0'), ce_loss:0.4906243681907654, cluster_loss:0.07967568933963776, sep_loss:0.024985134601593018, soft_orth_loss:0.005052831489592791, local_consistency_loss:0.0005112258368171751, proto_loss:0.1102248877286911
Evaluating: 100%|| 15/15 [00:09<00:00,  1.59it/s]
acc1: 86.3248, acc3: 100.0000, Precision: 0.7778, Recall: 0.8006, F1-Score: 0.7883, Specificity: 0.9221
2026-01-26 05:33:54.651 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [53/100], Top1:86.325, Top3:100.000, Test_precision:0.7778,Test_recall:0.8006,Test_f1:0.7883,,Test_specificity:0.9221 Test_loss:0.349939
2026-01-26 05:33:54.652 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:33:54.652 | INFO     | __main__:main_worker:349 - ---> start train epoch54
2026-01-26 05:34:09.413 | INFO     | __main__:main_worker:423 - [54/100], remain:0d.00h.38m, It:[10/54], Max-Mem:11251M, Data-Time:0.023, LR:0.0000, Train_Loss:-0.1307, total_loss:tensor([-0.1307], device='cuda:0'), ce_loss:0.4359772205352783, cluster_loss:0.07452672719955444, sep_loss:0.024192778393626213, soft_orth_loss:0.005047597922384739, local_consistency_loss:0.001058182562701404, proto_loss:0.10482528805732727
2026-01-26 05:34:17.569 | INFO     | __main__:main_worker:423 - [54/100], remain:0d.00h.35m, It:[20/54], Max-Mem:11251M, Data-Time:0.018, LR:0.0000, Train_Loss:0.0434, total_loss:tensor([0.0434], device='cuda:0'), ce_loss:0.5288143754005432, cluster_loss:0.08633523434400558, sep_loss:0.03268761187791824, soft_orth_loss:0.005044692195951939, local_consistency_loss:0.0011727222008630633, proto_loss:0.1252402663230896
2026-01-26 05:34:24.911 | INFO     | __main__:main_worker:423 - [54/100], remain:0d.00h.33m, It:[30/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0000, Train_Loss:0.7380, total_loss:tensor([0.7380], device='cuda:0'), ce_loss:0.9141139388084412, cluster_loss:0.1492920219898224, sep_loss:0.037828683853149414, soft_orth_loss:0.005043057259172201, local_consistency_loss:0.0012216533068567514, proto_loss:0.19338542222976685
2026-01-26 05:34:31.540 | INFO     | __main__:main_worker:423 - [54/100], remain:0d.00h.31m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.1777, total_loss:tensor([0.1777], device='cuda:0'), ce_loss:0.5986033082008362, cluster_loss:0.10644743591547012, sep_loss:0.030253276228904724, soft_orth_loss:0.005043307319283485, local_consistency_loss:0.0009368531755171716, proto_loss:0.14268088340759277
2026-01-26 05:34:39.678 | INFO     | __main__:main_worker:423 - [54/100], remain:0d.00h.31m, It:[50/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:0.0995, total_loss:tensor([0.0995], device='cuda:0'), ce_loss:0.6774646043777466, cluster_loss:0.00025279034161940217, sep_loss:0.025441667065024376, soft_orth_loss:0.0050427974201738834, local_consistency_loss:0.0010447150561958551, proto_loss:0.03178197145462036
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
2026-01-26 05:34:50.940 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [54/100], Top1:87.179, Top3:100.000, Test_precision:0.7977,Test_recall:0.7823,Test_f1:0.7869,,Test_specificity:0.9238 Test_loss:0.326778
acc1: 87.1795, acc3: 100.0000, Precision: 0.7977, Recall: 0.7823, F1-Score: 0.7869, Specificity: 0.9238
2026-01-26 05:34:50.941 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:34:50.941 | INFO     | __main__:main_worker:349 - ---> start train epoch55
2026-01-26 05:35:04.167 | INFO     | __main__:main_worker:423 - [55/100], remain:0d.00h.37m, It:[10/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0000, Train_Loss:0.4183, total_loss:tensor([0.4183], device='cuda:0'), ce_loss:0.7699000239372253, cluster_loss:0.09327878803014755, sep_loss:0.035710860043764114, soft_orth_loss:0.005042451899498701, local_consistency_loss:0.00047978974180296063, proto_loss:0.13451188802719116
2026-01-26 05:35:12.304 | INFO     | __main__:main_worker:423 - [55/100], remain:0d.00h.34m, It:[20/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.1342, total_loss:tensor([0.1342], device='cuda:0'), ce_loss:0.58973228931427, cluster_loss:0.09170122444629669, sep_loss:0.028345057740807533, soft_orth_loss:0.005041141528636217, local_consistency_loss:0.0010662379208952188, proto_loss:0.12615366280078888
2026-01-26 05:35:20.489 | INFO     | __main__:main_worker:423 - [55/100], remain:0d.00h.33m, It:[30/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:0.7880, total_loss:tensor([0.7880], device='cuda:0'), ce_loss:0.9649221897125244, cluster_loss:0.1308152675628662, sep_loss:0.04240565374493599, soft_orth_loss:0.00503920903429389, local_consistency_loss:0.0009179951739497483, proto_loss:0.1791781336069107
2026-01-26 05:35:27.653 | INFO     | __main__:main_worker:423 - [55/100], remain:0d.00h.32m, It:[40/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:-0.0698, total_loss:tensor([-0.0698], device='cuda:0'), ce_loss:0.46967828273773193, cluster_loss:0.0834827646613121, sep_loss:0.023247312754392624, soft_orth_loss:0.005036656279116869, local_consistency_loss:0.000712854671292007, proto_loss:0.11247958987951279
2026-01-26 05:35:33.639 | INFO     | __main__:main_worker:423 - [55/100], remain:0d.00h.30m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.2972, total_loss:tensor([0.2972], device='cuda:0'), ce_loss:0.6614606976509094, cluster_loss:0.12398417294025421, sep_loss:0.02824919857084751, soft_orth_loss:0.005035008303821087, local_consistency_loss:0.0010000872425734997, proto_loss:0.15826848149299622
Evaluating: 100%|| 15/15 [00:08<00:00,  1.71it/s]
2026-01-26 05:35:45.405 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [55/100], Top1:84.188, Top3:100.000, Test_precision:0.7447,Test_recall:0.8330,Test_f1:0.7720,,Test_specificity:0.9229 Test_loss:0.387663
2026-01-26 05:35:45.406 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
acc1: 84.1880, acc3: 100.0000, Precision: 0.7447, Recall: 0.8330, F1-Score: 0.7720, Specificity: 0.9229
2026-01-26 05:35:54.727 | INFO     | __main__:main_worker:349 - ---> start train epoch56
2026-01-26 05:36:09.277 | INFO     | __main__:main_worker:423 - [56/100], remain:0d.00h.31m, It:[10/54], Max-Mem:11251M, Data-Time:0.020, LR:0.0000, Train_Loss:0.6201, total_loss:tensor([0.6201], device='cuda:0'), ce_loss:0.8309162259101868, cluster_loss:0.15018704533576965, sep_loss:0.03328213840723038, soft_orth_loss:0.005031765438616276, local_consistency_loss:0.009286187589168549, proto_loss:0.19778713583946228
2026-01-26 05:36:17.402 | INFO     | __main__:main_worker:423 - [56/100], remain:0d.00h.31m, It:[20/54], Max-Mem:11251M, Data-Time:0.021, LR:0.0000, Train_Loss:-0.1434, total_loss:tensor([-0.1434], device='cuda:0'), ce_loss:0.411632239818573, cluster_loss:0.08713614195585251, sep_loss:0.02461564540863037, soft_orth_loss:0.005031186155974865, local_consistency_loss:0.0038540733512490988, proto_loss:0.12063704431056976
2026-01-26 05:36:23.075 | INFO     | __main__:main_worker:423 - [56/100], remain:0d.00h.28m, It:[30/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0000, Train_Loss:0.4376, total_loss:tensor([0.4376], device='cuda:0'), ce_loss:0.7638959288597107, cluster_loss:0.11901183426380157, sep_loss:0.02679106406867504, soft_orth_loss:0.005029857158660889, local_consistency_loss:0.0006105583161115646, proto_loss:0.15144331753253937
2026-01-26 05:36:31.282 | INFO     | __main__:main_worker:423 - [56/100], remain:0d.00h.29m, It:[40/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:0.0538, total_loss:tensor([0.0538], device='cuda:0'), ce_loss:0.5490297079086304, cluster_loss:0.0820506289601326, sep_loss:0.028204334899783134, soft_orth_loss:0.005028518848121166, local_consistency_loss:0.0010230335174128413, proto_loss:0.11630651354789734
2026-01-26 05:36:39.528 | INFO     | __main__:main_worker:423 - [56/100], remain:0d.00h.29m, It:[50/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:0.3040, total_loss:tensor([0.3040], device='cuda:0'), ce_loss:0.7206130027770996, cluster_loss:0.07315723598003387, sep_loss:0.03374436870217323, soft_orth_loss:0.005027249455451965, local_consistency_loss:0.0008701931801624596, proto_loss:0.11279904097318649
2026-01-26 05:36:42.668 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 56 (LR=0.000043, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.0882
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.9676
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.9669
Local prototype push completed!
2026-01-26 05:37:12.726 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:09<00:00,  1.65it/s]
2026-01-26 05:37:21.847 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [56/100], Top1:84.615, Top3:100.000, Test_precision:0.7381,Test_recall:0.8130,Test_f1:0.7627,,Test_specificity:0.9284 Test_loss:0.419984
2026-01-26 05:37:21.848 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:37:21.848 | INFO     | __main__:main_worker:349 - ---> start train epoch57
acc1: 84.6154, acc3: 100.0000, Precision: 0.7381, Recall: 0.8130, F1-Score: 0.7627, Specificity: 0.9284
2026-01-26 05:37:32.957 | INFO     | __main__:main_worker:423 - [57/100], remain:0d.00h.24m, It:[10/54], Max-Mem:11251M, Data-Time:0.025, LR:0.0000, Train_Loss:0.3789, total_loss:tensor([0.3789], device='cuda:0'), ce_loss:0.7274020314216614, cluster_loss:0.11068420857191086, sep_loss:0.031303104013204575, soft_orth_loss:0.0050298236310482025, local_consistency_loss:0.0025166794657707214, proto_loss:0.14953380823135376
2026-01-26 05:37:41.104 | INFO     | __main__:main_worker:423 - [57/100], remain:0d.00h.27m, It:[20/54], Max-Mem:11251M, Data-Time:0.018, LR:0.0000, Train_Loss:-0.0739, total_loss:tensor([-0.0739], device='cuda:0'), ce_loss:0.46362146735191345, cluster_loss:0.08199450373649597, sep_loss:0.029406119138002396, soft_orth_loss:0.005032522138208151, local_consistency_loss:0.00047370418906211853, proto_loss:0.11690685153007507
2026-01-26 05:37:49.187 | INFO     | __main__:main_worker:423 - [57/100], remain:0d.00h.28m, It:[30/54], Max-Mem:11251M, Data-Time:0.023, LR:0.0000, Train_Loss:1.1734, total_loss:tensor([1.1734], device='cuda:0'), ce_loss:1.1378227472305298, cluster_loss:0.20779362320899963, sep_loss:0.03773804381489754, soft_orth_loss:0.005034689791500568, local_consistency_loss:0.0009943533223122358, proto_loss:0.2515607178211212
2026-01-26 05:37:57.347 | INFO     | __main__:main_worker:423 - [57/100], remain:0d.00h.29m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.1260, total_loss:tensor([-0.1260], device='cuda:0'), ce_loss:0.4340824484825134, cluster_loss:0.0802917405962944, sep_loss:0.02678282931447029, soft_orth_loss:0.005034076515585184, local_consistency_loss:0.0006844694726169109, proto_loss:0.11279311776161194
2026-01-26 05:38:05.460 | INFO     | __main__:main_worker:423 - [57/100], remain:0d.00h.29m, It:[50/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0000, Train_Loss:0.4943, total_loss:tensor([0.4943], device='cuda:0'), ce_loss:0.7990761995315552, cluster_loss:0.11002077162265778, sep_loss:0.03883838281035423, soft_orth_loss:0.005034466739743948, local_consistency_loss:0.0007448960095643997, proto_loss:0.15463851392269135
Evaluating: 100%|| 15/15 [00:07<00:00,  1.89it/s]
acc1: 86.3248, acc3: 100.0000, Precision: 0.7704, Recall: 0.8256, F1-Score: 0.7931, Specificity: 0.9307
2026-01-26 05:38:16.377 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [57/100], Top1:86.325, Top3:100.000, Test_precision:0.7704,Test_recall:0.8256,Test_f1:0.7931,,Test_specificity:0.9307 Test_loss:0.376972
2026-01-26 05:38:16.379 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:38:16.380 | INFO     | __main__:main_worker:349 - ---> start train epoch58
2026-01-26 05:38:29.480 | INFO     | __main__:main_worker:423 - [58/100], remain:0d.00h.30m, It:[10/54], Max-Mem:11251M, Data-Time:0.022, LR:0.0000, Train_Loss:-0.0639, total_loss:tensor([-0.0639], device='cuda:0'), ce_loss:0.47467944025993347, cluster_loss:0.07761814445257187, sep_loss:0.030094420537352562, soft_orth_loss:0.005036360118538141, local_consistency_loss:0.0011438608635216951, proto_loss:0.11389278620481491
2026-01-26 05:38:35.960 | INFO     | __main__:main_worker:423 - [58/100], remain:0d.00h.27m, It:[20/54], Max-Mem:11251M, Data-Time:0.026, LR:0.0000, Train_Loss:-0.0509, total_loss:tensor([-0.0509], device='cuda:0'), ce_loss:0.480044424533844, cluster_loss:0.08614381402730942, sep_loss:0.024919448420405388, soft_orth_loss:0.005038163624703884, local_consistency_loss:0.0007622793200425804, proto_loss:0.11686370521783829
2026-01-26 05:38:39.841 | INFO     | __main__:main_worker:423 - [58/100], remain:0d.00h.22m, It:[30/54], Max-Mem:11251M, Data-Time:0.018, LR:0.0000, Train_Loss:0.1231, total_loss:tensor([0.1231], device='cuda:0'), ce_loss:0.5757704973220825, cluster_loss:0.10010383278131485, sep_loss:0.027690643444657326, soft_orth_loss:0.00503899622708559, local_consistency_loss:0.001461990992538631, proto_loss:0.13429546356201172
2026-01-26 05:38:48.014 | INFO     | __main__:main_worker:423 - [58/100], remain:0d.00h.24m, It:[40/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.2507, total_loss:tensor([-0.2507], device='cuda:0'), ce_loss:0.35607659816741943, cluster_loss:0.08254864066839218, sep_loss:0.020062005147337914, soft_orth_loss:0.005039247218519449, local_consistency_loss:0.0015426031313836575, proto_loss:0.10919249802827835
2026-01-26 05:38:56.522 | INFO     | __main__:main_worker:423 - [58/100], remain:0d.00h.25m, It:[50/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:0.9383, total_loss:tensor([0.9383], device='cuda:0'), ce_loss:1.0372360944747925, cluster_loss:0.1581089347600937, sep_loss:0.04040415212512016, soft_orth_loss:0.0050361561588943005, local_consistency_loss:0.0007578894728794694, proto_loss:0.20430713891983032
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
2026-01-26 05:39:07.616 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [58/100], Top1:85.897, Top3:100.000, Test_precision:0.7661,Test_recall:0.8140,Test_f1:0.7854,,Test_specificity:0.9302 Test_loss:0.366342
acc1: 85.8974, acc3: 100.0000, Precision: 0.7661, Recall: 0.8140, F1-Score: 0.7854, Specificity: 0.9302
2026-01-26 05:39:07.617 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:39:07.617 | INFO     | __main__:main_worker:349 - ---> start train epoch59
2026-01-26 05:39:18.059 | INFO     | __main__:main_worker:423 - [59/100], remain:0d.00h.21m, It:[10/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:-0.2238, total_loss:tensor([-0.2238], device='cuda:0'), ce_loss:0.3967435956001282, cluster_loss:0.06051718816161156, sep_loss:0.02384956367313862, soft_orth_loss:0.005031246226280928, local_consistency_loss:0.0011428825091570616, proto_loss:0.09054087847471237
2026-01-26 05:39:25.821 | INFO     | __main__:main_worker:423 - [59/100], remain:0d.00h.24m, It:[20/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:0.1994, total_loss:tensor([0.1994], device='cuda:0'), ce_loss:0.6255577802658081, cluster_loss:0.09617713838815689, sep_loss:0.03382682427763939, soft_orth_loss:0.005027428735047579, local_consistency_loss:0.0008663392509333789, proto_loss:0.13589772582054138
2026-01-26 05:39:34.134 | INFO     | __main__:main_worker:423 - [59/100], remain:0d.00h.26m, It:[30/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0000, Train_Loss:-0.0988, total_loss:tensor([-0.0988], device='cuda:0'), ce_loss:0.545077919960022, cluster_loss:0.00019376256386749446, sep_loss:0.030261075124144554, soft_orth_loss:0.005023476202040911, local_consistency_loss:0.0007324966718442738, proto_loss:0.0362108089029789
2026-01-26 05:39:40.866 | INFO     | __main__:main_worker:423 - [59/100], remain:0d.00h.25m, It:[40/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:0.2576, total_loss:tensor([0.2576], device='cuda:0'), ce_loss:0.651032030582428, cluster_loss:0.1113833412528038, sep_loss:0.02978380396962166, soft_orth_loss:0.005022973753511906, local_consistency_loss:0.0012544725323095918, proto_loss:0.14744459092617035
2026-01-26 05:39:48.622 | INFO     | __main__:main_worker:423 - [59/100], remain:0d.00h.26m, It:[50/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:0.4005, total_loss:tensor([0.4005], device='cuda:0'), ce_loss:0.7233894467353821, cluster_loss:0.13326461613178253, sep_loss:0.027272731065750122, soft_orth_loss:0.005024312529712915, local_consistency_loss:0.0013377327704802155, proto_loss:0.1668993979692459
Evaluating: 100%|| 15/15 [00:09<00:00,  1.64it/s]
2026-01-26 05:40:00.809 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [59/100], Top1:86.538, Top3:100.000, Test_precision:0.7699,Test_recall:0.7989,Test_f1:0.7831,,Test_specificity:0.9256 Test_loss:0.368896
acc1: 86.5385, acc3: 100.0000, Precision: 0.7699, Recall: 0.7989, F1-Score: 0.7831, Specificity: 0.9256
2026-01-26 05:40:00.810 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:40:00.810 | INFO     | __main__:main_worker:349 - ---> start train epoch60
2026-01-26 05:40:14.384 | INFO     | __main__:main_worker:423 - [60/100], remain:0d.00h.33m, It:[10/54], Max-Mem:11251M, Data-Time:0.020, LR:0.0000, Train_Loss:0.0469, total_loss:tensor([0.0469], device='cuda:0'), ce_loss:0.5239241123199463, cluster_loss:0.10417967289686203, sep_loss:0.026593422517180443, soft_orth_loss:0.005024141166359186, local_consistency_loss:0.0006755762733519077, proto_loss:0.13647280633449554
2026-01-26 05:40:20.038 | INFO     | __main__:main_worker:423 - [60/100], remain:0d.00h.26m, It:[20/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.1185, total_loss:tensor([0.1185], device='cuda:0'), ce_loss:0.5615444183349609, cluster_loss:0.10738920420408249, sep_loss:0.030819261446595192, soft_orth_loss:0.0050232685171067715, local_consistency_loss:0.0019384190673008561, proto_loss:0.1451701521873474
2026-01-26 05:40:28.333 | INFO     | __main__:main_worker:423 - [60/100], remain:0d.00h.27m, It:[30/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:0.7772, total_loss:tensor([0.7772], device='cuda:0'), ce_loss:0.944797933101654, cluster_loss:0.1466991901397705, sep_loss:0.03975629806518555, soft_orth_loss:0.0050231278873980045, local_consistency_loss:0.0006638539489358664, proto_loss:0.19214245676994324
2026-01-26 05:40:36.594 | INFO     | __main__:main_worker:423 - [60/100], remain:0d.00h.27m, It:[40/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:-0.1548, total_loss:tensor([-0.1548], device='cuda:0'), ce_loss:0.44031038880348206, cluster_loss:0.06430487334728241, sep_loss:0.02381591685116291, soft_orth_loss:0.005023528356105089, local_consistency_loss:0.0010275148088112473, proto_loss:0.09417183697223663
2026-01-26 05:40:42.909 | INFO     | __main__:main_worker:423 - [60/100], remain:0d.00h.26m, It:[50/54], Max-Mem:11251M, Data-Time:0.008, LR:0.0000, Train_Loss:0.3548, total_loss:tensor([0.3548], device='cuda:0'), ce_loss:0.7174238562583923, cluster_loss:0.11049909889698029, sep_loss:0.030828246846795082, soft_orth_loss:0.0050234487280249596, local_consistency_loss:0.0004571772296912968, proto_loss:0.1468079835176468
Evaluating: 100%|| 15/15 [00:08<00:00,  1.81it/s]
2026-01-26 05:40:54.231 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [60/100], Top1:86.966, Top3:100.000, Test_precision:0.7804,Test_recall:0.8531,Test_f1:0.8080,,Test_specificity:0.9344 Test_loss:0.362818
acc1: 86.9658, acc3: 100.0000, Precision: 0.7804, Recall: 0.8531, F1-Score: 0.8080, Specificity: 0.9344
2026-01-26 05:40:54.232 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:41:03.642 | INFO     | __main__:main_worker:349 - ---> start train epoch61
2026-01-26 05:41:18.351 | INFO     | __main__:main_worker:423 - [61/100], remain:0d.00h.31m, It:[10/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:0.8200, total_loss:tensor([0.8200], device='cuda:0'), ce_loss:0.9434023499488831, cluster_loss:0.17410263419151306, sep_loss:0.03219398111104965, soft_orth_loss:0.005021851975470781, local_consistency_loss:0.006258993875235319, proto_loss:0.2175774723291397
2026-01-26 05:41:26.593 | INFO     | __main__:main_worker:423 - [61/100], remain:0d.00h.29m, It:[20/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0000, Train_Loss:-0.1062, total_loss:tensor([-0.1062], device='cuda:0'), ce_loss:0.45112234354019165, cluster_loss:0.08426407724618912, sep_loss:0.02307259850203991, soft_orth_loss:0.005019262433052063, local_consistency_loss:0.0005292771384119987, proto_loss:0.11288521438837051
2026-01-26 05:41:33.626 | INFO     | __main__:main_worker:423 - [61/100], remain:0d.00h.27m, It:[30/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0000, Train_Loss:0.2341, total_loss:tensor([0.2341], device='cuda:0'), ce_loss:0.6357421875, cluster_loss:0.11745347082614899, sep_loss:0.02428646758198738, soft_orth_loss:0.005016537383198738, local_consistency_loss:0.0015759425004944205, proto_loss:0.148332417011261
2026-01-26 05:41:41.240 | INFO     | __main__:main_worker:423 - [61/100], remain:0d.00h.27m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.3666, total_loss:tensor([0.3666], device='cuda:0'), ce_loss:0.7480974197387695, cluster_loss:0.0921221673488617, sep_loss:0.028527474030852318, soft_orth_loss:0.005014644004404545, local_consistency_loss:0.0024082667659968138, proto_loss:0.1280725598335266
2026-01-26 05:41:49.281 | INFO     | __main__:main_worker:423 - [61/100], remain:0d.00h.27m, It:[50/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:0.6172, total_loss:tensor([0.6172], device='cuda:0'), ce_loss:0.8592079281806946, cluster_loss:0.1316642314195633, sep_loss:0.036735210567712784, soft_orth_loss:0.005013924092054367, local_consistency_loss:0.001590070896781981, proto_loss:0.17500343918800354
Evaluating: 100%|| 15/15 [00:08<00:00,  1.86it/s]
2026-01-26 05:42:00.372 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [61/100], Top1:84.829, Top3:100.000, Test_precision:0.7472,Test_recall:0.7993,Test_f1:0.7677,,Test_specificity:0.9192 Test_loss:0.382872
2026-01-26 05:42:00.373 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:42:00.374 | INFO     | __main__:main_worker:349 - ---> start train epoch62
acc1: 84.8291, acc3: 100.0000, Precision: 0.7472, Recall: 0.7993, F1-Score: 0.7677, Specificity: 0.9192
2026-01-26 05:42:12.123 | INFO     | __main__:main_worker:423 - [62/100], remain:0d.00h.23m, It:[10/54], Max-Mem:11251M, Data-Time:0.022, LR:0.0000, Train_Loss:0.2285, total_loss:tensor([0.2285], device='cuda:0'), ce_loss:0.6489477753639221, cluster_loss:0.09252908080816269, sep_loss:0.03364464268088341, soft_orth_loss:0.00501398928463459, local_consistency_loss:0.0032166519667953253, proto_loss:0.13440436124801636
2026-01-26 05:42:19.101 | INFO     | __main__:main_worker:423 - [62/100], remain:0d.00h.23m, It:[20/54], Max-Mem:11251M, Data-Time:0.021, LR:0.0000, Train_Loss:-0.0125, total_loss:tensor([-0.0125], device='cuda:0'), ce_loss:0.5075584053993225, cluster_loss:0.08477091044187546, sep_loss:0.027992768213152885, soft_orth_loss:0.005013777408748865, local_consistency_loss:0.0008150208741426468, proto_loss:0.11859247833490372
2026-01-26 05:42:27.222 | INFO     | __main__:main_worker:423 - [62/100], remain:0d.00h.24m, It:[30/54], Max-Mem:11251M, Data-Time:0.021, LR:0.0000, Train_Loss:-0.2654, total_loss:tensor([-0.2654], device='cuda:0'), ce_loss:0.35365715622901917, cluster_loss:0.0811280608177185, sep_loss:0.019062960520386696, soft_orth_loss:0.005013875663280487, local_consistency_loss:0.001478623948059976, proto_loss:0.10668352246284485
2026-01-26 05:42:34.866 | INFO     | __main__:main_worker:423 - [62/100], remain:0d.00h.24m, It:[40/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:0.2561, total_loss:tensor([0.2561], device='cuda:0'), ce_loss:0.662768542766571, cluster_loss:0.10207366943359375, sep_loss:0.03031291998922825, soft_orth_loss:0.005014043767005205, local_consistency_loss:0.001142025226727128, proto_loss:0.13854266703128815
2026-01-26 05:42:38.443 | INFO     | __main__:main_worker:423 - [62/100], remain:0d.00h.22m, It:[50/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:-0.3053, total_loss:tensor([-0.3053], device='cuda:0'), ce_loss:0.3350246846675873, cluster_loss:0.0764847919344902, sep_loss:0.01855941116809845, soft_orth_loss:0.005014476832002401, local_consistency_loss:0.00034605039400048554, proto_loss:0.10040473192930222
Evaluating: 100%|| 15/15 [00:07<00:00,  1.89it/s]
2026-01-26 05:42:48.317 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [62/100], Top1:86.111, Top3:100.000, Test_precision:0.7816,Test_recall:0.8236,Test_f1:0.7999,,Test_specificity:0.9206 Test_loss:0.340599
acc1: 86.1111, acc3: 100.0000, Precision: 0.7816, Recall: 0.8236, F1-Score: 0.7999, Specificity: 0.9206
2026-01-26 05:42:48.318 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:42:48.318 | INFO     | __main__:main_worker:349 - ---> start train epoch63
2026-01-26 05:42:56.985 | INFO     | __main__:main_worker:423 - [63/100], remain:0d.00h.14m, It:[10/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.3762, total_loss:tensor([0.3762], device='cuda:0'), ce_loss:0.703815758228302, cluster_loss:0.12491364777088165, sep_loss:0.039558134973049164, soft_orth_loss:0.0050146193243563175, local_consistency_loss:0.0019954759627580643, proto_loss:0.17148186266422272
2026-01-26 05:43:02.268 | INFO     | __main__:main_worker:423 - [63/100], remain:0d.00h.16m, It:[20/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:0.4764, total_loss:tensor([0.4764], device='cuda:0'), ce_loss:0.7722426652908325, cluster_loss:0.1392679661512375, sep_loss:0.024830197915434837, soft_orth_loss:0.00501586077734828, local_consistency_loss:0.0008452737820334733, proto_loss:0.16995929181575775
2026-01-26 05:43:06.038 | INFO     | __main__:main_worker:423 - [63/100], remain:0d.00h.14m, It:[30/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.1717, total_loss:tensor([-0.1717], device='cuda:0'), ce_loss:0.42697206139564514, cluster_loss:0.06880196183919907, sep_loss:0.02388291247189045, soft_orth_loss:0.0050168270245194435, local_consistency_loss:0.0005467365845106542, proto_loss:0.0982484370470047
2026-01-26 05:43:10.349 | INFO     | __main__:main_worker:423 - [63/100], remain:0d.00h.14m, It:[40/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:0.1229, total_loss:tensor([0.1229], device='cuda:0'), ce_loss:0.5815045237541199, cluster_loss:0.098596952855587, sep_loss:0.029099902138113976, soft_orth_loss:0.005016204435378313, local_consistency_loss:0.0003541185287758708, proto_loss:0.13306717574596405
2026-01-26 05:43:15.594 | INFO     | __main__:main_worker:423 - [63/100], remain:0d.00h.15m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.2924, total_loss:tensor([0.2924], device='cuda:0'), ce_loss:0.6736564040184021, cluster_loss:0.11487813293933868, sep_loss:0.02950437366962433, soft_orth_loss:0.005014651454985142, local_consistency_loss:0.0009274935582652688, proto_loss:0.15032465755939484
Evaluating: 100%|| 15/15 [00:09<00:00,  1.61it/s]
2026-01-26 05:43:26.568 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [63/100], Top1:86.752, Top3:100.000, Test_precision:0.7735,Test_recall:0.8237,Test_f1:0.7946,,Test_specificity:0.9318 Test_loss:0.354370
2026-01-26 05:43:26.569 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:43:26.569 | INFO     | __main__:main_worker:349 - ---> start train epoch64
acc1: 86.7521, acc3: 100.0000, Precision: 0.7735, Recall: 0.8237, F1-Score: 0.7946, Specificity: 0.9318
2026-01-26 05:43:35.753 | INFO     | __main__:main_worker:423 - [64/100], remain:0d.00h.13m, It:[10/54], Max-Mem:11251M, Data-Time:0.422, LR:0.0000, Train_Loss:0.1469, total_loss:tensor([0.1469], device='cuda:0'), ce_loss:0.5964969396591187, cluster_loss:0.09884502738714218, sep_loss:0.029216015711426735, soft_orth_loss:0.00501286843791604, local_consistency_loss:0.0009860623395070434, proto_loss:0.13405998051166534
2026-01-26 05:43:40.168 | INFO     | __main__:main_worker:423 - [64/100], remain:0d.00h.13m, It:[20/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:0.2726, total_loss:tensor([0.2726], device='cuda:0'), ce_loss:0.6596195697784424, cluster_loss:0.11241090297698975, sep_loss:0.032554205507040024, soft_orth_loss:0.005012391600757837, local_consistency_loss:0.0012929246295243502, proto_loss:0.15127043426036835
2026-01-26 05:43:45.845 | INFO     | __main__:main_worker:423 - [64/100], remain:0d.00h.15m, It:[30/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:-0.0539, total_loss:tensor([-0.0539], device='cuda:0'), ce_loss:0.4663490951061249, cluster_loss:0.09924682229757309, sep_loss:0.02670649252831936, soft_orth_loss:0.005012180656194687, local_consistency_loss:0.0006690036389045417, proto_loss:0.13163450360298157
2026-01-26 05:43:51.051 | INFO     | __main__:main_worker:423 - [64/100], remain:0d.00h.15m, It:[40/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:0.2396, total_loss:tensor([0.2396], device='cuda:0'), ce_loss:0.6459985375404358, cluster_loss:0.11304213851690292, sep_loss:0.02601110003888607, soft_orth_loss:0.005012333393096924, local_consistency_loss:0.00044659103150479496, proto_loss:0.14451216161251068
2026-01-26 05:43:55.600 | INFO     | __main__:main_worker:423 - [64/100], remain:0d.00h.15m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.0665, total_loss:tensor([0.0665], device='cuda:0'), ce_loss:0.5562143921852112, cluster_loss:0.08529471606016159, sep_loss:0.03236672282218933, soft_orth_loss:0.005012260749936104, local_consistency_loss:0.0008396192570216954, proto_loss:0.12351331859827042
2026-01-26 05:43:58.021 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 64 (LR=0.000031, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.0378
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.9351
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.9284
Local prototype push completed!
2026-01-26 05:44:25.636 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.68it/s]
acc1: 85.0427, acc3: 100.0000, Precision: 0.7518, Recall: 0.7990, F1-Score: 0.7705, Specificity: 0.9181
2026-01-26 05:44:34.575 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [64/100], Top1:85.043, Top3:100.000, Test_precision:0.7518,Test_recall:0.7990,Test_f1:0.7705,,Test_specificity:0.9181 Test_loss:0.464285
2026-01-26 05:44:34.575 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:44:34.576 | INFO     | __main__:main_worker:349 - ---> start train epoch65
2026-01-26 05:44:45.024 | INFO     | __main__:main_worker:423 - [65/100], remain:0d.00h.18m, It:[10/54], Max-Mem:11251M, Data-Time:1.822, LR:0.0000, Train_Loss:-0.0390, total_loss:tensor([-0.0390], device='cuda:0'), ce_loss:0.487569659948349, cluster_loss:0.08952230215072632, sep_loss:0.027318784967064857, soft_orth_loss:0.00486306007951498, local_consistency_loss:0.0008748674881644547, proto_loss:0.12257901579141617
2026-01-26 05:44:49.327 | INFO     | __main__:main_worker:423 - [65/100], remain:0d.00h.15m, It:[20/54], Max-Mem:11251M, Data-Time:0.628, LR:0.0000, Train_Loss:0.3535, total_loss:tensor([0.3535], device='cuda:0'), ce_loss:0.8503567576408386, cluster_loss:0.00025852813269011676, sep_loss:0.03014434687793255, soft_orth_loss:0.004860325250774622, local_consistency_loss:0.001288263825699687, proto_loss:0.03655146434903145
2026-01-26 05:44:54.573 | INFO     | __main__:main_worker:423 - [65/100], remain:0d.00h.16m, It:[30/54], Max-Mem:11251M, Data-Time:0.022, LR:0.0000, Train_Loss:-0.1213, total_loss:tensor([-0.1213], device='cuda:0'), ce_loss:0.4299439787864685, cluster_loss:0.09495126456022263, sep_loss:0.0246613547205925, soft_orth_loss:0.004855644423514605, local_consistency_loss:0.0008977690595202148, proto_loss:0.12536603212356567
2026-01-26 05:44:59.152 | INFO     | __main__:main_worker:423 - [65/100], remain:0d.00h.15m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.2090, total_loss:tensor([0.2090], device='cuda:0'), ce_loss:0.6331863403320312, cluster_loss:0.10592092573642731, sep_loss:0.02720656991004944, soft_orth_loss:0.004850543104112148, local_consistency_loss:0.0007905393722467124, proto_loss:0.13876856863498688
2026-01-26 05:45:05.050 | INFO     | __main__:main_worker:423 - [65/100], remain:0d.00h.16m, It:[50/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:-0.1976, total_loss:tensor([-0.1976], device='cuda:0'), ce_loss:0.4034631550312042, cluster_loss:0.07201867550611496, sep_loss:0.02797090820968151, soft_orth_loss:0.004848222713917494, local_consistency_loss:0.00042014653445221484, proto_loss:0.10525795072317123
Evaluating: 100%|| 15/15 [00:08<00:00,  1.71it/s]
2026-01-26 05:45:15.520 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [65/100], Top1:85.470, Top3:100.000, Test_precision:0.7596,Test_recall:0.7776,Test_f1:0.7676,,Test_specificity:0.9133 Test_loss:0.396874
2026-01-26 05:45:15.521 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
acc1: 85.4701, acc3: 100.0000, Precision: 0.7596, Recall: 0.7776, F1-Score: 0.7676, Specificity: 0.9133
2026-01-26 05:45:25.510 | INFO     | __main__:main_worker:349 - ---> start train epoch66
2026-01-26 05:45:35.206 | INFO     | __main__:main_worker:423 - [66/100], remain:0d.00h.15m, It:[10/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.1678, total_loss:tensor([-0.1678], device='cuda:0'), ce_loss:0.42249634861946106, cluster_loss:0.07472573965787888, sep_loss:0.02588561177253723, soft_orth_loss:0.00484795868396759, local_consistency_loss:0.0006082773325033486, proto_loss:0.10606759041547775
2026-01-26 05:45:39.477 | INFO     | __main__:main_worker:423 - [66/100], remain:0d.00h.14m, It:[20/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.0557, total_loss:tensor([-0.0557], device='cuda:0'), ce_loss:0.5027000904083252, cluster_loss:0.06810098886489868, sep_loss:0.026784813031554222, soft_orth_loss:0.004848943557590246, local_consistency_loss:0.001532999100163579, proto_loss:0.1012677475810051
2026-01-26 05:45:43.685 | INFO     | __main__:main_worker:423 - [66/100], remain:0d.00h.13m, It:[30/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:0.1245, total_loss:tensor([0.1245], device='cuda:0'), ce_loss:0.5694649815559387, cluster_loss:0.10693887621164322, sep_loss:0.030483657494187355, soft_orth_loss:0.0048494720831513405, local_consistency_loss:0.0033590742386877537, proto_loss:0.1456310898065567
2026-01-26 05:45:48.065 | INFO     | __main__:main_worker:423 - [66/100], remain:0d.00h.13m, It:[40/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.1724, total_loss:tensor([-0.1724], device='cuda:0'), ce_loss:0.41323450207710266, cluster_loss:0.0830317884683609, sep_loss:0.023237546905875206, soft_orth_loss:0.004850343801081181, local_consistency_loss:0.0004810159734915942, proto_loss:0.11160069704055786
2026-01-26 05:45:53.744 | INFO     | __main__:main_worker:423 - [66/100], remain:0d.00h.14m, It:[50/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.1603, total_loss:tensor([-0.1603], device='cuda:0'), ce_loss:0.41627416014671326, cluster_loss:0.08366335928440094, sep_loss:0.026349306106567383, soft_orth_loss:0.0048514665104448795, local_consistency_loss:0.0010073930025100708, proto_loss:0.11587152630090714
Evaluating: 100%|| 15/15 [00:07<00:00,  1.93it/s]
2026-01-26 05:46:04.347 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [66/100], Top1:84.402, Top3:100.000, Test_precision:0.7304,Test_recall:0.7929,Test_f1:0.7513,,Test_specificity:0.9256 Test_loss:0.485600
2026-01-26 05:46:04.348 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:46:04.348 | INFO     | __main__:main_worker:349 - ---> start train epoch67
acc1: 84.4017, acc3: 100.0000, Precision: 0.7304, Recall: 0.7929, F1-Score: 0.7513, Specificity: 0.9256
2026-01-26 05:46:12.375 | INFO     | __main__:main_worker:423 - [67/100], remain:0d.00h.13m, It:[10/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.1783, total_loss:tensor([-0.1783], device='cuda:0'), ce_loss:0.4057576656341553, cluster_loss:0.08149639517068863, sep_loss:0.02788122370839119, soft_orth_loss:0.004851627629250288, local_consistency_loss:0.0006180607015267015, proto_loss:0.11484730988740921
2026-01-26 05:46:16.437 | INFO     | __main__:main_worker:423 - [67/100], remain:0d.00h.12m, It:[20/54], Max-Mem:11251M, Data-Time:0.111, LR:0.0000, Train_Loss:-0.3074, total_loss:tensor([-0.3074], device='cuda:0'), ce_loss:0.3513794541358948, cluster_loss:0.06409355252981186, sep_loss:0.018234681338071823, soft_orth_loss:0.004851196426898241, local_consistency_loss:0.0016367326024919748, proto_loss:0.08881616592407227
2026-01-26 05:46:21.985 | INFO     | __main__:main_worker:423 - [67/100], remain:0d.00h.13m, It:[30/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:-0.1752, total_loss:tensor([-0.1752], device='cuda:0'), ce_loss:0.4040936529636383, cluster_loss:0.08584445714950562, sep_loss:0.026440411806106567, soft_orth_loss:0.0048512606881558895, local_consistency_loss:0.0011042809346690774, proto_loss:0.11824040859937668
2026-01-26 05:46:27.783 | INFO     | __main__:main_worker:423 - [67/100], remain:0d.00h.14m, It:[40/54], Max-Mem:11251M, Data-Time:0.367, LR:0.0000, Train_Loss:0.0417, total_loss:tensor([0.0417], device='cuda:0'), ce_loss:0.5365675687789917, cluster_loss:0.09756912291049957, sep_loss:0.02474793791770935, soft_orth_loss:0.004851590376347303, local_consistency_loss:0.0006344899302348495, proto_loss:0.12780314683914185
2026-01-26 05:46:31.994 | INFO     | __main__:main_worker:423 - [67/100], remain:0d.00h.14m, It:[50/54], Max-Mem:11251M, Data-Time:0.708, LR:0.0000, Train_Loss:0.1415, total_loss:tensor([0.1415], device='cuda:0'), ce_loss:0.5839970707893372, cluster_loss:0.11103717237710953, sep_loss:0.026735937222838402, soft_orth_loss:0.004852085839956999, local_consistency_loss:0.0009371386840939522, proto_loss:0.14356233179569244
Evaluating: 100%|| 15/15 [00:07<00:00,  1.90it/s]
2026-01-26 05:46:41.175 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [67/100], Top1:86.111, Top3:100.000, Test_precision:0.7706,Test_recall:0.8371,Test_f1:0.7956,,Test_specificity:0.9268 Test_loss:0.398956
2026-01-26 05:46:41.176 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:46:41.177 | INFO     | __main__:main_worker:349 - ---> start train epoch68
acc1: 86.1111, acc3: 100.0000, Precision: 0.7706, Recall: 0.8371, F1-Score: 0.7956, Specificity: 0.9268
2026-01-26 05:46:49.883 | INFO     | __main__:main_worker:423 - [68/100], remain:0d.00h.15m, It:[10/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:0.7790, total_loss:tensor([0.7790], device='cuda:0'), ce_loss:0.9454489946365356, cluster_loss:0.15038429200649261, sep_loss:0.03840597718954086, soft_orth_loss:0.004851990379393101, local_consistency_loss:0.0011462619295343757, proto_loss:0.19478851556777954
2026-01-26 05:46:54.753 | INFO     | __main__:main_worker:423 - [68/100], remain:0d.00h.14m, It:[20/54], Max-Mem:11251M, Data-Time:1.195, LR:0.0000, Train_Loss:0.0445, total_loss:tensor([0.0445], device='cuda:0'), ce_loss:0.5292351841926575, cluster_loss:0.10254134982824326, sep_loss:0.027047593146562576, soft_orth_loss:0.004851771984249353, local_consistency_loss:0.0014389533316716552, proto_loss:0.13587968051433563
2026-01-26 05:47:01.343 | INFO     | __main__:main_worker:423 - [68/100], remain:0d.00h.16m, It:[30/54], Max-Mem:11251M, Data-Time:0.971, LR:0.0000, Train_Loss:0.0326, total_loss:tensor([0.0326], device='cuda:0'), ce_loss:0.5147812366485596, cluster_loss:0.10718276351690292, sep_loss:0.02812924049794674, soft_orth_loss:0.004852073732763529, local_consistency_loss:0.0013330787187442183, proto_loss:0.1414971500635147
2026-01-26 05:47:07.213 | INFO     | __main__:main_worker:423 - [68/100], remain:0d.00h.16m, It:[40/54], Max-Mem:11251M, Data-Time:1.512, LR:0.0000, Train_Loss:0.0126, total_loss:tensor([0.0126], device='cuda:0'), ce_loss:0.5259868502616882, cluster_loss:0.08657592535018921, sep_loss:0.02625908888876438, soft_orth_loss:0.0048527768813073635, local_consistency_loss:0.0033834229689091444, proto_loss:0.1210712119936943
2026-01-26 05:47:12.076 | INFO     | __main__:main_worker:423 - [68/100], remain:0d.00h.15m, It:[50/54], Max-Mem:11251M, Data-Time:1.325, LR:0.0000, Train_Loss:1.0753, total_loss:tensor([1.0753], device='cuda:0'), ce_loss:1.1435359716415405, cluster_loss:0.14739851653575897, sep_loss:0.038748640567064285, soft_orth_loss:0.004852917045354843, local_consistency_loss:0.0023209131322801113, proto_loss:0.19332098960876465
Evaluating: 100%|| 15/15 [00:08<00:00,  1.77it/s]
2026-01-26 05:47:21.904 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [68/100], Top1:85.470, Top3:100.000, Test_precision:0.7519,Test_recall:0.8189,Test_f1:0.7766,,Test_specificity:0.9292 Test_loss:0.401144
acc1: 85.4701, acc3: 100.0000, Precision: 0.7519, Recall: 0.8189, F1-Score: 0.7766, Specificity: 0.9292
2026-01-26 05:47:21.905 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:47:21.905 | INFO     | __main__:main_worker:349 - ---> start train epoch69
2026-01-26 05:47:31.581 | INFO     | __main__:main_worker:423 - [69/100], remain:0d.00h.15m, It:[10/54], Max-Mem:11251M, Data-Time:0.709, LR:0.0000, Train_Loss:0.1228, total_loss:tensor([0.1228], device='cuda:0'), ce_loss:0.6983330845832825, cluster_loss:0.0002179465227527544, sep_loss:0.03120487928390503, soft_orth_loss:0.004852284677326679, local_consistency_loss:0.0015752131585031748, proto_loss:0.03785032406449318
2026-01-26 05:47:36.852 | INFO     | __main__:main_worker:423 - [69/100], remain:0d.00h.14m, It:[20/54], Max-Mem:11251M, Data-Time:0.490, LR:0.0000, Train_Loss:-0.1909, total_loss:tensor([-0.1909], device='cuda:0'), ce_loss:0.49676230549812317, cluster_loss:0.00019078199693467468, sep_loss:0.026809362694621086, soft_orth_loss:0.004851088859140873, local_consistency_loss:0.0010423654457554221, proto_loss:0.032893598079681396
2026-01-26 05:47:43.035 | INFO     | __main__:main_worker:423 - [69/100], remain:0d.00h.15m, It:[30/54], Max-Mem:11251M, Data-Time:1.499, LR:0.0000, Train_Loss:0.3879, total_loss:tensor([0.3879], device='cuda:0'), ce_loss:0.7509268522262573, cluster_loss:0.10404554754495621, sep_loss:0.029751380905508995, soft_orth_loss:0.004849892109632492, local_consistency_loss:0.0025147590786218643, proto_loss:0.14116159081459045
2026-01-26 05:47:48.609 | INFO     | __main__:main_worker:423 - [69/100], remain:0d.00h.15m, It:[40/54], Max-Mem:11251M, Data-Time:1.416, LR:0.0000, Train_Loss:-0.1711, total_loss:tensor([-0.1711], device='cuda:0'), ce_loss:0.40491917729377747, cluster_loss:0.09101693332195282, sep_loss:0.023286527022719383, soft_orth_loss:0.004849150776863098, local_consistency_loss:0.0020299856550991535, proto_loss:0.12118259817361832
2026-01-26 05:47:53.174 | INFO     | __main__:main_worker:423 - [69/100], remain:0d.00h.14m, It:[50/54], Max-Mem:11251M, Data-Time:0.580, LR:0.0000, Train_Loss:0.1399, total_loss:tensor([0.1399], device='cuda:0'), ce_loss:0.5737920999526978, cluster_loss:0.11948960274457932, sep_loss:0.027294589206576347, soft_orth_loss:0.00484834797680378, local_consistency_loss:0.0006519220769405365, proto_loss:0.15228445827960968
Evaluating: 100%|| 15/15 [00:09<00:00,  1.66it/s]
2026-01-26 05:48:04.457 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [69/100], Top1:88.034, Top3:100.000, Test_precision:0.8043,Test_recall:0.8016,Test_f1:0.8013,,Test_specificity:0.9318 Test_loss:0.364048
2026-01-26 05:48:04.458 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:48:04.459 | INFO     | __main__:main_worker:349 - ---> start train epoch70
acc1: 88.0342, acc3: 100.0000, Precision: 0.8043, Recall: 0.8016, F1-Score: 0.8013, Specificity: 0.9318
2026-01-26 05:48:15.682 | INFO     | __main__:main_worker:423 - [70/100], remain:0d.00h.15m, It:[10/54], Max-Mem:11251M, Data-Time:2.132, LR:0.0000, Train_Loss:-0.0951, total_loss:tensor([-0.0951], device='cuda:0'), ce_loss:0.4821818172931671, cluster_loss:0.07311739772558212, sep_loss:0.019535869359970093, soft_orth_loss:0.004846884869039059, local_consistency_loss:0.001324469456449151, proto_loss:0.09882462024688721
2026-01-26 05:48:21.333 | INFO     | __main__:main_worker:423 - [70/100], remain:0d.00h.15m, It:[20/54], Max-Mem:11251M, Data-Time:2.089, LR:0.0000, Train_Loss:-0.1016, total_loss:tensor([-0.1016], device='cuda:0'), ce_loss:0.4598369896411896, cluster_loss:0.08374959975481033, sep_loss:0.023810571059584618, soft_orth_loss:0.004846628755331039, local_consistency_loss:0.0016536656767129898, proto_loss:0.11406046897172928
2026-01-26 05:48:25.629 | INFO     | __main__:main_worker:423 - [70/100], remain:0d.00h.14m, It:[30/54], Max-Mem:11251M, Data-Time:0.727, LR:0.0000, Train_Loss:0.5668, total_loss:tensor([0.5668], device='cuda:0'), ce_loss:0.8424555659294128, cluster_loss:0.1199968084692955, sep_loss:0.0386820025742054, soft_orth_loss:0.004846368916332722, local_consistency_loss:0.0004739016876555979, proto_loss:0.16399908065795898
2026-01-26 05:48:30.519 | INFO     | __main__:main_worker:423 - [70/100], remain:0d.00h.13m, It:[40/54], Max-Mem:11251M, Data-Time:1.160, LR:0.0000, Train_Loss:-0.1723, total_loss:tensor([-0.1723], device='cuda:0'), ce_loss:0.42897549271583557, cluster_loss:0.06851058453321457, sep_loss:0.026500655338168144, soft_orth_loss:0.004846370313316584, local_consistency_loss:0.0010943397646769881, proto_loss:0.10095195472240448
2026-01-26 05:48:35.966 | INFO     | __main__:main_worker:423 - [70/100], remain:0d.00h.13m, It:[50/54], Max-Mem:11251M, Data-Time:1.951, LR:0.0000, Train_Loss:-0.1795, total_loss:tensor([-0.1795], device='cuda:0'), ce_loss:0.43329918384552, cluster_loss:0.06603581458330154, sep_loss:0.021975068375468254, soft_orth_loss:0.004845918156206608, local_consistency_loss:0.000510674377437681, proto_loss:0.09336747974157333
Evaluating: 100%|| 15/15 [00:08<00:00,  1.69it/s]
acc1: 86.1111, acc3: 100.0000, Precision: 0.7614, Recall: 0.8000, F1-Score: 0.7778, Specificity: 0.9253
2026-01-26 05:48:46.265 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [70/100], Top1:86.111, Top3:100.000, Test_precision:0.7614,Test_recall:0.8000,Test_f1:0.7778,,Test_specificity:0.9253 Test_loss:0.408961
2026-01-26 05:48:46.266 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:48:55.562 | INFO     | __main__:main_worker:349 - ---> start train epoch71
2026-01-26 05:49:04.563 | INFO     | __main__:main_worker:423 - [71/100], remain:0d.00h.12m, It:[10/54], Max-Mem:11251M, Data-Time:0.028, LR:0.0000, Train_Loss:-0.0829, total_loss:tensor([-0.0829], device='cuda:0'), ce_loss:0.4700564742088318, cluster_loss:0.0852508470416069, sep_loss:0.025325844064354897, soft_orth_loss:0.004843621049076319, local_consistency_loss:0.0008299825713038445, proto_loss:0.11625029146671295
2026-01-26 05:49:10.783 | INFO     | __main__:main_worker:423 - [71/100], remain:0d.00h.14m, It:[20/54], Max-Mem:11251M, Data-Time:0.014, LR:0.0000, Train_Loss:0.3939, total_loss:tensor([0.3939], device='cuda:0'), ce_loss:0.7385963797569275, cluster_loss:0.11573397368192673, sep_loss:0.032468926161527634, soft_orth_loss:0.004842872731387615, local_consistency_loss:0.002460675546899438, proto_loss:0.1555064469575882
2026-01-26 05:49:16.033 | INFO     | __main__:main_worker:423 - [71/100], remain:0d.00h.14m, It:[30/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:0.0775, total_loss:tensor([0.0775], device='cuda:0'), ce_loss:0.5528592467308044, cluster_loss:0.09858708828687668, sep_loss:0.03169059380888939, soft_orth_loss:0.0048421709798276424, local_consistency_loss:0.0007795829442329705, proto_loss:0.13589943945407867
2026-01-26 05:49:20.472 | INFO     | __main__:main_worker:423 - [71/100], remain:0d.00h.13m, It:[40/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:0.5055, total_loss:tensor([0.5055], device='cuda:0'), ce_loss:0.8337755799293518, cluster_loss:0.09114744514226913, sep_loss:0.04022734984755516, soft_orth_loss:0.004842011723667383, local_consistency_loss:0.0014569703489542007, proto_loss:0.1376737803220749
2026-01-26 05:49:24.196 | INFO     | __main__:main_worker:423 - [71/100], remain:0d.00h.12m, It:[50/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:0.3121, total_loss:tensor([0.3121], device='cuda:0'), ce_loss:0.7054377794265747, cluster_loss:0.09733187407255173, sep_loss:0.03517235442996025, soft_orth_loss:0.004841777496039867, local_consistency_loss:0.000802047026809305, proto_loss:0.13814803957939148
Evaluating: 100%|| 15/15 [00:07<00:00,  1.94it/s]
2026-01-26 05:49:34.294 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [71/100], Top1:87.179, Top3:100.000, Test_precision:0.7761,Test_recall:0.8436,Test_f1:0.8023,,Test_specificity:0.9382 Test_loss:0.394466
2026-01-26 05:49:34.295 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:49:34.295 | INFO     | __main__:main_worker:349 - ---> start train epoch72
acc1: 87.1795, acc3: 100.0000, Precision: 0.7761, Recall: 0.8436, F1-Score: 0.8023, Specificity: 0.9382
2026-01-26 05:49:43.144 | INFO     | __main__:main_worker:423 - [72/100], remain:0d.00h.11m, It:[10/54], Max-Mem:11251M, Data-Time:0.747, LR:0.0000, Train_Loss:-0.0138, total_loss:tensor([-0.0138], device='cuda:0'), ce_loss:0.4905564785003662, cluster_loss:0.0946560874581337, sep_loss:0.02628224901854992, soft_orth_loss:0.004841758869588375, local_consistency_loss:0.01206971239298582, proto_loss:0.1378498077392578
2026-01-26 05:49:47.067 | INFO     | __main__:main_worker:423 - [72/100], remain:0d.00h.10m, It:[20/54], Max-Mem:11251M, Data-Time:0.281, LR:0.0000, Train_Loss:0.2725, total_loss:tensor([0.2725], device='cuda:0'), ce_loss:0.7952961325645447, cluster_loss:0.0002295930898981169, sep_loss:0.033531446009874344, soft_orth_loss:0.004840812645852566, local_consistency_loss:0.0024356970097869635, proto_loss:0.04103754833340645
2026-01-26 05:49:52.492 | INFO     | __main__:main_worker:423 - [72/100], remain:0d.00h.11m, It:[30/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:0.5013, total_loss:tensor([0.5013], device='cuda:0'), ce_loss:0.8111870288848877, cluster_loss:0.11240241676568985, sep_loss:0.03582614287734032, soft_orth_loss:0.004840721841901541, local_consistency_loss:0.0014222710160538554, proto_loss:0.15449154376983643
2026-01-26 05:49:56.990 | INFO     | __main__:main_worker:423 - [72/100], remain:0d.00h.11m, It:[40/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:-0.1416, total_loss:tensor([-0.1416], device='cuda:0'), ce_loss:0.446649968624115, cluster_loss:0.07435958832502365, sep_loss:0.023010490462183952, soft_orth_loss:0.004840697627514601, local_consistency_loss:0.0019200511742383242, proto_loss:0.1041308268904686
2026-01-26 05:50:01.116 | INFO     | __main__:main_worker:423 - [72/100], remain:0d.00h.11m, It:[50/54], Max-Mem:11251M, Data-Time:0.011, LR:0.0000, Train_Loss:0.0497, total_loss:tensor([0.0497], device='cuda:0'), ce_loss:0.5595120787620544, cluster_loss:0.07802154868841171, sep_loss:0.031437505036592484, soft_orth_loss:0.004841051995754242, local_consistency_loss:0.001230354537256062, proto_loss:0.11553046107292175
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-26 05:50:03.594 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 72 (LR=0.000020, momentum=0.85)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.0098
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.9136
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.8800
Local prototype push completed!
2026-01-26 05:50:28.541 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:07<00:00,  1.90it/s]
2026-01-26 05:50:36.454 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [72/100], Top1:87.179, Top3:100.000, Test_precision:0.7888,Test_recall:0.8306,Test_f1:0.8070,,Test_specificity:0.9294 Test_loss:0.396668
acc1: 87.1795, acc3: 100.0000, Precision: 0.7888, Recall: 0.8306, F1-Score: 0.8070, Specificity: 0.9294
2026-01-26 05:50:36.455 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:50:36.456 | INFO     | __main__:main_worker:349 - ---> start train epoch73
2026-01-26 05:50:47.305 | INFO     | __main__:main_worker:423 - [73/100], remain:0d.00h.13m, It:[10/54], Max-Mem:11251M, Data-Time:1.968, LR:0.0000, Train_Loss:0.2636, total_loss:tensor([0.2636], device='cuda:0'), ce_loss:0.7867051362991333, cluster_loss:0.00031581343500874937, sep_loss:0.03517312929034233, soft_orth_loss:0.004975505638867617, local_consistency_loss:0.00316919875331223, proto_loss:0.04363364726305008
2026-01-26 05:50:52.369 | INFO     | __main__:main_worker:423 - [73/100], remain:0d.00h.12m, It:[20/54], Max-Mem:11251M, Data-Time:1.517, LR:0.0000, Train_Loss:0.1868, total_loss:tensor([0.1868], device='cuda:0'), ce_loss:0.6348447203636169, cluster_loss:0.08732447028160095, sep_loss:0.03394736722111702, soft_orth_loss:0.004976158961653709, local_consistency_loss:0.002186546567827463, proto_loss:0.12843453884124756
2026-01-26 05:50:58.332 | INFO     | __main__:main_worker:423 - [73/100], remain:0d.00h.13m, It:[30/54], Max-Mem:11251M, Data-Time:2.387, LR:0.0000, Train_Loss:0.0654, total_loss:tensor([0.0654], device='cuda:0'), ce_loss:0.5575777888298035, cluster_loss:0.09243229776620865, sep_loss:0.027581695467233658, soft_orth_loss:0.004972946364432573, local_consistency_loss:0.0010541289811953902, proto_loss:0.12604106962680817
2026-01-26 05:51:04.049 | INFO     | __main__:main_worker:423 - [73/100], remain:0d.00h.13m, It:[40/54], Max-Mem:11251M, Data-Time:2.188, LR:0.0000, Train_Loss:0.6416, total_loss:tensor([0.6416], device='cuda:0'), ce_loss:0.8817777633666992, cluster_loss:0.13425667583942413, sep_loss:0.03317654877901077, soft_orth_loss:0.004969275090843439, local_consistency_loss:0.0009025325998663902, proto_loss:0.17330503463745117
2026-01-26 05:51:07.573 | INFO     | __main__:main_worker:423 - [73/100], remain:0d.00h.12m, It:[50/54], Max-Mem:11251M, Data-Time:0.151, LR:0.0000, Train_Loss:-0.4148, total_loss:tensor([-0.4148], device='cuda:0'), ce_loss:0.2813837230205536, cluster_loss:0.06910597532987595, sep_loss:0.0167801845818758, soft_orth_loss:0.004966345615684986, local_consistency_loss:0.0010313648963347077, proto_loss:0.09188386797904968
Evaluating: 100%|| 15/15 [00:08<00:00,  1.72it/s]
2026-01-26 05:51:17.606 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [73/100], Top1:87.179, Top3:100.000, Test_precision:0.7927,Test_recall:0.8180,Test_f1:0.8037,,Test_specificity:0.9304 Test_loss:0.365754
acc1: 87.1795, acc3: 100.0000, Precision: 0.7927, Recall: 0.8180, F1-Score: 0.8037, Specificity: 0.9304
2026-01-26 05:51:17.607 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:51:17.608 | INFO     | __main__:main_worker:349 - ---> start train epoch74
2026-01-26 05:51:28.617 | INFO     | __main__:main_worker:423 - [74/100], remain:0d.00h.14m, It:[10/54], Max-Mem:11251M, Data-Time:1.932, LR:0.0000, Train_Loss:0.1127, total_loss:tensor([0.1127], device='cuda:0'), ce_loss:0.5774379372596741, cluster_loss:0.09826497733592987, sep_loss:0.03194001689553261, soft_orth_loss:0.004965217784047127, local_consistency_loss:0.0005839646910317242, proto_loss:0.13575416803359985
2026-01-26 05:51:34.725 | INFO     | __main__:main_worker:423 - [74/100], remain:0d.00h.14m, It:[20/54], Max-Mem:11251M, Data-Time:2.115, LR:0.0000, Train_Loss:-0.1121, total_loss:tensor([-0.1121], device='cuda:0'), ce_loss:0.4418781101703644, cluster_loss:0.09851428121328354, sep_loss:0.02109484188258648, soft_orth_loss:0.004965115338563919, local_consistency_loss:0.0004547671996988356, proto_loss:0.12502901256084442
2026-01-26 05:51:39.354 | INFO     | __main__:main_worker:423 - [74/100], remain:0d.00h.13m, It:[30/54], Max-Mem:11251M, Data-Time:1.109, LR:0.0000, Train_Loss:-0.0466, total_loss:tensor([-0.0466], device='cuda:0'), ce_loss:0.5907552242279053, cluster_loss:0.00020086528093088418, sep_loss:0.030390728265047073, soft_orth_loss:0.004963973071426153, local_consistency_loss:0.001076317043043673, proto_loss:0.036631885915994644
2026-01-26 05:51:44.151 | INFO     | __main__:main_worker:423 - [74/100], remain:0d.00h.12m, It:[40/54], Max-Mem:11251M, Data-Time:1.151, LR:0.0000, Train_Loss:0.0823, total_loss:tensor([0.0823], device='cuda:0'), ce_loss:0.5636749267578125, cluster_loss:0.09474298357963562, sep_loss:0.029996952041983604, soft_orth_loss:0.004962109960615635, local_consistency_loss:0.0009711637394502759, proto_loss:0.13067321479320526
2026-01-26 05:51:49.191 | INFO     | __main__:main_worker:423 - [74/100], remain:0d.00h.12m, It:[50/54], Max-Mem:11251M, Data-Time:1.553, LR:0.0000, Train_Loss:0.3644, total_loss:tensor([0.3644], device='cuda:0'), ce_loss:0.7042108178138733, cluster_loss:0.12614281475543976, sep_loss:0.03739874064922333, soft_orth_loss:0.00496147945523262, local_consistency_loss:0.0005298457108438015, proto_loss:0.16903287172317505
Evaluating: 100%|| 15/15 [00:08<00:00,  1.72it/s]
2026-01-26 05:51:59.284 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [74/100], Top1:86.111, Top3:100.000, Test_precision:0.7769,Test_recall:0.7805,Test_f1:0.7783,,Test_specificity:0.9178 Test_loss:0.377103
2026-01-26 05:51:59.285 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:51:59.285 | INFO     | __main__:main_worker:349 - ---> start train epoch75
acc1: 86.1111, acc3: 100.0000, Precision: 0.7769, Recall: 0.7805, F1-Score: 0.7783, Specificity: 0.9178
2026-01-26 05:52:09.375 | INFO     | __main__:main_worker:423 - [75/100], remain:0d.00h.11m, It:[10/54], Max-Mem:11251M, Data-Time:0.688, LR:0.0000, Train_Loss:-0.2922, total_loss:tensor([-0.2922], device='cuda:0'), ce_loss:0.3603821396827698, cluster_loss:0.06858381628990173, sep_loss:0.019337309524416924, soft_orth_loss:0.004960671067237854, local_consistency_loss:0.001229205634444952, proto_loss:0.09411100298166275
2026-01-26 05:52:14.044 | INFO     | __main__:main_worker:423 - [75/100], remain:0d.00h.11m, It:[20/54], Max-Mem:11251M, Data-Time:0.906, LR:0.0000, Train_Loss:-0.0578, total_loss:tensor([-0.0578], device='cuda:0'), ce_loss:0.5023450255393982, cluster_loss:0.07590930908918381, sep_loss:0.023054659366607666, soft_orth_loss:0.004960714839398861, local_consistency_loss:0.000951369758695364, proto_loss:0.10487605631351471
2026-01-26 05:52:18.515 | INFO     | __main__:main_worker:423 - [75/100], remain:0d.00h.10m, It:[30/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0000, Train_Loss:0.1949, total_loss:tensor([0.1949], device='cuda:0'), ce_loss:0.7480676174163818, cluster_loss:0.0002271184785058722, sep_loss:0.032843660563230515, soft_orth_loss:0.0049614449962973595, local_consistency_loss:0.0007911794818937778, proto_loss:0.038823407143354416
2026-01-26 05:52:24.820 | INFO     | __main__:main_worker:423 - [75/100], remain:0d.00h.11m, It:[40/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0000, Train_Loss:-0.3513, total_loss:tensor([-0.3513], device='cuda:0'), ce_loss:0.3331579864025116, cluster_loss:0.06191388517618179, sep_loss:0.017025606706738472, soft_orth_loss:0.004960925318300724, local_consistency_loss:0.0005816624616272748, proto_loss:0.08448207378387451
2026-01-26 05:52:29.805 | INFO     | __main__:main_worker:423 - [75/100], remain:0d.00h.11m, It:[50/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:0.3310, total_loss:tensor([0.3310], device='cuda:0'), ce_loss:0.7018918395042419, cluster_loss:0.11231713742017746, sep_loss:0.03428872674703598, soft_orth_loss:0.004960753954946995, local_consistency_loss:0.0011658667353913188, proto_loss:0.1527324914932251
Evaluating: 100%|| 15/15 [00:08<00:00,  1.87it/s]
2026-01-26 05:52:40.784 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [75/100], Top1:85.043, Top3:100.000, Test_precision:0.7476,Test_recall:0.8004,Test_f1:0.7683,,Test_specificity:0.9221 Test_loss:0.395458
2026-01-26 05:52:40.784 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
acc1: 85.0427, acc3: 100.0000, Precision: 0.7476, Recall: 0.8004, F1-Score: 0.7683, Specificity: 0.9221
2026-01-26 05:52:49.962 | INFO     | __main__:main_worker:349 - ---> start train epoch76
2026-01-26 05:53:03.023 | INFO     | __main__:main_worker:423 - [76/100], remain:0d.00h.14m, It:[10/54], Max-Mem:11251M, Data-Time:2.910, LR:0.0000, Train_Loss:-0.0012, total_loss:tensor([-0.0012], device='cuda:0'), ce_loss:0.5235106945037842, cluster_loss:0.08269990980625153, sep_loss:0.030445469543337822, soft_orth_loss:0.004960918333381414, local_consistency_loss:0.0005256618605926633, proto_loss:0.11863195896148682
2026-01-26 05:53:08.263 | INFO     | __main__:main_worker:423 - [76/100], remain:0d.00h.13m, It:[20/54], Max-Mem:11251M, Data-Time:1.748, LR:0.0000, Train_Loss:0.3990, total_loss:tensor([0.3990], device='cuda:0'), ce_loss:0.7249388694763184, cluster_loss:0.14084476232528687, sep_loss:0.023385463282465935, soft_orth_loss:0.0049607763066887856, local_consistency_loss:0.0019264195580035448, proto_loss:0.17111742496490479
2026-01-26 05:53:11.935 | INFO     | __main__:main_worker:423 - [76/100], remain:0d.00h.11m, It:[30/54], Max-Mem:11251M, Data-Time:0.202, LR:0.0000, Train_Loss:0.1031, total_loss:tensor([0.1031], device='cuda:0'), ce_loss:0.5690485835075378, cluster_loss:0.10720228403806686, sep_loss:0.025183146819472313, soft_orth_loss:0.004960629623383284, local_consistency_loss:0.0008993857773020864, proto_loss:0.13824544847011566
2026-01-26 05:53:18.032 | INFO     | __main__:main_worker:423 - [76/100], remain:0d.00h.11m, It:[40/54], Max-Mem:11251M, Data-Time:2.653, LR:0.0000, Train_Loss:0.0657, total_loss:tensor([0.0657], device='cuda:0'), ce_loss:0.5764598846435547, cluster_loss:0.07125011831521988, sep_loss:0.031260233372449875, soft_orth_loss:0.004960333928465843, local_consistency_loss:0.003964612726122141, proto_loss:0.11143529415130615
2026-01-26 05:53:22.148 | INFO     | __main__:main_worker:423 - [76/100], remain:0d.00h.11m, It:[50/54], Max-Mem:11251M, Data-Time:0.702, LR:0.0000, Train_Loss:0.7544, total_loss:tensor([0.7544], device='cuda:0'), ce_loss:0.9255776405334473, cluster_loss:0.15826381742954254, sep_loss:0.03573456406593323, soft_orth_loss:0.0049598729237914085, local_consistency_loss:0.0005072640487924218, proto_loss:0.19946551322937012
Evaluating: 100%|| 15/15 [00:08<00:00,  1.85it/s]
2026-01-26 05:53:31.579 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [76/100], Top1:86.325, Top3:100.000, Test_precision:0.7703,Test_recall:0.8168,Test_f1:0.7901,,Test_specificity:0.9286 Test_loss:0.381439
acc1: 86.3248, acc3: 100.0000, Precision: 0.7703, Recall: 0.8168, F1-Score: 0.7901, Specificity: 0.9286
2026-01-26 05:53:31.579 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:53:31.580 | INFO     | __main__:main_worker:349 - ---> start train epoch77
2026-01-26 05:53:42.094 | INFO     | __main__:main_worker:423 - [77/100], remain:0d.00h.10m, It:[10/54], Max-Mem:11251M, Data-Time:1.493, LR:0.0000, Train_Loss:0.2575, total_loss:tensor([0.2575], device='cuda:0'), ce_loss:0.6574227213859558, cluster_loss:0.10507891327142715, sep_loss:0.03851998969912529, soft_orth_loss:0.004959327634423971, local_consistency_loss:0.0011409580474719405, proto_loss:0.14969918131828308
2026-01-26 05:53:45.638 | INFO     | __main__:main_worker:423 - [77/100], remain:0d.00h.08m, It:[20/54], Max-Mem:11251M, Data-Time:0.023, LR:0.0000, Train_Loss:0.1112, total_loss:tensor([0.1112], device='cuda:0'), ce_loss:0.5763751864433289, cluster_loss:0.10064952820539474, sep_loss:0.030239759013056755, soft_orth_loss:0.004959182348102331, local_consistency_loss:0.0009516220889054239, proto_loss:0.13680008053779602
2026-01-26 05:53:50.168 | INFO     | __main__:main_worker:423 - [77/100], remain:0d.00h.08m, It:[30/54], Max-Mem:11251M, Data-Time:0.673, LR:0.0000, Train_Loss:0.3671, total_loss:tensor([0.3671], device='cuda:0'), ce_loss:0.7151469588279724, cluster_loss:0.12581774592399597, sep_loss:0.03059770166873932, soft_orth_loss:0.004958380479365587, local_consistency_loss:0.0005891853361390531, proto_loss:0.16196301579475403
2026-01-26 05:53:53.941 | INFO     | __main__:main_worker:423 - [77/100], remain:0d.00h.08m, It:[40/54], Max-Mem:11251M, Data-Time:0.304, LR:0.0000, Train_Loss:0.0924, total_loss:tensor([0.0924], device='cuda:0'), ce_loss:0.6004607677459717, cluster_loss:0.07488324493169785, sep_loss:0.025405166670680046, soft_orth_loss:0.004958074539899826, local_consistency_loss:0.0011566500179469585, proto_loss:0.10640313476324081
2026-01-26 05:53:57.602 | INFO     | __main__:main_worker:423 - [77/100], remain:0d.00h.08m, It:[50/54], Max-Mem:11251M, Data-Time:0.213, LR:0.0000, Train_Loss:-0.1892, total_loss:tensor([-0.1892], device='cuda:0'), ce_loss:0.4186364412307739, cluster_loss:0.07556087523698807, sep_loss:0.022175101563334465, soft_orth_loss:0.004957846365869045, local_consistency_loss:0.000550761993508786, proto_loss:0.1032445877790451
Evaluating: 100%|| 15/15 [00:08<00:00,  1.83it/s]
2026-01-26 05:54:07.963 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [77/100], Top1:85.043, Top3:100.000, Test_precision:0.7581,Test_recall:0.7773,Test_f1:0.7662,,Test_specificity:0.9104 Test_loss:0.395372
2026-01-26 05:54:07.964 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:54:07.964 | INFO     | __main__:main_worker:349 - ---> start train epoch78
acc1: 85.0427, acc3: 100.0000, Precision: 0.7581, Recall: 0.7773, F1-Score: 0.7662, Specificity: 0.9104
2026-01-26 05:54:15.815 | INFO     | __main__:main_worker:423 - [78/100], remain:0d.00h.09m, It:[10/54], Max-Mem:11251M, Data-Time:0.240, LR:0.0000, Train_Loss:0.0270, total_loss:tensor([0.0270], device='cuda:0'), ce_loss:0.5444499850273132, cluster_loss:0.09267658740282059, sep_loss:0.018687784671783447, soft_orth_loss:0.004957946948707104, local_consistency_loss:0.0010123009560629725, proto_loss:0.11733461916446686
2026-01-26 05:54:20.561 | INFO     | __main__:main_worker:423 - [78/100], remain:0d.00h.09m, It:[20/54], Max-Mem:11251M, Data-Time:0.138, LR:0.0000, Train_Loss:-0.0667, total_loss:tensor([-0.0667], device='cuda:0'), ce_loss:0.5827540755271912, cluster_loss:0.00019973446615040302, sep_loss:0.02763690985739231, soft_orth_loss:0.004957795608788729, local_consistency_loss:0.0008634075638838112, proto_loss:0.033657848834991455
2026-01-26 05:54:25.568 | INFO     | __main__:main_worker:423 - [78/100], remain:0d.00h.09m, It:[30/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:0.7525, total_loss:tensor([0.7525], device='cuda:0'), ce_loss:0.9238684177398682, cluster_loss:0.16234125196933746, sep_loss:0.030701279640197754, soft_orth_loss:0.004957087337970734, local_consistency_loss:0.002069604815915227, proto_loss:0.20006923377513885
2026-01-26 05:54:30.008 | INFO     | __main__:main_worker:423 - [78/100], remain:0d.00h.09m, It:[40/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:-0.2374, total_loss:tensor([-0.2374], device='cuda:0'), ce_loss:0.3676060438156128, cluster_loss:0.09138529002666473, sep_loss:0.022881440818309784, soft_orth_loss:0.004956051707267761, local_consistency_loss:0.0004436360322870314, proto_loss:0.11966641992330551
2026-01-26 05:54:34.850 | INFO     | __main__:main_worker:423 - [78/100], remain:0d.00h.09m, It:[50/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0000, Train_Loss:-0.1012, total_loss:tensor([-0.1012], device='cuda:0'), ce_loss:0.554939866065979, cluster_loss:0.00020523792773019522, sep_loss:0.03212662413716316, soft_orth_loss:0.004955474752932787, local_consistency_loss:0.000824746850412339, proto_loss:0.038112081587314606
Evaluating: 100%|| 15/15 [00:09<00:00,  1.55it/s]
2026-01-26 05:54:47.018 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [78/100], Top1:86.111, Top3:100.000, Test_precision:0.7677,Test_recall:0.8088,Test_f1:0.7855,,Test_specificity:0.9258 Test_loss:0.383329
acc1: 86.1111, acc3: 100.0000, Precision: 0.7677, Recall: 0.8088, F1-Score: 0.7855, Specificity: 0.9258
2026-01-26 05:54:47.020 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:54:47.020 | INFO     | __main__:main_worker:349 - ---> start train epoch79
2026-01-26 05:54:56.921 | INFO     | __main__:main_worker:423 - [79/100], remain:0d.00h.09m, It:[10/54], Max-Mem:11251M, Data-Time:1.138, LR:0.0000, Train_Loss:0.1673, total_loss:tensor([0.1673], device='cuda:0'), ce_loss:0.6081861257553101, cluster_loss:0.10719471424818039, sep_loss:0.028553420677781105, soft_orth_loss:0.004955025389790535, local_consistency_loss:0.0009630545973777771, proto_loss:0.1416662037372589
2026-01-26 05:55:01.584 | INFO     | __main__:main_worker:423 - [79/100], remain:0d.00h.09m, It:[20/54], Max-Mem:11251M, Data-Time:1.175, LR:0.0000, Train_Loss:-0.3606, total_loss:tensor([-0.3606], device='cuda:0'), ce_loss:0.33069756627082825, cluster_loss:0.05503438785672188, sep_loss:0.02162395417690277, soft_orth_loss:0.004954312462359667, local_consistency_loss:0.0012507783249020576, proto_loss:0.08286343514919281
2026-01-26 05:55:05.719 | INFO     | __main__:main_worker:423 - [79/100], remain:0d.00h.08m, It:[30/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:0.0807, total_loss:tensor([0.0807], device='cuda:0'), ce_loss:0.569415807723999, cluster_loss:0.08958865702152252, sep_loss:0.03157591447234154, soft_orth_loss:0.004953201860189438, local_consistency_loss:0.0003481880121398717, proto_loss:0.12646597623825073
2026-01-26 05:55:11.042 | INFO     | __main__:main_worker:423 - [79/100], remain:0d.00h.09m, It:[40/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.2117, total_loss:tensor([-0.2117], device='cuda:0'), ce_loss:0.3997582197189331, cluster_loss:0.07947202026844025, sep_loss:0.02202439308166504, soft_orth_loss:0.004952851217240095, local_consistency_loss:0.0008061678963713348, proto_loss:0.10725542902946472
2026-01-26 05:55:16.901 | INFO     | __main__:main_worker:423 - [79/100], remain:0d.00h.09m, It:[50/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.3987, total_loss:tensor([-0.3987], device='cuda:0'), ce_loss:0.2854096293449402, cluster_loss:0.07133301347494125, sep_loss:0.02295469120144844, soft_orth_loss:0.0049528018571436405, local_consistency_loss:0.0007048390107229352, proto_loss:0.09994535148143768
Evaluating: 100%|| 15/15 [00:08<00:00,  1.69it/s]
2026-01-26 05:55:27.712 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [79/100], Top1:86.752, Top3:100.000, Test_precision:0.7734,Test_recall:0.7954,Test_f1:0.7835,,Test_specificity:0.9271 Test_loss:0.379287
2026-01-26 05:55:27.713 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:55:27.714 | INFO     | __main__:main_worker:349 - ---> start train epoch80
acc1: 86.7521, acc3: 100.0000, Precision: 0.7734, Recall: 0.7954, F1-Score: 0.7835, Specificity: 0.9271
2026-01-26 05:55:38.178 | INFO     | __main__:main_worker:423 - [80/100], remain:0d.00h.09m, It:[10/54], Max-Mem:11251M, Data-Time:1.848, LR:0.0000, Train_Loss:0.4762, total_loss:tensor([0.4762], device='cuda:0'), ce_loss:0.7920048236846924, cluster_loss:0.11893844604492188, sep_loss:0.03239617869257927, soft_orth_loss:0.004952410236001015, local_consistency_loss:0.002004549838602543, proto_loss:0.15829159319400787
2026-01-26 05:55:42.663 | INFO     | __main__:main_worker:423 - [80/100], remain:0d.00h.08m, It:[20/54], Max-Mem:11251M, Data-Time:0.938, LR:0.0000, Train_Loss:0.0278, total_loss:tensor([0.0278], device='cuda:0'), ce_loss:0.5310826897621155, cluster_loss:0.09990634769201279, sep_loss:0.024045659229159355, soft_orth_loss:0.0049523841589689255, local_consistency_loss:0.0006137988530099392, proto_loss:0.12951818108558655
2026-01-26 05:55:47.513 | INFO     | __main__:main_worker:423 - [80/100], remain:0d.00h.08m, It:[30/54], Max-Mem:11251M, Data-Time:1.189, LR:0.0000, Train_Loss:-0.1482, total_loss:tensor([-0.1482], device='cuda:0'), ce_loss:0.4441058933734894, cluster_loss:0.06804218143224716, sep_loss:0.030209852382540703, soft_orth_loss:0.004951880779117346, local_consistency_loss:0.0021614190191030502, proto_loss:0.1053653359413147
2026-01-26 05:55:53.249 | INFO     | __main__:main_worker:423 - [80/100], remain:0d.00h.09m, It:[40/54], Max-Mem:11251M, Data-Time:2.125, LR:0.0000, Train_Loss:-0.0473, total_loss:tensor([-0.0473], device='cuda:0'), ce_loss:0.47704246640205383, cluster_loss:0.097732774913311, sep_loss:0.029550159350037575, soft_orth_loss:0.004950996953994036, local_consistency_loss:0.0012212481815367937, proto_loss:0.13345518708229065
2026-01-26 05:55:57.648 | INFO     | __main__:main_worker:423 - [80/100], remain:0d.00h.08m, It:[50/54], Max-Mem:11251M, Data-Time:0.871, LR:0.0000, Train_Loss:-0.3628, total_loss:tensor([-0.3628], device='cuda:0'), ce_loss:0.3150582015514374, cluster_loss:0.073240727186203, sep_loss:0.01652519963681698, soft_orth_loss:0.004950046539306641, local_consistency_loss:0.00045992518425919116, proto_loss:0.09517589956521988
2026-01-26 05:55:58.989 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 80 (LR=0.000011, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.0224
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.8987
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 25.9416
Local prototype push completed!
2026-01-26 05:56:26.332 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating: 100%|| 15/15 [00:08<00:00,  1.79it/s]
2026-01-26 05:56:34.719 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [80/100], Top1:70.513, Top3:100.000, Test_precision:0.6315,Test_recall:0.6091,Test_f1:0.5977,,Test_specificity:0.7821 Test_loss:1.101843
acc1: 70.5128, acc3: 100.0000, Precision: 0.6315, Recall: 0.6091, F1-Score: 0.5977, Specificity: 0.7821
2026-01-26 05:56:34.720 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:56:43.974 | INFO     | __main__:main_worker:349 - ---> start train epoch81
2026-01-26 05:56:55.333 | INFO     | __main__:main_worker:423 - [81/100], remain:0d.00h.10m, It:[10/54], Max-Mem:11251M, Data-Time:2.229, LR:0.0000, Train_Loss:0.0425, total_loss:tensor([0.0425], device='cuda:0'), ce_loss:0.6519041061401367, cluster_loss:0.00021097132412251085, sep_loss:0.030022909864783287, soft_orth_loss:0.005692769307643175, local_consistency_loss:0.0008200121228583157, proto_loss:0.036746662110090256
2026-01-26 05:57:00.889 | INFO     | __main__:main_worker:423 - [81/100], remain:0d.00h.09m, It:[20/54], Max-Mem:11251M, Data-Time:2.006, LR:0.0000, Train_Loss:-0.3216, total_loss:tensor([-0.3216], device='cuda:0'), ce_loss:0.36067578196525574, cluster_loss:0.05539124086499214, sep_loss:0.018262967467308044, soft_orth_loss:0.005688803270459175, local_consistency_loss:0.0005270325927995145, proto_loss:0.07987003773450851
2026-01-26 05:57:05.011 | INFO     | __main__:main_worker:423 - [81/100], remain:0d.00h.08m, It:[30/54], Max-Mem:11251M, Data-Time:0.650, LR:0.0000, Train_Loss:-0.1696, total_loss:tensor([-0.1696], device='cuda:0'), ce_loss:0.4338560402393341, cluster_loss:0.07508096098899841, sep_loss:0.02095351181924343, soft_orth_loss:0.0056874570436775684, local_consistency_loss:0.0006831557839177549, proto_loss:0.10240509361028671
2026-01-26 05:57:10.816 | INFO     | __main__:main_worker:423 - [81/100], remain:0d.00h.09m, It:[40/54], Max-Mem:11251M, Data-Time:2.284, LR:0.0000, Train_Loss:0.0388, total_loss:tensor([0.0388], device='cuda:0'), ce_loss:0.5198860168457031, cluster_loss:0.11402106285095215, sep_loss:0.024396313354372978, soft_orth_loss:0.005686504766345024, local_consistency_loss:0.00115461356472224, proto_loss:0.14525850117206573
2026-01-26 05:57:14.712 | INFO     | __main__:main_worker:423 - [81/100], remain:0d.00h.08m, It:[50/54], Max-Mem:11251M, Data-Time:0.393, LR:0.0000, Train_Loss:0.3232, total_loss:tensor([0.3232], device='cuda:0'), ce_loss:0.7146255373954773, cluster_loss:0.1002587229013443, sep_loss:0.03123152256011963, soft_orth_loss:0.005685629788786173, local_consistency_loss:0.0018402234418317676, proto_loss:0.13901609182357788
Evaluating: 100%|| 15/15 [00:07<00:00,  1.90it/s]
2026-01-26 05:57:23.928 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [81/100], Top1:86.966, Top3:100.000, Test_precision:0.7794,Test_recall:0.8095,Test_f1:0.7928,,Test_specificity:0.9291 Test_loss:0.440727
2026-01-26 05:57:23.928 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:57:23.929 | INFO     | __main__:main_worker:349 - ---> start train epoch82
acc1: 86.9658, acc3: 100.0000, Precision: 0.7794, Recall: 0.8095, F1-Score: 0.7928, Specificity: 0.9291
2026-01-26 05:57:33.222 | INFO     | __main__:main_worker:423 - [82/100], remain:0d.00h.07m, It:[10/54], Max-Mem:11251M, Data-Time:0.164, LR:0.0000, Train_Loss:0.2995, total_loss:tensor([0.2995], device='cuda:0'), ce_loss:0.6860694885253906, cluster_loss:0.1110699400305748, sep_loss:0.03108212910592556, soft_orth_loss:0.005682290531694889, local_consistency_loss:0.0020309833344072104, proto_loss:0.14986534416675568
2026-01-26 05:57:38.357 | INFO     | __main__:main_worker:423 - [82/100], remain:0d.00h.07m, It:[20/54], Max-Mem:11251M, Data-Time:0.941, LR:0.0000, Train_Loss:0.1665, total_loss:tensor([0.1665], device='cuda:0'), ce_loss:0.6110281348228455, cluster_loss:0.10351454466581345, sep_loss:0.028128856793045998, soft_orth_loss:0.005679669324308634, local_consistency_loss:0.002133952919393778, proto_loss:0.13945701718330383
2026-01-26 05:57:42.982 | INFO     | __main__:main_worker:423 - [82/100], remain:0d.00h.07m, It:[30/54], Max-Mem:11251M, Data-Time:1.109, LR:0.0000, Train_Loss:-0.0441, total_loss:tensor([-0.0441], device='cuda:0'), ce_loss:0.4867919981479645, cluster_loss:0.0906243771314621, sep_loss:0.029573217034339905, soft_orth_loss:0.005678047891706228, local_consistency_loss:0.0015437486581504345, proto_loss:0.1274193823337555
2026-01-26 05:57:46.648 | INFO     | __main__:main_worker:423 - [82/100], remain:0d.00h.07m, It:[40/54], Max-Mem:11251M, Data-Time:0.228, LR:0.0000, Train_Loss:0.0982, total_loss:tensor([0.0982], device='cuda:0'), ce_loss:0.5777231454849243, cluster_loss:0.0932910367846489, sep_loss:0.029865635558962822, soft_orth_loss:0.005678100511431694, local_consistency_loss:0.0009465463808737695, proto_loss:0.1297813206911087
2026-01-26 05:57:51.241 | INFO     | __main__:main_worker:423 - [82/100], remain:0d.00h.07m, It:[50/54], Max-Mem:11251M, Data-Time:0.467, LR:0.0000, Train_Loss:0.5528, total_loss:tensor([0.5528], device='cuda:0'), ce_loss:0.8172516822814941, cluster_loss:0.1382526159286499, sep_loss:0.034779030829668045, soft_orth_loss:0.00567729352042079, local_consistency_loss:0.001043636933900416, proto_loss:0.17975257337093353
Evaluating: 100%|| 15/15 [00:07<00:00,  1.92it/s]
acc1: 86.9658, acc3: 100.0000, Precision: 0.7887, Recall: 0.8053, F1-Score: 0.7962, Specificity: 0.9265
2026-01-26 05:58:01.388 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [82/100], Top1:86.966, Top3:100.000, Test_precision:0.7887,Test_recall:0.8053,Test_f1:0.7962,,Test_specificity:0.9265 Test_loss:0.379458
2026-01-26 05:58:01.389 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:58:01.390 | INFO     | __main__:main_worker:349 - ---> start train epoch83
2026-01-26 05:58:11.426 | INFO     | __main__:main_worker:423 - [83/100], remain:0d.00h.08m, It:[10/54], Max-Mem:11251M, Data-Time:1.844, LR:0.0000, Train_Loss:0.1443, total_loss:tensor([0.1443], device='cuda:0'), ce_loss:0.6266340017318726, cluster_loss:0.07972989231348038, sep_loss:0.02690029703080654, soft_orth_loss:0.005674347281455994, local_consistency_loss:0.0020318147726356983, proto_loss:0.11433635652065277
2026-01-26 05:58:15.429 | INFO     | __main__:main_worker:423 - [83/100], remain:0d.00h.07m, It:[20/54], Max-Mem:11251M, Data-Time:0.504, LR:0.0000, Train_Loss:0.3128, total_loss:tensor([0.3128], device='cuda:0'), ce_loss:0.6937705278396606, cluster_loss:0.11416077613830566, sep_loss:0.02993563748896122, soft_orth_loss:0.005672662053257227, local_consistency_loss:0.0011933634523302317, proto_loss:0.1509624421596527
2026-01-26 05:58:19.434 | INFO     | __main__:main_worker:423 - [83/100], remain:0d.00h.06m, It:[30/54], Max-Mem:11251M, Data-Time:0.571, LR:0.0000, Train_Loss:0.0533, total_loss:tensor([0.0533], device='cuda:0'), ce_loss:0.547060489654541, cluster_loss:0.10132491588592529, sep_loss:0.022495100274682045, soft_orth_loss:0.0056717535480856895, local_consistency_loss:0.001385965384542942, proto_loss:0.13087773323059082
2026-01-26 05:58:24.211 | INFO     | __main__:main_worker:423 - [83/100], remain:0d.00h.06m, It:[40/54], Max-Mem:11251M, Data-Time:0.874, LR:0.0000, Train_Loss:0.0571, total_loss:tensor([0.0571], device='cuda:0'), ce_loss:0.5228831171989441, cluster_loss:0.12628589570522308, sep_loss:0.01806877739727497, soft_orth_loss:0.005671127699315548, local_consistency_loss:0.003185556037351489, proto_loss:0.15321135520935059
2026-01-26 05:58:30.140 | INFO     | __main__:main_worker:423 - [83/100], remain:0d.00h.07m, It:[50/54], Max-Mem:11251M, Data-Time:2.340, LR:0.0000, Train_Loss:0.0484, total_loss:tensor([0.0484], device='cuda:0'), ce_loss:0.5454056262969971, cluster_loss:0.09226913750171661, sep_loss:0.0302602406591177, soft_orth_loss:0.005670109298080206, local_consistency_loss:0.0013826488284394145, proto_loss:0.12958213686943054
Evaluating: 100%|| 15/15 [00:11<00:00,  1.36it/s]
acc1: 86.9658, acc3: 100.0000, Precision: 0.7779, Recall: 0.8067, F1-Score: 0.7908, Specificity: 0.9300
2026-01-26 05:58:42.551 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [83/100], Top1:86.966, Top3:100.000, Test_precision:0.7779,Test_recall:0.8067,Test_f1:0.7908,,Test_specificity:0.9300 Test_loss:0.376531
2026-01-26 05:58:42.553 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:58:42.554 | INFO     | __main__:main_worker:349 - ---> start train epoch84
2026-01-26 05:58:57.372 | INFO     | __main__:main_worker:423 - [84/100], remain:0d.00h.10m, It:[10/54], Max-Mem:11251M, Data-Time:3.703, LR:0.0000, Train_Loss:0.0649, total_loss:tensor([0.0649], device='cuda:0'), ce_loss:0.5601384043693542, cluster_loss:0.09698547422885895, sep_loss:0.022620409727096558, soft_orth_loss:0.005668581463396549, local_consistency_loss:0.0011093923822045326, proto_loss:0.12638385593891144
2026-01-26 05:59:04.242 | INFO     | __main__:main_worker:423 - [84/100], remain:0d.00h.10m, It:[20/54], Max-Mem:11251M, Data-Time:3.261, LR:0.0000, Train_Loss:0.3025, total_loss:tensor([0.3025], device='cuda:0'), ce_loss:0.7017311453819275, cluster_loss:0.09733914583921432, sep_loss:0.03134686499834061, soft_orth_loss:0.0056677041575312614, local_consistency_loss:0.004384421743452549, proto_loss:0.13873814046382904
2026-01-26 05:59:11.681 | INFO     | __main__:main_worker:423 - [84/100], remain:0d.00h.10m, It:[30/54], Max-Mem:11251M, Data-Time:3.668, LR:0.0000, Train_Loss:-0.3555, total_loss:tensor([-0.3555], device='cuda:0'), ce_loss:0.31231242418289185, cluster_loss:0.07387232035398483, sep_loss:0.021682260558009148, soft_orth_loss:0.005666830576956272, local_consistency_loss:0.0011658211005851626, proto_loss:0.10238723456859589
2026-01-26 05:59:21.068 | INFO     | __main__:main_worker:423 - [84/100], remain:0d.00h.11m, It:[40/54], Max-Mem:11251M, Data-Time:5.668, LR:0.0000, Train_Loss:0.0505, total_loss:tensor([0.0505], device='cuda:0'), ce_loss:0.5488806366920471, cluster_loss:0.09271068125963211, sep_loss:0.02888835035264492, soft_orth_loss:0.005666324868798256, local_consistency_loss:0.0007188036106526852, proto_loss:0.1279841661453247
2026-01-26 05:59:26.241 | INFO     | __main__:main_worker:423 - [84/100], remain:0d.00h.10m, It:[50/54], Max-Mem:11251M, Data-Time:1.621, LR:0.0000, Train_Loss:0.2278, total_loss:tensor([0.2278], device='cuda:0'), ce_loss:0.6351845860481262, cluster_loss:0.11655548959970474, sep_loss:0.029344502836465836, soft_orth_loss:0.005666397511959076, local_consistency_loss:0.0017884258413687348, proto_loss:0.15335480868816376
Evaluating: 100%|| 15/15 [00:11<00:00,  1.29it/s]
2026-01-26 05:59:39.233 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [84/100], Top1:86.966, Top3:100.000, Test_precision:0.7750,Test_recall:0.8081,Test_f1:0.7897,,Test_specificity:0.9312 Test_loss:0.388732
acc1: 86.9658, acc3: 100.0000, Precision: 0.7750, Recall: 0.8081, F1-Score: 0.7897, Specificity: 0.9312
2026-01-26 05:59:39.234 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 05:59:39.234 | INFO     | __main__:main_worker:349 - ---> start train epoch85
2026-01-26 05:59:51.365 | INFO     | __main__:main_worker:423 - [85/100], remain:0d.00h.07m, It:[10/54], Max-Mem:11251M, Data-Time:1.800, LR:0.0000, Train_Loss:0.9825, total_loss:tensor([0.9825], device='cuda:0'), ce_loss:1.048615574836731, cluster_loss:0.18350711464881897, sep_loss:0.03287993744015694, soft_orth_loss:0.005666486453264952, local_consistency_loss:0.0007654208457097411, proto_loss:0.22281895577907562
2026-01-26 05:59:55.807 | INFO     | __main__:main_worker:423 - [85/100], remain:0d.00h.06m, It:[20/54], Max-Mem:11251M, Data-Time:0.459, LR:0.0000, Train_Loss:0.0338, total_loss:tensor([0.0338], device='cuda:0'), ce_loss:0.5704125165939331, cluster_loss:0.06479902565479279, sep_loss:0.028321683406829834, soft_orth_loss:0.0056656659580767155, local_consistency_loss:0.002044869353994727, proto_loss:0.10083124786615372
2026-01-26 06:00:02.736 | INFO     | __main__:main_worker:423 - [85/100], remain:0d.00h.07m, It:[30/54], Max-Mem:11251M, Data-Time:0.820, LR:0.0000, Train_Loss:0.1241, total_loss:tensor([0.1241], device='cuda:0'), ce_loss:0.5857429504394531, cluster_loss:0.10350248962640762, sep_loss:0.028101539239287376, soft_orth_loss:0.005664878990501165, local_consistency_loss:0.00044938409700989723, proto_loss:0.1377183049917221
2026-01-26 06:00:09.667 | INFO     | __main__:main_worker:423 - [85/100], remain:0d.00h.08m, It:[40/54], Max-Mem:11251M, Data-Time:0.929, LR:0.0000, Train_Loss:0.0771, total_loss:tensor([0.0771], device='cuda:0'), ce_loss:0.555985152721405, cluster_loss:0.09932755678892136, sep_loss:0.029728328809142113, soft_orth_loss:0.0056643313728272915, local_consistency_loss:0.0020386469550430775, proto_loss:0.13675886392593384
2026-01-26 06:00:18.066 | INFO     | __main__:main_worker:423 - [85/100], remain:0d.00h.08m, It:[50/54], Max-Mem:11251M, Data-Time:1.803, LR:0.0000, Train_Loss:0.0313, total_loss:tensor([0.0313], device='cuda:0'), ce_loss:0.5335678458213806, cluster_loss:0.10032043606042862, sep_loss:0.023541782051324844, soft_orth_loss:0.005663845222443342, local_consistency_loss:0.0008515980443917215, proto_loss:0.1303776651620865
Evaluating: 100%|| 15/15 [00:13<00:00,  1.13it/s]
acc1: 86.7521, acc3: 100.0000, Precision: 0.7728, Recall: 0.8056, F1-Score: 0.7873, Specificity: 0.9302
2026-01-26 06:00:32.696 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [85/100], Top1:86.752, Top3:100.000, Test_precision:0.7728,Test_recall:0.8056,Test_f1:0.7873,,Test_specificity:0.9302 Test_loss:0.393191
2026-01-26 06:00:32.697 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:00:42.534 | INFO     | __main__:main_worker:349 - ---> start train epoch86
2026-01-26 06:00:54.277 | INFO     | __main__:main_worker:423 - [86/100], remain:0d.00h.07m, It:[10/54], Max-Mem:11251M, Data-Time:1.919, LR:0.0000, Train_Loss:0.1629, total_loss:tensor([0.1629], device='cuda:0'), ce_loss:0.6049669981002808, cluster_loss:0.10542645305395126, sep_loss:0.03054853342473507, soft_orth_loss:0.005663197487592697, local_consistency_loss:0.0014149975031614304, proto_loss:0.14305318892002106
2026-01-26 06:01:01.158 | INFO     | __main__:main_worker:423 - [86/100], remain:0d.00h.08m, It:[20/54], Max-Mem:11251M, Data-Time:2.900, LR:0.0000, Train_Loss:-0.0389, total_loss:tensor([-0.0389], device='cuda:0'), ce_loss:0.5000980496406555, cluster_loss:0.08839278668165207, sep_loss:0.025004491209983826, soft_orth_loss:0.005662586074322462, local_consistency_loss:0.000706168357282877, proto_loss:0.11976602673530579
2026-01-26 06:01:08.299 | INFO     | __main__:main_worker:423 - [86/100], remain:0d.00h.08m, It:[30/54], Max-Mem:11251M, Data-Time:2.484, LR:0.0000, Train_Loss:-0.1027, total_loss:tensor([-0.1027], device='cuda:0'), ce_loss:0.4557689130306244, cluster_loss:0.09125924110412598, sep_loss:0.023928022012114525, soft_orth_loss:0.005661672912538052, local_consistency_loss:0.0009366771555505693, proto_loss:0.12178561836481094
2026-01-26 06:01:16.113 | INFO     | __main__:main_worker:423 - [86/100], remain:0d.00h.08m, It:[40/54], Max-Mem:11251M, Data-Time:3.648, LR:0.0000, Train_Loss:-0.2345, total_loss:tensor([-0.2345], device='cuda:0'), ce_loss:0.47730258107185364, cluster_loss:0.00020111277990508825, sep_loss:0.02456190623342991, soft_orth_loss:0.00566067872568965, local_consistency_loss:0.0009228858980350196, proto_loss:0.03134658560156822
2026-01-26 06:01:22.219 | INFO     | __main__:main_worker:423 - [86/100], remain:0d.00h.08m, It:[50/54], Max-Mem:11251M, Data-Time:1.796, LR:0.0000, Train_Loss:-0.0265, total_loss:tensor([-0.0265], device='cuda:0'), ce_loss:0.5091263055801392, cluster_loss:0.08464448899030685, sep_loss:0.028115663677453995, soft_orth_loss:0.005660200957208872, local_consistency_loss:0.0007192629273049533, proto_loss:0.11913961917161942
Evaluating: 100%|| 15/15 [00:11<00:00,  1.26it/s]
acc1: 86.9658, acc3: 100.0000, Precision: 0.7821, Recall: 0.8067, F1-Score: 0.7933, Specificity: 0.9279
2026-01-26 06:01:35.525 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [86/100], Top1:86.966, Top3:100.000, Test_precision:0.7821,Test_recall:0.8067,Test_f1:0.7933,,Test_specificity:0.9279 Test_loss:0.383746
2026-01-26 06:01:35.526 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:01:35.527 | INFO     | __main__:main_worker:349 - ---> start train epoch87
2026-01-26 06:01:46.486 | INFO     | __main__:main_worker:423 - [87/100], remain:0d.00h.06m, It:[10/54], Max-Mem:11251M, Data-Time:1.559, LR:0.0000, Train_Loss:-0.0001, total_loss:tensor([-0.0001], device='cuda:0'), ce_loss:0.5184701085090637, cluster_loss:0.09203948825597763, sep_loss:0.027698799967765808, soft_orth_loss:0.005659835413098335, local_consistency_loss:0.00043456905405037105, proto_loss:0.1258326917886734
2026-01-26 06:01:50.395 | INFO     | __main__:main_worker:423 - [87/100], remain:0d.00h.05m, It:[20/54], Max-Mem:11251M, Data-Time:0.399, LR:0.0000, Train_Loss:-0.3594, total_loss:tensor([-0.3594], device='cuda:0'), ce_loss:0.32851675152778625, cluster_loss:0.06501835584640503, sep_loss:0.01571822352707386, soft_orth_loss:0.00565958209335804, local_consistency_loss:0.0007657499518245459, proto_loss:0.08716190606355667
2026-01-26 06:01:55.462 | INFO     | __main__:main_worker:423 - [87/100], remain:0d.00h.05m, It:[30/54], Max-Mem:11251M, Data-Time:0.019, LR:0.0000, Train_Loss:0.2192, total_loss:tensor([0.2192], device='cuda:0'), ce_loss:0.6348164677619934, cluster_loss:0.11310809850692749, sep_loss:0.028163833543658257, soft_orth_loss:0.005659348797053099, local_consistency_loss:0.002277720719575882, proto_loss:0.14920899271965027
2026-01-26 06:02:00.509 | INFO     | __main__:main_worker:423 - [87/100], remain:0d.00h.05m, It:[40/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:0.2461, total_loss:tensor([0.2461], device='cuda:0'), ce_loss:0.6653509140014648, cluster_loss:0.09982196986675262, sep_loss:0.032093632966279984, soft_orth_loss:0.005658984184265137, local_consistency_loss:0.0009080860763788223, proto_loss:0.13848267495632172
2026-01-26 06:02:06.613 | INFO     | __main__:main_worker:423 - [87/100], remain:0d.00h.05m, It:[50/54], Max-Mem:11251M, Data-Time:0.008, LR:0.0000, Train_Loss:-0.2777, total_loss:tensor([-0.2777], device='cuda:0'), ce_loss:0.3544970452785492, cluster_loss:0.08134212344884872, sep_loss:0.02252408303320408, soft_orth_loss:0.0056584975682199, local_consistency_loss:0.0008939380059018731, proto_loss:0.1104186400771141
Evaluating: 100%|| 15/15 [00:09<00:00,  1.63it/s]
2026-01-26 06:02:17.796 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [87/100], Top1:86.538, Top3:100.000, Test_precision:0.7749,Test_recall:0.8077,Test_f1:0.7897,,Test_specificity:0.9264 Test_loss:0.388850
2026-01-26 06:02:17.797 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:02:17.797 | INFO     | __main__:main_worker:349 - ---> start train epoch88
acc1: 86.5385, acc3: 100.0000, Precision: 0.7749, Recall: 0.8077, F1-Score: 0.7897, Specificity: 0.9264
2026-01-26 06:02:27.855 | INFO     | __main__:main_worker:423 - [88/100], remain:0d.00h.07m, It:[10/54], Max-Mem:11251M, Data-Time:1.744, LR:0.0000, Train_Loss:0.8375, total_loss:tensor([0.8375], device='cuda:0'), ce_loss:0.990548312664032, cluster_loss:0.14956216514110565, sep_loss:0.034760065376758575, soft_orth_loss:0.005657779518514872, local_consistency_loss:0.0017992554930970073, proto_loss:0.1917792707681656
2026-01-26 06:02:31.997 | INFO     | __main__:main_worker:423 - [88/100], remain:0d.00h.05m, It:[20/54], Max-Mem:11251M, Data-Time:0.614, LR:0.0000, Train_Loss:1.2600, total_loss:tensor([1.2600], device='cuda:0'), ce_loss:1.1583304405212402, cluster_loss:0.24148570001125336, sep_loss:0.036023568361997604, soft_orth_loss:0.005657132714986801, local_consistency_loss:0.0005437367362901568, proto_loss:0.28371015191078186
2026-01-26 06:02:37.458 | INFO     | __main__:main_worker:423 - [88/100], remain:0d.00h.05m, It:[30/54], Max-Mem:11251M, Data-Time:0.966, LR:0.0000, Train_Loss:1.8331, total_loss:tensor([1.8331], device='cuda:0'), ce_loss:1.4858754873275757, cluster_loss:0.2807953357696533, sep_loss:0.03722139447927475, soft_orth_loss:0.00565633038058877, local_consistency_loss:0.0012598015600815415, proto_loss:0.32493287324905396
2026-01-26 06:02:42.542 | INFO     | __main__:main_worker:423 - [88/100], remain:0d.00h.05m, It:[40/54], Max-Mem:11251M, Data-Time:1.269, LR:0.0000, Train_Loss:-0.3163, total_loss:tensor([-0.3163], device='cuda:0'), ce_loss:0.3439442217350006, cluster_loss:0.07447228580713272, sep_loss:0.017523890361189842, soft_orth_loss:0.005655649118125439, local_consistency_loss:0.00049652683082968, proto_loss:0.09814835339784622
2026-01-26 06:02:47.115 | INFO     | __main__:main_worker:423 - [88/100], remain:0d.00h.05m, It:[50/54], Max-Mem:11251M, Data-Time:0.797, LR:0.0000, Train_Loss:0.2548, total_loss:tensor([0.2548], device='cuda:0'), ce_loss:0.7016589045524597, cluster_loss:0.07250344008207321, sep_loss:0.034604381769895554, soft_orth_loss:0.005654999054968357, local_consistency_loss:0.0002898256934713572, proto_loss:0.11305264383554459
2026-01-26 06:02:49.490 | INFO     | __main__:main_worker:464 - ---> Pushing prototypes at epoch 88 (LR=0.000005, momentum=0.85)
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 25.9985
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 25.8890
  Class 2: 5000 patches
2026-01-26 06:03:17.014 | INFO     | __main__:main_worker:469 - ---> Prototype push completed (gradual update with momentum=0.85)
Evaluating:   0%|          | 0/15 [00:00<?, ?it/s]    Updated 5 prototypes, min_dist: 25.8723
Local prototype push completed!
Evaluating: 100%|| 15/15 [00:08<00:00,  1.77it/s]
2026-01-26 06:03:25.489 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [88/100], Top1:65.385, Top3:100.000, Test_precision:0.4969,Test_recall:0.5417,Test_f1:0.4793,,Test_specificity:0.7178 Test_loss:2.702504
2026-01-26 06:03:25.490 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:03:25.491 | INFO     | __main__:main_worker:349 - ---> start train epoch89
acc1: 65.3846, acc3: 100.0000, Precision: 0.4969, Recall: 0.5417, F1-Score: 0.4793, Specificity: 0.7178
2026-01-26 06:03:36.734 | INFO     | __main__:main_worker:423 - [89/100], remain:0d.00h.06m, It:[10/54], Max-Mem:11251M, Data-Time:2.187, LR:0.0000, Train_Loss:0.4796, total_loss:tensor([0.4796], device='cuda:0'), ce_loss:0.7515320777893066, cluster_loss:0.16411720216274261, sep_loss:0.02291729860007763, soft_orth_loss:0.0071210130117833614, local_consistency_loss:0.0007237357785925269, proto_loss:0.19487924873828888
2026-01-26 06:03:41.011 | INFO     | __main__:main_worker:423 - [89/100], remain:0d.00h.05m, It:[20/54], Max-Mem:11251M, Data-Time:0.710, LR:0.0000, Train_Loss:0.0591, total_loss:tensor([0.0591], device='cuda:0'), ce_loss:0.5491836667060852, cluster_loss:0.0919693186879158, sep_loss:0.033433232456445694, soft_orth_loss:0.007119282148778439, local_consistency_loss:0.00042607448995113373, proto_loss:0.1329479068517685
2026-01-26 06:03:45.770 | INFO     | __main__:main_worker:423 - [89/100], remain:0d.00h.05m, It:[30/54], Max-Mem:11251M, Data-Time:1.213, LR:0.0000, Train_Loss:0.4894, total_loss:tensor([0.4894], device='cuda:0'), ce_loss:0.7997937798500061, cluster_loss:0.11402715742588043, sep_loss:0.03852501139044762, soft_orth_loss:0.0071164509281516075, local_consistency_loss:0.00031526837847195566, proto_loss:0.15998388826847076
2026-01-26 06:03:51.389 | INFO     | __main__:main_worker:423 - [89/100], remain:0d.00h.05m, It:[40/54], Max-Mem:11251M, Data-Time:2.017, LR:0.0000, Train_Loss:0.1927, total_loss:tensor([0.1927], device='cuda:0'), ce_loss:0.6272228956222534, cluster_loss:0.09916570037603378, sep_loss:0.034768566489219666, soft_orth_loss:0.007114319130778313, local_consistency_loss:0.0001244419108843431, proto_loss:0.14117302000522614
2026-01-26 06:03:55.094 | INFO     | __main__:main_worker:423 - [89/100], remain:0d.00h.04m, It:[50/54], Max-Mem:11251M, Data-Time:0.291, LR:0.0000, Train_Loss:0.2484, total_loss:tensor([0.2484], device='cuda:0'), ce_loss:0.6430540680885315, cluster_loss:0.1197228655219078, sep_loss:0.030928630381822586, soft_orth_loss:0.007112501654773951, local_consistency_loss:0.0007808688096702099, proto_loss:0.1585448682308197
Evaluating: 100%|| 15/15 [00:09<00:00,  1.60it/s]
2026-01-26 06:04:05.877 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [89/100], Top1:85.897, Top3:100.000, Test_precision:0.7642,Test_recall:0.8002,Test_f1:0.7795,,Test_specificity:0.9195 Test_loss:0.535194
acc1: 85.8974, acc3: 100.0000, Precision: 0.7642, Recall: 0.8002, F1-Score: 0.7795, Specificity: 0.9195
2026-01-26 06:04:05.878 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:04:05.879 | INFO     | __main__:main_worker:349 - ---> start train epoch90
2026-01-26 06:04:15.799 | INFO     | __main__:main_worker:423 - [90/100], remain:0d.00h.05m, It:[10/54], Max-Mem:11251M, Data-Time:0.996, LR:0.0000, Train_Loss:0.0610, total_loss:tensor([0.0610], device='cuda:0'), ce_loss:0.5332516431808472, cluster_loss:0.11088284105062485, sep_loss:0.02855442278087139, soft_orth_loss:0.00711019616574049, local_consistency_loss:0.0008260639733634889, proto_loss:0.1473735123872757
2026-01-26 06:04:21.053 | INFO     | __main__:main_worker:423 - [90/100], remain:0d.00h.04m, It:[20/54], Max-Mem:11251M, Data-Time:1.417, LR:0.0000, Train_Loss:0.2599, total_loss:tensor([0.2599], device='cuda:0'), ce_loss:0.6775736212730408, cluster_loss:0.09090720862150192, sep_loss:0.03767935559153557, soft_orth_loss:0.007108429446816444, local_consistency_loss:0.0003607371763791889, proto_loss:0.13605573773384094
2026-01-26 06:04:25.170 | INFO     | __main__:main_worker:423 - [90/100], remain:0d.00h.04m, It:[30/54], Max-Mem:11251M, Data-Time:0.644, LR:0.0000, Train_Loss:0.2175, total_loss:tensor([0.2175], device='cuda:0'), ce_loss:0.633917510509491, cluster_loss:0.11600688844919205, sep_loss:0.025758324190974236, soft_orth_loss:0.007106648292392492, local_consistency_loss:0.00040031876415014267, proto_loss:0.14927217364311218
2026-01-26 06:04:30.405 | INFO     | __main__:main_worker:423 - [90/100], remain:0d.00h.04m, It:[40/54], Max-Mem:11251M, Data-Time:1.754, LR:0.0000, Train_Loss:0.0347, total_loss:tensor([0.0347], device='cuda:0'), ce_loss:0.5560591220855713, cluster_loss:0.0767642930150032, sep_loss:0.02943219244480133, soft_orth_loss:0.007104904390871525, local_consistency_loss:0.0006275309715420008, proto_loss:0.11392892152070999
2026-01-26 06:04:35.543 | INFO     | __main__:main_worker:423 - [90/100], remain:0d.00h.04m, It:[50/54], Max-Mem:11251M, Data-Time:1.721, LR:0.0000, Train_Loss:0.0743, total_loss:tensor([0.0743], device='cuda:0'), ce_loss:0.6754413843154907, cluster_loss:0.0002560252323746681, sep_loss:0.027671579271554947, soft_orth_loss:0.007103482726961374, local_consistency_loss:0.0009029670036397874, proto_loss:0.03593405336141586
Evaluating: 100%|| 15/15 [00:07<00:00,  1.94it/s]
acc1: 87.1795, acc3: 100.0000, Precision: 0.7872, Recall: 0.8408, F1-Score: 0.8095, Specificity: 0.9307
2026-01-26 06:04:44.609 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [90/100], Top1:87.179, Top3:100.000, Test_precision:0.7872,Test_recall:0.8408,Test_f1:0.8095,,Test_specificity:0.9307 Test_loss:0.473746
2026-01-26 06:04:44.610 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:05:09.122 | INFO     | __main__:main_worker:349 - ---> start train epoch91
2026-01-26 06:05:18.996 | INFO     | __main__:main_worker:423 - [91/100], remain:0d.00h.04m, It:[10/54], Max-Mem:11251M, Data-Time:1.788, LR:0.0000, Train_Loss:-0.1189, total_loss:tensor([-0.1189], device='cuda:0'), ce_loss:0.4704400897026062, cluster_loss:0.06588684767484665, sep_loss:0.027681583538651466, soft_orth_loss:0.007101751398295164, local_consistency_loss:0.00041205078014172614, proto_loss:0.10108223557472229
2026-01-26 06:05:23.427 | INFO     | __main__:main_worker:423 - [91/100], remain:0d.00h.04m, It:[20/54], Max-Mem:11251M, Data-Time:0.988, LR:0.0000, Train_Loss:-0.0187, total_loss:tensor([-0.0187], device='cuda:0'), ce_loss:0.5048820376396179, cluster_loss:0.09477266669273376, sep_loss:0.025239422917366028, soft_orth_loss:0.0071010771207511425, local_consistency_loss:0.0002768368285614997, proto_loss:0.12738999724388123
2026-01-26 06:05:27.974 | INFO     | __main__:main_worker:423 - [91/100], remain:0d.00h.03m, It:[30/54], Max-Mem:11251M, Data-Time:0.761, LR:0.0000, Train_Loss:-0.0310, total_loss:tensor([-0.0310], device='cuda:0'), ce_loss:0.47726914286613464, cluster_loss:0.10463821887969971, sep_loss:0.023714248090982437, soft_orth_loss:0.007100807037204504, local_consistency_loss:0.008239686489105225, proto_loss:0.1436929553747177
2026-01-26 06:05:32.261 | INFO     | __main__:main_worker:423 - [91/100], remain:0d.00h.03m, It:[40/54], Max-Mem:11251M, Data-Time:0.824, LR:0.0000, Train_Loss:-0.1670, total_loss:tensor([-0.1670], device='cuda:0'), ce_loss:0.40573492646217346, cluster_loss:0.10300514847040176, sep_loss:0.017991185188293457, soft_orth_loss:0.007100469432771206, local_consistency_loss:0.0007130966987460852, proto_loss:0.12880989909172058
2026-01-26 06:05:36.445 | INFO     | __main__:main_worker:423 - [91/100], remain:0d.00h.03m, It:[50/54], Max-Mem:11251M, Data-Time:0.742, LR:0.0000, Train_Loss:-0.0927, total_loss:tensor([-0.0927], device='cuda:0'), ce_loss:0.46032625436782837, cluster_loss:0.09305180609226227, sep_loss:0.023143066093325615, soft_orth_loss:0.007100133690983057, local_consistency_loss:0.000709960819222033, proto_loss:0.12400496751070023
Evaluating: 100%|| 15/15 [00:08<00:00,  1.87it/s]
2026-01-26 06:05:45.814 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [91/100], Top1:87.179, Top3:100.000, Test_precision:0.7844,Test_recall:0.8361,Test_f1:0.8062,,Test_specificity:0.9317 Test_loss:0.486605
2026-01-26 06:05:45.815 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:05:45.815 | INFO     | __main__:main_worker:349 - ---> start train epoch92
acc1: 87.1795, acc3: 100.0000, Precision: 0.7844, Recall: 0.8361, F1-Score: 0.8062, Specificity: 0.9317
2026-01-26 06:05:54.841 | INFO     | __main__:main_worker:423 - [92/100], remain:0d.00h.03m, It:[10/54], Max-Mem:11251M, Data-Time:0.563, LR:0.0000, Train_Loss:0.2664, total_loss:tensor([0.2664], device='cuda:0'), ce_loss:0.6604811549186707, cluster_loss:0.11589448899030685, sep_loss:0.030580198392271996, soft_orth_loss:0.0070992750115692616, local_consistency_loss:0.0004302474844735116, proto_loss:0.15400420129299164
2026-01-26 06:05:59.680 | INFO     | __main__:main_worker:423 - [92/100], remain:0d.00h.03m, It:[20/54], Max-Mem:11251M, Data-Time:1.362, LR:0.0000, Train_Loss:-0.2179, total_loss:tensor([-0.2179], device='cuda:0'), ce_loss:0.3858359158039093, cluster_loss:0.08694731444120407, sep_loss:0.022696012631058693, soft_orth_loss:0.00709879957139492, local_consistency_loss:0.0007402466144412756, proto_loss:0.11748237162828445
2026-01-26 06:06:04.975 | INFO     | __main__:main_worker:423 - [92/100], remain:0d.00h.03m, It:[30/54], Max-Mem:11251M, Data-Time:1.746, LR:0.0000, Train_Loss:-0.2242, total_loss:tensor([-0.2242], device='cuda:0'), ce_loss:0.4875984787940979, cluster_loss:0.00023901199165266007, sep_loss:0.02141680382192135, soft_orth_loss:0.0070985122583806515, local_consistency_loss:0.0002711665874812752, proto_loss:0.029025495052337646
2026-01-26 06:06:09.419 | INFO     | __main__:main_worker:423 - [92/100], remain:0d.00h.03m, It:[40/54], Max-Mem:11251M, Data-Time:0.946, LR:0.0000, Train_Loss:-0.0208, total_loss:tensor([-0.0208], device='cuda:0'), ce_loss:0.49244314432144165, cluster_loss:0.10504703968763351, sep_loss:0.023891882970929146, soft_orth_loss:0.00709821842610836, local_consistency_loss:0.0006665918044745922, proto_loss:0.1367037296295166
2026-01-26 06:06:14.149 | INFO     | __main__:main_worker:423 - [92/100], remain:0d.00h.03m, It:[50/54], Max-Mem:11251M, Data-Time:1.105, LR:0.0000, Train_Loss:0.6299, total_loss:tensor([0.6299], device='cuda:0'), ce_loss:0.8453128337860107, cluster_loss:0.1669565737247467, sep_loss:0.024318238720297813, soft_orth_loss:0.007098089437931776, local_consistency_loss:0.0008757539908401668, proto_loss:0.19924865663051605
Evaluating: 100%|| 15/15 [00:09<00:00,  1.61it/s]
2026-01-26 06:06:25.595 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [92/100], Top1:87.179, Top3:100.000, Test_precision:0.7864,Test_recall:0.8361,Test_f1:0.8077,,Test_specificity:0.9315 Test_loss:0.476936
2026-01-26 06:06:25.596 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:06:25.596 | INFO     | __main__:main_worker:349 - ---> start train epoch93
acc1: 87.1795, acc3: 100.0000, Precision: 0.7864, Recall: 0.8361, F1-Score: 0.8077, Specificity: 0.9315
2026-01-26 06:06:37.352 | INFO     | __main__:main_worker:423 - [93/100], remain:0d.00h.04m, It:[10/54], Max-Mem:11251M, Data-Time:0.023, LR:0.0000, Train_Loss:-0.1818, total_loss:tensor([-0.1818], device='cuda:0'), ce_loss:0.42269155383110046, cluster_loss:0.07502629607915878, sep_loss:0.023960208520293236, soft_orth_loss:0.007097786292433739, local_consistency_loss:0.0004825275973416865, proto_loss:0.10656682401895523
2026-01-26 06:06:42.783 | INFO     | __main__:main_worker:423 - [93/100], remain:0d.00h.04m, It:[20/54], Max-Mem:11251M, Data-Time:0.018, LR:0.0000, Train_Loss:0.4609, total_loss:tensor([0.4609], device='cuda:0'), ce_loss:0.7627958655357361, cluster_loss:0.13636775314807892, sep_loss:0.02917514741420746, soft_orth_loss:0.007097538560628891, local_consistency_loss:0.0027672655414789915, proto_loss:0.17540770769119263
2026-01-26 06:06:47.501 | INFO     | __main__:main_worker:423 - [93/100], remain:0d.00h.03m, It:[30/54], Max-Mem:11251M, Data-Time:0.024, LR:0.0000, Train_Loss:0.7537, total_loss:tensor([0.7537], device='cuda:0'), ce_loss:0.9281556606292725, cluster_loss:0.16167335212230682, sep_loss:0.028501762077212334, soft_orth_loss:0.007097338791936636, local_consistency_loss:0.0007829139940440655, proto_loss:0.19805535674095154
2026-01-26 06:06:53.358 | INFO     | __main__:main_worker:423 - [93/100], remain:0d.00h.03m, It:[40/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.1475, total_loss:tensor([-0.1475], device='cuda:0'), ce_loss:0.4231069087982178, cluster_loss:0.09573490172624588, sep_loss:0.021696841344237328, soft_orth_loss:0.007097132038325071, local_consistency_loss:0.0005888215382583439, proto_loss:0.1251177042722702
2026-01-26 06:06:58.631 | INFO     | __main__:main_worker:423 - [93/100], remain:0d.00h.03m, It:[50/54], Max-Mem:11251M, Data-Time:0.010, LR:0.0000, Train_Loss:-0.1406, total_loss:tensor([-0.1406], device='cuda:0'), ce_loss:0.415155827999115, cluster_loss:0.10747971385717392, sep_loss:0.01998034492135048, soft_orth_loss:0.007096859160810709, local_consistency_loss:0.0009953720727935433, proto_loss:0.1355522871017456
Evaluating: 100%|| 15/15 [00:09<00:00,  1.63it/s]
2026-01-26 06:07:10.623 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [93/100], Top1:86.538, Top3:100.000, Test_precision:0.7765,Test_recall:0.7970,Test_f1:0.7858,,Test_specificity:0.9240 Test_loss:0.480792
acc1: 86.5385, acc3: 100.0000, Precision: 0.7765, Recall: 0.7970, F1-Score: 0.7858, Specificity: 0.9240
2026-01-26 06:07:10.624 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:07:10.625 | INFO     | __main__:main_worker:349 - ---> start train epoch94
2026-01-26 06:07:20.860 | INFO     | __main__:main_worker:423 - [94/100], remain:0d.00h.03m, It:[10/54], Max-Mem:11251M, Data-Time:1.028, LR:0.0000, Train_Loss:-0.0017, total_loss:tensor([-0.0017], device='cuda:0'), ce_loss:0.5097801089286804, cluster_loss:0.1016433984041214, sep_loss:0.023509478196501732, soft_orth_loss:0.00709674833342433, local_consistency_loss:0.0005533449002541602, proto_loss:0.13280296325683594
2026-01-26 06:07:26.947 | INFO     | __main__:main_worker:423 - [94/100], remain:0d.00h.03m, It:[20/54], Max-Mem:11251M, Data-Time:1.817, LR:0.0000, Train_Loss:-0.1425, total_loss:tensor([-0.1425], device='cuda:0'), ce_loss:0.4503795802593231, cluster_loss:0.07298944145441055, sep_loss:0.02443692646920681, soft_orth_loss:0.007096520625054836, local_consistency_loss:0.0006068730144761503, proto_loss:0.10512976348400116
2026-01-26 06:07:31.952 | INFO     | __main__:main_worker:423 - [94/100], remain:0d.00h.03m, It:[30/54], Max-Mem:11251M, Data-Time:1.580, LR:0.0000, Train_Loss:-0.2770, total_loss:tensor([-0.2770], device='cuda:0'), ce_loss:0.37489619851112366, cluster_loss:0.07106895744800568, sep_loss:0.01581854186952114, soft_orth_loss:0.007096135523170233, local_consistency_loss:0.0003290007298346609, proto_loss:0.0943126380443573
2026-01-26 06:07:37.954 | INFO     | __main__:main_worker:423 - [94/100], remain:0d.00h.03m, It:[40/54], Max-Mem:11251M, Data-Time:2.497, LR:0.0000, Train_Loss:0.1116, total_loss:tensor([0.1116], device='cuda:0'), ce_loss:0.5643075704574585, cluster_loss:0.11432033777236938, sep_loss:0.027557948604226112, soft_orth_loss:0.007095780223608017, local_consistency_loss:0.0005162430461496115, proto_loss:0.14949031174182892
2026-01-26 06:07:42.891 | INFO     | __main__:main_worker:423 - [94/100], remain:0d.00h.03m, It:[50/54], Max-Mem:11251M, Data-Time:1.440, LR:0.0000, Train_Loss:0.1677, total_loss:tensor([0.1677], device='cuda:0'), ce_loss:0.5955650210380554, cluster_loss:0.12184148281812668, sep_loss:0.024831293150782585, soft_orth_loss:0.007095606066286564, local_consistency_loss:0.0004114731273148209, proto_loss:0.15417984127998352
Evaluating: 100%|| 15/15 [00:09<00:00,  1.60it/s]
2026-01-26 06:07:53.628 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [94/100], Top1:86.966, Top3:100.000, Test_precision:0.7832,Test_recall:0.8350,Test_f1:0.8051,,Test_specificity:0.9297 Test_loss:0.463345
acc1: 86.9658, acc3: 100.0000, Precision: 0.7832, Recall: 0.8350, F1-Score: 0.8051, Specificity: 0.9297
2026-01-26 06:07:53.629 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:07:53.630 | INFO     | __main__:main_worker:349 - ---> start train epoch95
2026-01-26 06:08:04.648 | INFO     | __main__:main_worker:423 - [95/100], remain:0d.00h.02m, It:[10/54], Max-Mem:11251M, Data-Time:2.212, LR:0.0000, Train_Loss:0.3666, total_loss:tensor([0.3666], device='cuda:0'), ce_loss:0.7084428071975708, cluster_loss:0.132543683052063, sep_loss:0.029128992930054665, soft_orth_loss:0.007095560897141695, local_consistency_loss:0.00035091149038635194, proto_loss:0.16911914944648743
2026-01-26 06:08:10.440 | INFO     | __main__:main_worker:423 - [95/100], remain:0d.00h.02m, It:[20/54], Max-Mem:11251M, Data-Time:2.262, LR:0.0000, Train_Loss:-0.4909, total_loss:tensor([-0.4909], device='cuda:0'), ce_loss:0.23146896064281464, cluster_loss:0.0759771540760994, sep_loss:0.013054138980805874, soft_orth_loss:0.007095577660948038, local_consistency_loss:0.0005953430663794279, proto_loss:0.09672221541404724
2026-01-26 06:08:16.278 | INFO     | __main__:main_worker:423 - [95/100], remain:0d.00h.02m, It:[30/54], Max-Mem:11251M, Data-Time:2.354, LR:0.0000, Train_Loss:-0.0097, total_loss:tensor([-0.0097], device='cuda:0'), ce_loss:0.5309110283851624, cluster_loss:0.08421976119279861, sep_loss:0.019182460382580757, soft_orth_loss:0.007095471955835819, local_consistency_loss:0.0002854194608516991, proto_loss:0.11078310757875443
2026-01-26 06:08:21.517 | INFO     | __main__:main_worker:423 - [95/100], remain:0d.00h.02m, It:[40/54], Max-Mem:11251M, Data-Time:1.707, LR:0.0000, Train_Loss:0.7125, total_loss:tensor([0.7125], device='cuda:0'), ce_loss:0.8936936855316162, cluster_loss:0.16336970031261444, sep_loss:0.03311348706483841, soft_orth_loss:0.0070953210815787315, local_consistency_loss:0.0006684698164463043, proto_loss:0.20424698293209076
2026-01-26 06:08:27.065 | INFO     | __main__:main_worker:423 - [95/100], remain:0d.00h.02m, It:[50/54], Max-Mem:11251M, Data-Time:2.028, LR:0.0000, Train_Loss:0.4972, total_loss:tensor([0.4972], device='cuda:0'), ce_loss:0.7880949378013611, cluster_loss:0.1401434689760208, sep_loss:0.026254162192344666, soft_orth_loss:0.007095166482031345, local_consistency_loss:0.0007952341693453491, proto_loss:0.17428803443908691
Evaluating: 100%|| 15/15 [00:07<00:00,  1.91it/s]
2026-01-26 06:08:36.228 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [95/100], Top1:86.966, Top3:100.000, Test_precision:0.7889,Test_recall:0.8141,Test_f1:0.8003,,Test_specificity:0.9268 Test_loss:0.476916
2026-01-26 06:08:36.229 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
acc1: 86.9658, acc3: 100.0000, Precision: 0.7889, Recall: 0.8141, F1-Score: 0.8003, Specificity: 0.9268
2026-01-26 06:08:59.378 | INFO     | __main__:main_worker:349 - ---> start train epoch96
2026-01-26 06:09:08.219 | INFO     | __main__:main_worker:423 - [96/100], remain:0d.00h.01m, It:[10/54], Max-Mem:11251M, Data-Time:0.612, LR:0.0000, Train_Loss:0.2985, total_loss:tensor([0.2985], device='cuda:0'), ce_loss:0.6774246692657471, cluster_loss:0.1242280825972557, sep_loss:0.02512742020189762, soft_orth_loss:0.007095059379935265, local_consistency_loss:0.0012043989263474941, proto_loss:0.15765495598316193
2026-01-26 06:09:12.662 | INFO     | __main__:main_worker:423 - [96/100], remain:0d.00h.01m, It:[20/54], Max-Mem:11251M, Data-Time:0.828, LR:0.0000, Train_Loss:-0.2029, total_loss:tensor([-0.2029], device='cuda:0'), ce_loss:0.4118691086769104, cluster_loss:0.07136855274438858, sep_loss:0.02533433400094509, soft_orth_loss:0.00709499279037118, local_consistency_loss:0.0003886898048222065, proto_loss:0.10418657213449478
2026-01-26 06:09:16.340 | INFO     | __main__:main_worker:423 - [96/100], remain:0d.00h.01m, It:[30/54], Max-Mem:11251M, Data-Time:0.009, LR:0.0000, Train_Loss:-0.2401, total_loss:tensor([-0.2401], device='cuda:0'), ce_loss:0.39047813415527344, cluster_loss:0.07638689130544662, sep_loss:0.017255181446671486, soft_orth_loss:0.0070949518121778965, local_consistency_loss:0.0009408922051079571, proto_loss:0.10167790949344635
2026-01-26 06:09:21.204 | INFO     | __main__:main_worker:423 - [96/100], remain:0d.00h.01m, It:[40/54], Max-Mem:11251M, Data-Time:0.686, LR:0.0000, Train_Loss:-0.2499, total_loss:tensor([-0.2499], device='cuda:0'), ce_loss:0.37710246443748474, cluster_loss:0.08187782019376755, sep_loss:0.017778506502509117, soft_orth_loss:0.007094918750226498, local_consistency_loss:0.0007092069718055427, proto_loss:0.10746045410633087
2026-01-26 06:09:24.793 | INFO     | __main__:main_worker:423 - [96/100], remain:0d.00h.01m, It:[50/54], Max-Mem:11251M, Data-Time:0.176, LR:0.0000, Train_Loss:0.8443, total_loss:tensor([0.8443], device='cuda:0'), ce_loss:0.9806519150733948, cluster_loss:0.16315360367298126, sep_loss:0.03277922421693802, soft_orth_loss:0.00709485774859786, local_consistency_loss:0.000984799931757152, proto_loss:0.20401249825954437
2026-01-26 06:09:27.063 | INFO     | __main__:main_worker:482 - ---> Skipping prototype push: epoch > push_end(88)
Evaluating: 100%|| 15/15 [00:07<00:00,  1.92it/s]
acc1: 87.1795, acc3: 100.0000, Precision: 0.7897, Recall: 0.8241, F1-Score: 0.8050, Specificity: 0.9299
2026-01-26 06:09:34.879 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [96/100], Top1:87.179, Top3:100.000, Test_precision:0.7897,Test_recall:0.8241,Test_f1:0.8050,,Test_specificity:0.9299 Test_loss:0.467465
2026-01-26 06:09:34.880 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:09:34.881 | INFO     | __main__:main_worker:349 - ---> start train epoch97
2026-01-26 06:09:44.484 | INFO     | __main__:main_worker:423 - [97/100], remain:0d.00h.01m, It:[10/54], Max-Mem:11251M, Data-Time:1.071, LR:0.0000, Train_Loss:1.1826, total_loss:tensor([1.1826], device='cuda:0'), ce_loss:1.12552011013031, cluster_loss:0.22415266931056976, sep_loss:0.03680940717458725, soft_orth_loss:0.0070948307402431965, local_consistency_loss:0.000657775322906673, proto_loss:0.26871466636657715
2026-01-26 06:09:48.489 | INFO     | __main__:main_worker:423 - [97/100], remain:0d.00h.01m, It:[20/54], Max-Mem:11251M, Data-Time:0.585, LR:0.0000, Train_Loss:-0.1292, total_loss:tensor([-0.1292], device='cuda:0'), ce_loss:0.4293985366821289, cluster_loss:0.10104026645421982, sep_loss:0.021147368475794792, soft_orth_loss:0.00709482841193676, local_consistency_loss:0.0007782044704072177, proto_loss:0.13006065785884857
2026-01-26 06:09:52.564 | INFO     | __main__:main_worker:423 - [97/100], remain:0d.00h.01m, It:[30/54], Max-Mem:11251M, Data-Time:0.540, LR:0.0000, Train_Loss:0.0691, total_loss:tensor([0.0691], device='cuda:0'), ce_loss:0.600472092628479, cluster_loss:0.0679325982928276, sep_loss:0.020484725013375282, soft_orth_loss:0.0070948307402431965, local_consistency_loss:0.0005251526599749923, proto_loss:0.09603730589151382
2026-01-26 06:09:57.090 | INFO     | __main__:main_worker:423 - [97/100], remain:0d.00h.01m, It:[40/54], Max-Mem:11251M, Data-Time:0.882, LR:0.0000, Train_Loss:-0.1588, total_loss:tensor([-0.1588], device='cuda:0'), ce_loss:0.4205818474292755, cluster_loss:0.09006710350513458, sep_loss:0.023523619398474693, soft_orth_loss:0.00709480931982398, local_consistency_loss:0.0005119224078953266, proto_loss:0.12119745463132858
2026-01-26 06:10:01.422 | INFO     | __main__:main_worker:423 - [97/100], remain:0d.00h.01m, It:[50/54], Max-Mem:11251M, Data-Time:0.539, LR:0.0000, Train_Loss:0.0418, total_loss:tensor([0.0418], device='cuda:0'), ce_loss:0.5200272798538208, cluster_loss:0.12087815254926682, sep_loss:0.019161606207489967, soft_orth_loss:0.007094749249517918, local_consistency_loss:0.001130353077314794, proto_loss:0.14826487004756927
Evaluating: 100%|| 15/15 [00:09<00:00,  1.66it/s]
2026-01-26 06:10:11.765 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [97/100], Top1:86.752, Top3:100.000, Test_precision:0.7810,Test_recall:0.8177,Test_f1:0.7974,,Test_specificity:0.9264 Test_loss:0.486019
acc1: 86.7521, acc3: 100.0000, Precision: 0.7810, Recall: 0.8177, F1-Score: 0.7974, Specificity: 0.9264
2026-01-26 06:10:11.766 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:10:11.767 | INFO     | __main__:main_worker:349 - ---> start train epoch98
2026-01-26 06:10:23.070 | INFO     | __main__:main_worker:423 - [98/100], remain:0d.00h.01m, It:[10/54], Max-Mem:11251M, Data-Time:2.255, LR:0.0000, Train_Loss:0.1041, total_loss:tensor([0.1041], device='cuda:0'), ce_loss:0.579542338848114, cluster_loss:0.09525644034147263, sep_loss:0.029854822903871536, soft_orth_loss:0.007094646338373423, local_consistency_loss:0.0005139794084243476, proto_loss:0.13271990418434143
2026-01-26 06:10:27.515 | INFO     | __main__:main_worker:423 - [98/100], remain:0d.00h.01m, It:[20/54], Max-Mem:11251M, Data-Time:0.891, LR:0.0000, Train_Loss:0.1242, total_loss:tensor([0.1242], device='cuda:0'), ce_loss:0.5689078569412231, cluster_loss:0.11728179454803467, sep_loss:0.02781812660396099, soft_orth_loss:0.007094611879438162, local_consistency_loss:0.000432061729952693, proto_loss:0.15262658894062042
2026-01-26 06:10:32.408 | INFO     | __main__:main_worker:423 - [98/100], remain:0d.00h.01m, It:[30/54], Max-Mem:11251M, Data-Time:1.338, LR:0.0000, Train_Loss:0.1072, total_loss:tensor([0.1072], device='cuda:0'), ce_loss:0.5959453582763672, cluster_loss:0.08419670909643173, sep_loss:0.029129687696695328, soft_orth_loss:0.007094556000083685, local_consistency_loss:0.0003106826334260404, proto_loss:0.12073163688182831
2026-01-26 06:10:36.644 | INFO     | __main__:main_worker:423 - [98/100], remain:0d.00h.00m, It:[40/54], Max-Mem:11251M, Data-Time:0.787, LR:0.0000, Train_Loss:-0.0054, total_loss:tensor([-0.0054], device='cuda:0'), ce_loss:0.5191403031349182, cluster_loss:0.08888038247823715, sep_loss:0.02653402090072632, soft_orth_loss:0.007094451691955328, local_consistency_loss:0.0005854141199961305, proto_loss:0.12309426814317703
2026-01-26 06:10:41.702 | INFO     | __main__:main_worker:423 - [98/100], remain:0d.00h.00m, It:[50/54], Max-Mem:11251M, Data-Time:0.242, LR:0.0000, Train_Loss:0.1781, total_loss:tensor([0.1781], device='cuda:0'), ce_loss:0.6066592931747437, cluster_loss:0.11180960386991501, sep_loss:0.03127499297261238, soft_orth_loss:0.007094351574778557, local_consistency_loss:0.0005152710946276784, proto_loss:0.15069422125816345
Evaluating: 100%|| 15/15 [00:09<00:00,  1.66it/s]
2026-01-26 06:10:52.104 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [98/100], Top1:86.538, Top3:100.000, Test_precision:0.7768,Test_recall:0.8165,Test_f1:0.7943,,Test_specificity:0.9256 Test_loss:0.483890
2026-01-26 06:10:52.104 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:10:52.105 | INFO     | __main__:main_worker:349 - ---> start train epoch99
acc1: 86.5385, acc3: 100.0000, Precision: 0.7768, Recall: 0.8165, F1-Score: 0.7943, Specificity: 0.9256
2026-01-26 06:11:02.141 | INFO     | __main__:main_worker:423 - [99/100], remain:0d.00h.00m, It:[10/54], Max-Mem:11251M, Data-Time:0.308, LR:0.0000, Train_Loss:0.0498, total_loss:tensor([0.0498], device='cuda:0'), ce_loss:0.522428035736084, cluster_loss:0.1183566078543663, sep_loss:0.02468756213784218, soft_orth_loss:0.0070942481979727745, local_consistency_loss:0.0005101312417536974, proto_loss:0.1506485491991043
2026-01-26 06:11:07.812 | INFO     | __main__:main_worker:423 - [99/100], remain:0d.00h.00m, It:[20/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:0.0460, total_loss:tensor([0.0460], device='cuda:0'), ce_loss:0.5387933850288391, cluster_loss:0.10393872112035751, sep_loss:0.023511184379458427, soft_orth_loss:0.007094192318618298, local_consistency_loss:0.0003355345397721976, proto_loss:0.13487961888313293
2026-01-26 06:11:11.795 | INFO     | __main__:main_worker:423 - [99/100], remain:0d.00h.00m, It:[30/54], Max-Mem:11251M, Data-Time:0.012, LR:0.0000, Train_Loss:-0.2475, total_loss:tensor([-0.2475], device='cuda:0'), ce_loss:0.37427619099617004, cluster_loss:0.08096067607402802, sep_loss:0.02211957611143589, soft_orth_loss:0.0070941089652478695, local_consistency_loss:0.0010432380950078368, proto_loss:0.11121759563684464
2026-01-26 06:11:16.973 | INFO     | __main__:main_worker:423 - [99/100], remain:0d.00h.00m, It:[40/54], Max-Mem:11251M, Data-Time:0.015, LR:0.0000, Train_Loss:1.0796, total_loss:tensor([1.0796], device='cuda:0'), ce_loss:1.1269758939743042, cluster_loss:0.17452867329120636, sep_loss:0.028680134564638138, soft_orth_loss:0.007094025611877441, local_consistency_loss:0.0006336550577543676, proto_loss:0.21093648672103882
2026-01-26 06:11:21.427 | INFO     | __main__:main_worker:423 - [99/100], remain:0d.00h.00m, It:[50/54], Max-Mem:11251M, Data-Time:0.016, LR:0.0000, Train_Loss:0.0652, total_loss:tensor([0.0652], device='cuda:0'), ce_loss:0.5526806116104126, cluster_loss:0.10204799473285675, sep_loss:0.02424432896077633, soft_orth_loss:0.007093962747603655, local_consistency_loss:0.00045422144467011094, proto_loss:0.13384050130844116
Evaluating: 100%|| 15/15 [00:08<00:00,  1.69it/s]
2026-01-26 06:11:34.090 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [99/100], Top1:87.179, Top3:100.000, Test_precision:0.7904,Test_recall:0.8166,Test_f1:0.8023,,Test_specificity:0.9287 Test_loss:0.480578
2026-01-26 06:11:34.091 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
2026-01-26 06:11:34.091 | INFO     | __main__:main_worker:349 - ---> start train epoch100
acc1: 87.1795, acc3: 100.0000, Precision: 0.7904, Recall: 0.8166, F1-Score: 0.8023, Specificity: 0.9287
2026-01-26 06:11:44.871 | INFO     | __main__:main_worker:423 - [100/100], remain:0d.00h.00m, It:[10/54], Max-Mem:11251M, Data-Time:1.415, LR:0.0000, Train_Loss:-0.0454, total_loss:tensor([-0.0454], device='cuda:0'), ce_loss:0.6007816195487976, cluster_loss:0.00022283184807747602, sep_loss:0.02540229633450508, soft_orth_loss:0.007093814667314291, local_consistency_loss:0.0002570661890786141, proto_loss:0.03297600895166397
2026-01-26 06:11:50.472 | INFO     | __main__:main_worker:423 - [100/100], remain:0d.00h.00m, It:[20/54], Max-Mem:11251M, Data-Time:2.069, LR:0.0000, Train_Loss:-0.1409, total_loss:tensor([-0.1409], device='cuda:0'), ce_loss:0.44302284717559814, cluster_loss:0.08421476185321808, sep_loss:0.020685290917754173, soft_orth_loss:0.007093713153153658, local_consistency_loss:0.000353227456798777, proto_loss:0.11234699189662933
2026-01-26 06:11:55.466 | INFO     | __main__:main_worker:423 - [100/100], remain:0d.00h.00m, It:[30/54], Max-Mem:11251M, Data-Time:1.530, LR:0.0000, Train_Loss:-0.0165, total_loss:tensor([-0.0165], device='cuda:0'), ce_loss:0.5057251453399658, cluster_loss:0.09569772332906723, sep_loss:0.024545328691601753, soft_orth_loss:0.007093621883541346, local_consistency_loss:0.0009276065975427628, proto_loss:0.12826427817344666
2026-01-26 06:12:01.501 | INFO     | __main__:main_worker:423 - [100/100], remain:0d.00h.00m, It:[40/54], Max-Mem:11251M, Data-Time:2.456, LR:0.0000, Train_Loss:-0.1178, total_loss:tensor([-0.1178], device='cuda:0'), ce_loss:0.4447007477283478, cluster_loss:0.08534511923789978, sep_loss:0.0218113474547863, soft_orth_loss:0.007093536667525768, local_consistency_loss:0.009365018457174301, proto_loss:0.12361502647399902
2026-01-26 06:12:05.021 | INFO     | __main__:main_worker:423 - [100/100], remain:0d.00h.00m, It:[50/54], Max-Mem:11251M, Data-Time:0.013, LR:0.0000, Train_Loss:0.4094, total_loss:tensor([0.4094], device='cuda:0'), ce_loss:0.7394340634346008, cluster_loss:0.12773850560188293, sep_loss:0.03164788708090782, soft_orth_loss:0.007093521766364574, local_consistency_loss:0.00031974769080989063, proto_loss:0.1667996644973755
Evaluating: 100%|| 15/15 [00:09<00:00,  1.60it/s]
2026-01-26 06:12:16.236 | INFO     | __main__:main_worker:490 - 	Eval-Epoch: [100/100], Top1:86.538, Top3:100.000, Test_precision:0.7785,Test_recall:0.8300,Test_f1:0.8002,,Test_specificity:0.9277 Test_loss:0.465121
2026-01-26 06:12:16.236 | INFO     | __main__:main_worker:501 - 	Best Top1 at epoch [43/100], Top1:88.462, Top-3:100.000
acc1: 86.5385, acc3: 100.0000, Precision: 0.7785, Recall: 0.8300, F1-Score: 0.8002, Specificity: 0.9277
2026-01-26 06:12:25.275 | INFO     | __main__:main_worker:541 - Training of experiment: HiFuse_Small_1e-5-0.05/ft_progressive_v3_eval is done.
2026-01-26 06:12:25.277 | INFO     | __main__:main_worker:543 - 	Best Top1 at epoch [43/100], Top1:88.462, Top3:100.000
/home/backup/lh/KD/mae_lite/tools/train.py:548: DeprecationWarning: The 'stop()' method is deprecated, please use 'remove()' instead
  logger.stop()

Process finished with exit code 0
