/home/backup/lh/anaconda3/bin/python3 /home/backup/lh/KD/mae_lite/tools/train.py 
2026-01-24 15:06:19.717 | INFO     | __main__:main_worker:218 - gpuid: 0, args: <>Namespace(dist_backend='nccl', dist_url=None, batch_size=32, max_epoch=100, devices='0', eval=True, exp_file='/home/backup/lh/KD/projects/eval_tools/finetuning_exp.py', ckpt='/home/backup/lh/KD/projects/mae_lite/checkpoints/HiFuse_ImageNet1K.pth', amp=False, exp_options=None, world_size=1)
/home/backup/lh/KD/mae_lite/tools/train.py:219: DeprecationWarning: The 'ansi' parameter is deprecated, please use 'colors' instead
  logger.opt(ansi=True).info(
2026-01-24 15:06:19.721 | INFO     | __main__:main_worker:219 - Used experiment configs:
======================  ==========================
config key              value
======================  ==========================
batch_size              32
max_epoch               100
seed                    0
data_format             image
clip_grad               <class 'NoneType'>
clip_mode               norm
output_dir              /home/backup/lh/KD/outputs
print_interval          10
dump_interval           10
eval_interval           10
enable_tensorboard      True
dataset                 CommonDataSet
transform               typical_imagenet_transform
image_size              224
encoder_arch            HiFuse_Small
pretrained              False
num_classes             3
global_pool             True
img_size                224
input_size              <class 'NoneType'>
crop_pct                <class 'NoneType'>
mean                    <class 'NoneType'>
std                     <class 'NoneType'>
interpolation
validation_batch_size   <class 'NoneType'>
validation_dataset      MyDataSet
test_dataset            MyDataSet
test_batch_size         <class 'NoneType'>
opt                     adamw
opt_eps                 1e-08
opt_betas               (0.9, 0.999)
momentum                0.9
weight_decay            0.01
sched                   warmcos_scale
basic_lr_per_img        3.125e-06
lr_noise                <class 'NoneType'>
lr_noise_pct            0.67
lr_noise_std            1.0
lr_cycle_mul            1.0
lr_cycle_decay          0.5
lr_cycle_limit          1
lr_k_decay              1.0
warmup_lr_per_img       3.125e-06
min_lr_per_img          3.125e-07
epochs                  100
epoch_repeats           0
start_epoch             <class 'NoneType'>
decay_epochs            <class 'NoneType'>
warmup_epochs           1
cooldown_epochs         10
patience_epochs         10
decay_rate              0.1
no_aug                  False
scale                   (0.08, 1.0)
ratio                   (0.75, 1.3333333333333333)
hflip                   0.5
vflip                   0.0
color_jitter            0.3
aa                      rand-m10-mstd0.5-inc1
reprob                  0.0
remode                  pixel
recount                 1
resplit                 False
mixup                   0.0
cutmix                  0.0
cutmix_minmax           <class 'NoneType'>
mixup_prob              1.0
mixup_switch_prob       0.5
mixup_mode              batch
mixup_off_epoch         0
smoothing               0.0
train_interpolation     bicubic
drop                    0.0
drop_connect            <class 'NoneType'>
drop_path               0.0
drop_block              <class 'NoneType'>
bn_tf                   False
bn_momentum             <class 'NoneType'>
bn_eps                  <class 'NoneType'>
sync_bn                 False
dist_bn                 reduce
model_ema               False
model_ema_force_cpu     False
model_ema_decay         0.9998
num_workers             10
weights_prefix
layer_decay             1.0
warmup_lr               0.0
min_lr                  1e-06
attn_drop_rate          0.0
pretrain_exp_name       HiFuse_Small_1e-5-0.05
save_folder_prefix      ft_
use_mhf_enhancement     True
enhancement_reduction   0.0625
backbone_lr_scale       0.1
mhf_lr_scale            0.5
enhancement_lr_scale    1.0
freeze_backbone_epochs  0
======================  ==========================
/home/backup/lh/KD/mae_lite/tools/train.py:226: DeprecationWarning: The 'ansi' parameter is deprecated, please use 'colors' instead
  logger.opt(ansi=True).info("<yellow>Environment info:</yellow>\n<blue>{}</blue>".format(collect_env_info()))
/home/backup/lh/KD/mae_lite/utils/env.py:48: UserWarning: Current path is possibly not a valid git repository.
  warnings.warn("Current path is possibly not a valid git repository.")
2026-01-24 15:06:21.266 | INFO     | __main__:main_worker:226 - Environment info:
----------------------  --------------------------------------------------------------------------
sys.platform            linux
Python                  3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
numpy                   1.24.3
Pillow                  9.4.0
PyTorch                 2.1.0 @/home/backup/lh/anaconda3/lib/python3.11/site-packages/torch
PyTorch debug build     False
CUDA available          True
GPU 0                   NVIDIA GeForce RTX 3090
CUDA_HOME               /usr
NVCC                    Build cuda_12.0.r12.0/compiler.32267302_0
torchvision             0.16.0 @/home/backup/lh/anaconda3/lib/python3.11/site-packages/torchvision
torchvision arch flags  sm_35, sm_50, sm_60, sm_70, sm_75, sm_80, sm_86
cv2                     4.8.1
----------------------  --------------------------------------------------------------------------
Git status: unknown
----------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.1.1 (Git Hash 64f6bcbcbab628e96f33a62c3e975f8535a7bde4)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.7
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=8.7.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-invalid-partial-specialization -Wno-unused-private-field -Wno-aligned-allocation-unavailable -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_DISABLE_GPU_ASSERTS=ON, TORCH_VERSION=2.1.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

2026-01-24 15:06:25.536232: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-24 15:06:29.289980: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
220 images were found in the dataset.
1753 images for training.
468 images for validation.
2026-01-24 15:06:34.645 | INFO     | projects.eval_tools.finetuning_mae_exp:get_model:115 - Using original model: HiFuse_Small
2026-01-24 15:06:34.652 | INFO     | __main__:main_worker:253 - Illustration of model strcutures:
Model(
  (model): main_model(
    (downsample_layers): ModuleList(
      (0): Sequential(
        (0): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
        (1): LayerNorm()
      )
      (1): Sequential(
        (0): LayerNorm()
        (1): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
      )
      (2): Sequential(
        (0): LayerNorm()
        (1): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
      )
      (3): Sequential(
        (0): LayerNorm()
        (1): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
      )
    )
    (stages): ModuleList(
      (0): Sequential(
        (0): Block(
          (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=96, out_features=384, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=384, out_features=96, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=96, out_features=384, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=384, out_features=96, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(96, 96, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=96)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=96, out_features=384, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=384, out_features=96, bias=True)
          (drop_path): Identity()
        )
      )
      (1): Sequential(
        (0): Block(
          (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=192, out_features=768, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=768, out_features=192, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=192, out_features=768, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=768, out_features=192, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=192, out_features=768, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=768, out_features=192, bias=True)
          (drop_path): Identity()
        )
      )
      (2): Sequential(
        (0): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (3): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (4): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (5): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (6): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (7): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
        (8): Block(
          (dwconv): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=1536, out_features=384, bias=True)
          (drop_path): Identity()
        )
      )
      (3): Sequential(
        (0): Block(
          (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
          (drop_path): Identity()
        )
        (1): Block(
          (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
          (drop_path): Identity()
        )
        (2): Block(
          (dwconv): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
          (norm): LayerNorm()
          (pwconv1): Linear(in_features=768, out_features=3072, bias=True)
          (act): GELU(approximate='none')
          (pwconv2): Linear(in_features=3072, out_features=768, bias=True)
          (drop_path): Identity()
        )
      )
    )
    (conv_norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
    (patch_embed): PatchEmbed(
      (proj): Conv2d(3, 96, kernel_size=(4, 4), stride=(4, 4))
      (norm): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
    )
    (pos_drop): Dropout(p=0.0, inplace=False)
    (meta_tokenlize): PatchEmbed(
      (proj): Conv2d(96, 768, kernel_size=(16, 16), stride=(16, 16))
      (norm): Identity()
    )
    (layers1): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock(
          (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=96, out_features=288, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=96, out_features=96, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=96, out_features=384, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=384, out_features=96, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
      )
    )
    (layers2): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock(
          (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=192, out_features=576, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=192, out_features=192, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=192, out_features=768, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=768, out_features=192, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=384, out_features=192, bias=False)
        (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      )
    )
    (layers3): BasicLayer(
      (blocks): ModuleList(
        (0-5): 6 x SwinTransformerBlock(
          (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=384, out_features=1152, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=384, out_features=384, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=384, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=1536, out_features=384, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=768, out_features=384, bias=False)
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      )
    )
    (layers4): BasicLayer(
      (blocks): ModuleList(
        (0-1): 2 x SwinTransformerBlock(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): WindowAttention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
            (softmax): Softmax(dim=-1)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (downsample): PatchMerging(
        (reduction): Linear(in_features=1536, out_features=768, bias=False)
        (norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
      )
    )
    (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (avgpool): AdaptiveAvgPool1d(output_size=1)
    (head): Head(
      (proj): Sequential(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (2): Dropout(p=0.1, inplace=False)
      )
      (proto_manager): DynamicPrototypeManager()
      (mixed_attn): MixedAttentionBlock(
        (cross_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
        )
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
        )
        (local_self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
        )
        (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (norm3): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (gate): Sequential(
          (0): Linear(in_features=2304, out_features=768, bias=True)
          (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (2): Sigmoid()
        )
      )
      (ffn): Sequential(
        (0): Linear(in_features=768, out_features=3072, bias=True)
        (1): GELU(approximate='none')
        (2): Dropout(p=0.1, inplace=False)
        (3): Linear(in_features=3072, out_features=768, bias=True)
        (4): Dropout(p=0.1, inplace=False)
      )
      (ffn_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (proto_loss_fn): BalancedPrototypeLoss()
    )
    (fu1): MHF_block(
      (att_conv): Sequential(
        (0): Conv2d(192, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(96, 6, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(6, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(192, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(288, 48, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(48, 48, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(48, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(288, 96, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.0, inplace=False)
    )
    (fu2): MHF_block(
      (att_conv): Sequential(
        (0): Conv2d(384, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(192, 12, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(12, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(192, 192, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(384, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(576, 96, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(576, 192, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.1, inplace=False)
    )
    (fu3): MHF_block(
      (att_conv): Sequential(
        (0): Conv2d(768, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(384, 24, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(24, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(768, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(1152, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(1152, 192, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(1152, 384, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.2, inplace=False)
    )
    (fu4): MHF_block(
      (att_conv): Sequential(
        (0): Conv2d(1536, 2, kernel_size=(1, 1), stride=(1, 1))
        (1): Sigmoid()
      )
      (maxpool): AdaptiveMaxPool2d(output_size=1)
      (avgpool): AdaptiveAvgPool2d(output_size=1)
      (se): Sequential(
        (0): Conv2d(768, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (1): ReLU()
        (2): Conv2d(48, 768, kernel_size=(1, 1), stride=(1, 1), bias=False)
      )
      (sigmoid): Sigmoid()
      (spatial): Conv(
        (conv): Conv2d(2, 1, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), bias=False)
        (bn): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_x): Conv(
        (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W_g): Conv(
        (conv): Conv2d(768, 768, kernel_size=(1, 1), stride=(1, 1))
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (Avg): AvgPool2d(kernel_size=2, stride=2, padding=0)
      (norm1): LayerNorm()
      (norm2): LayerNorm()
      (chan): Conv(
        (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (W): Conv(
        (conv): Conv2d(1536, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (relu): ReLU(inplace=True)
        (bn): BatchNorm2d(768, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (gelu): GELU(approximate='none')
      (residual): Residual(
        (relu): ReLU(inplace=True)
        (bn1): BatchNorm2d(2304, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv1): Conv(
          (conv): Conv2d(2304, 384, kernel_size=(1, 1), stride=(1, 1))
        )
        (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv(
          (conv): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
        (bn3): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv(
          (conv): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
        )
        (skip_layer): Conv(
          (conv): Conv2d(2304, 768, kernel_size=(1, 1), stride=(1, 1))
        )
      )
      (dropout): Dropout2d(p=0.2, inplace=False)
    )
  )
  (train_loss_fn): CrossEntropyLoss()
)
2026-01-24 15:06:34.652 | INFO     | projects.eval_tools.finetuning_mae_exp:get_optimizer:169 - Skip weight decay list: {'pos_embed', 'cls_token'}
2026-01-24 15:06:34.955 | INFO     | projects.eval_tools.finetuning_mae_exp:set_current_state:207 - Load pretrained checkpoints from /home/backup/lh/KD/projects/mae_lite/checkpoints/HiFuse_ImageNet1K.pth.
2026-01-24 15:06:35.351 | INFO     | projects.eval_tools.finetuning_mae_exp:set_current_state:209 - Model params ['model.meta_tokenlize.proj.weight', 'model.meta_tokenlize.proj.bias', 'model.head.temperature', 'model.head.log_sigma_ce', 'model.head.log_sigma_proto', 'model.head.proj.0.weight', 'model.head.proj.0.bias', 'model.head.proj.1.weight', 'model.head.proj.1.bias', 'model.head.proto_manager.prototypes', 'model.head.proto_manager.protos_per_class', 'model.head.proto_manager.valid_mask', 'model.head.proto_manager.momentum_cache', 'model.head.proto_manager.cache_count', 'model.head.mixed_attn.cross_attn.in_proj_weight', 'model.head.mixed_attn.cross_attn.in_proj_bias', 'model.head.mixed_attn.cross_attn.out_proj.weight', 'model.head.mixed_attn.cross_attn.out_proj.bias', 'model.head.mixed_attn.self_attn.in_proj_weight', 'model.head.mixed_attn.self_attn.in_proj_bias', 'model.head.mixed_attn.self_attn.out_proj.weight', 'model.head.mixed_attn.self_attn.out_proj.bias', 'model.head.mixed_attn.local_self_attn.in_proj_weight', 'model.head.mixed_attn.local_self_attn.in_proj_bias', 'model.head.mixed_attn.local_self_attn.out_proj.weight', 'model.head.mixed_attn.local_self_attn.out_proj.bias', 'model.head.mixed_attn.norm1.weight', 'model.head.mixed_attn.norm1.bias', 'model.head.mixed_attn.norm2.weight', 'model.head.mixed_attn.norm2.bias', 'model.head.mixed_attn.norm3.weight', 'model.head.mixed_attn.norm3.bias', 'model.head.mixed_attn.gate.0.weight', 'model.head.mixed_attn.gate.0.bias', 'model.head.mixed_attn.gate.1.weight', 'model.head.mixed_attn.gate.1.bias', 'model.head.ffn.0.weight', 'model.head.ffn.0.bias', 'model.head.ffn.3.weight', 'model.head.ffn.3.bias', 'model.head.ffn_norm.weight', 'model.head.ffn_norm.bias', 'model.fu1.att_conv.0.weight', 'model.fu1.att_conv.0.bias', 'model.fu1.norm1.weight', 'model.fu1.norm1.bias', 'model.fu1.norm2.weight', 'model.fu1.norm2.bias', 'model.fu2.att_conv.0.weight', 'model.fu2.att_conv.0.bias', 'model.fu2.norm1.weight', 'model.fu2.norm1.bias', 'model.fu2.norm2.weight', 'model.fu2.norm2.bias', 'model.fu3.att_conv.0.weight', 'model.fu3.att_conv.0.bias', 'model.fu3.norm1.weight', 'model.fu3.norm1.bias', 'model.fu3.norm2.weight', 'model.fu3.norm2.bias', 'model.fu4.att_conv.0.weight', 'model.fu4.att_conv.0.bias', 'model.fu4.norm1.weight', 'model.fu4.norm1.bias', 'model.fu4.norm2.weight', 'model.fu4.norm2.bias'] are not loaded
2026-01-24 15:06:35.351 | INFO     | projects.eval_tools.finetuning_mae_exp:set_current_state:210 - State-dict params ['model.fu1.W3.conv.weight', 'model.fu1.W3.conv.bias', 'model.fu1.W3.bn.weight', 'model.fu1.W3.bn.bias', 'model.fu1.W3.bn.running_mean', 'model.fu1.W3.bn.running_var', 'model.fu1.W3.bn.num_batches_tracked', 'model.fu2.W3.conv.weight', 'model.fu2.W3.conv.bias', 'model.fu2.W3.bn.weight', 'model.fu2.W3.bn.bias', 'model.fu2.W3.bn.running_mean', 'model.fu2.W3.bn.running_var', 'model.fu2.W3.bn.num_batches_tracked', 'model.fu3.W3.conv.weight', 'model.fu3.W3.conv.bias', 'model.fu3.W3.bn.weight', 'model.fu3.W3.bn.bias', 'model.fu3.W3.bn.running_mean', 'model.fu3.W3.bn.running_var', 'model.fu3.W3.bn.num_batches_tracked', 'model.fu4.W3.conv.weight', 'model.fu4.W3.conv.bias', 'model.fu4.W3.bn.weight', 'model.fu4.W3.bn.bias', 'model.fu4.W3.bn.running_mean', 'model.fu4.W3.bn.running_var', 'model.fu4.W3.bn.num_batches_tracked'] are not used
2026-01-24 15:06:35.352 | INFO     | __main__:main_worker:312 - Training start...
2026-01-24 15:06:43.024 | INFO     | __main__:main_worker:320 - ---> start train epoch1
2026-01-24 15:07:05.028 | INFO     | __main__:main_worker:382 - [1/100], remain:0d.03h.12m, It:[10/54], Max-Mem:12325M, Data-Time:0.020, LR:0.0000, Train_Loss:1.4004, total_loss:tensor([1.4004], device='cuda:0')
2026-01-24 15:07:08.657 | INFO     | __main__:main_worker:382 - [1/100], remain:0d.01h.51m, It:[20/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0000, Train_Loss:1.2468, total_loss:tensor([1.2468], device='cuda:0')
2026-01-24 15:07:13.518 | INFO     | __main__:main_worker:382 - [1/100], remain:0d.01h.28m, It:[30/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:1.2014, total_loss:tensor([1.2014], device='cuda:0')
2026-01-24 15:07:22.219 | INFO     | __main__:main_worker:382 - [1/100], remain:0d.01h.25m, It:[40/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0001, Train_Loss:1.1534, total_loss:tensor([1.1534], device='cuda:0')
2026-01-24 15:07:30.171 | INFO     | __main__:main_worker:382 - [1/100], remain:0d.01h.22m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:1.1372, total_loss:tensor([1.1372], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:12<00:00,  1.19it/s]
acc1: 63.2479, acc3: 100.0000, Precision: 0.8775, Recall: 0.3333, F1-Score: 0.2583, Specificity: 0.6667
2026-01-24 15:07:44.108 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [1/100], Top1:63.248, Top3:100.000, Test_precision:0.8775,Test_recall:0.3333,Test_f1:0.2583,,Test_specificity:0.6667 Test_loss:0.987064
2026-01-24 15:07:44.110 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:07:56.632 | INFO     | __main__:main_worker:320 - ---> start train epoch2
2026-01-24 15:08:06.706 | INFO     | __main__:main_worker:382 - [2/100], remain:0d.00h.40m, It:[10/54], Max-Mem:12325M, Data-Time:1.209, LR:0.0001, Train_Loss:1.1416, total_loss:tensor([1.1416], device='cuda:0')
2026-01-24 15:08:11.313 | INFO     | __main__:main_worker:382 - [2/100], remain:0d.00h.40m, It:[20/54], Max-Mem:12325M, Data-Time:1.070, LR:0.0001, Train_Loss:1.1196, total_loss:tensor([1.1196], device='cuda:0')
2026-01-24 15:08:15.774 | INFO     | __main__:main_worker:382 - [2/100], remain:0d.00h.39m, It:[30/54], Max-Mem:12325M, Data-Time:0.965, LR:0.0001, Train_Loss:1.0714, total_loss:tensor([1.0714], device='cuda:0')
2026-01-24 15:08:20.107 | INFO     | __main__:main_worker:382 - [2/100], remain:0d.00h.38m, It:[40/54], Max-Mem:12325M, Data-Time:0.847, LR:0.0001, Train_Loss:1.0112, total_loss:tensor([1.0112], device='cuda:0')
2026-01-24 15:08:23.887 | INFO     | __main__:main_worker:382 - [2/100], remain:0d.00h.37m, It:[50/54], Max-Mem:12325M, Data-Time:0.297, LR:0.0001, Train_Loss:1.0454, total_loss:tensor([1.0454], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
2026-01-24 15:08:33.610 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [2/100], Top1:63.248, Top3:100.000, Test_precision:0.8775,Test_recall:0.3333,Test_f1:0.2583,,Test_specificity:0.6667 Test_loss:0.874343
2026-01-24 15:08:33.612 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:08:33.612 | INFO     | __main__:main_worker:320 - ---> start train epoch3
acc1: 63.2479, acc3: 100.0000, Precision: 0.8775, Recall: 0.3333, F1-Score: 0.2583, Specificity: 0.6667
2026-01-24 15:08:42.871 | INFO     | __main__:main_worker:382 - [3/100], remain:0d.00h.43m, It:[10/54], Max-Mem:12325M, Data-Time:0.291, LR:0.0001, Train_Loss:1.1335, total_loss:tensor([1.1335], device='cuda:0')
2026-01-24 15:08:48.139 | INFO     | __main__:main_worker:382 - [3/100], remain:0d.00h.44m, It:[20/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:1.1828, total_loss:tensor([1.1828], device='cuda:0')
2026-01-24 15:08:52.142 | INFO     | __main__:main_worker:382 - [3/100], remain:0d.00h.40m, It:[30/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.9959, total_loss:tensor([0.9959], device='cuda:0')
2026-01-24 15:08:56.329 | INFO     | __main__:main_worker:382 - [3/100], remain:0d.00h.39m, It:[40/54], Max-Mem:12325M, Data-Time:0.405, LR:0.0001, Train_Loss:1.1303, total_loss:tensor([1.1303], device='cuda:0')
2026-01-24 15:09:00.757 | INFO     | __main__:main_worker:382 - [3/100], remain:0d.00h.38m, It:[50/54], Max-Mem:12325M, Data-Time:0.098, LR:0.0001, Train_Loss:1.0082, total_loss:tensor([1.0082], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:09:11.865 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [3/100], Top1:63.248, Top3:100.000, Test_precision:0.8775,Test_recall:0.3333,Test_f1:0.2583,,Test_specificity:0.6667 Test_loss:0.857044
acc1: 63.2479, acc3: 100.0000, Precision: 0.8775, Recall: 0.3333, F1-Score: 0.2583, Specificity: 0.6667
2026-01-24 15:09:11.868 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:09:11.868 | INFO     | __main__:main_worker:320 - ---> start train epoch4
2026-01-24 15:09:21.723 | INFO     | __main__:main_worker:382 - [4/100], remain:0d.00h.41m, It:[10/54], Max-Mem:12325M, Data-Time:1.409, LR:0.0001, Train_Loss:1.0995, total_loss:tensor([1.0995], device='cuda:0')
2026-01-24 15:09:26.239 | INFO     | __main__:main_worker:382 - [4/100], remain:0d.00h.39m, It:[20/54], Max-Mem:12325M, Data-Time:1.031, LR:0.0001, Train_Loss:0.9082, total_loss:tensor([0.9082], device='cuda:0')
2026-01-24 15:09:30.896 | INFO     | __main__:main_worker:382 - [4/100], remain:0d.00h.39m, It:[30/54], Max-Mem:12325M, Data-Time:1.127, LR:0.0001, Train_Loss:1.1500, total_loss:tensor([1.1500], device='cuda:0')
2026-01-24 15:09:35.040 | INFO     | __main__:main_worker:382 - [4/100], remain:0d.00h.38m, It:[40/54], Max-Mem:12325M, Data-Time:0.629, LR:0.0001, Train_Loss:0.9762, total_loss:tensor([0.9762], device='cuda:0')
2026-01-24 15:09:39.170 | INFO     | __main__:main_worker:382 - [4/100], remain:0d.00h.37m, It:[50/54], Max-Mem:12325M, Data-Time:0.587, LR:0.0001, Train_Loss:0.8499, total_loss:tensor([0.8499], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
acc1: 63.2479, acc3: 100.0000, Precision: 0.8775, Recall: 0.3333, F1-Score: 0.2583, Specificity: 0.6667
2026-01-24 15:09:48.833 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [4/100], Top1:63.248, Top3:100.000, Test_precision:0.8775,Test_recall:0.3333,Test_f1:0.2583,,Test_specificity:0.6667 Test_loss:0.863190
2026-01-24 15:09:48.835 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:09:48.835 | INFO     | __main__:main_worker:320 - ---> start train epoch5
2026-01-24 15:09:59.466 | INFO     | __main__:main_worker:382 - [5/100], remain:0d.00h.40m, It:[10/54], Max-Mem:12325M, Data-Time:1.348, LR:0.0001, Train_Loss:0.9490, total_loss:tensor([0.9490], device='cuda:0')
2026-01-24 15:10:03.165 | INFO     | __main__:main_worker:382 - [5/100], remain:0d.00h.35m, It:[20/54], Max-Mem:12325M, Data-Time:0.097, LR:0.0001, Train_Loss:1.0582, total_loss:tensor([1.0582], device='cuda:0')
2026-01-24 15:10:07.166 | INFO     | __main__:main_worker:382 - [5/100], remain:0d.00h.34m, It:[30/54], Max-Mem:12325M, Data-Time:0.046, LR:0.0001, Train_Loss:0.8870, total_loss:tensor([0.8870], device='cuda:0')
2026-01-24 15:10:12.756 | INFO     | __main__:main_worker:382 - [5/100], remain:0d.00h.37m, It:[40/54], Max-Mem:12325M, Data-Time:0.042, LR:0.0001, Train_Loss:0.9279, total_loss:tensor([0.9279], device='cuda:0')
2026-01-24 15:10:16.908 | INFO     | __main__:main_worker:382 - [5/100], remain:0d.00h.36m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.9611, total_loss:tensor([0.9611], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
acc1: 63.2479, acc3: 100.0000, Precision: 0.8775, Recall: 0.3333, F1-Score: 0.2583, Specificity: 0.6667
2026-01-24 15:10:27.726 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [5/100], Top1:63.248, Top3:100.000, Test_precision:0.8775,Test_recall:0.3333,Test_f1:0.2583,,Test_specificity:0.6667 Test_loss:0.866326
2026-01-24 15:10:27.727 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:10:27.728 | INFO     | __main__:main_worker:320 - ---> start train epoch6
2026-01-24 15:10:37.189 | INFO     | __main__:main_worker:382 - [6/100], remain:0d.00h.43m, It:[10/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:0.9123, total_loss:tensor([0.9123], device='cuda:0')
2026-01-24 15:10:42.357 | INFO     | __main__:main_worker:382 - [6/100], remain:0d.00h.43m, It:[20/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:0.9342, total_loss:tensor([0.9342], device='cuda:0')
2026-01-24 15:10:46.719 | INFO     | __main__:main_worker:382 - [6/100], remain:0d.00h.40m, It:[30/54], Max-Mem:12325M, Data-Time:0.772, LR:0.0001, Train_Loss:0.9622, total_loss:tensor([0.9622], device='cuda:0')
2026-01-24 15:10:50.729 | INFO     | __main__:main_worker:382 - [6/100], remain:0d.00h.38m, It:[40/54], Max-Mem:12325M, Data-Time:0.398, LR:0.0001, Train_Loss:0.8809, total_loss:tensor([0.8809], device='cuda:0')
2026-01-24 15:10:55.536 | INFO     | __main__:main_worker:382 - [6/100], remain:0d.00h.38m, It:[50/54], Max-Mem:12325M, Data-Time:0.231, LR:0.0001, Train_Loss:0.9173, total_loss:tensor([0.9173], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
2026-01-24 15:11:06.180 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [6/100], Top1:63.248, Top3:100.000, Test_precision:0.8775,Test_recall:0.3333,Test_f1:0.2583,,Test_specificity:0.6667 Test_loss:0.860120
acc1: 63.2479, acc3: 100.0000, Precision: 0.8775, Recall: 0.3333, F1-Score: 0.2583, Specificity: 0.6667
2026-01-24 15:11:06.182 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:11:06.182 | INFO     | __main__:main_worker:320 - ---> start train epoch7
2026-01-24 15:11:15.350 | INFO     | __main__:main_worker:382 - [7/100], remain:0d.00h.44m, It:[10/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.8096, total_loss:tensor([0.8096], device='cuda:0')
2026-01-24 15:11:19.947 | INFO     | __main__:main_worker:382 - [7/100], remain:0d.00h.40m, It:[20/54], Max-Mem:12325M, Data-Time:0.443, LR:0.0001, Train_Loss:0.9300, total_loss:tensor([0.9300], device='cuda:0')
2026-01-24 15:11:24.016 | INFO     | __main__:main_worker:382 - [7/100], remain:0d.00h.38m, It:[30/54], Max-Mem:12325M, Data-Time:0.016, LR:0.0001, Train_Loss:0.8464, total_loss:tensor([0.8464], device='cuda:0')
2026-01-24 15:11:28.396 | INFO     | __main__:main_worker:382 - [7/100], remain:0d.00h.37m, It:[40/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.9629, total_loss:tensor([0.9629], device='cuda:0')
2026-01-24 15:11:33.893 | INFO     | __main__:main_worker:382 - [7/100], remain:0d.00h.38m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.9642, total_loss:tensor([0.9642], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
acc1: 63.2479, acc3: 100.0000, Precision: 0.8775, Recall: 0.3333, F1-Score: 0.2583, Specificity: 0.6667
2026-01-24 15:11:44.064 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [7/100], Top1:63.248, Top3:100.000, Test_precision:0.8775,Test_recall:0.3333,Test_f1:0.2583,,Test_specificity:0.6667 Test_loss:0.816691
2026-01-24 15:11:44.065 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:11:44.066 | INFO     | __main__:main_worker:320 - ---> start train epoch8
2026-01-24 15:11:53.631 | INFO     | __main__:main_worker:382 - [8/100], remain:0d.00h.41m, It:[10/54], Max-Mem:12325M, Data-Time:1.478, LR:0.0001, Train_Loss:0.9283, total_loss:tensor([0.9283], device='cuda:0')
2026-01-24 15:11:58.204 | INFO     | __main__:main_worker:382 - [8/100], remain:0d.00h.39m, It:[20/54], Max-Mem:12325M, Data-Time:1.069, LR:0.0001, Train_Loss:1.0201, total_loss:tensor([1.0201], device='cuda:0')
2026-01-24 15:12:02.368 | INFO     | __main__:main_worker:382 - [8/100], remain:0d.00h.37m, It:[30/54], Max-Mem:12325M, Data-Time:0.623, LR:0.0001, Train_Loss:0.8822, total_loss:tensor([0.8822], device='cuda:0')
2026-01-24 15:12:06.254 | INFO     | __main__:main_worker:382 - [8/100], remain:0d.00h.35m, It:[40/54], Max-Mem:12325M, Data-Time:0.354, LR:0.0001, Train_Loss:1.0294, total_loss:tensor([1.0294], device='cuda:0')
2026-01-24 15:12:10.632 | INFO     | __main__:main_worker:382 - [8/100], remain:0d.00h.35m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.8740, total_loss:tensor([0.8740], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:12:21.193 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [8/100], Top1:63.248, Top3:100.000, Test_precision:0.8775,Test_recall:0.3333,Test_f1:0.2583,,Test_specificity:0.6667 Test_loss:0.806635
acc1: 63.2479, acc3: 100.0000, Precision: 0.8775, Recall: 0.3333, F1-Score: 0.2583, Specificity: 0.6667
2026-01-24 15:12:21.195 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:12:21.195 | INFO     | __main__:main_worker:320 - ---> start train epoch9
2026-01-24 15:12:31.505 | INFO     | __main__:main_worker:382 - [9/100], remain:0d.00h.40m, It:[10/54], Max-Mem:12325M, Data-Time:1.526, LR:0.0001, Train_Loss:1.0096, total_loss:tensor([1.0096], device='cuda:0')
2026-01-24 15:12:36.239 | INFO     | __main__:main_worker:382 - [9/100], remain:0d.00h.39m, It:[20/54], Max-Mem:12325M, Data-Time:1.195, LR:0.0001, Train_Loss:0.9983, total_loss:tensor([0.9983], device='cuda:0')
2026-01-24 15:12:40.208 | INFO     | __main__:main_worker:382 - [9/100], remain:0d.00h.36m, It:[30/54], Max-Mem:12325M, Data-Time:0.454, LR:0.0001, Train_Loss:0.9456, total_loss:tensor([0.9456], device='cuda:0')
2026-01-24 15:12:44.418 | INFO     | __main__:main_worker:382 - [9/100], remain:0d.00h.35m, It:[40/54], Max-Mem:12325M, Data-Time:0.017, LR:0.0001, Train_Loss:0.9845, total_loss:tensor([0.9845], device='cuda:0')
2026-01-24 15:12:49.745 | INFO     | __main__:main_worker:382 - [9/100], remain:0d.00h.37m, It:[50/54], Max-Mem:12325M, Data-Time:0.017, LR:0.0001, Train_Loss:1.0001, total_loss:tensor([1.0001], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
2026-01-24 15:12:59.721 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [9/100], Top1:63.248, Top3:100.000, Test_precision:0.8775,Test_recall:0.3333,Test_f1:0.2583,,Test_specificity:0.6667 Test_loss:0.778561
acc1: 63.2479, acc3: 100.0000, Precision: 0.8775, Recall: 0.3333, F1-Score: 0.2583, Specificity: 0.6667
2026-01-24 15:12:59.722 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:12:59.723 | INFO     | __main__:main_worker:320 - ---> start train epoch10
2026-01-24 15:13:11.177 | INFO     | __main__:main_worker:382 - [10/100], remain:0d.00h.48m, It:[10/54], Max-Mem:12325M, Data-Time:2.521, LR:0.0001, Train_Loss:0.8299, total_loss:tensor([0.8299], device='cuda:0')
2026-01-24 15:13:15.267 | INFO     | __main__:main_worker:382 - [10/100], remain:0d.00h.40m, It:[20/54], Max-Mem:12325M, Data-Time:0.554, LR:0.0001, Train_Loss:0.7678, total_loss:tensor([0.7678], device='cuda:0')
2026-01-24 15:13:19.232 | INFO     | __main__:main_worker:382 - [10/100], remain:0d.00h.37m, It:[30/54], Max-Mem:12325M, Data-Time:0.392, LR:0.0001, Train_Loss:0.6837, total_loss:tensor([0.6837], device='cuda:0')
2026-01-24 15:13:23.336 | INFO     | __main__:main_worker:382 - [10/100], remain:0d.00h.35m, It:[40/54], Max-Mem:12325M, Data-Time:0.559, LR:0.0001, Train_Loss:0.8586, total_loss:tensor([0.8586], device='cuda:0')
2026-01-24 15:13:27.399 | INFO     | __main__:main_worker:382 - [10/100], remain:0d.00h.35m, It:[50/54], Max-Mem:12325M, Data-Time:0.230, LR:0.0001, Train_Loss:1.1515, total_loss:tensor([1.1515], device='cuda:0')
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-24 15:13:29.124 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 10
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 27.6518
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 27.5389
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 27.6248
Local prototype push completed!
2026-01-24 15:13:55.575 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
acc1: 63.2479, acc3: 100.0000, Precision: 0.7110, Recall: 0.3347, F1-Score: 0.2630, Specificity: 0.6676
2026-01-24 15:14:03.809 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [10/100], Top1:63.248, Top3:100.000, Test_precision:0.7110,Test_recall:0.3347,Test_f1:0.2630,,Test_specificity:0.6676 Test_loss:0.750535
2026-01-24 15:14:03.811 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [1/100], Top1:63.248, Top-3:100.000
2026-01-24 15:14:10.472 | INFO     | __main__:main_worker:320 - ---> start train epoch11
2026-01-24 15:14:19.804 | INFO     | __main__:main_worker:382 - [11/100], remain:0d.00h.32m, It:[10/54], Max-Mem:12325M, Data-Time:0.674, LR:0.0001, Train_Loss:0.8659, total_loss:tensor([0.8659], device='cuda:0')
2026-01-24 15:14:23.777 | INFO     | __main__:main_worker:382 - [11/100], remain:0d.00h.31m, It:[20/54], Max-Mem:12325M, Data-Time:0.424, LR:0.0001, Train_Loss:0.8023, total_loss:tensor([0.8023], device='cuda:0')
2026-01-24 15:14:28.065 | INFO     | __main__:main_worker:382 - [11/100], remain:0d.00h.32m, It:[30/54], Max-Mem:12325M, Data-Time:0.017, LR:0.0001, Train_Loss:0.8280, total_loss:tensor([0.8280], device='cuda:0')
2026-01-24 15:14:32.985 | INFO     | __main__:main_worker:382 - [11/100], remain:0d.00h.33m, It:[40/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.7810, total_loss:tensor([0.7810], device='cuda:0')
2026-01-24 15:14:37.751 | INFO     | __main__:main_worker:382 - [11/100], remain:0d.00h.34m, It:[50/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0001, Train_Loss:0.7717, total_loss:tensor([0.7717], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2026-01-24 15:14:47.874 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [11/100], Top1:64.103, Top3:100.000, Test_precision:0.8131,Test_recall:0.3434,Test_f1:0.2793,,Test_specificity:0.6754 Test_loss:0.728830
acc1: 64.1026, acc3: 100.0000, Precision: 0.8131, Recall: 0.3434, F1-Score: 0.2793, Specificity: 0.6754
2026-01-24 15:14:47.875 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [11/100], Top1:64.103, Top-3:100.000
2026-01-24 15:15:00.673 | INFO     | __main__:main_worker:320 - ---> start train epoch12
2026-01-24 15:15:12.379 | INFO     | __main__:main_worker:382 - [12/100], remain:0d.00h.42m, It:[10/54], Max-Mem:12325M, Data-Time:1.900, LR:0.0001, Train_Loss:0.9029, total_loss:tensor([0.9029], device='cuda:0')
2026-01-24 15:15:16.400 | INFO     | __main__:main_worker:382 - [12/100], remain:0d.00h.36m, It:[20/54], Max-Mem:12325M, Data-Time:0.498, LR:0.0001, Train_Loss:0.9166, total_loss:tensor([0.9166], device='cuda:0')
2026-01-24 15:15:20.733 | INFO     | __main__:main_worker:382 - [12/100], remain:0d.00h.35m, It:[30/54], Max-Mem:12325M, Data-Time:0.790, LR:0.0001, Train_Loss:0.6353, total_loss:tensor([0.6353], device='cuda:0')
2026-01-24 15:15:24.937 | INFO     | __main__:main_worker:382 - [12/100], remain:0d.00h.34m, It:[40/54], Max-Mem:12325M, Data-Time:0.740, LR:0.0001, Train_Loss:0.9060, total_loss:tensor([0.9060], device='cuda:0')
2026-01-24 15:15:29.072 | INFO     | __main__:main_worker:382 - [12/100], remain:0d.00h.33m, It:[50/54], Max-Mem:12325M, Data-Time:0.602, LR:0.0001, Train_Loss:0.9625, total_loss:tensor([0.9625], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
acc1: 73.5043, acc3: 100.0000, Precision: 0.8199, Recall: 0.5530, F1-Score: 0.5002, Specificity: 0.8615
2026-01-24 15:15:38.574 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [12/100], Top1:73.504, Top3:100.000, Test_precision:0.8199,Test_recall:0.5530,Test_f1:0.5002,,Test_specificity:0.8615 Test_loss:0.641131
2026-01-24 15:15:38.575 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [12/100], Top1:73.504, Top-3:100.000
2026-01-24 15:15:51.289 | INFO     | __main__:main_worker:320 - ---> start train epoch13
2026-01-24 15:16:03.541 | INFO     | __main__:main_worker:382 - [13/100], remain:0d.00h.53m, It:[10/54], Max-Mem:12325M, Data-Time:3.322, LR:0.0001, Train_Loss:1.0680, total_loss:tensor([1.0680], device='cuda:0')
2026-01-24 15:16:07.968 | INFO     | __main__:main_worker:382 - [13/100], remain:0d.00h.43m, It:[20/54], Max-Mem:12325M, Data-Time:0.715, LR:0.0001, Train_Loss:0.8231, total_loss:tensor([0.8231], device='cuda:0')
2026-01-24 15:16:12.683 | INFO     | __main__:main_worker:382 - [13/100], remain:0d.00h.40m, It:[30/54], Max-Mem:12325M, Data-Time:1.168, LR:0.0001, Train_Loss:0.8381, total_loss:tensor([0.8381], device='cuda:0')
2026-01-24 15:16:18.304 | INFO     | __main__:main_worker:382 - [13/100], remain:0d.00h.41m, It:[40/54], Max-Mem:12325M, Data-Time:2.084, LR:0.0001, Train_Loss:0.9256, total_loss:tensor([0.9256], device='cuda:0')
2026-01-24 15:16:22.377 | INFO     | __main__:main_worker:382 - [13/100], remain:0d.00h.39m, It:[50/54], Max-Mem:12325M, Data-Time:0.556, LR:0.0001, Train_Loss:0.7166, total_loss:tensor([0.7166], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
2026-01-24 15:16:32.037 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [13/100], Top1:63.462, Top3:100.000, Test_precision:0.7208,Test_recall:0.4255,Test_f1:0.4050,,Test_specificity:0.7591 Test_loss:0.634480
acc1: 63.4615, acc3: 100.0000, Precision: 0.7208, Recall: 0.4255, F1-Score: 0.4050, Specificity: 0.7591
2026-01-24 15:16:32.039 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [12/100], Top1:73.504, Top-3:100.000
2026-01-24 15:16:32.039 | INFO     | __main__:main_worker:320 - ---> start train epoch14
2026-01-24 15:16:41.564 | INFO     | __main__:main_worker:382 - [14/100], remain:0d.00h.43m, It:[10/54], Max-Mem:12325M, Data-Time:1.350, LR:0.0001, Train_Loss:0.8324, total_loss:tensor([0.8324], device='cuda:0')
2026-01-24 15:16:46.322 | INFO     | __main__:main_worker:382 - [14/100], remain:0d.00h.39m, It:[20/54], Max-Mem:12325M, Data-Time:0.553, LR:0.0001, Train_Loss:0.6586, total_loss:tensor([0.6586], device='cuda:0')
2026-01-24 15:16:51.904 | INFO     | __main__:main_worker:382 - [14/100], remain:0d.00h.40m, It:[30/54], Max-Mem:12325M, Data-Time:2.067, LR:0.0001, Train_Loss:0.8675, total_loss:tensor([0.8675], device='cuda:0')
2026-01-24 15:16:56.859 | INFO     | __main__:main_worker:382 - [14/100], remain:0d.00h.39m, It:[40/54], Max-Mem:12325M, Data-Time:1.427, LR:0.0001, Train_Loss:0.7397, total_loss:tensor([0.7397], device='cuda:0')
2026-01-24 15:17:00.682 | INFO     | __main__:main_worker:382 - [14/100], remain:0d.00h.37m, It:[50/54], Max-Mem:12325M, Data-Time:0.332, LR:0.0001, Train_Loss:0.7705, total_loss:tensor([0.7705], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
acc1: 60.0427, acc3: 100.0000, Precision: 0.5976, Recall: 0.3233, F1-Score: 0.2713, Specificity: 0.6621
2026-01-24 15:17:10.398 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [14/100], Top1:60.043, Top3:100.000, Test_precision:0.5976,Test_recall:0.3233,Test_f1:0.2713,,Test_specificity:0.6621 Test_loss:0.708484
2026-01-24 15:17:10.400 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [12/100], Top1:73.504, Top-3:100.000
2026-01-24 15:17:10.400 | INFO     | __main__:main_worker:320 - ---> start train epoch15
2026-01-24 15:17:20.130 | INFO     | __main__:main_worker:382 - [15/100], remain:0d.00h.41m, It:[10/54], Max-Mem:12325M, Data-Time:1.157, LR:0.0001, Train_Loss:0.8574, total_loss:tensor([0.8574], device='cuda:0')
2026-01-24 15:17:23.788 | INFO     | __main__:main_worker:382 - [15/100], remain:0d.00h.34m, It:[20/54], Max-Mem:12325M, Data-Time:0.016, LR:0.0001, Train_Loss:0.6476, total_loss:tensor([0.6476], device='cuda:0')
2026-01-24 15:17:27.889 | INFO     | __main__:main_worker:382 - [15/100], remain:0d.00h.32m, It:[30/54], Max-Mem:12325M, Data-Time:0.597, LR:0.0001, Train_Loss:0.9658, total_loss:tensor([0.9658], device='cuda:0')
2026-01-24 15:17:32.570 | INFO     | __main__:main_worker:382 - [15/100], remain:0d.00h.33m, It:[40/54], Max-Mem:12325M, Data-Time:0.396, LR:0.0001, Train_Loss:0.6490, total_loss:tensor([0.6490], device='cuda:0')
2026-01-24 15:17:36.926 | INFO     | __main__:main_worker:382 - [15/100], remain:0d.00h.33m, It:[50/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.6951, total_loss:tensor([0.6951], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
2026-01-24 15:17:46.806 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [15/100], Top1:77.778, Top3:100.000, Test_precision:0.8414,Test_recall:0.5327,Test_f1:0.5182,,Test_specificity:0.8296 Test_loss:0.585357
acc1: 77.7778, acc3: 100.0000, Precision: 0.8414, Recall: 0.5327, F1-Score: 0.5182, Specificity: 0.8296
2026-01-24 15:17:46.808 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [15/100], Top1:77.778, Top-3:100.000
2026-01-24 15:17:59.541 | INFO     | __main__:main_worker:320 - ---> start train epoch16
2026-01-24 15:18:08.309 | INFO     | __main__:main_worker:382 - [16/100], remain:0d.00h.31m, It:[10/54], Max-Mem:12325M, Data-Time:0.403, LR:0.0001, Train_Loss:0.7441, total_loss:tensor([0.7441], device='cuda:0')
2026-01-24 15:18:12.739 | INFO     | __main__:main_worker:382 - [16/100], remain:0d.00h.32m, It:[20/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0001, Train_Loss:0.7423, total_loss:tensor([0.7423], device='cuda:0')
2026-01-24 15:18:17.184 | INFO     | __main__:main_worker:382 - [16/100], remain:0d.00h.32m, It:[30/54], Max-Mem:12325M, Data-Time:0.479, LR:0.0001, Train_Loss:0.7187, total_loss:tensor([0.7187], device='cuda:0')
2026-01-24 15:18:22.337 | INFO     | __main__:main_worker:382 - [16/100], remain:0d.00h.33m, It:[40/54], Max-Mem:12325M, Data-Time:0.555, LR:0.0001, Train_Loss:1.0201, total_loss:tensor([1.0201], device='cuda:0')
2026-01-24 15:18:27.515 | INFO     | __main__:main_worker:382 - [16/100], remain:0d.00h.34m, It:[50/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:0.8932, total_loss:tensor([0.8932], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:18:37.819 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [16/100], Top1:78.846, Top3:100.000, Test_precision:0.8438,Test_recall:0.5508,Test_f1:0.5297,,Test_specificity:0.8459 Test_loss:0.584243
acc1: 78.8462, acc3: 100.0000, Precision: 0.8438, Recall: 0.5508, F1-Score: 0.5297, Specificity: 0.8459
2026-01-24 15:18:37.820 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [16/100], Top1:78.846, Top-3:100.000
2026-01-24 15:18:50.462 | INFO     | __main__:main_worker:320 - ---> start train epoch17
2026-01-24 15:18:59.157 | INFO     | __main__:main_worker:382 - [17/100], remain:0d.00h.32m, It:[10/54], Max-Mem:12325M, Data-Time:0.092, LR:0.0001, Train_Loss:0.7892, total_loss:tensor([0.7892], device='cuda:0')
2026-01-24 15:19:04.496 | INFO     | __main__:main_worker:382 - [17/100], remain:0d.00h.35m, It:[20/54], Max-Mem:12325M, Data-Time:0.020, LR:0.0001, Train_Loss:0.9984, total_loss:tensor([0.9984], device='cuda:0')
2026-01-24 15:19:09.199 | INFO     | __main__:main_worker:382 - [17/100], remain:0d.00h.35m, It:[30/54], Max-Mem:12325M, Data-Time:0.017, LR:0.0001, Train_Loss:0.5754, total_loss:tensor([0.5754], device='cuda:0')
2026-01-24 15:19:13.269 | INFO     | __main__:main_worker:382 - [17/100], remain:0d.00h.33m, It:[40/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.6322, total_loss:tensor([0.6322], device='cuda:0')
2026-01-24 15:19:18.599 | INFO     | __main__:main_worker:382 - [17/100], remain:0d.00h.34m, It:[50/54], Max-Mem:12325M, Data-Time:0.845, LR:0.0001, Train_Loss:0.6336, total_loss:tensor([0.6336], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
2026-01-24 15:19:28.125 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [17/100], Top1:76.496, Top3:100.000, Test_precision:0.8248,Test_recall:0.5550,Test_f1:0.5185,,Test_specificity:0.8491 Test_loss:0.581908
acc1: 76.4957, acc3: 100.0000, Precision: 0.8248, Recall: 0.5550, F1-Score: 0.5185, Specificity: 0.8491
2026-01-24 15:19:28.126 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [16/100], Top1:78.846, Top-3:100.000
2026-01-24 15:19:28.127 | INFO     | __main__:main_worker:320 - ---> start train epoch18
2026-01-24 15:19:36.829 | INFO     | __main__:main_worker:382 - [18/100], remain:0d.00h.32m, It:[10/54], Max-Mem:12325M, Data-Time:0.388, LR:0.0001, Train_Loss:0.7492, total_loss:tensor([0.7492], device='cuda:0')
2026-01-24 15:19:41.168 | INFO     | __main__:main_worker:382 - [18/100], remain:0d.00h.31m, It:[20/54], Max-Mem:12325M, Data-Time:0.833, LR:0.0001, Train_Loss:0.8846, total_loss:tensor([0.8846], device='cuda:0')
2026-01-24 15:19:45.893 | INFO     | __main__:main_worker:382 - [18/100], remain:0d.00h.32m, It:[30/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:0.6967, total_loss:tensor([0.6967], device='cuda:0')
2026-01-24 15:19:50.390 | INFO     | __main__:main_worker:382 - [18/100], remain:0d.00h.32m, It:[40/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0001, Train_Loss:0.6927, total_loss:tensor([0.6927], device='cuda:0')
2026-01-24 15:19:55.184 | INFO     | __main__:main_worker:382 - [18/100], remain:0d.00h.32m, It:[50/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.4741, total_loss:tensor([0.4741], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:20:04.765 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [18/100], Top1:78.632, Top3:100.000, Test_precision:0.8377,Test_recall:0.5538,Test_f1:0.5278,,Test_specificity:0.8524 Test_loss:0.506435
acc1: 78.6325, acc3: 100.0000, Precision: 0.8377, Recall: 0.5538, F1-Score: 0.5278, Specificity: 0.8524
2026-01-24 15:20:04.766 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [16/100], Top1:78.846, Top-3:100.000
2026-01-24 15:20:04.766 | INFO     | __main__:main_worker:320 - ---> start train epoch19
2026-01-24 15:20:13.746 | INFO     | __main__:main_worker:382 - [19/100], remain:0d.00h.37m, It:[10/54], Max-Mem:12325M, Data-Time:0.834, LR:0.0001, Train_Loss:0.8534, total_loss:tensor([0.8534], device='cuda:0')
2026-01-24 15:20:17.481 | INFO     | __main__:main_worker:382 - [19/100], remain:0d.00h.31m, It:[20/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.7112, total_loss:tensor([0.7112], device='cuda:0')
2026-01-24 15:20:21.891 | INFO     | __main__:main_worker:382 - [19/100], remain:0d.00h.31m, It:[30/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.7390, total_loss:tensor([0.7390], device='cuda:0')
2026-01-24 15:20:26.688 | INFO     | __main__:main_worker:382 - [19/100], remain:0d.00h.32m, It:[40/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:0.6075, total_loss:tensor([0.6075], device='cuda:0')
2026-01-24 15:20:31.125 | INFO     | __main__:main_worker:382 - [19/100], remain:0d.00h.31m, It:[50/54], Max-Mem:12325M, Data-Time:0.281, LR:0.0001, Train_Loss:0.7078, total_loss:tensor([0.7078], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.85it/s]
2026-01-24 15:20:41.016 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [19/100], Top1:80.556, Top3:100.000, Test_precision:0.8541,Test_recall:0.5722,Test_f1:0.5452,,Test_specificity:0.8642 Test_loss:0.549562
acc1: 80.5556, acc3: 100.0000, Precision: 0.8541, Recall: 0.5722, F1-Score: 0.5452, Specificity: 0.8642
2026-01-24 15:20:41.018 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:20:54.038 | INFO     | __main__:main_worker:320 - ---> start train epoch20
2026-01-24 15:21:02.797 | INFO     | __main__:main_worker:382 - [20/100], remain:0d.00h.30m, It:[10/54], Max-Mem:12325M, Data-Time:0.413, LR:0.0001, Train_Loss:0.5159, total_loss:tensor([0.5159], device='cuda:0')
2026-01-24 15:21:07.514 | INFO     | __main__:main_worker:382 - [20/100], remain:0d.00h.31m, It:[20/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.6515, total_loss:tensor([0.6515], device='cuda:0')
2026-01-24 15:21:12.452 | INFO     | __main__:main_worker:382 - [20/100], remain:0d.00h.32m, It:[30/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0001, Train_Loss:0.5347, total_loss:tensor([0.5347], device='cuda:0')
2026-01-24 15:21:17.549 | INFO     | __main__:main_worker:382 - [20/100], remain:0d.00h.33m, It:[40/54], Max-Mem:12325M, Data-Time:0.021, LR:0.0001, Train_Loss:0.4704, total_loss:tensor([0.4704], device='cuda:0')
2026-01-24 15:21:22.639 | INFO     | __main__:main_worker:382 - [20/100], remain:0d.00h.33m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.5896, total_loss:tensor([0.5896], device='cuda:0')
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-24 15:21:24.817 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 20
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.8533
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.9232
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.8193
Local prototype push completed!
2026-01-24 15:21:49.695 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
acc1: 55.1282, acc3: 100.0000, Precision: 0.5688, Recall: 0.2974, F1-Score: 0.2592, Specificity: 0.6534
2026-01-24 15:21:58.082 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [20/100], Top1:55.128, Top3:100.000, Test_precision:0.5688,Test_recall:0.2974,Test_f1:0.2592,,Test_specificity:0.6534 Test_loss:0.758370
2026-01-24 15:21:58.084 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:22:04.669 | INFO     | __main__:main_worker:320 - ---> start train epoch21
2026-01-24 15:22:13.416 | INFO     | __main__:main_worker:382 - [21/100], remain:0d.00h.29m, It:[10/54], Max-Mem:12325M, Data-Time:0.774, LR:0.0001, Train_Loss:0.7276, total_loss:tensor([0.7276], device='cuda:0')
2026-01-24 15:22:18.322 | INFO     | __main__:main_worker:382 - [21/100], remain:0d.00h.31m, It:[20/54], Max-Mem:12325M, Data-Time:1.308, LR:0.0001, Train_Loss:0.7409, total_loss:tensor([0.7409], device='cuda:0')
2026-01-24 15:22:23.074 | INFO     | __main__:main_worker:382 - [21/100], remain:0d.00h.32m, It:[30/54], Max-Mem:12325M, Data-Time:1.207, LR:0.0001, Train_Loss:0.5491, total_loss:tensor([0.5491], device='cuda:0')
2026-01-24 15:22:27.500 | INFO     | __main__:main_worker:382 - [21/100], remain:0d.00h.31m, It:[40/54], Max-Mem:12325M, Data-Time:0.911, LR:0.0001, Train_Loss:0.8003, total_loss:tensor([0.8003], device='cuda:0')
2026-01-24 15:22:31.594 | INFO     | __main__:main_worker:382 - [21/100], remain:0d.00h.30m, It:[50/54], Max-Mem:12325M, Data-Time:0.574, LR:0.0001, Train_Loss:0.5362, total_loss:tensor([0.5362], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
2026-01-24 15:22:42.147 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [21/100], Top1:77.137, Top3:100.000, Test_precision:0.8312,Test_recall:0.5390,Test_f1:0.5176,,Test_specificity:0.8341 Test_loss:0.576387
2026-01-24 15:22:42.148 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:22:42.148 | INFO     | __main__:main_worker:320 - ---> start train epoch22
acc1: 77.1368, acc3: 100.0000, Precision: 0.8312, Recall: 0.5390, F1-Score: 0.5176, Specificity: 0.8341
2026-01-24 15:22:51.734 | INFO     | __main__:main_worker:382 - [22/100], remain:0d.00h.35m, It:[10/54], Max-Mem:12325M, Data-Time:1.576, LR:0.0001, Train_Loss:0.7028, total_loss:tensor([0.7028], device='cuda:0')
2026-01-24 15:22:55.392 | INFO     | __main__:main_worker:382 - [22/100], remain:0d.00h.30m, It:[20/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.6544, total_loss:tensor([0.6544], device='cuda:0')
2026-01-24 15:23:00.563 | INFO     | __main__:main_worker:382 - [22/100], remain:0d.00h.31m, It:[30/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0001, Train_Loss:0.6388, total_loss:tensor([0.6388], device='cuda:0')
2026-01-24 15:23:05.153 | INFO     | __main__:main_worker:382 - [22/100], remain:0d.00h.31m, It:[40/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0001, Train_Loss:0.6459, total_loss:tensor([0.6459], device='cuda:0')
2026-01-24 15:23:10.942 | INFO     | __main__:main_worker:382 - [22/100], remain:0d.00h.33m, It:[50/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0001, Train_Loss:0.5820, total_loss:tensor([0.5820], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
acc1: 74.7863, acc3: 100.0000, Precision: 0.8165, Recall: 0.5046, F1-Score: 0.4911, Specificity: 0.8072
2026-01-24 15:23:20.555 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [22/100], Top1:74.786, Top3:100.000, Test_precision:0.8165,Test_recall:0.5046,Test_f1:0.4911,,Test_specificity:0.8072 Test_loss:0.561548
2026-01-24 15:23:20.557 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:23:20.558 | INFO     | __main__:main_worker:320 - ---> start train epoch23
2026-01-24 15:23:30.298 | INFO     | __main__:main_worker:382 - [23/100], remain:0d.00h.33m, It:[10/54], Max-Mem:12325M, Data-Time:1.428, LR:0.0001, Train_Loss:1.0133, total_loss:tensor([1.0133], device='cuda:0')
2026-01-24 15:23:35.044 | INFO     | __main__:main_worker:382 - [23/100], remain:0d.00h.32m, It:[20/54], Max-Mem:12325M, Data-Time:1.218, LR:0.0001, Train_Loss:0.6830, total_loss:tensor([0.6830], device='cuda:0')
2026-01-24 15:23:39.935 | INFO     | __main__:main_worker:382 - [23/100], remain:0d.00h.32m, It:[30/54], Max-Mem:12325M, Data-Time:0.017, LR:0.0001, Train_Loss:0.5653, total_loss:tensor([0.5653], device='cuda:0')
2026-01-24 15:23:44.693 | INFO     | __main__:main_worker:382 - [23/100], remain:0d.00h.32m, It:[40/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.6322, total_loss:tensor([0.6322], device='cuda:0')
2026-01-24 15:23:49.771 | INFO     | __main__:main_worker:382 - [23/100], remain:0d.00h.32m, It:[50/54], Max-Mem:12325M, Data-Time:0.016, LR:0.0001, Train_Loss:0.6359, total_loss:tensor([0.6359], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
acc1: 66.6667, acc3: 100.0000, Precision: 0.7504, Recall: 0.4121, F1-Score: 0.3995, Specificity: 0.7297
2026-01-24 15:24:00.602 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [23/100], Top1:66.667, Top3:100.000, Test_precision:0.7504,Test_recall:0.4121,Test_f1:0.3995,,Test_specificity:0.7297 Test_loss:0.652046
2026-01-24 15:24:00.603 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:24:00.604 | INFO     | __main__:main_worker:320 - ---> start train epoch24
2026-01-24 15:24:10.294 | INFO     | __main__:main_worker:382 - [24/100], remain:0d.00h.27m, It:[10/54], Max-Mem:12325M, Data-Time:0.643, LR:0.0001, Train_Loss:0.5951, total_loss:tensor([0.5951], device='cuda:0')
2026-01-24 15:24:15.748 | INFO     | __main__:main_worker:382 - [24/100], remain:0d.00h.32m, It:[20/54], Max-Mem:12325M, Data-Time:1.908, LR:0.0001, Train_Loss:0.6695, total_loss:tensor([0.6695], device='cuda:0')
2026-01-24 15:24:20.531 | INFO     | __main__:main_worker:382 - [24/100], remain:0d.00h.32m, It:[30/54], Max-Mem:12325M, Data-Time:1.241, LR:0.0001, Train_Loss:0.5338, total_loss:tensor([0.5338], device='cuda:0')
2026-01-24 15:24:25.358 | INFO     | __main__:main_worker:382 - [24/100], remain:0d.00h.32m, It:[40/54], Max-Mem:12325M, Data-Time:1.317, LR:0.0001, Train_Loss:0.7208, total_loss:tensor([0.7208], device='cuda:0')
2026-01-24 15:24:29.290 | INFO     | __main__:main_worker:382 - [24/100], remain:0d.00h.30m, It:[50/54], Max-Mem:12325M, Data-Time:0.413, LR:0.0001, Train_Loss:0.4925, total_loss:tensor([0.4925], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
2026-01-24 15:24:38.928 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [24/100], Top1:74.786, Top3:100.000, Test_precision:0.8124,Test_recall:0.5128,Test_f1:0.4948,,Test_specificity:0.8147 Test_loss:0.613541
2026-01-24 15:24:38.929 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:24:38.930 | INFO     | __main__:main_worker:320 - ---> start train epoch25
acc1: 74.7863, acc3: 100.0000, Precision: 0.8124, Recall: 0.5128, F1-Score: 0.4948, Specificity: 0.8147
2026-01-24 15:24:48.570 | INFO     | __main__:main_worker:382 - [25/100], remain:0d.00h.36m, It:[10/54], Max-Mem:12325M, Data-Time:1.544, LR:0.0001, Train_Loss:0.4876, total_loss:tensor([0.4876], device='cuda:0')
2026-01-24 15:24:53.559 | INFO     | __main__:main_worker:382 - [25/100], remain:0d.00h.34m, It:[20/54], Max-Mem:12325M, Data-Time:1.491, LR:0.0001, Train_Loss:0.4777, total_loss:tensor([0.4777], device='cuda:0')
2026-01-24 15:24:58.209 | INFO     | __main__:main_worker:382 - [25/100], remain:0d.00h.33m, It:[30/54], Max-Mem:12325M, Data-Time:1.154, LR:0.0001, Train_Loss:0.4912, total_loss:tensor([0.4912], device='cuda:0')
2026-01-24 15:25:03.514 | INFO     | __main__:main_worker:382 - [25/100], remain:0d.00h.33m, It:[40/54], Max-Mem:12325M, Data-Time:1.791, LR:0.0001, Train_Loss:0.6845, total_loss:tensor([0.6845], device='cuda:0')
2026-01-24 15:25:07.793 | INFO     | __main__:main_worker:382 - [25/100], remain:0d.00h.32m, It:[50/54], Max-Mem:12325M, Data-Time:0.834, LR:0.0001, Train_Loss:0.6469, total_loss:tensor([0.6469], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2026-01-24 15:25:17.513 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [25/100], Top1:76.923, Top3:100.000, Test_precision:0.8408,Test_recall:0.5227,Test_f1:0.5115,,Test_specificity:0.8180 Test_loss:0.541135
acc1: 76.9231, acc3: 100.0000, Precision: 0.8408, Recall: 0.5227, F1-Score: 0.5115, Specificity: 0.8180
2026-01-24 15:25:17.514 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:25:17.515 | INFO     | __main__:main_worker:320 - ---> start train epoch26
2026-01-24 15:25:26.709 | INFO     | __main__:main_worker:382 - [26/100], remain:0d.00h.31m, It:[10/54], Max-Mem:12325M, Data-Time:0.890, LR:0.0001, Train_Loss:0.7716, total_loss:tensor([0.7716], device='cuda:0')
2026-01-24 15:25:31.535 | INFO     | __main__:main_worker:382 - [26/100], remain:0d.00h.31m, It:[20/54], Max-Mem:12325M, Data-Time:1.103, LR:0.0001, Train_Loss:0.6489, total_loss:tensor([0.6489], device='cuda:0')
2026-01-24 15:25:35.430 | INFO     | __main__:main_worker:382 - [26/100], remain:0d.00h.29m, It:[30/54], Max-Mem:12325M, Data-Time:0.352, LR:0.0001, Train_Loss:0.6036, total_loss:tensor([0.6036], device='cuda:0')
2026-01-24 15:25:39.866 | INFO     | __main__:main_worker:382 - [26/100], remain:0d.00h.29m, It:[40/54], Max-Mem:12325M, Data-Time:0.849, LR:0.0001, Train_Loss:0.2916, total_loss:tensor([0.2916], device='cuda:0')
2026-01-24 15:25:45.046 | INFO     | __main__:main_worker:382 - [26/100], remain:0d.00h.29m, It:[50/54], Max-Mem:12325M, Data-Time:1.674, LR:0.0001, Train_Loss:0.5420, total_loss:tensor([0.5420], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
2026-01-24 15:25:54.670 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [26/100], Top1:79.701, Top3:100.000, Test_precision:0.8530,Test_recall:0.5650,Test_f1:0.5413,,Test_specificity:0.8517 Test_loss:0.541102
acc1: 79.7009, acc3: 100.0000, Precision: 0.8530, Recall: 0.5650, F1-Score: 0.5413, Specificity: 0.8517
2026-01-24 15:25:54.672 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:25:54.672 | INFO     | __main__:main_worker:320 - ---> start train epoch27
2026-01-24 15:26:02.987 | INFO     | __main__:main_worker:382 - [27/100], remain:0d.00h.25m, It:[10/54], Max-Mem:12325M, Data-Time:0.423, LR:0.0001, Train_Loss:0.6676, total_loss:tensor([0.6676], device='cuda:0')
2026-01-24 15:26:07.430 | INFO     | __main__:main_worker:382 - [27/100], remain:0d.00h.26m, It:[20/54], Max-Mem:12325M, Data-Time:0.543, LR:0.0001, Train_Loss:0.5867, total_loss:tensor([0.5867], device='cuda:0')
2026-01-24 15:26:12.911 | INFO     | __main__:main_worker:382 - [27/100], remain:0d.00h.29m, It:[30/54], Max-Mem:12325M, Data-Time:1.174, LR:0.0001, Train_Loss:0.9375, total_loss:tensor([0.9375], device='cuda:0')
2026-01-24 15:26:17.505 | INFO     | __main__:main_worker:382 - [27/100], remain:0d.00h.29m, It:[40/54], Max-Mem:12325M, Data-Time:0.820, LR:0.0001, Train_Loss:0.5993, total_loss:tensor([0.5993], device='cuda:0')
2026-01-24 15:26:21.662 | INFO     | __main__:main_worker:382 - [27/100], remain:0d.00h.28m, It:[50/54], Max-Mem:12325M, Data-Time:0.485, LR:0.0001, Train_Loss:0.8804, total_loss:tensor([0.8804], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2026-01-24 15:26:31.882 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [27/100], Top1:77.350, Top3:100.000, Test_precision:0.5983,Test_recall:0.5660,Test_f1:0.5536,,Test_specificity:0.8475 Test_loss:0.510517
2026-01-24 15:26:31.883 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:26:31.883 | INFO     | __main__:main_worker:320 - ---> start train epoch28
acc1: 77.3504, acc3: 100.0000, Precision: 0.5983, Recall: 0.5660, F1-Score: 0.5536, Specificity: 0.8475
2026-01-24 15:26:41.968 | INFO     | __main__:main_worker:382 - [28/100], remain:0d.00h.34m, It:[10/54], Max-Mem:12325M, Data-Time:0.016, LR:0.0001, Train_Loss:0.5870, total_loss:tensor([0.5870], device='cuda:0')
2026-01-24 15:26:46.864 | INFO     | __main__:main_worker:382 - [28/100], remain:0d.00h.32m, It:[20/54], Max-Mem:12325M, Data-Time:0.015, LR:0.0001, Train_Loss:0.6391, total_loss:tensor([0.6391], device='cuda:0')
2026-01-24 15:26:50.510 | INFO     | __main__:main_worker:382 - [28/100], remain:0d.00h.29m, It:[30/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:0.7639, total_loss:tensor([0.7639], device='cuda:0')
2026-01-24 15:26:54.716 | INFO     | __main__:main_worker:382 - [28/100], remain:0d.00h.28m, It:[40/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.7117, total_loss:tensor([0.7117], device='cuda:0')
2026-01-24 15:26:58.696 | INFO     | __main__:main_worker:382 - [28/100], remain:0d.00h.27m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.6970, total_loss:tensor([0.6970], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:27:08.291 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [28/100], Top1:74.145, Top3:100.000, Test_precision:0.8374,Test_recall:0.4832,Test_f1:0.4793,,Test_specificity:0.7834 Test_loss:0.573703
acc1: 74.1453, acc3: 100.0000, Precision: 0.8374, Recall: 0.4832, F1-Score: 0.4793, Specificity: 0.7834
2026-01-24 15:27:08.293 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:27:08.293 | INFO     | __main__:main_worker:320 - ---> start train epoch29
2026-01-24 15:27:17.954 | INFO     | __main__:main_worker:382 - [29/100], remain:0d.00h.26m, It:[10/54], Max-Mem:12325M, Data-Time:0.749, LR:0.0001, Train_Loss:0.5572, total_loss:tensor([0.5572], device='cuda:0')
2026-01-24 15:27:22.228 | INFO     | __main__:main_worker:382 - [29/100], remain:0d.00h.26m, It:[20/54], Max-Mem:12325M, Data-Time:0.268, LR:0.0001, Train_Loss:0.4975, total_loss:tensor([0.4975], device='cuda:0')
2026-01-24 15:27:26.820 | INFO     | __main__:main_worker:382 - [29/100], remain:0d.00h.27m, It:[30/54], Max-Mem:12325M, Data-Time:0.770, LR:0.0001, Train_Loss:0.5983, total_loss:tensor([0.5983], device='cuda:0')
2026-01-24 15:27:30.489 | INFO     | __main__:main_worker:382 - [29/100], remain:0d.00h.26m, It:[40/54], Max-Mem:12325M, Data-Time:0.027, LR:0.0001, Train_Loss:0.7999, total_loss:tensor([0.7999], device='cuda:0')
2026-01-24 15:27:35.101 | INFO     | __main__:main_worker:382 - [29/100], remain:0d.00h.26m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.5183, total_loss:tensor([0.5183], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
acc1: 74.3590, acc3: 100.0000, Precision: 0.8203, Recall: 0.5009, F1-Score: 0.4900, Specificity: 0.7986
2026-01-24 15:27:45.066 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [29/100], Top1:74.359, Top3:100.000, Test_precision:0.8203,Test_recall:0.5009,Test_f1:0.4900,,Test_specificity:0.7986 Test_loss:0.528032
2026-01-24 15:27:45.067 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:27:45.068 | INFO     | __main__:main_worker:320 - ---> start train epoch30
2026-01-24 15:27:53.977 | INFO     | __main__:main_worker:382 - [30/100], remain:0d.00h.28m, It:[10/54], Max-Mem:12325M, Data-Time:0.785, LR:0.0001, Train_Loss:0.4333, total_loss:tensor([0.4333], device='cuda:0')
2026-01-24 15:27:58.331 | INFO     | __main__:main_worker:382 - [30/100], remain:0d.00h.27m, It:[20/54], Max-Mem:12325M, Data-Time:0.532, LR:0.0001, Train_Loss:0.5577, total_loss:tensor([0.5577], device='cuda:0')
2026-01-24 15:28:02.560 | INFO     | __main__:main_worker:382 - [30/100], remain:0d.00h.26m, It:[30/54], Max-Mem:12325M, Data-Time:0.042, LR:0.0001, Train_Loss:0.4267, total_loss:tensor([0.4267], device='cuda:0')
2026-01-24 15:28:07.281 | INFO     | __main__:main_worker:382 - [30/100], remain:0d.00h.27m, It:[40/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.5784, total_loss:tensor([0.5784], device='cuda:0')
2026-01-24 15:28:11.580 | INFO     | __main__:main_worker:382 - [30/100], remain:0d.00h.27m, It:[50/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0001, Train_Loss:0.4746, total_loss:tensor([0.4746], device='cuda:0')
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-24 15:28:14.084 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 30
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.7581
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.8260
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.7107
Local prototype push completed!
2026-01-24 15:28:39.075 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
2026-01-24 15:28:47.372 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [30/100], Top1:77.564, Top3:100.000, Test_precision:0.6230,Test_recall:0.5520,Test_f1:0.5517,,Test_specificity:0.8323 Test_loss:0.513014
acc1: 77.5641, acc3: 100.0000, Precision: 0.6230, Recall: 0.5520, F1-Score: 0.5517, Specificity: 0.8323
2026-01-24 15:28:47.373 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:28:54.141 | INFO     | __main__:main_worker:320 - ---> start train epoch31
2026-01-24 15:29:04.149 | INFO     | __main__:main_worker:382 - [31/100], remain:0d.00h.30m, It:[10/54], Max-Mem:12325M, Data-Time:1.484, LR:0.0001, Train_Loss:0.5390, total_loss:tensor([0.5390], device='cuda:0')
2026-01-24 15:29:08.975 | INFO     | __main__:main_worker:382 - [31/100], remain:0d.00h.29m, It:[20/54], Max-Mem:12325M, Data-Time:1.335, LR:0.0001, Train_Loss:0.5355, total_loss:tensor([0.5355], device='cuda:0')
2026-01-24 15:29:13.908 | INFO     | __main__:main_worker:382 - [31/100], remain:0d.00h.29m, It:[30/54], Max-Mem:12325M, Data-Time:1.423, LR:0.0001, Train_Loss:0.6461, total_loss:tensor([0.6461], device='cuda:0')
2026-01-24 15:29:18.446 | INFO     | __main__:main_worker:382 - [31/100], remain:0d.00h.29m, It:[40/54], Max-Mem:12325M, Data-Time:1.041, LR:0.0001, Train_Loss:0.6676, total_loss:tensor([0.6676], device='cuda:0')
2026-01-24 15:29:22.707 | INFO     | __main__:main_worker:382 - [31/100], remain:0d.00h.28m, It:[50/54], Max-Mem:12325M, Data-Time:0.753, LR:0.0001, Train_Loss:0.5183, total_loss:tensor([0.5183], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
2026-01-24 15:29:32.304 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [31/100], Top1:73.291, Top3:100.000, Test_precision:0.8053,Test_recall:0.4967,Test_f1:0.4823,,Test_specificity:0.7974 Test_loss:0.559135
2026-01-24 15:29:32.305 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:29:32.305 | INFO     | __main__:main_worker:320 - ---> start train epoch32
acc1: 73.2906, acc3: 100.0000, Precision: 0.8053, Recall: 0.4967, F1-Score: 0.4823, Specificity: 0.7974
2026-01-24 15:29:41.845 | INFO     | __main__:main_worker:382 - [32/100], remain:0d.00h.24m, It:[10/54], Max-Mem:12325M, Data-Time:0.624, LR:0.0001, Train_Loss:0.4730, total_loss:tensor([0.4730], device='cuda:0')
2026-01-24 15:29:46.752 | INFO     | __main__:main_worker:382 - [32/100], remain:0d.00h.27m, It:[20/54], Max-Mem:12325M, Data-Time:1.313, LR:0.0001, Train_Loss:0.3445, total_loss:tensor([0.3445], device='cuda:0')
2026-01-24 15:29:50.841 | INFO     | __main__:main_worker:382 - [32/100], remain:0d.00h.26m, It:[30/54], Max-Mem:12325M, Data-Time:0.398, LR:0.0001, Train_Loss:0.9193, total_loss:tensor([0.9193], device='cuda:0')
2026-01-24 15:29:56.201 | INFO     | __main__:main_worker:382 - [32/100], remain:0d.00h.27m, It:[40/54], Max-Mem:12325M, Data-Time:1.593, LR:0.0001, Train_Loss:0.4357, total_loss:tensor([0.4357], device='cuda:0')
2026-01-24 15:29:59.886 | INFO     | __main__:main_worker:382 - [32/100], remain:0d.00h.26m, It:[50/54], Max-Mem:12325M, Data-Time:0.020, LR:0.0001, Train_Loss:0.5154, total_loss:tensor([0.5154], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
acc1: 72.2222, acc3: 100.0000, Precision: 0.6080, Recall: 0.5666, F1-Score: 0.5808, Specificity: 0.8115
2026-01-24 15:30:10.313 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [32/100], Top1:72.222, Top3:100.000, Test_precision:0.6080,Test_recall:0.5666,Test_f1:0.5808,,Test_specificity:0.8115 Test_loss:0.627469
2026-01-24 15:30:10.314 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:30:10.315 | INFO     | __main__:main_worker:320 - ---> start train epoch33
2026-01-24 15:30:18.773 | INFO     | __main__:main_worker:382 - [33/100], remain:0d.00h.22m, It:[10/54], Max-Mem:12325M, Data-Time:0.356, LR:0.0001, Train_Loss:0.5646, total_loss:tensor([0.5646], device='cuda:0')
2026-01-24 15:30:23.276 | INFO     | __main__:main_worker:382 - [33/100], remain:0d.00h.24m, It:[20/54], Max-Mem:12325M, Data-Time:0.091, LR:0.0001, Train_Loss:0.8815, total_loss:tensor([0.8815], device='cuda:0')
2026-01-24 15:30:28.110 | INFO     | __main__:main_worker:382 - [33/100], remain:0d.00h.25m, It:[30/54], Max-Mem:12325M, Data-Time:0.017, LR:0.0001, Train_Loss:0.6193, total_loss:tensor([0.6193], device='cuda:0')
2026-01-24 15:30:33.674 | INFO     | __main__:main_worker:382 - [33/100], remain:0d.00h.27m, It:[40/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.3829, total_loss:tensor([0.3829], device='cuda:0')
2026-01-24 15:30:37.316 | INFO     | __main__:main_worker:382 - [33/100], remain:0d.00h.26m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.6093, total_loss:tensor([0.6093], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
2026-01-24 15:30:47.771 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [33/100], Top1:76.068, Top3:100.000, Test_precision:0.6505,Test_recall:0.5655,Test_f1:0.5814,,Test_specificity:0.8278 Test_loss:0.552660
acc1: 76.0684, acc3: 100.0000, Precision: 0.6505, Recall: 0.5655, F1-Score: 0.5814, Specificity: 0.8278
2026-01-24 15:30:47.773 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:30:47.773 | INFO     | __main__:main_worker:320 - ---> start train epoch34
2026-01-24 15:30:56.579 | INFO     | __main__:main_worker:382 - [34/100], remain:0d.00h.32m, It:[10/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.5003, total_loss:tensor([0.5003], device='cuda:0')
2026-01-24 15:31:01.285 | INFO     | __main__:main_worker:382 - [34/100], remain:0d.00h.29m, It:[20/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.4316, total_loss:tensor([0.4316], device='cuda:0')
2026-01-24 15:31:05.523 | INFO     | __main__:main_worker:382 - [34/100], remain:0d.00h.27m, It:[30/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.5578, total_loss:tensor([0.5578], device='cuda:0')
2026-01-24 15:31:09.995 | INFO     | __main__:main_worker:382 - [34/100], remain:0d.00h.27m, It:[40/54], Max-Mem:12325M, Data-Time:0.428, LR:0.0001, Train_Loss:0.7299, total_loss:tensor([0.7299], device='cuda:0')
2026-01-24 15:31:15.218 | INFO     | __main__:main_worker:382 - [34/100], remain:0d.00h.27m, It:[50/54], Max-Mem:12325M, Data-Time:0.015, LR:0.0001, Train_Loss:0.5112, total_loss:tensor([0.5112], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
2026-01-24 15:31:25.667 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [34/100], Top1:76.068, Top3:100.000, Test_precision:0.6463,Test_recall:0.6716,Test_f1:0.6572,,Test_specificity:0.8598 Test_loss:0.606791
acc1: 76.0684, acc3: 100.0000, Precision: 0.6463, Recall: 0.6716, F1-Score: 0.6572, Specificity: 0.8598
2026-01-24 15:31:25.668 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:31:25.669 | INFO     | __main__:main_worker:320 - ---> start train epoch35
2026-01-24 15:31:35.285 | INFO     | __main__:main_worker:382 - [35/100], remain:0d.00h.30m, It:[10/54], Max-Mem:12325M, Data-Time:0.831, LR:0.0001, Train_Loss:0.6195, total_loss:tensor([0.6195], device='cuda:0')
2026-01-24 15:31:40.155 | INFO     | __main__:main_worker:382 - [35/100], remain:0d.00h.29m, It:[20/54], Max-Mem:12325M, Data-Time:0.019, LR:0.0001, Train_Loss:0.3556, total_loss:tensor([0.3556], device='cuda:0')
2026-01-24 15:31:44.135 | INFO     | __main__:main_worker:382 - [35/100], remain:0d.00h.26m, It:[30/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.5593, total_loss:tensor([0.5593], device='cuda:0')
2026-01-24 15:31:48.691 | INFO     | __main__:main_worker:382 - [35/100], remain:0d.00h.26m, It:[40/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0001, Train_Loss:0.4875, total_loss:tensor([0.4875], device='cuda:0')
2026-01-24 15:31:52.392 | INFO     | __main__:main_worker:382 - [35/100], remain:0d.00h.25m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.4622, total_loss:tensor([0.4622], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:32:02.816 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [35/100], Top1:79.701, Top3:100.000, Test_precision:0.6718,Test_recall:0.5933,Test_f1:0.5963,,Test_specificity:0.8566 Test_loss:0.496363
acc1: 79.7009, acc3: 100.0000, Precision: 0.6718, Recall: 0.5933, F1-Score: 0.5963, Specificity: 0.8566
2026-01-24 15:32:02.818 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:32:02.818 | INFO     | __main__:main_worker:320 - ---> start train epoch36
2026-01-24 15:32:11.572 | INFO     | __main__:main_worker:382 - [36/100], remain:0d.00h.28m, It:[10/54], Max-Mem:12325M, Data-Time:0.342, LR:0.0001, Train_Loss:0.6392, total_loss:tensor([0.6392], device='cuda:0')
2026-01-24 15:32:16.082 | INFO     | __main__:main_worker:382 - [36/100], remain:0d.00h.26m, It:[20/54], Max-Mem:12325M, Data-Time:0.255, LR:0.0001, Train_Loss:0.5092, total_loss:tensor([0.5092], device='cuda:0')
2026-01-24 15:32:20.664 | INFO     | __main__:main_worker:382 - [36/100], remain:0d.00h.26m, It:[30/54], Max-Mem:12325M, Data-Time:0.531, LR:0.0001, Train_Loss:0.5200, total_loss:tensor([0.5200], device='cuda:0')
2026-01-24 15:32:25.599 | INFO     | __main__:main_worker:382 - [36/100], remain:0d.00h.26m, It:[40/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.5451, total_loss:tensor([0.5451], device='cuda:0')
2026-01-24 15:32:29.889 | INFO     | __main__:main_worker:382 - [36/100], remain:0d.00h.26m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.6090, total_loss:tensor([0.6090], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
2026-01-24 15:32:39.897 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [36/100], Top1:78.205, Top3:100.000, Test_precision:0.6426,Test_recall:0.5730,Test_f1:0.5823,,Test_specificity:0.8387 Test_loss:0.518162
acc1: 78.2051, acc3: 100.0000, Precision: 0.6426, Recall: 0.5730, F1-Score: 0.5823, Specificity: 0.8387
2026-01-24 15:32:39.899 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:32:39.899 | INFO     | __main__:main_worker:320 - ---> start train epoch37
2026-01-24 15:32:49.210 | INFO     | __main__:main_worker:382 - [37/100], remain:0d.00h.28m, It:[10/54], Max-Mem:12325M, Data-Time:1.302, LR:0.0001, Train_Loss:0.6658, total_loss:tensor([0.6658], device='cuda:0')
2026-01-24 15:32:53.395 | INFO     | __main__:main_worker:382 - [37/100], remain:0d.00h.25m, It:[20/54], Max-Mem:12325M, Data-Time:0.643, LR:0.0001, Train_Loss:0.6010, total_loss:tensor([0.6010], device='cuda:0')
2026-01-24 15:32:57.476 | INFO     | __main__:main_worker:382 - [37/100], remain:0d.00h.24m, It:[30/54], Max-Mem:12325M, Data-Time:0.516, LR:0.0001, Train_Loss:0.7591, total_loss:tensor([0.7591], device='cuda:0')
2026-01-24 15:33:01.694 | INFO     | __main__:main_worker:382 - [37/100], remain:0d.00h.24m, It:[40/54], Max-Mem:12325M, Data-Time:0.267, LR:0.0001, Train_Loss:0.6147, total_loss:tensor([0.6147], device='cuda:0')
2026-01-24 15:33:07.131 | INFO     | __main__:main_worker:382 - [37/100], remain:0d.00h.25m, It:[50/54], Max-Mem:12325M, Data-Time:0.017, LR:0.0001, Train_Loss:0.4708, total_loss:tensor([0.4708], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
acc1: 80.1282, acc3: 100.0000, Precision: 0.7038, Recall: 0.6150, F1-Score: 0.6291, Specificity: 0.8626
2026-01-24 15:33:17.888 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [37/100], Top1:80.128, Top3:100.000, Test_precision:0.7038,Test_recall:0.6150,Test_f1:0.6291,,Test_specificity:0.8626 Test_loss:0.530890
2026-01-24 15:33:17.890 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:33:17.890 | INFO     | __main__:main_worker:320 - ---> start train epoch38
2026-01-24 15:33:26.872 | INFO     | __main__:main_worker:382 - [38/100], remain:0d.00h.24m, It:[10/54], Max-Mem:12325M, Data-Time:0.873, LR:0.0001, Train_Loss:0.3102, total_loss:tensor([0.3102], device='cuda:0')
2026-01-24 15:33:31.041 | INFO     | __main__:main_worker:382 - [38/100], remain:0d.00h.23m, It:[20/54], Max-Mem:12325M, Data-Time:0.618, LR:0.0001, Train_Loss:0.5136, total_loss:tensor([0.5136], device='cuda:0')
2026-01-24 15:33:35.184 | INFO     | __main__:main_worker:382 - [38/100], remain:0d.00h.22m, It:[30/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.5197, total_loss:tensor([0.5197], device='cuda:0')
2026-01-24 15:33:39.589 | INFO     | __main__:main_worker:382 - [38/100], remain:0d.00h.23m, It:[40/54], Max-Mem:12325M, Data-Time:0.018, LR:0.0001, Train_Loss:0.5138, total_loss:tensor([0.5138], device='cuda:0')
2026-01-24 15:33:44.117 | INFO     | __main__:main_worker:382 - [38/100], remain:0d.00h.23m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.4808, total_loss:tensor([0.4808], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
2026-01-24 15:33:54.410 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [38/100], Top1:77.137, Top3:100.000, Test_precision:0.6861,Test_recall:0.7000,Test_f1:0.6909,,Test_specificity:0.8497 Test_loss:0.521770
acc1: 77.1368, acc3: 100.0000, Precision: 0.6861, Recall: 0.7000, F1-Score: 0.6909, Specificity: 0.8497
2026-01-24 15:33:54.411 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:33:54.412 | INFO     | __main__:main_worker:320 - ---> start train epoch39
2026-01-24 15:34:04.032 | INFO     | __main__:main_worker:382 - [39/100], remain:0d.00h.26m, It:[10/54], Max-Mem:12325M, Data-Time:0.308, LR:0.0001, Train_Loss:0.6142, total_loss:tensor([0.6142], device='cuda:0')
2026-01-24 15:34:08.904 | INFO     | __main__:main_worker:382 - [39/100], remain:0d.00h.26m, It:[20/54], Max-Mem:12325M, Data-Time:0.299, LR:0.0001, Train_Loss:0.4530, total_loss:tensor([0.4530], device='cuda:0')
2026-01-24 15:34:13.193 | INFO     | __main__:main_worker:382 - [39/100], remain:0d.00h.25m, It:[30/54], Max-Mem:12325M, Data-Time:0.671, LR:0.0001, Train_Loss:0.3611, total_loss:tensor([0.3611], device='cuda:0')
2026-01-24 15:34:18.658 | INFO     | __main__:main_worker:382 - [39/100], remain:0d.00h.26m, It:[40/54], Max-Mem:12325M, Data-Time:1.663, LR:0.0001, Train_Loss:0.5832, total_loss:tensor([0.5832], device='cuda:0')
2026-01-24 15:34:22.803 | INFO     | __main__:main_worker:382 - [39/100], remain:0d.00h.25m, It:[50/54], Max-Mem:12325M, Data-Time:0.672, LR:0.0001, Train_Loss:0.4127, total_loss:tensor([0.4127], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2026-01-24 15:34:32.540 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [39/100], Top1:79.915, Top3:100.000, Test_precision:0.7333,Test_recall:0.6501,Test_f1:0.6769,,Test_specificity:0.8573 Test_loss:0.531423
acc1: 79.9145, acc3: 100.0000, Precision: 0.7333, Recall: 0.6501, F1-Score: 0.6769, Specificity: 0.8573
2026-01-24 15:34:32.541 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:34:32.542 | INFO     | __main__:main_worker:320 - ---> start train epoch40
2026-01-24 15:34:41.635 | INFO     | __main__:main_worker:382 - [40/100], remain:0d.00h.24m, It:[10/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.4901, total_loss:tensor([0.4901], device='cuda:0')
2026-01-24 15:34:46.040 | INFO     | __main__:main_worker:382 - [40/100], remain:0d.00h.23m, It:[20/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.4068, total_loss:tensor([0.4068], device='cuda:0')
2026-01-24 15:34:51.664 | INFO     | __main__:main_worker:382 - [40/100], remain:0d.00h.25m, It:[30/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.3829, total_loss:tensor([0.3829], device='cuda:0')
2026-01-24 15:34:55.818 | INFO     | __main__:main_worker:382 - [40/100], remain:0d.00h.24m, It:[40/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.5008, total_loss:tensor([0.5008], device='cuda:0')
2026-01-24 15:35:00.482 | INFO     | __main__:main_worker:382 - [40/100], remain:0d.00h.24m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.2353, total_loss:tensor([0.2353], device='cuda:0')
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
2026-01-24 15:35:03.314 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 40
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.7411
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.7901
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.6957
Local prototype push completed!
2026-01-24 15:35:27.945 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
acc1: 80.5556, acc3: 100.0000, Precision: 0.7306, Recall: 0.6539, F1-Score: 0.6713, Specificity: 0.8704
2026-01-24 15:35:36.135 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [40/100], Top1:80.556, Top3:100.000, Test_precision:0.7306,Test_recall:0.6539,Test_f1:0.6713,,Test_specificity:0.8704 Test_loss:0.536370
2026-01-24 15:35:36.137 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:35:42.677 | INFO     | __main__:main_worker:320 - ---> start train epoch41
2026-01-24 15:35:51.949 | INFO     | __main__:main_worker:382 - [41/100], remain:0d.00h.21m, It:[10/54], Max-Mem:12325M, Data-Time:0.616, LR:0.0001, Train_Loss:0.2298, total_loss:tensor([0.2298], device='cuda:0')
2026-01-24 15:35:56.056 | INFO     | __main__:main_worker:382 - [41/100], remain:0d.00h.21m, It:[20/54], Max-Mem:12325M, Data-Time:0.613, LR:0.0001, Train_Loss:0.2665, total_loss:tensor([0.2665], device='cuda:0')
2026-01-24 15:36:01.144 | INFO     | __main__:main_worker:382 - [41/100], remain:0d.00h.22m, It:[30/54], Max-Mem:12325M, Data-Time:1.165, LR:0.0001, Train_Loss:0.5069, total_loss:tensor([0.5069], device='cuda:0')
2026-01-24 15:36:06.282 | INFO     | __main__:main_worker:382 - [41/100], remain:0d.00h.23m, It:[40/54], Max-Mem:12325M, Data-Time:1.448, LR:0.0001, Train_Loss:0.7201, total_loss:tensor([0.7201], device='cuda:0')
2026-01-24 15:36:09.996 | INFO     | __main__:main_worker:382 - [41/100], remain:0d.00h.22m, It:[50/54], Max-Mem:12325M, Data-Time:0.202, LR:0.0001, Train_Loss:0.4179, total_loss:tensor([0.4179], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
2026-01-24 15:36:20.171 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [41/100], Top1:80.342, Top3:100.000, Test_precision:0.7557,Test_recall:0.6431,Test_f1:0.6708,,Test_specificity:0.8596 Test_loss:0.500364
acc1: 80.3419, acc3: 100.0000, Precision: 0.7557, Recall: 0.6431, F1-Score: 0.6708, Specificity: 0.8596
2026-01-24 15:36:20.172 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:36:20.173 | INFO     | __main__:main_worker:320 - ---> start train epoch42
2026-01-24 15:36:29.315 | INFO     | __main__:main_worker:382 - [42/100], remain:0d.00h.20m, It:[10/54], Max-Mem:12325M, Data-Time:0.472, LR:0.0001, Train_Loss:0.5242, total_loss:tensor([0.5242], device='cuda:0')
2026-01-24 15:36:33.527 | INFO     | __main__:main_worker:382 - [42/100], remain:0d.00h.20m, It:[20/54], Max-Mem:12325M, Data-Time:0.015, LR:0.0001, Train_Loss:0.2975, total_loss:tensor([0.2975], device='cuda:0')
2026-01-24 15:36:37.880 | INFO     | __main__:main_worker:382 - [42/100], remain:0d.00h.21m, It:[30/54], Max-Mem:12325M, Data-Time:0.086, LR:0.0001, Train_Loss:0.3025, total_loss:tensor([0.3025], device='cuda:0')
2026-01-24 15:36:41.957 | INFO     | __main__:main_worker:382 - [42/100], remain:0d.00h.21m, It:[40/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.3820, total_loss:tensor([0.3820], device='cuda:0')
2026-01-24 15:36:46.748 | INFO     | __main__:main_worker:382 - [42/100], remain:0d.00h.21m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.3779, total_loss:tensor([0.3779], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.85it/s]
2026-01-24 15:36:57.527 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [42/100], Top1:77.137, Top3:100.000, Test_precision:0.8293,Test_recall:0.5618,Test_f1:0.5729,,Test_specificity:0.8322 Test_loss:0.535713
2026-01-24 15:36:57.528 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:36:57.529 | INFO     | __main__:main_worker:320 - ---> start train epoch43
acc1: 77.1368, acc3: 100.0000, Precision: 0.8293, Recall: 0.5618, F1-Score: 0.5729, Specificity: 0.8322
2026-01-24 15:37:05.716 | INFO     | __main__:main_worker:382 - [43/100], remain:0d.00h.23m, It:[10/54], Max-Mem:12325M, Data-Time:0.017, LR:0.0001, Train_Loss:0.4378, total_loss:tensor([0.4378], device='cuda:0')
2026-01-24 15:37:09.956 | INFO     | __main__:main_worker:382 - [43/100], remain:0d.00h.22m, It:[20/54], Max-Mem:12325M, Data-Time:0.137, LR:0.0001, Train_Loss:0.5067, total_loss:tensor([0.5067], device='cuda:0')
2026-01-24 15:37:14.814 | INFO     | __main__:main_worker:382 - [43/100], remain:0d.00h.22m, It:[30/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:0.6347, total_loss:tensor([0.6347], device='cuda:0')
2026-01-24 15:37:19.355 | INFO     | __main__:main_worker:382 - [43/100], remain:0d.00h.22m, It:[40/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.5177, total_loss:tensor([0.5177], device='cuda:0')
2026-01-24 15:37:24.314 | INFO     | __main__:main_worker:382 - [43/100], remain:0d.00h.23m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0001, Train_Loss:0.1898, total_loss:tensor([0.1898], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
acc1: 76.7094, acc3: 100.0000, Precision: 0.6943, Recall: 0.6101, F1-Score: 0.6347, Specificity: 0.8348
2026-01-24 15:37:35.156 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [43/100], Top1:76.709, Top3:100.000, Test_precision:0.6943,Test_recall:0.6101,Test_f1:0.6347,,Test_specificity:0.8348 Test_loss:0.502148
2026-01-24 15:37:35.157 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:37:35.157 | INFO     | __main__:main_worker:320 - ---> start train epoch44
2026-01-24 15:37:45.725 | INFO     | __main__:main_worker:382 - [44/100], remain:0d.00h.29m, It:[10/54], Max-Mem:12325M, Data-Time:1.369, LR:0.0001, Train_Loss:0.7616, total_loss:tensor([0.7616], device='cuda:0')
2026-01-24 15:37:50.207 | INFO     | __main__:main_worker:382 - [44/100], remain:0d.00h.25m, It:[20/54], Max-Mem:12325M, Data-Time:0.944, LR:0.0001, Train_Loss:0.2975, total_loss:tensor([0.2975], device='cuda:0')
2026-01-24 15:37:54.582 | INFO     | __main__:main_worker:382 - [44/100], remain:0d.00h.24m, It:[30/54], Max-Mem:12325M, Data-Time:0.641, LR:0.0001, Train_Loss:0.5563, total_loss:tensor([0.5563], device='cuda:0')
2026-01-24 15:37:59.093 | INFO     | __main__:main_worker:382 - [44/100], remain:0d.00h.23m, It:[40/54], Max-Mem:12325M, Data-Time:0.026, LR:0.0001, Train_Loss:0.3083, total_loss:tensor([0.3083], device='cuda:0')
2026-01-24 15:38:04.298 | INFO     | __main__:main_worker:382 - [44/100], remain:0d.00h.23m, It:[50/54], Max-Mem:12325M, Data-Time:0.021, LR:0.0001, Train_Loss:0.5795, total_loss:tensor([0.5795], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
acc1: 78.6325, acc3: 100.0000, Precision: 0.7192, Recall: 0.6434, F1-Score: 0.6668, Specificity: 0.8532
2026-01-24 15:38:13.868 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [44/100], Top1:78.632, Top3:100.000, Test_precision:0.7192,Test_recall:0.6434,Test_f1:0.6668,,Test_specificity:0.8532 Test_loss:0.508348
2026-01-24 15:38:13.870 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:38:13.870 | INFO     | __main__:main_worker:320 - ---> start train epoch45
2026-01-24 15:38:23.677 | INFO     | __main__:main_worker:382 - [45/100], remain:0d.00h.23m, It:[10/54], Max-Mem:12325M, Data-Time:1.284, LR:0.0001, Train_Loss:0.3994, total_loss:tensor([0.3994], device='cuda:0')
2026-01-24 15:38:27.518 | INFO     | __main__:main_worker:382 - [45/100], remain:0d.00h.20m, It:[20/54], Max-Mem:12325M, Data-Time:0.322, LR:0.0001, Train_Loss:0.6797, total_loss:tensor([0.6797], device='cuda:0')
2026-01-24 15:38:32.590 | INFO     | __main__:main_worker:382 - [45/100], remain:0d.00h.22m, It:[30/54], Max-Mem:12325M, Data-Time:1.311, LR:0.0001, Train_Loss:0.5257, total_loss:tensor([0.5257], device='cuda:0')
2026-01-24 15:38:36.759 | INFO     | __main__:main_worker:382 - [45/100], remain:0d.00h.21m, It:[40/54], Max-Mem:12325M, Data-Time:0.645, LR:0.0001, Train_Loss:0.7090, total_loss:tensor([0.7090], device='cuda:0')
2026-01-24 15:38:42.085 | INFO     | __main__:main_worker:382 - [45/100], remain:0d.00h.22m, It:[50/54], Max-Mem:12325M, Data-Time:1.808, LR:0.0001, Train_Loss:0.3955, total_loss:tensor([0.3955], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
2026-01-24 15:38:51.626 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [45/100], Top1:79.915, Top3:100.000, Test_precision:0.7285,Test_recall:0.6422,Test_f1:0.6648,,Test_specificity:0.8599 Test_loss:0.499369
2026-01-24 15:38:51.628 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:38:51.628 | INFO     | __main__:main_worker:320 - ---> start train epoch46
acc1: 79.9145, acc3: 100.0000, Precision: 0.7285, Recall: 0.6422, F1-Score: 0.6648, Specificity: 0.8599
2026-01-24 15:39:00.698 | INFO     | __main__:main_worker:382 - [46/100], remain:0d.00h.21m, It:[10/54], Max-Mem:12325M, Data-Time:0.247, LR:0.0001, Train_Loss:0.4211, total_loss:tensor([0.4211], device='cuda:0')
2026-01-24 15:39:06.196 | INFO     | __main__:main_worker:382 - [46/100], remain:0d.00h.23m, It:[20/54], Max-Mem:12325M, Data-Time:1.530, LR:0.0001, Train_Loss:0.6306, total_loss:tensor([0.6306], device='cuda:0')
2026-01-24 15:39:10.869 | INFO     | __main__:main_worker:382 - [46/100], remain:0d.00h.23m, It:[30/54], Max-Mem:12325M, Data-Time:1.201, LR:0.0001, Train_Loss:0.5689, total_loss:tensor([0.5689], device='cuda:0')
2026-01-24 15:39:15.223 | INFO     | __main__:main_worker:382 - [46/100], remain:0d.00h.22m, It:[40/54], Max-Mem:12325M, Data-Time:0.396, LR:0.0001, Train_Loss:0.6150, total_loss:tensor([0.6150], device='cuda:0')
2026-01-24 15:39:20.200 | INFO     | __main__:main_worker:382 - [46/100], remain:0d.00h.22m, It:[50/54], Max-Mem:12325M, Data-Time:0.281, LR:0.0001, Train_Loss:0.5606, total_loss:tensor([0.5606], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
acc1: 79.7009, acc3: 100.0000, Precision: 0.7159, Recall: 0.6207, F1-Score: 0.6444, Specificity: 0.8523
2026-01-24 15:39:30.474 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [46/100], Top1:79.701, Top3:100.000, Test_precision:0.7159,Test_recall:0.6207,Test_f1:0.6444,,Test_specificity:0.8523 Test_loss:0.498033
2026-01-24 15:39:30.475 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:39:30.476 | INFO     | __main__:main_worker:320 - ---> start train epoch47
2026-01-24 15:39:39.243 | INFO     | __main__:main_worker:382 - [47/100], remain:0d.00h.20m, It:[10/54], Max-Mem:12325M, Data-Time:0.283, LR:0.0001, Train_Loss:0.7260, total_loss:tensor([0.7260], device='cuda:0')
2026-01-24 15:39:44.197 | INFO     | __main__:main_worker:382 - [47/100], remain:0d.00h.22m, It:[20/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.4913, total_loss:tensor([0.4913], device='cuda:0')
2026-01-24 15:39:48.400 | INFO     | __main__:main_worker:382 - [47/100], remain:0d.00h.21m, It:[30/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.3276, total_loss:tensor([0.3276], device='cuda:0')
2026-01-24 15:39:53.317 | INFO     | __main__:main_worker:382 - [47/100], remain:0d.00h.21m, It:[40/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0001, Train_Loss:0.1998, total_loss:tensor([0.1998], device='cuda:0')
2026-01-24 15:39:58.134 | INFO     | __main__:main_worker:382 - [47/100], remain:0d.00h.21m, It:[50/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0001, Train_Loss:0.5129, total_loss:tensor([0.5129], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
acc1: 79.2735, acc3: 100.0000, Precision: 0.7462, Recall: 0.6668, F1-Score: 0.6965, Specificity: 0.8515
2026-01-24 15:40:08.735 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [47/100], Top1:79.274, Top3:100.000, Test_precision:0.7462,Test_recall:0.6668,Test_f1:0.6965,,Test_specificity:0.8515 Test_loss:0.530929
2026-01-24 15:40:08.737 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:40:08.737 | INFO     | __main__:main_worker:320 - ---> start train epoch48
2026-01-24 15:40:19.489 | INFO     | __main__:main_worker:382 - [48/100], remain:0d.00h.25m, It:[10/54], Max-Mem:12325M, Data-Time:1.599, LR:0.0001, Train_Loss:0.3107, total_loss:tensor([0.3107], device='cuda:0')
2026-01-24 15:40:24.181 | INFO     | __main__:main_worker:382 - [48/100], remain:0d.00h.23m, It:[20/54], Max-Mem:12325M, Data-Time:1.169, LR:0.0001, Train_Loss:0.3388, total_loss:tensor([0.3388], device='cuda:0')
2026-01-24 15:40:28.599 | INFO     | __main__:main_worker:382 - [48/100], remain:0d.00h.22m, It:[30/54], Max-Mem:12325M, Data-Time:0.894, LR:0.0001, Train_Loss:0.1734, total_loss:tensor([0.1734], device='cuda:0')
2026-01-24 15:40:33.959 | INFO     | __main__:main_worker:382 - [48/100], remain:0d.00h.22m, It:[40/54], Max-Mem:12325M, Data-Time:1.852, LR:0.0001, Train_Loss:0.3461, total_loss:tensor([0.3461], device='cuda:0')
2026-01-24 15:40:38.433 | INFO     | __main__:main_worker:382 - [48/100], remain:0d.00h.22m, It:[50/54], Max-Mem:12325M, Data-Time:0.946, LR:0.0001, Train_Loss:0.2691, total_loss:tensor([0.2691], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
2026-01-24 15:40:48.290 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [48/100], Top1:77.350, Top3:100.000, Test_precision:0.7232,Test_recall:0.6563,Test_f1:0.6829,,Test_specificity:0.8364 Test_loss:0.516298
acc1: 77.3504, acc3: 100.0000, Precision: 0.7232, Recall: 0.6563, F1-Score: 0.6829, Specificity: 0.8364
2026-01-24 15:40:48.291 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:40:48.292 | INFO     | __main__:main_worker:320 - ---> start train epoch49
2026-01-24 15:40:57.892 | INFO     | __main__:main_worker:382 - [49/100], remain:0d.00h.21m, It:[10/54], Max-Mem:12325M, Data-Time:1.224, LR:0.0001, Train_Loss:0.7430, total_loss:tensor([0.7430], device='cuda:0')
2026-01-24 15:41:02.039 | INFO     | __main__:main_worker:382 - [49/100], remain:0d.00h.20m, It:[20/54], Max-Mem:12325M, Data-Time:0.609, LR:0.0001, Train_Loss:0.1990, total_loss:tensor([0.1990], device='cuda:0')
2026-01-24 15:41:06.093 | INFO     | __main__:main_worker:382 - [49/100], remain:0d.00h.19m, It:[30/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0001, Train_Loss:0.4367, total_loss:tensor([0.4367], device='cuda:0')
2026-01-24 15:41:10.858 | INFO     | __main__:main_worker:382 - [49/100], remain:0d.00h.19m, It:[40/54], Max-Mem:12325M, Data-Time:0.015, LR:0.0001, Train_Loss:0.5536, total_loss:tensor([0.5536], device='cuda:0')
2026-01-24 15:41:16.430 | INFO     | __main__:main_worker:382 - [49/100], remain:0d.00h.20m, It:[50/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:0.7515, total_loss:tensor([0.7515], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
2026-01-24 15:41:26.312 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [49/100], Top1:73.504, Top3:100.000, Test_precision:0.7617,Test_recall:0.5760,Test_f1:0.6248,,Test_specificity:0.7839 Test_loss:0.537448
2026-01-24 15:41:26.313 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:41:26.314 | INFO     | __main__:main_worker:320 - ---> start train epoch50
acc1: 73.5043, acc3: 100.0000, Precision: 0.7617, Recall: 0.5760, F1-Score: 0.6248, Specificity: 0.7839
2026-01-24 15:41:36.716 | INFO     | __main__:main_worker:382 - [50/100], remain:0d.00h.23m, It:[10/54], Max-Mem:12325M, Data-Time:1.138, LR:0.0001, Train_Loss:0.2522, total_loss:tensor([0.2522], device='cuda:0')
2026-01-24 15:41:40.732 | INFO     | __main__:main_worker:382 - [50/100], remain:0d.00h.20m, It:[20/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0001, Train_Loss:0.4242, total_loss:tensor([0.4242], device='cuda:0')
2026-01-24 15:41:44.869 | INFO     | __main__:main_worker:382 - [50/100], remain:0d.00h.19m, It:[30/54], Max-Mem:12325M, Data-Time:0.162, LR:0.0001, Train_Loss:0.5182, total_loss:tensor([0.5182], device='cuda:0')
2026-01-24 15:41:49.674 | INFO     | __main__:main_worker:382 - [50/100], remain:0d.00h.19m, It:[40/54], Max-Mem:12325M, Data-Time:0.940, LR:0.0001, Train_Loss:0.3740, total_loss:tensor([0.3740], device='cuda:0')
2026-01-24 15:41:54.467 | INFO     | __main__:main_worker:382 - [50/100], remain:0d.00h.20m, It:[50/54], Max-Mem:12325M, Data-Time:1.274, LR:0.0001, Train_Loss:0.3245, total_loss:tensor([0.3245], device='cuda:0')
2026-01-24 15:41:55.806 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 50
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.7066
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.7596
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.6794
Local prototype push completed!
2026-01-24 15:42:21.949 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:42:30.196 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [50/100], Top1:78.419, Top3:100.000, Test_precision:0.7512,Test_recall:0.6419,Test_f1:0.6781,,Test_specificity:0.8405 Test_loss:0.503760
acc1: 78.4188, acc3: 100.0000, Precision: 0.7512, Recall: 0.6419, F1-Score: 0.6781, Specificity: 0.8405
2026-01-24 15:42:30.197 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:42:37.097 | INFO     | __main__:main_worker:320 - ---> start train epoch51
2026-01-24 15:42:46.195 | INFO     | __main__:main_worker:382 - [51/100], remain:0d.00h.17m, It:[10/54], Max-Mem:12325M, Data-Time:0.457, LR:0.0001, Train_Loss:0.3412, total_loss:tensor([0.3412], device='cuda:0')
2026-01-24 15:42:50.341 | INFO     | __main__:main_worker:382 - [51/100], remain:0d.00h.17m, It:[20/54], Max-Mem:12325M, Data-Time:0.596, LR:0.0001, Train_Loss:0.3796, total_loss:tensor([0.3796], device='cuda:0')
2026-01-24 15:42:54.565 | INFO     | __main__:main_worker:382 - [51/100], remain:0d.00h.17m, It:[30/54], Max-Mem:12325M, Data-Time:0.153, LR:0.0001, Train_Loss:0.2096, total_loss:tensor([0.2096], device='cuda:0')
2026-01-24 15:42:59.950 | INFO     | __main__:main_worker:382 - [51/100], remain:0d.00h.19m, It:[40/54], Max-Mem:12325M, Data-Time:0.632, LR:0.0001, Train_Loss:0.1461, total_loss:tensor([0.1461], device='cuda:0')
2026-01-24 15:43:04.597 | INFO     | __main__:main_worker:382 - [51/100], remain:0d.00h.19m, It:[50/54], Max-Mem:12325M, Data-Time:1.135, LR:0.0000, Train_Loss:0.5571, total_loss:tensor([0.5571], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
acc1: 75.6410, acc3: 100.0000, Precision: 0.6870, Recall: 0.6539, F1-Score: 0.6639, Specificity: 0.8238
2026-01-24 15:43:14.194 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [51/100], Top1:75.641, Top3:100.000, Test_precision:0.6870,Test_recall:0.6539,Test_f1:0.6639,,Test_specificity:0.8238 Test_loss:0.549598
2026-01-24 15:43:14.196 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:43:14.197 | INFO     | __main__:main_worker:320 - ---> start train epoch52
2026-01-24 15:43:22.830 | INFO     | __main__:main_worker:382 - [52/100], remain:0d.00h.20m, It:[10/54], Max-Mem:12325M, Data-Time:0.020, LR:0.0000, Train_Loss:0.2791, total_loss:tensor([0.2791], device='cuda:0')
2026-01-24 15:43:27.680 | INFO     | __main__:main_worker:382 - [52/100], remain:0d.00h.20m, It:[20/54], Max-Mem:12325M, Data-Time:0.019, LR:0.0000, Train_Loss:0.2030, total_loss:tensor([0.2030], device='cuda:0')
2026-01-24 15:43:33.038 | INFO     | __main__:main_worker:382 - [52/100], remain:0d.00h.21m, It:[30/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0000, Train_Loss:0.3876, total_loss:tensor([0.3876], device='cuda:0')
2026-01-24 15:43:37.421 | INFO     | __main__:main_worker:382 - [52/100], remain:0d.00h.20m, It:[40/54], Max-Mem:12325M, Data-Time:0.016, LR:0.0000, Train_Loss:0.4840, total_loss:tensor([0.4840], device='cuda:0')
2026-01-24 15:43:41.157 | INFO     | __main__:main_worker:382 - [52/100], remain:0d.00h.19m, It:[50/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0000, Train_Loss:0.6191, total_loss:tensor([0.6191], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
acc1: 79.2735, acc3: 100.0000, Precision: 0.7337, Recall: 0.6783, F1-Score: 0.7007, Specificity: 0.8566
2026-01-24 15:43:52.479 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [52/100], Top1:79.274, Top3:100.000, Test_precision:0.7337,Test_recall:0.6783,Test_f1:0.7007,,Test_specificity:0.8566 Test_loss:0.521953
2026-01-24 15:43:52.480 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:43:52.481 | INFO     | __main__:main_worker:320 - ---> start train epoch53
2026-01-24 15:44:01.686 | INFO     | __main__:main_worker:382 - [53/100], remain:0d.00h.21m, It:[10/54], Max-Mem:12325M, Data-Time:1.085, LR:0.0000, Train_Loss:0.4046, total_loss:tensor([0.4046], device='cuda:0')
2026-01-24 15:44:05.969 | INFO     | __main__:main_worker:382 - [53/100], remain:0d.00h.19m, It:[20/54], Max-Mem:12325M, Data-Time:0.630, LR:0.0000, Train_Loss:0.2588, total_loss:tensor([0.2588], device='cuda:0')
2026-01-24 15:44:10.441 | INFO     | __main__:main_worker:382 - [53/100], remain:0d.00h.19m, It:[30/54], Max-Mem:12325M, Data-Time:0.491, LR:0.0000, Train_Loss:0.2679, total_loss:tensor([0.2679], device='cuda:0')
2026-01-24 15:44:14.846 | INFO     | __main__:main_worker:382 - [53/100], remain:0d.00h.18m, It:[40/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.8874, total_loss:tensor([0.8874], device='cuda:0')
2026-01-24 15:44:20.173 | INFO     | __main__:main_worker:382 - [53/100], remain:0d.00h.19m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.4957, total_loss:tensor([0.4957], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
acc1: 78.8462, acc3: 100.0000, Precision: 0.6946, Recall: 0.6588, F1-Score: 0.6717, Specificity: 0.8600
2026-01-24 15:44:31.171 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [53/100], Top1:78.846, Top3:100.000, Test_precision:0.6946,Test_recall:0.6588,Test_f1:0.6717,,Test_specificity:0.8600 Test_loss:0.509916
2026-01-24 15:44:31.172 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [19/100], Top1:80.556, Top-3:100.000
2026-01-24 15:44:31.173 | INFO     | __main__:main_worker:320 - ---> start train epoch54
2026-01-24 15:44:41.308 | INFO     | __main__:main_worker:382 - [54/100], remain:0d.00h.20m, It:[10/54], Max-Mem:12325M, Data-Time:1.192, LR:0.0000, Train_Loss:0.2349, total_loss:tensor([0.2349], device='cuda:0')
2026-01-24 15:44:45.160 | INFO     | __main__:main_worker:382 - [54/100], remain:0d.00h.17m, It:[20/54], Max-Mem:12325M, Data-Time:0.178, LR:0.0000, Train_Loss:0.5134, total_loss:tensor([0.5134], device='cuda:0')
2026-01-24 15:44:49.589 | INFO     | __main__:main_worker:382 - [54/100], remain:0d.00h.17m, It:[30/54], Max-Mem:12325M, Data-Time:0.942, LR:0.0000, Train_Loss:0.5381, total_loss:tensor([0.5381], device='cuda:0')
2026-01-24 15:44:53.565 | INFO     | __main__:main_worker:382 - [54/100], remain:0d.00h.17m, It:[40/54], Max-Mem:12325M, Data-Time:0.478, LR:0.0000, Train_Loss:0.4329, total_loss:tensor([0.4329], device='cuda:0')
2026-01-24 15:44:58.201 | INFO     | __main__:main_worker:382 - [54/100], remain:0d.00h.17m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.4238, total_loss:tensor([0.4238], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
2026-01-24 15:45:08.390 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [54/100], Top1:81.410, Top3:100.000, Test_precision:0.7849,Test_recall:0.6352,Test_f1:0.6636,,Test_specificity:0.8632 Test_loss:0.482835
2026-01-24 15:45:08.391 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
acc1: 81.4103, acc3: 100.0000, Precision: 0.7849, Recall: 0.6352, F1-Score: 0.6636, Specificity: 0.8632
2026-01-24 15:45:20.897 | INFO     | __main__:main_worker:320 - ---> start train epoch55
2026-01-24 15:45:30.865 | INFO     | __main__:main_worker:382 - [55/100], remain:0d.00h.18m, It:[10/54], Max-Mem:12325M, Data-Time:0.943, LR:0.0000, Train_Loss:0.3720, total_loss:tensor([0.3720], device='cuda:0')
2026-01-24 15:45:35.412 | INFO     | __main__:main_worker:382 - [55/100], remain:0d.00h.18m, It:[20/54], Max-Mem:12325M, Data-Time:1.051, LR:0.0000, Train_Loss:0.2490, total_loss:tensor([0.2490], device='cuda:0')
2026-01-24 15:45:40.675 | INFO     | __main__:main_worker:382 - [55/100], remain:0d.00h.19m, It:[30/54], Max-Mem:12325M, Data-Time:1.742, LR:0.0000, Train_Loss:0.3067, total_loss:tensor([0.3067], device='cuda:0')
2026-01-24 15:45:44.732 | INFO     | __main__:main_worker:382 - [55/100], remain:0d.00h.18m, It:[40/54], Max-Mem:12325M, Data-Time:0.546, LR:0.0000, Train_Loss:0.3415, total_loss:tensor([0.3415], device='cuda:0')
2026-01-24 15:45:48.846 | INFO     | __main__:main_worker:382 - [55/100], remain:0d.00h.17m, It:[50/54], Max-Mem:12325M, Data-Time:0.561, LR:0.0000, Train_Loss:0.5245, total_loss:tensor([0.5245], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.85it/s]
2026-01-24 15:45:58.452 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [55/100], Top1:77.137, Top3:100.000, Test_precision:0.7000,Test_recall:0.6918,Test_f1:0.6944,,Test_specificity:0.8437 Test_loss:0.521781
2026-01-24 15:45:58.453 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:45:58.454 | INFO     | __main__:main_worker:320 - ---> start train epoch56
acc1: 77.1368, acc3: 100.0000, Precision: 0.7000, Recall: 0.6918, F1-Score: 0.6944, Specificity: 0.8437
2026-01-24 15:46:08.033 | INFO     | __main__:main_worker:382 - [56/100], remain:0d.00h.18m, It:[10/54], Max-Mem:12325M, Data-Time:1.213, LR:0.0000, Train_Loss:0.3584, total_loss:tensor([0.3584], device='cuda:0')
2026-01-24 15:46:13.043 | INFO     | __main__:main_worker:382 - [56/100], remain:0d.00h.18m, It:[20/54], Max-Mem:12325M, Data-Time:1.464, LR:0.0000, Train_Loss:0.8343, total_loss:tensor([0.8343], device='cuda:0')
2026-01-24 15:46:17.614 | INFO     | __main__:main_worker:382 - [56/100], remain:0d.00h.18m, It:[30/54], Max-Mem:12325M, Data-Time:1.020, LR:0.0000, Train_Loss:0.4198, total_loss:tensor([0.4198], device='cuda:0')
2026-01-24 15:46:21.286 | INFO     | __main__:main_worker:382 - [56/100], remain:0d.00h.17m, It:[40/54], Max-Mem:12325M, Data-Time:0.072, LR:0.0000, Train_Loss:0.5299, total_loss:tensor([0.5299], device='cuda:0')
2026-01-24 15:46:24.914 | INFO     | __main__:main_worker:382 - [56/100], remain:0d.00h.16m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.3795, total_loss:tensor([0.3795], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:46:34.761 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [56/100], Top1:77.991, Top3:100.000, Test_precision:0.7326,Test_recall:0.6559,Test_f1:0.6846,,Test_specificity:0.8446 Test_loss:0.535041
acc1: 77.9915, acc3: 100.0000, Precision: 0.7326, Recall: 0.6559, F1-Score: 0.6846, Specificity: 0.8446
2026-01-24 15:46:34.763 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:46:34.763 | INFO     | __main__:main_worker:320 - ---> start train epoch57
2026-01-24 15:46:42.846 | INFO     | __main__:main_worker:382 - [57/100], remain:0d.00h.16m, It:[10/54], Max-Mem:12325M, Data-Time:0.502, LR:0.0000, Train_Loss:0.4184, total_loss:tensor([0.4184], device='cuda:0')
2026-01-24 15:46:47.542 | INFO     | __main__:main_worker:382 - [57/100], remain:0d.00h.17m, It:[20/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0000, Train_Loss:0.4789, total_loss:tensor([0.4789], device='cuda:0')
2026-01-24 15:46:52.269 | INFO     | __main__:main_worker:382 - [57/100], remain:0d.00h.17m, It:[30/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0000, Train_Loss:0.2628, total_loss:tensor([0.2628], device='cuda:0')
2026-01-24 15:46:56.625 | INFO     | __main__:main_worker:382 - [57/100], remain:0d.00h.17m, It:[40/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0000, Train_Loss:0.5277, total_loss:tensor([0.5277], device='cuda:0')
2026-01-24 15:47:01.545 | INFO     | __main__:main_worker:382 - [57/100], remain:0d.00h.17m, It:[50/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0000, Train_Loss:0.5255, total_loss:tensor([0.5255], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
2026-01-24 15:47:11.122 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [57/100], Top1:78.205, Top3:100.000, Test_precision:0.7086,Test_recall:0.7084,Test_f1:0.7084,,Test_specificity:0.8570 Test_loss:0.541896
2026-01-24 15:47:11.123 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:47:11.124 | INFO     | __main__:main_worker:320 - ---> start train epoch58
acc1: 78.2051, acc3: 100.0000, Precision: 0.7086, Recall: 0.7084, F1-Score: 0.7084, Specificity: 0.8570
2026-01-24 15:47:20.467 | INFO     | __main__:main_worker:382 - [58/100], remain:0d.00h.19m, It:[10/54], Max-Mem:12325M, Data-Time:1.428, LR:0.0000, Train_Loss:0.0621, total_loss:tensor([0.0621], device='cuda:0')
2026-01-24 15:47:24.598 | INFO     | __main__:main_worker:382 - [58/100], remain:0d.00h.17m, It:[20/54], Max-Mem:12325M, Data-Time:0.496, LR:0.0000, Train_Loss:0.4294, total_loss:tensor([0.4294], device='cuda:0')
2026-01-24 15:47:29.217 | INFO     | __main__:main_worker:382 - [58/100], remain:0d.00h.17m, It:[30/54], Max-Mem:12325M, Data-Time:0.415, LR:0.0000, Train_Loss:0.3126, total_loss:tensor([0.3126], device='cuda:0')
2026-01-24 15:47:34.124 | INFO     | __main__:main_worker:382 - [58/100], remain:0d.00h.17m, It:[40/54], Max-Mem:12325M, Data-Time:0.711, LR:0.0000, Train_Loss:0.7721, total_loss:tensor([0.7721], device='cuda:0')
2026-01-24 15:47:38.357 | INFO     | __main__:main_worker:382 - [58/100], remain:0d.00h.17m, It:[50/54], Max-Mem:12325M, Data-Time:0.690, LR:0.0000, Train_Loss:0.2763, total_loss:tensor([0.2763], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
acc1: 77.7778, acc3: 100.0000, Precision: 0.7249, Recall: 0.6863, F1-Score: 0.7027, Specificity: 0.8409
2026-01-24 15:47:48.686 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [58/100], Top1:77.778, Top3:100.000, Test_precision:0.7249,Test_recall:0.6863,Test_f1:0.7027,,Test_specificity:0.8409 Test_loss:0.528990
2026-01-24 15:47:48.687 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:47:48.688 | INFO     | __main__:main_worker:320 - ---> start train epoch59
2026-01-24 15:47:59.037 | INFO     | __main__:main_worker:382 - [59/100], remain:0d.00h.20m, It:[10/54], Max-Mem:12325M, Data-Time:1.912, LR:0.0000, Train_Loss:0.3897, total_loss:tensor([0.3897], device='cuda:0')
2026-01-24 15:48:02.968 | INFO     | __main__:main_worker:382 - [59/100], remain:0d.00h.17m, It:[20/54], Max-Mem:12325M, Data-Time:0.464, LR:0.0000, Train_Loss:0.4633, total_loss:tensor([0.4633], device='cuda:0')
2026-01-24 15:48:08.165 | INFO     | __main__:main_worker:382 - [59/100], remain:0d.00h.17m, It:[30/54], Max-Mem:12325M, Data-Time:1.675, LR:0.0000, Train_Loss:0.7742, total_loss:tensor([0.7742], device='cuda:0')
2026-01-24 15:48:12.297 | INFO     | __main__:main_worker:382 - [59/100], remain:0d.00h.16m, It:[40/54], Max-Mem:12325M, Data-Time:0.586, LR:0.0000, Train_Loss:0.2895, total_loss:tensor([0.2895], device='cuda:0')
2026-01-24 15:48:16.464 | INFO     | __main__:main_worker:382 - [59/100], remain:0d.00h.16m, It:[50/54], Max-Mem:12325M, Data-Time:0.405, LR:0.0000, Train_Loss:0.2152, total_loss:tensor([0.2152], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
acc1: 76.0684, acc3: 100.0000, Precision: 0.7168, Recall: 0.6004, F1-Score: 0.6343, Specificity: 0.8229
2026-01-24 15:48:27.264 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [59/100], Top1:76.068, Top3:100.000, Test_precision:0.7168,Test_recall:0.6004,Test_f1:0.6343,,Test_specificity:0.8229 Test_loss:0.507547
2026-01-24 15:48:27.265 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:48:27.266 | INFO     | __main__:main_worker:320 - ---> start train epoch60
2026-01-24 15:48:36.657 | INFO     | __main__:main_worker:382 - [60/100], remain:0d.00h.20m, It:[10/54], Max-Mem:12325M, Data-Time:0.892, LR:0.0000, Train_Loss:0.1674, total_loss:tensor([0.1674], device='cuda:0')
2026-01-24 15:48:41.206 | INFO     | __main__:main_worker:382 - [60/100], remain:0d.00h.18m, It:[20/54], Max-Mem:12325M, Data-Time:0.288, LR:0.0000, Train_Loss:0.7248, total_loss:tensor([0.7248], device='cuda:0')
2026-01-24 15:48:45.556 | INFO     | __main__:main_worker:382 - [60/100], remain:0d.00h.17m, It:[30/54], Max-Mem:12325M, Data-Time:0.015, LR:0.0000, Train_Loss:0.2136, total_loss:tensor([0.2136], device='cuda:0')
2026-01-24 15:48:50.240 | INFO     | __main__:main_worker:382 - [60/100], remain:0d.00h.16m, It:[40/54], Max-Mem:12325M, Data-Time:0.659, LR:0.0000, Train_Loss:0.7399, total_loss:tensor([0.7399], device='cuda:0')
2026-01-24 15:48:55.548 | INFO     | __main__:main_worker:382 - [60/100], remain:0d.00h.17m, It:[50/54], Max-Mem:12325M, Data-Time:0.955, LR:0.0000, Train_Loss:0.4493, total_loss:tensor([0.4493], device='cuda:0')
2026-01-24 15:48:57.769 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 60
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.6941
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.7498
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.6680
Local prototype push completed!
2026-01-24 15:49:23.155 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
acc1: 74.7863, acc3: 100.0000, Precision: 0.6924, Recall: 0.5584, F1-Score: 0.5877, Specificity: 0.8092
2026-01-24 15:49:31.425 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [60/100], Top1:74.786, Top3:100.000, Test_precision:0.6924,Test_recall:0.5584,Test_f1:0.5877,,Test_specificity:0.8092 Test_loss:0.509368
2026-01-24 15:49:31.427 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:49:38.785 | INFO     | __main__:main_worker:320 - ---> start train epoch61
2026-01-24 15:49:48.954 | INFO     | __main__:main_worker:382 - [61/100], remain:0d.00h.20m, It:[10/54], Max-Mem:12325M, Data-Time:1.347, LR:0.0000, Train_Loss:0.4885, total_loss:tensor([0.4885], device='cuda:0')
2026-01-24 15:49:52.776 | INFO     | __main__:main_worker:382 - [61/100], remain:0d.00h.16m, It:[20/54], Max-Mem:12325M, Data-Time:0.338, LR:0.0000, Train_Loss:0.3882, total_loss:tensor([0.3882], device='cuda:0')
2026-01-24 15:49:57.648 | INFO     | __main__:main_worker:382 - [61/100], remain:0d.00h.16m, It:[30/54], Max-Mem:12325M, Data-Time:0.981, LR:0.0000, Train_Loss:0.5075, total_loss:tensor([0.5075], device='cuda:0')
2026-01-24 15:50:01.639 | INFO     | __main__:main_worker:382 - [61/100], remain:0d.00h.15m, It:[40/54], Max-Mem:12325M, Data-Time:0.310, LR:0.0000, Train_Loss:0.2887, total_loss:tensor([0.2887], device='cuda:0')
2026-01-24 15:50:06.557 | INFO     | __main__:main_worker:382 - [61/100], remain:0d.00h.15m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.4413, total_loss:tensor([0.4413], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
acc1: 79.4872, acc3: 100.0000, Precision: 0.7133, Recall: 0.7169, F1-Score: 0.7141, Specificity: 0.8750
2026-01-24 15:50:16.989 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [61/100], Top1:79.487, Top3:100.000, Test_precision:0.7133,Test_recall:0.7169,Test_f1:0.7141,,Test_specificity:0.8750 Test_loss:0.531302
2026-01-24 15:50:16.991 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:50:16.991 | INFO     | __main__:main_worker:320 - ---> start train epoch62
2026-01-24 15:50:26.507 | INFO     | __main__:main_worker:382 - [62/100], remain:0d.00h.14m, It:[10/54], Max-Mem:12325M, Data-Time:0.817, LR:0.0000, Train_Loss:0.1099, total_loss:tensor([0.1099], device='cuda:0')
2026-01-24 15:50:31.201 | INFO     | __main__:main_worker:382 - [62/100], remain:0d.00h.15m, It:[20/54], Max-Mem:12325M, Data-Time:1.219, LR:0.0000, Train_Loss:-0.0209, total_loss:tensor([-0.0209], device='cuda:0')
2026-01-24 15:50:35.392 | INFO     | __main__:main_worker:382 - [62/100], remain:0d.00h.14m, It:[30/54], Max-Mem:12325M, Data-Time:0.542, LR:0.0000, Train_Loss:0.5296, total_loss:tensor([0.5296], device='cuda:0')
2026-01-24 15:50:39.879 | INFO     | __main__:main_worker:382 - [62/100], remain:0d.00h.14m, It:[40/54], Max-Mem:12325M, Data-Time:0.862, LR:0.0000, Train_Loss:0.2234, total_loss:tensor([0.2234], device='cuda:0')
2026-01-24 15:50:43.794 | INFO     | __main__:main_worker:382 - [62/100], remain:0d.00h.14m, It:[50/54], Max-Mem:12325M, Data-Time:0.114, LR:0.0000, Train_Loss:0.2148, total_loss:tensor([0.2148], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
2026-01-24 15:50:54.870 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [62/100], Top1:75.214, Top3:100.000, Test_precision:0.7030,Test_recall:0.6785,Test_f1:0.6869,,Test_specificity:0.8226 Test_loss:0.521446
2026-01-24 15:50:54.871 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:50:54.872 | INFO     | __main__:main_worker:320 - ---> start train epoch63
acc1: 75.2137, acc3: 100.0000, Precision: 0.7030, Recall: 0.6785, F1-Score: 0.6869, Specificity: 0.8226
2026-01-24 15:51:06.481 | INFO     | __main__:main_worker:382 - [63/100], remain:0d.00h.19m, It:[10/54], Max-Mem:12325M, Data-Time:2.280, LR:0.0000, Train_Loss:0.3149, total_loss:tensor([0.3149], device='cuda:0')
2026-01-24 15:51:10.982 | INFO     | __main__:main_worker:382 - [63/100], remain:0d.00h.17m, It:[20/54], Max-Mem:12325M, Data-Time:0.978, LR:0.0000, Train_Loss:0.2920, total_loss:tensor([0.2920], device='cuda:0')
2026-01-24 15:51:15.335 | INFO     | __main__:main_worker:382 - [63/100], remain:0d.00h.16m, It:[30/54], Max-Mem:12325M, Data-Time:0.781, LR:0.0000, Train_Loss:0.2829, total_loss:tensor([0.2829], device='cuda:0')
2026-01-24 15:51:18.963 | INFO     | __main__:main_worker:382 - [63/100], remain:0d.00h.14m, It:[40/54], Max-Mem:12325M, Data-Time:0.153, LR:0.0000, Train_Loss:0.3966, total_loss:tensor([0.3966], device='cuda:0')
2026-01-24 15:51:24.685 | INFO     | __main__:main_worker:382 - [63/100], remain:0d.00h.15m, It:[50/54], Max-Mem:12325M, Data-Time:2.162, LR:0.0000, Train_Loss:0.3736, total_loss:tensor([0.3736], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
2026-01-24 15:51:34.554 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [63/100], Top1:72.436, Top3:100.000, Test_precision:0.6913,Test_recall:0.6056,Test_f1:0.6363,,Test_specificity:0.7951 Test_loss:0.544450
acc1: 72.4359, acc3: 100.0000, Precision: 0.6913, Recall: 0.6056, F1-Score: 0.6363, Specificity: 0.7951
2026-01-24 15:51:34.555 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:51:34.556 | INFO     | __main__:main_worker:320 - ---> start train epoch64
2026-01-24 15:51:43.133 | INFO     | __main__:main_worker:382 - [64/100], remain:0d.00h.17m, It:[10/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0000, Train_Loss:0.2966, total_loss:tensor([0.2966], device='cuda:0')
2026-01-24 15:51:48.759 | INFO     | __main__:main_worker:382 - [64/100], remain:0d.00h.17m, It:[20/54], Max-Mem:12325M, Data-Time:0.007, LR:0.0000, Train_Loss:0.1880, total_loss:tensor([0.1880], device='cuda:0')
2026-01-24 15:51:53.067 | INFO     | __main__:main_worker:382 - [64/100], remain:0d.00h.16m, It:[30/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0000, Train_Loss:0.1403, total_loss:tensor([0.1403], device='cuda:0')
2026-01-24 15:51:57.334 | INFO     | __main__:main_worker:382 - [64/100], remain:0d.00h.15m, It:[40/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.7908, total_loss:tensor([0.7908], device='cuda:0')
2026-01-24 15:52:02.585 | INFO     | __main__:main_worker:382 - [64/100], remain:0d.00h.15m, It:[50/54], Max-Mem:12325M, Data-Time:0.007, LR:0.0000, Train_Loss:0.2416, total_loss:tensor([0.2416], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
2026-01-24 15:52:13.837 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [64/100], Top1:77.350, Top3:100.000, Test_precision:0.7384,Test_recall:0.6684,Test_f1:0.6962,,Test_specificity:0.8333 Test_loss:0.577514
acc1: 77.3504, acc3: 100.0000, Precision: 0.7384, Recall: 0.6684, F1-Score: 0.6962, Specificity: 0.8333
2026-01-24 15:52:13.839 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:52:13.839 | INFO     | __main__:main_worker:320 - ---> start train epoch65
2026-01-24 15:52:23.377 | INFO     | __main__:main_worker:382 - [65/100], remain:0d.00h.14m, It:[10/54], Max-Mem:12325M, Data-Time:1.176, LR:0.0000, Train_Loss:0.3760, total_loss:tensor([0.3760], device='cuda:0')
2026-01-24 15:52:27.295 | INFO     | __main__:main_worker:382 - [65/100], remain:0d.00h.13m, It:[20/54], Max-Mem:12325M, Data-Time:0.383, LR:0.0000, Train_Loss:0.3789, total_loss:tensor([0.3789], device='cuda:0')
2026-01-24 15:52:31.458 | INFO     | __main__:main_worker:382 - [65/100], remain:0d.00h.13m, It:[30/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.1286, total_loss:tensor([0.1286], device='cuda:0')
2026-01-24 15:52:36.802 | INFO     | __main__:main_worker:382 - [65/100], remain:0d.00h.13m, It:[40/54], Max-Mem:12325M, Data-Time:0.731, LR:0.0000, Train_Loss:0.4611, total_loss:tensor([0.4611], device='cuda:0')
2026-01-24 15:52:42.199 | INFO     | __main__:main_worker:382 - [65/100], remain:0d.00h.14m, It:[50/54], Max-Mem:12325M, Data-Time:0.028, LR:0.0000, Train_Loss:0.4606, total_loss:tensor([0.4606], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
acc1: 78.2051, acc3: 100.0000, Precision: 0.7628, Recall: 0.6487, F1-Score: 0.6877, Specificity: 0.8392
2026-01-24 15:52:52.963 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [65/100], Top1:78.205, Top3:100.000, Test_precision:0.7628,Test_recall:0.6487,Test_f1:0.6877,,Test_specificity:0.8392 Test_loss:0.520949
2026-01-24 15:52:52.965 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:52:52.966 | INFO     | __main__:main_worker:320 - ---> start train epoch66
2026-01-24 15:53:01.575 | INFO     | __main__:main_worker:382 - [66/100], remain:0d.00h.11m, It:[10/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.2806, total_loss:tensor([0.2806], device='cuda:0')
2026-01-24 15:53:06.157 | INFO     | __main__:main_worker:382 - [66/100], remain:0d.00h.12m, It:[20/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.4442, total_loss:tensor([0.4442], device='cuda:0')
2026-01-24 15:53:11.149 | INFO     | __main__:main_worker:382 - [66/100], remain:0d.00h.13m, It:[30/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.5116, total_loss:tensor([0.5116], device='cuda:0')
2026-01-24 15:53:15.223 | INFO     | __main__:main_worker:382 - [66/100], remain:0d.00h.13m, It:[40/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.4743, total_loss:tensor([0.4743], device='cuda:0')
2026-01-24 15:53:19.855 | INFO     | __main__:main_worker:382 - [66/100], remain:0d.00h.13m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.2590, total_loss:tensor([0.2590], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
acc1: 70.2991, acc3: 100.0000, Precision: 0.6788, Recall: 0.5601, F1-Score: 0.5937, Specificity: 0.7670
2026-01-24 15:53:29.943 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [66/100], Top1:70.299, Top3:100.000, Test_precision:0.6788,Test_recall:0.5601,Test_f1:0.5937,,Test_specificity:0.7670 Test_loss:0.527925
2026-01-24 15:53:29.944 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:53:29.945 | INFO     | __main__:main_worker:320 - ---> start train epoch67
2026-01-24 15:53:39.067 | INFO     | __main__:main_worker:382 - [67/100], remain:0d.00h.13m, It:[10/54], Max-Mem:12325M, Data-Time:0.528, LR:0.0000, Train_Loss:0.5094, total_loss:tensor([0.5094], device='cuda:0')
2026-01-24 15:53:44.071 | INFO     | __main__:main_worker:382 - [67/100], remain:0d.00h.14m, It:[20/54], Max-Mem:12325M, Data-Time:0.019, LR:0.0000, Train_Loss:0.4136, total_loss:tensor([0.4136], device='cuda:0')
2026-01-24 15:53:48.374 | INFO     | __main__:main_worker:382 - [67/100], remain:0d.00h.13m, It:[30/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.3322, total_loss:tensor([0.3322], device='cuda:0')
2026-01-24 15:53:53.083 | INFO     | __main__:main_worker:382 - [67/100], remain:0d.00h.13m, It:[40/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.0947, total_loss:tensor([0.0947], device='cuda:0')
2026-01-24 15:53:58.131 | INFO     | __main__:main_worker:382 - [67/100], remain:0d.00h.13m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.6364, total_loss:tensor([0.6364], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
2026-01-24 15:54:08.673 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [67/100], Top1:66.239, Top3:100.000, Test_precision:0.6063,Test_recall:0.5579,Test_f1:0.5669,,Test_specificity:0.7426 Test_loss:0.570772
acc1: 66.2393, acc3: 100.0000, Precision: 0.6063, Recall: 0.5579, F1-Score: 0.5669, Specificity: 0.7426
2026-01-24 15:54:08.674 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:54:08.675 | INFO     | __main__:main_worker:320 - ---> start train epoch68
2026-01-24 15:54:16.937 | INFO     | __main__:main_worker:382 - [68/100], remain:0d.00h.13m, It:[10/54], Max-Mem:12325M, Data-Time:0.038, LR:0.0000, Train_Loss:0.3725, total_loss:tensor([0.3725], device='cuda:0')
2026-01-24 15:54:21.177 | INFO     | __main__:main_worker:382 - [68/100], remain:0d.00h.12m, It:[20/54], Max-Mem:12325M, Data-Time:0.345, LR:0.0000, Train_Loss:0.2681, total_loss:tensor([0.2681], device='cuda:0')
2026-01-24 15:54:25.808 | INFO     | __main__:main_worker:382 - [68/100], remain:0d.00h.12m, It:[30/54], Max-Mem:12325M, Data-Time:0.550, LR:0.0000, Train_Loss:0.5049, total_loss:tensor([0.5049], device='cuda:0')
2026-01-24 15:54:30.581 | INFO     | __main__:main_worker:382 - [68/100], remain:0d.00h.12m, It:[40/54], Max-Mem:12325M, Data-Time:0.023, LR:0.0000, Train_Loss:0.3895, total_loss:tensor([0.3895], device='cuda:0')
2026-01-24 15:54:36.516 | INFO     | __main__:main_worker:382 - [68/100], remain:0d.00h.13m, It:[50/54], Max-Mem:12325M, Data-Time:0.020, LR:0.0000, Train_Loss:0.2256, total_loss:tensor([0.2256], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
acc1: 74.1453, acc3: 100.0000, Precision: 0.6943, Recall: 0.6363, F1-Score: 0.6585, Specificity: 0.8113
2026-01-24 15:54:47.162 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [68/100], Top1:74.145, Top3:100.000, Test_precision:0.6943,Test_recall:0.6363,Test_f1:0.6585,,Test_specificity:0.8113 Test_loss:0.506421
2026-01-24 15:54:47.163 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:54:47.163 | INFO     | __main__:main_worker:320 - ---> start train epoch69
2026-01-24 15:54:56.516 | INFO     | __main__:main_worker:382 - [69/100], remain:0d.00h.13m, It:[10/54], Max-Mem:12325M, Data-Time:1.435, LR:0.0000, Train_Loss:0.6870, total_loss:tensor([0.6870], device='cuda:0')
2026-01-24 15:55:01.233 | INFO     | __main__:main_worker:382 - [69/100], remain:0d.00h.13m, It:[20/54], Max-Mem:12325M, Data-Time:1.193, LR:0.0000, Train_Loss:0.4281, total_loss:tensor([0.4281], device='cuda:0')
2026-01-24 15:55:05.481 | INFO     | __main__:main_worker:382 - [69/100], remain:0d.00h.12m, It:[30/54], Max-Mem:12325M, Data-Time:0.636, LR:0.0000, Train_Loss:0.6485, total_loss:tensor([0.6485], device='cuda:0')
2026-01-24 15:55:10.476 | INFO     | __main__:main_worker:382 - [69/100], remain:0d.00h.12m, It:[40/54], Max-Mem:12325M, Data-Time:0.776, LR:0.0000, Train_Loss:0.1726, total_loss:tensor([0.1726], device='cuda:0')
2026-01-24 15:55:16.135 | INFO     | __main__:main_worker:382 - [69/100], remain:0d.00h.13m, It:[50/54], Max-Mem:12325M, Data-Time:2.122, LR:0.0000, Train_Loss:0.1252, total_loss:tensor([0.1252], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:55:25.706 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [69/100], Top1:69.658, Top3:100.000, Test_precision:0.6504,Test_recall:0.5757,Test_f1:0.6002,,Test_specificity:0.7722 Test_loss:0.525913
acc1: 69.6581, acc3: 100.0000, Precision: 0.6504, Recall: 0.5757, F1-Score: 0.6002, Specificity: 0.7722
2026-01-24 15:55:25.707 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:55:25.708 | INFO     | __main__:main_worker:320 - ---> start train epoch70
2026-01-24 15:55:36.320 | INFO     | __main__:main_worker:382 - [70/100], remain:0d.00h.14m, It:[10/54], Max-Mem:12325M, Data-Time:1.886, LR:0.0000, Train_Loss:0.2883, total_loss:tensor([0.2883], device='cuda:0')
2026-01-24 15:55:40.197 | INFO     | __main__:main_worker:382 - [70/100], remain:0d.00h.12m, It:[20/54], Max-Mem:12325M, Data-Time:0.342, LR:0.0000, Train_Loss:0.4879, total_loss:tensor([0.4879], device='cuda:0')
2026-01-24 15:55:43.810 | INFO     | __main__:main_worker:382 - [70/100], remain:0d.00h.11m, It:[30/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.0883, total_loss:tensor([0.0883], device='cuda:0')
2026-01-24 15:55:48.494 | INFO     | __main__:main_worker:382 - [70/100], remain:0d.00h.11m, It:[40/54], Max-Mem:12325M, Data-Time:1.138, LR:0.0000, Train_Loss:0.4625, total_loss:tensor([0.4625], device='cuda:0')
2026-01-24 15:55:53.122 | INFO     | __main__:main_worker:382 - [70/100], remain:0d.00h.11m, It:[50/54], Max-Mem:12325M, Data-Time:1.093, LR:0.0000, Train_Loss:0.6061, total_loss:tensor([0.6061], device='cuda:0')
2026-01-24 15:55:54.456 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 70
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.6779
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.7253
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.6602
Local prototype push completed!
2026-01-24 15:56:19.914 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 15:56:28.185 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [70/100], Top1:66.880, Top3:100.000, Test_precision:0.6115,Test_recall:0.5390,Test_f1:0.5529,,Test_specificity:0.7418 Test_loss:0.535557
acc1: 66.8803, acc3: 100.0000, Precision: 0.6115, Recall: 0.5390, F1-Score: 0.5529, Specificity: 0.7418
2026-01-24 15:56:28.187 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:56:34.835 | INFO     | __main__:main_worker:320 - ---> start train epoch71
2026-01-24 15:56:44.068 | INFO     | __main__:main_worker:382 - [71/100], remain:0d.00h.13m, It:[10/54], Max-Mem:12325M, Data-Time:0.830, LR:0.0000, Train_Loss:0.3231, total_loss:tensor([0.3231], device='cuda:0')
2026-01-24 15:56:48.781 | INFO     | __main__:main_worker:382 - [71/100], remain:0d.00h.12m, It:[20/54], Max-Mem:12325M, Data-Time:1.123, LR:0.0000, Train_Loss:0.2772, total_loss:tensor([0.2772], device='cuda:0')
2026-01-24 15:56:52.861 | INFO     | __main__:main_worker:382 - [71/100], remain:0d.00h.11m, It:[30/54], Max-Mem:12325M, Data-Time:0.348, LR:0.0000, Train_Loss:0.1582, total_loss:tensor([0.1582], device='cuda:0')
2026-01-24 15:56:56.713 | INFO     | __main__:main_worker:382 - [71/100], remain:0d.00h.11m, It:[40/54], Max-Mem:12325M, Data-Time:0.250, LR:0.0000, Train_Loss:0.2875, total_loss:tensor([0.2875], device='cuda:0')
2026-01-24 15:57:02.012 | INFO     | __main__:main_worker:382 - [71/100], remain:0d.00h.11m, It:[50/54], Max-Mem:12325M, Data-Time:0.016, LR:0.0000, Train_Loss:0.4843, total_loss:tensor([0.4843], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
acc1: 70.7265, acc3: 100.0000, Precision: 0.6727, Recall: 0.6083, F1-Score: 0.6257, Specificity: 0.7756
2026-01-24 15:57:11.829 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [71/100], Top1:70.726, Top3:100.000, Test_precision:0.6727,Test_recall:0.6083,Test_f1:0.6257,,Test_specificity:0.7756 Test_loss:0.540498
2026-01-24 15:57:11.831 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:57:11.831 | INFO     | __main__:main_worker:320 - ---> start train epoch72
2026-01-24 15:57:20.336 | INFO     | __main__:main_worker:382 - [72/100], remain:0d.00h.10m, It:[10/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0000, Train_Loss:0.2152, total_loss:tensor([0.2152], device='cuda:0')
2026-01-24 15:57:25.463 | INFO     | __main__:main_worker:382 - [72/100], remain:0d.00h.11m, It:[20/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0000, Train_Loss:0.2487, total_loss:tensor([0.2487], device='cuda:0')
2026-01-24 15:57:30.408 | INFO     | __main__:main_worker:382 - [72/100], remain:0d.00h.11m, It:[30/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0000, Train_Loss:0.1649, total_loss:tensor([0.1649], device='cuda:0')
2026-01-24 15:57:34.828 | INFO     | __main__:main_worker:382 - [72/100], remain:0d.00h.11m, It:[40/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.1155, total_loss:tensor([0.1155], device='cuda:0')
2026-01-24 15:57:39.241 | INFO     | __main__:main_worker:382 - [72/100], remain:0d.00h.11m, It:[50/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.3130, total_loss:tensor([0.3130], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
acc1: 69.2308, acc3: 100.0000, Precision: 0.6638, Recall: 0.5504, F1-Score: 0.5821, Specificity: 0.7602
2026-01-24 15:57:50.036 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [72/100], Top1:69.231, Top3:100.000, Test_precision:0.6638,Test_recall:0.5504,Test_f1:0.5821,,Test_specificity:0.7602 Test_loss:0.583159
2026-01-24 15:57:50.037 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:57:50.038 | INFO     | __main__:main_worker:320 - ---> start train epoch73
2026-01-24 15:57:58.593 | INFO     | __main__:main_worker:382 - [73/100], remain:0d.00h.09m, It:[10/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.1549, total_loss:tensor([0.1549], device='cuda:0')
2026-01-24 15:58:03.354 | INFO     | __main__:main_worker:382 - [73/100], remain:0d.00h.10m, It:[20/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.4155, total_loss:tensor([0.4155], device='cuda:0')
2026-01-24 15:58:08.212 | INFO     | __main__:main_worker:382 - [73/100], remain:0d.00h.10m, It:[30/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0000, Train_Loss:0.1316, total_loss:tensor([0.1316], device='cuda:0')
2026-01-24 15:58:13.331 | INFO     | __main__:main_worker:382 - [73/100], remain:0d.00h.11m, It:[40/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.2808, total_loss:tensor([0.2808], device='cuda:0')
2026-01-24 15:58:17.533 | INFO     | __main__:main_worker:382 - [73/100], remain:0d.00h.10m, It:[50/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.1997, total_loss:tensor([0.1997], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2026-01-24 15:58:28.077 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [73/100], Top1:71.368, Top3:100.000, Test_precision:0.6545,Test_recall:0.6246,Test_f1:0.6264,,Test_specificity:0.7876 Test_loss:0.548086
2026-01-24 15:58:28.078 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:58:28.078 | INFO     | __main__:main_worker:320 - ---> start train epoch74
acc1: 71.3675, acc3: 100.0000, Precision: 0.6545, Recall: 0.6246, F1-Score: 0.6264, Specificity: 0.7876
2026-01-24 15:58:38.670 | INFO     | __main__:main_worker:382 - [74/100], remain:0d.00h.13m, It:[10/54], Max-Mem:12325M, Data-Time:2.259, LR:0.0000, Train_Loss:0.4016, total_loss:tensor([0.4016], device='cuda:0')
2026-01-24 15:58:43.213 | INFO     | __main__:main_worker:382 - [74/100], remain:0d.00h.12m, It:[20/54], Max-Mem:12325M, Data-Time:1.019, LR:0.0000, Train_Loss:0.3648, total_loss:tensor([0.3648], device='cuda:0')
2026-01-24 15:58:48.325 | INFO     | __main__:main_worker:382 - [74/100], remain:0d.00h.11m, It:[30/54], Max-Mem:12325M, Data-Time:1.595, LR:0.0000, Train_Loss:0.2762, total_loss:tensor([0.2762], device='cuda:0')
2026-01-24 15:58:54.152 | INFO     | __main__:main_worker:382 - [74/100], remain:0d.00h.12m, It:[40/54], Max-Mem:12325M, Data-Time:2.254, LR:0.0000, Train_Loss:0.3821, total_loss:tensor([0.3821], device='cuda:0')
2026-01-24 15:58:59.068 | INFO     | __main__:main_worker:382 - [74/100], remain:0d.00h.11m, It:[50/54], Max-Mem:12325M, Data-Time:1.377, LR:0.0000, Train_Loss:0.1974, total_loss:tensor([0.1974], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
2026-01-24 15:59:08.686 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [74/100], Top1:72.436, Top3:100.000, Test_precision:0.6749,Test_recall:0.6176,Test_f1:0.6376,,Test_specificity:0.7960 Test_loss:0.507784
acc1: 72.4359, acc3: 100.0000, Precision: 0.6749, Recall: 0.6176, F1-Score: 0.6376, Specificity: 0.7960
2026-01-24 15:59:08.687 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:59:08.688 | INFO     | __main__:main_worker:320 - ---> start train epoch75
2026-01-24 15:59:17.221 | INFO     | __main__:main_worker:382 - [75/100], remain:0d.00h.09m, It:[10/54], Max-Mem:12325M, Data-Time:0.557, LR:0.0000, Train_Loss:0.2813, total_loss:tensor([0.2813], device='cuda:0')
2026-01-24 15:59:21.820 | INFO     | __main__:main_worker:382 - [75/100], remain:0d.00h.09m, It:[20/54], Max-Mem:12325M, Data-Time:1.070, LR:0.0000, Train_Loss:0.4645, total_loss:tensor([0.4645], device='cuda:0')
2026-01-24 15:59:26.737 | INFO     | __main__:main_worker:382 - [75/100], remain:0d.00h.10m, It:[30/54], Max-Mem:12325M, Data-Time:1.390, LR:0.0000, Train_Loss:0.2133, total_loss:tensor([0.2133], device='cuda:0')
2026-01-24 15:59:31.788 | INFO     | __main__:main_worker:382 - [75/100], remain:0d.00h.10m, It:[40/54], Max-Mem:12325M, Data-Time:1.528, LR:0.0000, Train_Loss:0.0772, total_loss:tensor([0.0772], device='cuda:0')
2026-01-24 15:59:36.790 | INFO     | __main__:main_worker:382 - [75/100], remain:0d.00h.10m, It:[50/54], Max-Mem:12325M, Data-Time:1.475, LR:0.0000, Train_Loss:0.4216, total_loss:tensor([0.4216], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
acc1: 74.1453, acc3: 100.0000, Precision: 0.6907, Recall: 0.6586, F1-Score: 0.6682, Specificity: 0.8112
2026-01-24 15:59:46.385 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [75/100], Top1:74.145, Top3:100.000, Test_precision:0.6907,Test_recall:0.6586,Test_f1:0.6682,,Test_specificity:0.8112 Test_loss:0.519388
2026-01-24 15:59:46.386 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 15:59:46.387 | INFO     | __main__:main_worker:320 - ---> start train epoch76
2026-01-24 15:59:55.374 | INFO     | __main__:main_worker:382 - [76/100], remain:0d.00h.11m, It:[10/54], Max-Mem:12325M, Data-Time:1.141, LR:0.0000, Train_Loss:0.3451, total_loss:tensor([0.3451], device='cuda:0')
2026-01-24 16:00:00.225 | INFO     | __main__:main_worker:382 - [76/100], remain:0d.00h.10m, It:[20/54], Max-Mem:12325M, Data-Time:1.315, LR:0.0000, Train_Loss:0.3754, total_loss:tensor([0.3754], device='cuda:0')
2026-01-24 16:00:04.223 | INFO     | __main__:main_worker:382 - [76/100], remain:0d.00h.10m, It:[30/54], Max-Mem:12325M, Data-Time:0.408, LR:0.0000, Train_Loss:0.5005, total_loss:tensor([0.5005], device='cuda:0')
2026-01-24 16:00:08.745 | INFO     | __main__:main_worker:382 - [76/100], remain:0d.00h.09m, It:[40/54], Max-Mem:12325M, Data-Time:0.906, LR:0.0000, Train_Loss:0.1952, total_loss:tensor([0.1952], device='cuda:0')
2026-01-24 16:00:13.355 | INFO     | __main__:main_worker:382 - [76/100], remain:0d.00h.09m, It:[50/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.3773, total_loss:tensor([0.3773], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2026-01-24 16:00:23.294 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [76/100], Top1:67.735, Top3:100.000, Test_precision:0.6273,Test_recall:0.5518,Test_f1:0.5727,,Test_specificity:0.7539 Test_loss:0.554763
acc1: 67.7350, acc3: 100.0000, Precision: 0.6273, Recall: 0.5518, F1-Score: 0.5727, Specificity: 0.7539
2026-01-24 16:00:23.295 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 16:00:23.296 | INFO     | __main__:main_worker:320 - ---> start train epoch77
2026-01-24 16:00:32.683 | INFO     | __main__:main_worker:382 - [77/100], remain:0d.00h.10m, It:[10/54], Max-Mem:12325M, Data-Time:1.324, LR:0.0000, Train_Loss:0.2312, total_loss:tensor([0.2312], device='cuda:0')
2026-01-24 16:00:37.170 | INFO     | __main__:main_worker:382 - [77/100], remain:0d.00h.09m, It:[20/54], Max-Mem:12325M, Data-Time:0.676, LR:0.0000, Train_Loss:0.5392, total_loss:tensor([0.5392], device='cuda:0')
2026-01-24 16:00:41.965 | INFO     | __main__:main_worker:382 - [77/100], remain:0d.00h.09m, It:[30/54], Max-Mem:12325M, Data-Time:0.023, LR:0.0000, Train_Loss:0.3184, total_loss:tensor([0.3184], device='cuda:0')
2026-01-24 16:00:47.143 | INFO     | __main__:main_worker:382 - [77/100], remain:0d.00h.09m, It:[40/54], Max-Mem:12325M, Data-Time:0.016, LR:0.0000, Train_Loss:0.3248, total_loss:tensor([0.3248], device='cuda:0')
2026-01-24 16:00:52.194 | INFO     | __main__:main_worker:382 - [77/100], remain:0d.00h.09m, It:[50/54], Max-Mem:12325M, Data-Time:1.257, LR:0.0000, Train_Loss:0.2986, total_loss:tensor([0.2986], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
acc1: 67.3077, acc3: 100.0000, Precision: 0.6146, Recall: 0.5649, F1-Score: 0.5724, Specificity: 0.7497
2026-01-24 16:01:01.707 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [77/100], Top1:67.308, Top3:100.000, Test_precision:0.6146,Test_recall:0.5649,Test_f1:0.5724,,Test_specificity:0.7497 Test_loss:0.537081
2026-01-24 16:01:01.709 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 16:01:01.709 | INFO     | __main__:main_worker:320 - ---> start train epoch78
2026-01-24 16:01:12.422 | INFO     | __main__:main_worker:382 - [78/100], remain:0d.00h.11m, It:[10/54], Max-Mem:12325M, Data-Time:2.143, LR:0.0000, Train_Loss:0.3120, total_loss:tensor([0.3120], device='cuda:0')
2026-01-24 16:01:17.131 | INFO     | __main__:main_worker:382 - [78/100], remain:0d.00h.10m, It:[20/54], Max-Mem:12325M, Data-Time:1.215, LR:0.0000, Train_Loss:0.2103, total_loss:tensor([0.2103], device='cuda:0')
2026-01-24 16:01:21.948 | INFO     | __main__:main_worker:382 - [78/100], remain:0d.00h.09m, It:[30/54], Max-Mem:12325M, Data-Time:1.279, LR:0.0000, Train_Loss:0.2254, total_loss:tensor([0.2254], device='cuda:0')
2026-01-24 16:01:26.378 | INFO     | __main__:main_worker:382 - [78/100], remain:0d.00h.09m, It:[40/54], Max-Mem:12325M, Data-Time:0.941, LR:0.0000, Train_Loss:0.1894, total_loss:tensor([0.1894], device='cuda:0')
2026-01-24 16:01:30.869 | INFO     | __main__:main_worker:382 - [78/100], remain:0d.00h.09m, It:[50/54], Max-Mem:12325M, Data-Time:0.957, LR:0.0000, Train_Loss:0.1768, total_loss:tensor([0.1768], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
acc1: 69.8718, acc3: 100.0000, Precision: 0.6505, Recall: 0.5889, F1-Score: 0.6080, Specificity: 0.7744
2026-01-24 16:01:40.523 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [78/100], Top1:69.872, Top3:100.000, Test_precision:0.6505,Test_recall:0.5889,Test_f1:0.6080,,Test_specificity:0.7744 Test_loss:0.543987
2026-01-24 16:01:40.525 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 16:01:40.525 | INFO     | __main__:main_worker:320 - ---> start train epoch79
2026-01-24 16:01:49.705 | INFO     | __main__:main_worker:382 - [79/100], remain:0d.00h.10m, It:[10/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.0944, total_loss:tensor([0.0944], device='cuda:0')
2026-01-24 16:01:54.562 | INFO     | __main__:main_worker:382 - [79/100], remain:0d.00h.09m, It:[20/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0000, Train_Loss:0.2376, total_loss:tensor([0.2376], device='cuda:0')
2026-01-24 16:01:59.166 | INFO     | __main__:main_worker:382 - [79/100], remain:0d.00h.09m, It:[30/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.2704, total_loss:tensor([0.2704], device='cuda:0')
2026-01-24 16:02:03.037 | INFO     | __main__:main_worker:382 - [79/100], remain:0d.00h.08m, It:[40/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.2491, total_loss:tensor([0.2491], device='cuda:0')
2026-01-24 16:02:07.834 | INFO     | __main__:main_worker:382 - [79/100], remain:0d.00h.08m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.3937, total_loss:tensor([0.3937], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
acc1: 71.1538, acc3: 100.0000, Precision: 0.6686, Recall: 0.5910, F1-Score: 0.6151, Specificity: 0.7811
2026-01-24 16:02:18.298 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [79/100], Top1:71.154, Top3:100.000, Test_precision:0.6686,Test_recall:0.5910,Test_f1:0.6151,,Test_specificity:0.7811 Test_loss:0.544654
2026-01-24 16:02:18.300 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [54/100], Top1:81.410, Top-3:100.000
2026-01-24 16:02:18.301 | INFO     | __main__:main_worker:320 - ---> start train epoch80
2026-01-24 16:02:28.557 | INFO     | __main__:main_worker:382 - [80/100], remain:0d.00h.09m, It:[10/54], Max-Mem:12325M, Data-Time:1.589, LR:0.0000, Train_Loss:0.1524, total_loss:tensor([0.1524], device='cuda:0')
2026-01-24 16:02:32.830 | INFO     | __main__:main_worker:382 - [80/100], remain:0d.00h.08m, It:[20/54], Max-Mem:12325M, Data-Time:0.769, LR:0.0000, Train_Loss:0.4061, total_loss:tensor([0.4061], device='cuda:0')
2026-01-24 16:02:36.751 | INFO     | __main__:main_worker:382 - [80/100], remain:0d.00h.07m, It:[30/54], Max-Mem:12325M, Data-Time:0.135, LR:0.0000, Train_Loss:0.4908, total_loss:tensor([0.4908], device='cuda:0')
2026-01-24 16:02:41.263 | INFO     | __main__:main_worker:382 - [80/100], remain:0d.00h.07m, It:[40/54], Max-Mem:12325M, Data-Time:0.954, LR:0.0000, Train_Loss:0.3747, total_loss:tensor([0.3747], device='cuda:0')
2026-01-24 16:02:45.359 | INFO     | __main__:main_worker:382 - [80/100], remain:0d.00h.07m, It:[50/54], Max-Mem:12325M, Data-Time:0.175, LR:0.0000, Train_Loss:0.1861, total_loss:tensor([0.1861], device='cuda:0')
2026-01-24 16:02:47.625 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 80
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.6711
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.7103
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.6522
Local prototype push completed!
2026-01-24 16:03:12.828 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
acc1: 83.3333, acc3: 100.0000, Precision: 0.7934, Recall: 0.7339, F1-Score: 0.7566, Specificity: 0.8871
2026-01-24 16:03:21.152 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [80/100], Top1:83.333, Top3:100.000, Test_precision:0.7934,Test_recall:0.7339,Test_f1:0.7566,,Test_specificity:0.8871 Test_loss:0.465827
2026-01-24 16:03:21.153 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:03:33.993 | INFO     | __main__:main_worker:320 - ---> start train epoch81
2026-01-24 16:03:43.991 | INFO     | __main__:main_worker:382 - [81/100], remain:0d.00h.09m, It:[10/54], Max-Mem:12325M, Data-Time:1.153, LR:0.0000, Train_Loss:0.3076, total_loss:tensor([0.3076], device='cuda:0')
2026-01-24 16:03:48.205 | INFO     | __main__:main_worker:382 - [81/100], remain:0d.00h.08m, It:[20/54], Max-Mem:12325M, Data-Time:0.702, LR:0.0000, Train_Loss:0.1912, total_loss:tensor([0.1912], device='cuda:0')
2026-01-24 16:03:53.352 | INFO     | __main__:main_worker:382 - [81/100], remain:0d.00h.08m, It:[30/54], Max-Mem:12325M, Data-Time:1.432, LR:0.0000, Train_Loss:0.1361, total_loss:tensor([0.1361], device='cuda:0')
2026-01-24 16:03:58.570 | INFO     | __main__:main_worker:382 - [81/100], remain:0d.00h.08m, It:[40/54], Max-Mem:12325M, Data-Time:1.682, LR:0.0000, Train_Loss:0.3088, total_loss:tensor([0.3088], device='cuda:0')
2026-01-24 16:04:03.112 | INFO     | __main__:main_worker:382 - [81/100], remain:0d.00h.08m, It:[50/54], Max-Mem:12325M, Data-Time:1.055, LR:0.0000, Train_Loss:0.2243, total_loss:tensor([0.2243], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
2026-01-24 16:04:12.772 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [81/100], Top1:77.564, Top3:100.000, Test_precision:0.7232,Test_recall:0.6778,Test_f1:0.6971,,Test_specificity:0.8397 Test_loss:0.512083
2026-01-24 16:04:12.773 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:04:12.773 | INFO     | __main__:main_worker:320 - ---> start train epoch82
acc1: 77.5641, acc3: 100.0000, Precision: 0.7232, Recall: 0.6778, F1-Score: 0.6971, Specificity: 0.8397
2026-01-24 16:04:22.454 | INFO     | __main__:main_worker:382 - [82/100], remain:0d.00h.07m, It:[10/54], Max-Mem:12325M, Data-Time:1.132, LR:0.0000, Train_Loss:0.4264, total_loss:tensor([0.4264], device='cuda:0')
2026-01-24 16:04:26.217 | INFO     | __main__:main_worker:382 - [82/100], remain:0d.00h.06m, It:[20/54], Max-Mem:12325M, Data-Time:0.186, LR:0.0000, Train_Loss:0.3688, total_loss:tensor([0.3688], device='cuda:0')
2026-01-24 16:04:30.860 | INFO     | __main__:main_worker:382 - [82/100], remain:0d.00h.06m, It:[30/54], Max-Mem:12325M, Data-Time:0.016, LR:0.0000, Train_Loss:0.3220, total_loss:tensor([0.3220], device='cuda:0')
2026-01-24 16:04:35.271 | INFO     | __main__:main_worker:382 - [82/100], remain:0d.00h.06m, It:[40/54], Max-Mem:12325M, Data-Time:0.015, LR:0.0000, Train_Loss:0.1186, total_loss:tensor([0.1186], device='cuda:0')
2026-01-24 16:04:40.620 | INFO     | __main__:main_worker:382 - [82/100], remain:0d.00h.07m, It:[50/54], Max-Mem:12325M, Data-Time:0.010, LR:0.0000, Train_Loss:0.7751, total_loss:tensor([0.7751], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
acc1: 78.8462, acc3: 100.0000, Precision: 0.7525, Recall: 0.6752, F1-Score: 0.7056, Specificity: 0.8457
2026-01-24 16:04:50.503 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [82/100], Top1:78.846, Top3:100.000, Test_precision:0.7525,Test_recall:0.6752,Test_f1:0.7056,,Test_specificity:0.8457 Test_loss:0.514304
2026-01-24 16:04:50.505 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:04:50.505 | INFO     | __main__:main_worker:320 - ---> start train epoch83
2026-01-24 16:05:01.538 | INFO     | __main__:main_worker:382 - [83/100], remain:0d.00h.08m, It:[10/54], Max-Mem:12325M, Data-Time:1.900, LR:0.0000, Train_Loss:0.2407, total_loss:tensor([0.2407], device='cuda:0')
2026-01-24 16:05:05.967 | INFO     | __main__:main_worker:382 - [83/100], remain:0d.00h.07m, It:[20/54], Max-Mem:12325M, Data-Time:0.901, LR:0.0000, Train_Loss:0.2264, total_loss:tensor([0.2264], device='cuda:0')
2026-01-24 16:05:09.625 | INFO     | __main__:main_worker:382 - [83/100], remain:0d.00h.06m, It:[30/54], Max-Mem:12325M, Data-Time:0.076, LR:0.0000, Train_Loss:0.5577, total_loss:tensor([0.5577], device='cuda:0')
2026-01-24 16:05:14.773 | INFO     | __main__:main_worker:382 - [83/100], remain:0d.00h.07m, It:[40/54], Max-Mem:12325M, Data-Time:1.423, LR:0.0000, Train_Loss:0.1064, total_loss:tensor([0.1064], device='cuda:0')
2026-01-24 16:05:18.821 | INFO     | __main__:main_worker:382 - [83/100], remain:0d.00h.06m, It:[50/54], Max-Mem:12325M, Data-Time:0.581, LR:0.0000, Train_Loss:0.0471, total_loss:tensor([0.0471], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
acc1: 79.7009, acc3: 100.0000, Precision: 0.7382, Recall: 0.6954, F1-Score: 0.7139, Specificity: 0.8607
2026-01-24 16:05:29.002 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [83/100], Top1:79.701, Top3:100.000, Test_precision:0.7382,Test_recall:0.6954,Test_f1:0.7139,,Test_specificity:0.8607 Test_loss:0.502144
2026-01-24 16:05:29.003 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:05:29.004 | INFO     | __main__:main_worker:320 - ---> start train epoch84
2026-01-24 16:05:38.203 | INFO     | __main__:main_worker:382 - [84/100], remain:0d.00h.06m, It:[10/54], Max-Mem:12325M, Data-Time:0.770, LR:0.0000, Train_Loss:0.0487, total_loss:tensor([0.0487], device='cuda:0')
2026-01-24 16:05:42.244 | INFO     | __main__:main_worker:382 - [84/100], remain:0d.00h.06m, It:[20/54], Max-Mem:12325M, Data-Time:0.564, LR:0.0000, Train_Loss:0.3538, total_loss:tensor([0.3538], device='cuda:0')
2026-01-24 16:05:47.412 | INFO     | __main__:main_worker:382 - [84/100], remain:0d.00h.06m, It:[30/54], Max-Mem:12325M, Data-Time:1.629, LR:0.0000, Train_Loss:0.3966, total_loss:tensor([0.3966], device='cuda:0')
2026-01-24 16:05:51.485 | INFO     | __main__:main_worker:382 - [84/100], remain:0d.00h.06m, It:[40/54], Max-Mem:12325M, Data-Time:0.510, LR:0.0000, Train_Loss:0.2800, total_loss:tensor([0.2800], device='cuda:0')
2026-01-24 16:05:55.620 | INFO     | __main__:main_worker:382 - [84/100], remain:0d.00h.06m, It:[50/54], Max-Mem:12325M, Data-Time:0.129, LR:0.0000, Train_Loss:0.4744, total_loss:tensor([0.4744], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2026-01-24 16:06:05.991 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [84/100], Top1:79.060, Top3:100.000, Test_precision:0.7268,Test_recall:0.6953,Test_f1:0.7095,,Test_specificity:0.8563 Test_loss:0.518937
2026-01-24 16:06:05.992 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:06:05.992 | INFO     | __main__:main_worker:320 - ---> start train epoch85
acc1: 79.0598, acc3: 100.0000, Precision: 0.7268, Recall: 0.6953, F1-Score: 0.7095, Specificity: 0.8563
2026-01-24 16:06:15.309 | INFO     | __main__:main_worker:382 - [85/100], remain:0d.00h.06m, It:[10/54], Max-Mem:12325M, Data-Time:0.957, LR:0.0000, Train_Loss:0.4156, total_loss:tensor([0.4156], device='cuda:0')
2026-01-24 16:06:19.652 | INFO     | __main__:main_worker:382 - [85/100], remain:0d.00h.06m, It:[20/54], Max-Mem:12325M, Data-Time:0.788, LR:0.0000, Train_Loss:0.6532, total_loss:tensor([0.6532], device='cuda:0')
2026-01-24 16:06:24.464 | INFO     | __main__:main_worker:382 - [85/100], remain:0d.00h.06m, It:[30/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.2157, total_loss:tensor([0.2157], device='cuda:0')
2026-01-24 16:06:29.293 | INFO     | __main__:main_worker:382 - [85/100], remain:0d.00h.06m, It:[40/54], Max-Mem:12325M, Data-Time:0.015, LR:0.0000, Train_Loss:0.5560, total_loss:tensor([0.5560], device='cuda:0')
2026-01-24 16:06:33.831 | INFO     | __main__:main_worker:382 - [85/100], remain:0d.00h.06m, It:[50/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.2179, total_loss:tensor([0.2179], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
2026-01-24 16:06:44.058 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [85/100], Top1:77.564, Top3:100.000, Test_precision:0.7066,Test_recall:0.6731,Test_f1:0.6879,,Test_specificity:0.8448 Test_loss:0.533334
2026-01-24 16:06:44.059 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:06:44.060 | INFO     | __main__:main_worker:320 - ---> start train epoch86
acc1: 77.5641, acc3: 100.0000, Precision: 0.7066, Recall: 0.6731, F1-Score: 0.6879, Specificity: 0.8448
2026-01-24 16:06:55.040 | INFO     | __main__:main_worker:382 - [86/100], remain:0d.00h.08m, It:[10/54], Max-Mem:12325M, Data-Time:2.612, LR:0.0000, Train_Loss:0.3248, total_loss:tensor([0.3248], device='cuda:0')
2026-01-24 16:06:58.914 | INFO     | __main__:main_worker:382 - [86/100], remain:0d.00h.06m, It:[20/54], Max-Mem:12325M, Data-Time:0.340, LR:0.0000, Train_Loss:0.2377, total_loss:tensor([0.2377], device='cuda:0')
2026-01-24 16:07:02.940 | INFO     | __main__:main_worker:382 - [86/100], remain:0d.00h.05m, It:[30/54], Max-Mem:12325M, Data-Time:0.508, LR:0.0000, Train_Loss:0.3000, total_loss:tensor([0.3000], device='cuda:0')
2026-01-24 16:07:07.866 | INFO     | __main__:main_worker:382 - [86/100], remain:0d.00h.05m, It:[40/54], Max-Mem:12325M, Data-Time:1.429, LR:0.0000, Train_Loss:0.4523, total_loss:tensor([0.4523], device='cuda:0')
2026-01-24 16:07:12.235 | INFO     | __main__:main_worker:382 - [86/100], remain:0d.00h.05m, It:[50/54], Max-Mem:12325M, Data-Time:0.824, LR:0.0000, Train_Loss:0.5135, total_loss:tensor([0.5135], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
2026-01-24 16:07:21.886 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [86/100], Top1:78.205, Top3:100.000, Test_precision:0.7225,Test_recall:0.6719,Test_f1:0.6931,,Test_specificity:0.8481 Test_loss:0.526264
2026-01-24 16:07:21.887 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:07:21.887 | INFO     | __main__:main_worker:320 - ---> start train epoch87
acc1: 78.2051, acc3: 100.0000, Precision: 0.7225, Recall: 0.6719, F1-Score: 0.6931, Specificity: 0.8481
2026-01-24 16:07:30.768 | INFO     | __main__:main_worker:382 - [87/100], remain:0d.00h.05m, It:[10/54], Max-Mem:12325M, Data-Time:0.018, LR:0.0000, Train_Loss:0.1786, total_loss:tensor([0.1786], device='cuda:0')
2026-01-24 16:07:35.144 | INFO     | __main__:main_worker:382 - [87/100], remain:0d.00h.05m, It:[20/54], Max-Mem:12325M, Data-Time:0.256, LR:0.0000, Train_Loss:0.0730, total_loss:tensor([0.0730], device='cuda:0')
2026-01-24 16:07:40.107 | INFO     | __main__:main_worker:382 - [87/100], remain:0d.00h.05m, It:[30/54], Max-Mem:12325M, Data-Time:1.185, LR:0.0000, Train_Loss:0.2687, total_loss:tensor([0.2687], device='cuda:0')
2026-01-24 16:07:44.886 | INFO     | __main__:main_worker:382 - [87/100], remain:0d.00h.05m, It:[40/54], Max-Mem:12325M, Data-Time:0.483, LR:0.0000, Train_Loss:0.4354, total_loss:tensor([0.4354], device='cuda:0')
2026-01-24 16:07:49.547 | INFO     | __main__:main_worker:382 - [87/100], remain:0d.00h.05m, It:[50/54], Max-Mem:12325M, Data-Time:1.168, LR:0.0000, Train_Loss:0.3412, total_loss:tensor([0.3412], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
2026-01-24 16:07:59.237 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [87/100], Top1:76.496, Top3:100.000, Test_precision:0.6983,Test_recall:0.6680,Test_f1:0.6809,,Test_specificity:0.8354 Test_loss:0.529975
2026-01-24 16:07:59.238 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:07:59.238 | INFO     | __main__:main_worker:320 - ---> start train epoch88
acc1: 76.4957, acc3: 100.0000, Precision: 0.6983, Recall: 0.6680, F1-Score: 0.6809, Specificity: 0.8354
2026-01-24 16:08:08.191 | INFO     | __main__:main_worker:382 - [88/100], remain:0d.00h.05m, It:[10/54], Max-Mem:12325M, Data-Time:0.521, LR:0.0000, Train_Loss:0.1933, total_loss:tensor([0.1933], device='cuda:0')
2026-01-24 16:08:12.971 | INFO     | __main__:main_worker:382 - [88/100], remain:0d.00h.05m, It:[20/54], Max-Mem:12325M, Data-Time:1.268, LR:0.0000, Train_Loss:0.4385, total_loss:tensor([0.4385], device='cuda:0')
2026-01-24 16:08:18.069 | INFO     | __main__:main_worker:382 - [88/100], remain:0d.00h.05m, It:[30/54], Max-Mem:12325M, Data-Time:0.938, LR:0.0000, Train_Loss:0.6118, total_loss:tensor([0.6118], device='cuda:0')
2026-01-24 16:08:22.330 | INFO     | __main__:main_worker:382 - [88/100], remain:0d.00h.05m, It:[40/54], Max-Mem:12325M, Data-Time:0.696, LR:0.0000, Train_Loss:0.6382, total_loss:tensor([0.6382], device='cuda:0')
2026-01-24 16:08:26.889 | INFO     | __main__:main_worker:382 - [88/100], remain:0d.00h.05m, It:[50/54], Max-Mem:12325M, Data-Time:1.036, LR:0.0000, Train_Loss:0.1659, total_loss:tensor([0.1659], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2026-01-24 16:08:36.618 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [88/100], Top1:78.205, Top3:100.000, Test_precision:0.7165,Test_recall:0.6788,Test_f1:0.6951,,Test_specificity:0.8521 Test_loss:0.512578
acc1: 78.2051, acc3: 100.0000, Precision: 0.7165, Recall: 0.6788, F1-Score: 0.6951, Specificity: 0.8521
2026-01-24 16:08:36.620 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:08:36.620 | INFO     | __main__:main_worker:320 - ---> start train epoch89
2026-01-24 16:08:48.681 | INFO     | __main__:main_worker:382 - [89/100], remain:0d.00h.06m, It:[10/54], Max-Mem:12325M, Data-Time:2.932, LR:0.0000, Train_Loss:0.3707, total_loss:tensor([0.3707], device='cuda:0')
2026-01-24 16:08:53.391 | INFO     | __main__:main_worker:382 - [89/100], remain:0d.00h.05m, It:[20/54], Max-Mem:12325M, Data-Time:1.176, LR:0.0000, Train_Loss:0.3884, total_loss:tensor([0.3884], device='cuda:0')
2026-01-24 16:08:57.835 | INFO     | __main__:main_worker:382 - [89/100], remain:0d.00h.05m, It:[30/54], Max-Mem:12325M, Data-Time:0.934, LR:0.0000, Train_Loss:0.2492, total_loss:tensor([0.2492], device='cuda:0')
2026-01-24 16:09:01.684 | INFO     | __main__:main_worker:382 - [89/100], remain:0d.00h.04m, It:[40/54], Max-Mem:12325M, Data-Time:0.355, LR:0.0000, Train_Loss:0.2740, total_loss:tensor([0.2740], device='cuda:0')
2026-01-24 16:09:05.336 | INFO     | __main__:main_worker:382 - [89/100], remain:0d.00h.04m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.4460, total_loss:tensor([0.4460], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2026-01-24 16:09:15.092 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [89/100], Top1:77.350, Top3:100.000, Test_precision:0.7087,Test_recall:0.6882,Test_f1:0.6975,,Test_specificity:0.8440 Test_loss:0.523279
acc1: 77.3504, acc3: 100.0000, Precision: 0.7087, Recall: 0.6882, F1-Score: 0.6975, Specificity: 0.8440
2026-01-24 16:09:15.094 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:09:15.094 | INFO     | __main__:main_worker:320 - ---> start train epoch90
2026-01-24 16:09:24.527 | INFO     | __main__:main_worker:382 - [90/100], remain:0d.00h.04m, It:[10/54], Max-Mem:12325M, Data-Time:1.252, LR:0.0000, Train_Loss:0.4826, total_loss:tensor([0.4826], device='cuda:0')
2026-01-24 16:09:29.187 | INFO     | __main__:main_worker:382 - [90/100], remain:0d.00h.04m, It:[20/54], Max-Mem:12325M, Data-Time:0.737, LR:0.0000, Train_Loss:0.1445, total_loss:tensor([0.1445], device='cuda:0')
2026-01-24 16:09:33.884 | INFO     | __main__:main_worker:382 - [90/100], remain:0d.00h.04m, It:[30/54], Max-Mem:12325M, Data-Time:1.171, LR:0.0000, Train_Loss:0.2052, total_loss:tensor([0.2052], device='cuda:0')
2026-01-24 16:09:37.748 | INFO     | __main__:main_worker:382 - [90/100], remain:0d.00h.04m, It:[40/54], Max-Mem:12325M, Data-Time:0.296, LR:0.0000, Train_Loss:0.3909, total_loss:tensor([0.3909], device='cuda:0')
2026-01-24 16:09:43.423 | INFO     | __main__:main_worker:382 - [90/100], remain:0d.00h.04m, It:[50/54], Max-Mem:12325M, Data-Time:1.671, LR:0.0000, Train_Loss:0.1253, total_loss:tensor([0.1253], device='cuda:0')
2026-01-24 16:09:44.756 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 90
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.6625
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.6986
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.6511
Local prototype push completed!
2026-01-24 16:10:09.160 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
acc1: 60.4701, acc3: 100.0000, Precision: 0.4510, Recall: 0.4740, F1-Score: 0.4491, Specificity: 0.6919
2026-01-24 16:10:17.650 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [90/100], Top1:60.470, Top3:100.000, Test_precision:0.4510,Test_recall:0.4740,Test_f1:0.4491,,Test_specificity:0.6919 Test_loss:0.723496
2026-01-24 16:10:17.652 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:10:24.338 | INFO     | __main__:main_worker:320 - ---> start train epoch91
2026-01-24 16:10:34.355 | INFO     | __main__:main_worker:382 - [91/100], remain:0d.00h.03m, It:[10/54], Max-Mem:12325M, Data-Time:1.038, LR:0.0000, Train_Loss:0.1114, total_loss:tensor([0.1114], device='cuda:0')
2026-01-24 16:10:39.792 | INFO     | __main__:main_worker:382 - [91/100], remain:0d.00h.04m, It:[20/54], Max-Mem:12325M, Data-Time:1.931, LR:0.0000, Train_Loss:0.2525, total_loss:tensor([0.2525], device='cuda:0')
2026-01-24 16:10:44.165 | INFO     | __main__:main_worker:382 - [91/100], remain:0d.00h.03m, It:[30/54], Max-Mem:12325M, Data-Time:0.845, LR:0.0000, Train_Loss:0.2020, total_loss:tensor([0.2020], device='cuda:0')
2026-01-24 16:10:48.264 | INFO     | __main__:main_worker:382 - [91/100], remain:0d.00h.03m, It:[40/54], Max-Mem:12325M, Data-Time:0.588, LR:0.0000, Train_Loss:0.2045, total_loss:tensor([0.2045], device='cuda:0')
2026-01-24 16:10:51.915 | INFO     | __main__:main_worker:382 - [91/100], remain:0d.00h.03m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.5291, total_loss:tensor([0.5291], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
2026-01-24 16:11:01.417 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [91/100], Top1:60.897, Top3:100.000, Test_precision:0.4738,Test_recall:0.4763,Test_f1:0.4606,,Test_specificity:0.6940 Test_loss:0.700056
2026-01-24 16:11:01.419 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:11:01.419 | INFO     | __main__:main_worker:320 - ---> start train epoch92
acc1: 60.8974, acc3: 100.0000, Precision: 0.4738, Recall: 0.4763, F1-Score: 0.4606, Specificity: 0.6940
2026-01-24 16:11:10.099 | INFO     | __main__:main_worker:382 - [92/100], remain:0d.00h.03m, It:[10/54], Max-Mem:12325M, Data-Time:0.939, LR:0.0000, Train_Loss:0.3945, total_loss:tensor([0.3945], device='cuda:0')
2026-01-24 16:11:14.385 | INFO     | __main__:main_worker:382 - [92/100], remain:0d.00h.03m, It:[20/54], Max-Mem:12325M, Data-Time:0.777, LR:0.0000, Train_Loss:0.2091, total_loss:tensor([0.2091], device='cuda:0')
2026-01-24 16:11:19.612 | INFO     | __main__:main_worker:382 - [92/100], remain:0d.00h.03m, It:[30/54], Max-Mem:12325M, Data-Time:0.970, LR:0.0000, Train_Loss:0.3416, total_loss:tensor([0.3416], device='cuda:0')
2026-01-24 16:11:23.633 | INFO     | __main__:main_worker:382 - [92/100], remain:0d.00h.03m, It:[40/54], Max-Mem:12325M, Data-Time:0.288, LR:0.0000, Train_Loss:0.4024, total_loss:tensor([0.4024], device='cuda:0')
2026-01-24 16:11:29.333 | INFO     | __main__:main_worker:382 - [92/100], remain:0d.00h.03m, It:[50/54], Max-Mem:12325M, Data-Time:1.249, LR:0.0000, Train_Loss:0.3672, total_loss:tensor([0.3672], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
acc1: 60.8974, acc3: 100.0000, Precision: 0.4631, Recall: 0.4763, F1-Score: 0.4553, Specificity: 0.6934
2026-01-24 16:11:39.086 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [92/100], Top1:60.897, Top3:100.000, Test_precision:0.4631,Test_recall:0.4763,Test_f1:0.4553,,Test_specificity:0.6934 Test_loss:0.698312
2026-01-24 16:11:39.089 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:11:39.090 | INFO     | __main__:main_worker:320 - ---> start train epoch93
2026-01-24 16:11:48.331 | INFO     | __main__:main_worker:382 - [93/100], remain:0d.00h.02m, It:[10/54], Max-Mem:12325M, Data-Time:0.682, LR:0.0000, Train_Loss:0.3096, total_loss:tensor([0.3096], device='cuda:0')
2026-01-24 16:11:53.316 | INFO     | __main__:main_worker:382 - [93/100], remain:0d.00h.03m, It:[20/54], Max-Mem:12325M, Data-Time:0.490, LR:0.0000, Train_Loss:0.3789, total_loss:tensor([0.3789], device='cuda:0')
2026-01-24 16:11:58.801 | INFO     | __main__:main_worker:382 - [93/100], remain:0d.00h.03m, It:[30/54], Max-Mem:12325M, Data-Time:0.020, LR:0.0000, Train_Loss:0.3494, total_loss:tensor([0.3494], device='cuda:0')
2026-01-24 16:12:03.107 | INFO     | __main__:main_worker:382 - [93/100], remain:0d.00h.03m, It:[40/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.0635, total_loss:tensor([0.0635], device='cuda:0')
2026-01-24 16:12:07.553 | INFO     | __main__:main_worker:382 - [93/100], remain:0d.00h.02m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.3021, total_loss:tensor([0.3021], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
2026-01-24 16:12:17.512 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [93/100], Top1:60.470, Top3:100.000, Test_precision:0.4556,Test_recall:0.4740,Test_f1:0.4514,,Test_specificity:0.6917 Test_loss:0.688622
2026-01-24 16:12:17.513 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:12:17.514 | INFO     | __main__:main_worker:320 - ---> start train epoch94
acc1: 60.4701, acc3: 100.0000, Precision: 0.4556, Recall: 0.4740, F1-Score: 0.4514, Specificity: 0.6917
2026-01-24 16:12:26.541 | INFO     | __main__:main_worker:382 - [94/100], remain:0d.00h.02m, It:[10/54], Max-Mem:12325M, Data-Time:0.632, LR:0.0000, Train_Loss:0.0546, total_loss:tensor([0.0546], device='cuda:0')
2026-01-24 16:12:31.406 | INFO     | __main__:main_worker:382 - [94/100], remain:0d.00h.02m, It:[20/54], Max-Mem:12325M, Data-Time:0.778, LR:0.0000, Train_Loss:0.2303, total_loss:tensor([0.2303], device='cuda:0')
2026-01-24 16:12:35.713 | INFO     | __main__:main_worker:382 - [94/100], remain:0d.00h.02m, It:[30/54], Max-Mem:12325M, Data-Time:0.804, LR:0.0000, Train_Loss:0.1835, total_loss:tensor([0.1835], device='cuda:0')
2026-01-24 16:12:40.349 | INFO     | __main__:main_worker:382 - [94/100], remain:0d.00h.02m, It:[40/54], Max-Mem:12325M, Data-Time:1.098, LR:0.0000, Train_Loss:0.1164, total_loss:tensor([0.1164], device='cuda:0')
2026-01-24 16:12:45.546 | INFO     | __main__:main_worker:382 - [94/100], remain:0d.00h.02m, It:[50/54], Max-Mem:12325M, Data-Time:1.686, LR:0.0000, Train_Loss:0.4222, total_loss:tensor([0.4222], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
acc1: 60.8974, acc3: 100.0000, Precision: 0.4631, Recall: 0.4763, F1-Score: 0.4553, Specificity: 0.6934
2026-01-24 16:12:55.378 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [94/100], Top1:60.897, Top3:100.000, Test_precision:0.4631,Test_recall:0.4763,Test_f1:0.4553,,Test_specificity:0.6934 Test_loss:0.670271
2026-01-24 16:12:55.379 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:12:55.380 | INFO     | __main__:main_worker:320 - ---> start train epoch95
2026-01-24 16:13:04.306 | INFO     | __main__:main_worker:382 - [95/100], remain:0d.00h.02m, It:[10/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.3922, total_loss:tensor([0.3922], device='cuda:0')
2026-01-24 16:13:08.939 | INFO     | __main__:main_worker:382 - [95/100], remain:0d.00h.02m, It:[20/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.3776, total_loss:tensor([0.3776], device='cuda:0')
2026-01-24 16:13:13.210 | INFO     | __main__:main_worker:382 - [95/100], remain:0d.00h.02m, It:[30/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.1395, total_loss:tensor([0.1395], device='cuda:0')
2026-01-24 16:13:19.016 | INFO     | __main__:main_worker:382 - [95/100], remain:0d.00h.02m, It:[40/54], Max-Mem:12325M, Data-Time:0.011, LR:0.0000, Train_Loss:0.5410, total_loss:tensor([0.5410], device='cuda:0')
2026-01-24 16:13:22.666 | INFO     | __main__:main_worker:382 - [95/100], remain:0d.00h.02m, It:[50/54], Max-Mem:12325M, Data-Time:0.009, LR:0.0000, Train_Loss:0.3451, total_loss:tensor([0.3451], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
acc1: 61.3248, acc3: 100.0000, Precision: 0.4728, Recall: 0.4934, F1-Score: 0.4685, Specificity: 0.6954
2026-01-24 16:13:32.659 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [95/100], Top1:61.325, Top3:100.000, Test_precision:0.4728,Test_recall:0.4934,Test_f1:0.4685,,Test_specificity:0.6954 Test_loss:0.681341
2026-01-24 16:13:32.661 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:13:32.661 | INFO     | __main__:main_worker:320 - ---> start train epoch96
2026-01-24 16:13:44.747 | INFO     | __main__:main_worker:382 - [96/100], remain:0d.00h.02m, It:[10/54], Max-Mem:12325M, Data-Time:1.922, LR:0.0000, Train_Loss:0.3090, total_loss:tensor([0.3090], device='cuda:0')
2026-01-24 16:13:48.364 | INFO     | __main__:main_worker:382 - [96/100], remain:0d.00h.01m, It:[20/54], Max-Mem:12325M, Data-Time:0.121, LR:0.0000, Train_Loss:0.0553, total_loss:tensor([0.0553], device='cuda:0')
2026-01-24 16:13:53.295 | INFO     | __main__:main_worker:382 - [96/100], remain:0d.00h.01m, It:[30/54], Max-Mem:12325M, Data-Time:1.391, LR:0.0000, Train_Loss:0.2085, total_loss:tensor([0.2085], device='cuda:0')
2026-01-24 16:13:58.129 | INFO     | __main__:main_worker:382 - [96/100], remain:0d.00h.01m, It:[40/54], Max-Mem:12325M, Data-Time:1.296, LR:0.0000, Train_Loss:0.1730, total_loss:tensor([0.1730], device='cuda:0')
2026-01-24 16:14:02.854 | INFO     | __main__:main_worker:382 - [96/100], remain:0d.00h.01m, It:[50/54], Max-Mem:12325M, Data-Time:1.213, LR:0.0000, Train_Loss:0.2016, total_loss:tensor([0.2016], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
acc1: 60.8974, acc3: 100.0000, Precision: 0.4631, Recall: 0.4763, F1-Score: 0.4553, Specificity: 0.6934
2026-01-24 16:14:12.402 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [96/100], Top1:60.897, Top3:100.000, Test_precision:0.4631,Test_recall:0.4763,Test_f1:0.4553,,Test_specificity:0.6934 Test_loss:0.672965
2026-01-24 16:14:12.404 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:14:12.404 | INFO     | __main__:main_worker:320 - ---> start train epoch97
2026-01-24 16:14:21.691 | INFO     | __main__:main_worker:382 - [97/100], remain:0d.00h.01m, It:[10/54], Max-Mem:12325M, Data-Time:1.200, LR:0.0000, Train_Loss:0.3315, total_loss:tensor([0.3315], device='cuda:0')
2026-01-24 16:14:26.254 | INFO     | __main__:main_worker:382 - [97/100], remain:0d.00h.01m, It:[20/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.1939, total_loss:tensor([0.1939], device='cuda:0')
2026-01-24 16:14:30.210 | INFO     | __main__:main_worker:382 - [97/100], remain:0d.00h.01m, It:[30/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.0569, total_loss:tensor([0.0569], device='cuda:0')
2026-01-24 16:14:34.879 | INFO     | __main__:main_worker:382 - [97/100], remain:0d.00h.01m, It:[40/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.3728, total_loss:tensor([0.3728], device='cuda:0')
2026-01-24 16:14:39.282 | INFO     | __main__:main_worker:382 - [97/100], remain:0d.00h.01m, It:[50/54], Max-Mem:12325M, Data-Time:0.014, LR:0.0000, Train_Loss:0.0374, total_loss:tensor([0.0374], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
acc1: 61.1111, acc3: 100.0000, Precision: 0.4680, Recall: 0.4848, F1-Score: 0.4620, Specificity: 0.6944
2026-01-24 16:14:49.889 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [97/100], Top1:61.111, Top3:100.000, Test_precision:0.4680,Test_recall:0.4848,Test_f1:0.4620,,Test_specificity:0.6944 Test_loss:0.668880
2026-01-24 16:14:49.891 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:14:49.891 | INFO     | __main__:main_worker:320 - ---> start train epoch98
2026-01-24 16:14:59.470 | INFO     | __main__:main_worker:382 - [98/100], remain:0d.00h.01m, It:[10/54], Max-Mem:12325M, Data-Time:1.341, LR:0.0000, Train_Loss:0.1609, total_loss:tensor([0.1609], device='cuda:0')
2026-01-24 16:15:03.548 | INFO     | __main__:main_worker:382 - [98/100], remain:0d.00h.01m, It:[20/54], Max-Mem:12325M, Data-Time:0.605, LR:0.0000, Train_Loss:0.1826, total_loss:tensor([0.1826], device='cuda:0')
2026-01-24 16:15:08.172 | INFO     | __main__:main_worker:382 - [98/100], remain:0d.00h.00m, It:[30/54], Max-Mem:12325M, Data-Time:0.816, LR:0.0000, Train_Loss:0.1612, total_loss:tensor([0.1612], device='cuda:0')
2026-01-24 16:15:13.369 | INFO     | __main__:main_worker:382 - [98/100], remain:0d.00h.00m, It:[40/54], Max-Mem:12325M, Data-Time:1.678, LR:0.0000, Train_Loss:0.3429, total_loss:tensor([0.3429], device='cuda:0')
2026-01-24 16:15:17.998 | INFO     | __main__:main_worker:382 - [98/100], remain:0d.00h.00m, It:[50/54], Max-Mem:12325M, Data-Time:1.118, LR:0.0000, Train_Loss:0.2421, total_loss:tensor([0.2421], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
acc1: 60.4701, acc3: 100.0000, Precision: 0.4659, Recall: 0.4740, F1-Score: 0.4564, Specificity: 0.6912
2026-01-24 16:15:27.872 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [98/100], Top1:60.470, Top3:100.000, Test_precision:0.4659,Test_recall:0.4740,Test_f1:0.4564,,Test_specificity:0.6912 Test_loss:0.669524
2026-01-24 16:15:27.874 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:15:27.874 | INFO     | __main__:main_worker:320 - ---> start train epoch99
2026-01-24 16:15:37.313 | INFO     | __main__:main_worker:382 - [99/100], remain:0d.00h.00m, It:[10/54], Max-Mem:12325M, Data-Time:0.965, LR:0.0000, Train_Loss:0.4341, total_loss:tensor([0.4341], device='cuda:0')
2026-01-24 16:15:41.240 | INFO     | __main__:main_worker:382 - [99/100], remain:0d.00h.00m, It:[20/54], Max-Mem:12325M, Data-Time:0.379, LR:0.0000, Train_Loss:0.1976, total_loss:tensor([0.1976], device='cuda:0')
2026-01-24 16:15:46.822 | INFO     | __main__:main_worker:382 - [99/100], remain:0d.00h.00m, It:[30/54], Max-Mem:12325M, Data-Time:2.042, LR:0.0000, Train_Loss:0.1268, total_loss:tensor([0.1268], device='cuda:0')
2026-01-24 16:15:51.604 | INFO     | __main__:main_worker:382 - [99/100], remain:0d.00h.00m, It:[40/54], Max-Mem:12325M, Data-Time:1.308, LR:0.0000, Train_Loss:0.2622, total_loss:tensor([0.2622], device='cuda:0')
2026-01-24 16:15:55.276 | INFO     | __main__:main_worker:382 - [99/100], remain:0d.00h.00m, It:[50/54], Max-Mem:12325M, Data-Time:0.012, LR:0.0000, Train_Loss:0.0623, total_loss:tensor([0.0623], device='cuda:0')
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
acc1: 61.1111, acc3: 100.0000, Precision: 0.4732, Recall: 0.4848, F1-Score: 0.4646, Specificity: 0.6942
2026-01-24 16:16:04.972 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [99/100], Top1:61.111, Top3:100.000, Test_precision:0.4732,Test_recall:0.4848,Test_f1:0.4646,,Test_specificity:0.6942 Test_loss:0.665569
2026-01-24 16:16:04.974 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:16:04.974 | INFO     | __main__:main_worker:320 - ---> start train epoch100
2026-01-24 16:16:13.980 | INFO     | __main__:main_worker:382 - [100/100], remain:0d.00h.00m, It:[10/54], Max-Mem:12325M, Data-Time:0.477, LR:0.0000, Train_Loss:0.2004, total_loss:tensor([0.2004], device='cuda:0')
2026-01-24 16:16:19.578 | INFO     | __main__:main_worker:382 - [100/100], remain:0d.00h.00m, It:[20/54], Max-Mem:12325M, Data-Time:0.644, LR:0.0000, Train_Loss:0.0752, total_loss:tensor([0.0752], device='cuda:0')
2026-01-24 16:16:23.231 | INFO     | __main__:main_worker:382 - [100/100], remain:0d.00h.00m, It:[30/54], Max-Mem:12325M, Data-Time:0.033, LR:0.0000, Train_Loss:0.0821, total_loss:tensor([0.0821], device='cuda:0')
2026-01-24 16:16:28.212 | INFO     | __main__:main_worker:382 - [100/100], remain:0d.00h.00m, It:[40/54], Max-Mem:12325M, Data-Time:0.016, LR:0.0000, Train_Loss:0.3259, total_loss:tensor([0.3259], device='cuda:0')
2026-01-24 16:16:32.780 | INFO     | __main__:main_worker:382 - [100/100], remain:0d.00h.00m, It:[50/54], Max-Mem:12325M, Data-Time:0.013, LR:0.0000, Train_Loss:0.3248, total_loss:tensor([0.3248], device='cuda:0')
2026-01-24 16:16:34.828 | INFO     | __main__:main_worker:410 - ---> Pushing prototypes at epoch 100
Collecting LOCAL patch features for prototype push...
  Using x_fu1 (B, 49, 768) instead of x_fu (B, 1, 768)
  Processed 50 batches...
  All classes reached max patches (5000), stopping collection.
Patch collection statistics:
  Class 0: 5000 patches
  Class 1: 5000 patches
  Class 2: 5000 patches
Updating prototypes using LOCAL patches...
  Class 0: 5000 patches
    Updated 5 prototypes, min_dist: 26.6578
  Class 1: 5000 patches
    Updated 5 prototypes, min_dist: 26.7046
  Class 2: 5000 patches
    Updated 5 prototypes, min_dist: 26.6496
Local prototype push completed!
2026-01-24 16:16:59.362 | INFO     | __main__:main_worker:414 - ---> Prototype push completed
Evaluating: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
2026-01-24 16:17:07.710 | INFO     | __main__:main_worker:425 - 	Eval-Epoch: [100/100], Top1:67.094, Top3:100.000, Test_precision:0.6048,Test_recall:0.5322,Test_f1:0.5505,,Test_specificity:0.7485 Test_loss:0.599711
acc1: 67.0940, acc3: 100.0000, Precision: 0.6048, Recall: 0.5322, F1-Score: 0.5505, Specificity: 0.7485
2026-01-24 16:17:07.719 | INFO     | __main__:main_worker:436 - 	Best Top1 at epoch [80/100], Top1:83.333, Top-3:100.000
2026-01-24 16:17:14.606 | INFO     | __main__:main_worker:476 - Training of experiment: HiFuse_Small_1e-5-0.05/ft_eval is done.
2026-01-24 16:17:14.608 | INFO     | __main__:main_worker:478 - 	Best Top1 at epoch [80/100], Top1:83.333, Top3:100.000
/home/backup/lh/KD/mae_lite/tools/train.py:483: DeprecationWarning: The 'stop()' method is deprecated, please use 'remove()' instead
  logger.stop()

Process finished with exit code 0
